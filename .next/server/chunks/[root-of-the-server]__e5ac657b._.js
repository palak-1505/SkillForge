module.exports=[47909,(e,t,r)=>{t.exports=e.r(61724)},93780,81493,26256,87285,1262,17863,58316,66276,431,38901,84886,e=>{"use strict";function t(e){return Symbol.for(e)}e.s(["ContextAPI",()=>O],93780),e.s(["ROOT_CONTEXT",()=>i,"createContextKey",()=>t],81493);var r,n,i=new function e(t){var r=this;r._currentContext=t?new Map(t):new Map,r.getValue=function(e){return r._currentContext.get(e)},r.setValue=function(t,n){var i=new e(r._currentContext);return i._currentContext.set(t,n),i},r.deleteValue=function(t){var n=new e(r._currentContext);return n._currentContext.delete(t),n}},s=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o},o=function(e,t,r){if(r||2==arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},a=function(){function e(){}return e.prototype.active=function(){return i},e.prototype.with=function(e,t,r){for(var n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];return t.call.apply(t,o([r],s(n),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}();e.s(["getGlobal",()=>f,"registerGlobal",()=>p,"unregisterGlobal",()=>g],26256);var l="object"==typeof globalThis?globalThis:e.g,u="1.9.0",c=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,d=function(e){var t=new Set([e]),r=new Set,n=e.match(c);if(!n)return function(){return!1};var i={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(null!=i.prerelease)return function(t){return t===e};function s(e){return r.add(e),!1}return function(e){if(t.has(e))return!0;if(r.has(e))return!1;var n=e.match(c);if(!n)return s(e);var o={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(null!=o.prerelease||i.major!==o.major)return s(e);if(0===i.major)return i.minor===o.minor&&i.patch<=o.patch?(t.add(e),!0):s(e);return i.minor<=o.minor?(t.add(e),!0):s(e)}}(u),h=Symbol.for("opentelemetry.js.api."+u.split(".")[0]);function p(e,t,r,n){void 0===n&&(n=!1);var i,s=l[h]=null!=(i=l[h])?i:{version:u};if(!n&&s[e]){var o=Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return r.error(o.stack||o.message),!1}if(s.version!==u){var o=Error("@opentelemetry/api: Registration of version v"+s.version+" for "+e+" does not match previously registered API v"+u);return r.error(o.stack||o.message),!1}return s[e]=t,r.debug("@opentelemetry/api: Registered a global for "+e+" v"+u+"."),!0}function f(e){var t,r,n=null==(t=l[h])?void 0:t.version;if(n&&d(n))return null==(r=l[h])?void 0:r[e]}function g(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+u+".");var r=l[h];r&&delete r[e]}e.s(["DiagAPI",()=>S],1262);var m=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o},y=function(e,t,r){if(r||2==arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},v=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return _("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return _("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return _("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return _("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return _("verbose",this._namespace,e)},e}();function _(e,t,r){var n=f("diag");if(n)return r.unshift(t),n[e].apply(n,y([],m(r),!1))}e.s(["DiagLogLevel",()=>r],87285),function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(r||(r={}));var b=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o},E=function(e,t,r){if(r||2==arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},S=function(){function e(){function e(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=f("diag");if(n)return n[e].apply(n,E([],b(t),!1))}}var t=this;t.setLogger=function(e,n){if(void 0===n&&(n={logLevel:r.INFO}),e===t){var i,s,o,a=Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!=(i=a.stack)?i:a.message),!1}"number"==typeof n&&(n={logLevel:n});var l=f("diag"),u=function(e,t){function n(r,n){var i=t[r];return"function"==typeof i&&e>=n?i.bind(t):function(){}}return e<r.NONE?e=r.NONE:e>r.ALL&&(e=r.ALL),t=t||{},{error:n("error",r.ERROR),warn:n("warn",r.WARN),info:n("info",r.INFO),debug:n("debug",r.DEBUG),verbose:n("verbose",r.VERBOSE)}}(null!=(s=n.logLevel)?s:r.INFO,e);if(l&&!n.suppressOverrideMessage){var c=null!=(o=Error().stack)?o:"<failed to generate stacktrace>";l.warn("Current logger will be overwritten from "+c),u.warn("Current logger will overwrite one already registered from "+c)}return p("diag",u,t,!0)},t.disable=function(){g("diag",t)},t.createComponentLogger=function(e){return new v(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),w=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o},T=function(e,t,r){if(r||2==arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},C="context",A=new a,O=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return p(C,e,S.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,r){for(var n,i=[],s=3;s<arguments.length;s++)i[s-3]=arguments[s];return(n=this._getContextManager()).with.apply(n,T([e,t,r],w(i),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return f(C)||A},e.prototype.disable=function(){this._getContextManager().disable(),g(C,S.instance())},e}();e.s(["trace",()=>X],84886),e.s(["ProxyTracerProvider",()=>Y],38901),e.s(["ProxyTracer",()=>J],431),e.s(["INVALID_SPANID",()=>x,"INVALID_SPAN_CONTEXT",()=>k,"INVALID_TRACEID",()=>I],58316),e.s(["TraceFlags",()=>n],17863),function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(n||(n={}));var x="0000000000000000",I="00000000000000000000000000000000",k={traceId:I,spanId:x,traceFlags:n.NONE},R=function(){function e(e){void 0===e&&(e=k),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.addLink=function(e){return this},e.prototype.addLinks=function(e){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),P=t("OpenTelemetry Context Key SPAN");function N(e){return e.getValue(P)||void 0}function D(){return N(O.getInstance().active())}function M(e,t){return e.setValue(P,t)}function j(e){return e.deleteValue(P)}function U(e,t){return M(e,new R(t))}function L(e){var t;return null==(t=N(e))?void 0:t.spanContext()}e.s(["isSpanContextValid",()=>H,"isValidSpanId",()=>G,"isValidTraceId",()=>q,"wrapSpanContext",()=>$],66276);var F=/^([0-9a-f]{32})$/i,B=/^[0-9a-f]{16}$/i;function q(e){return F.test(e)&&e!==I}function G(e){return B.test(e)&&e!==x}function H(e){return q(e.traceId)&&G(e.spanId)}function $(e){return new R(e)}var V=O.getInstance(),K=function(){function e(){}return e.prototype.startSpan=function(e,t,r){if(void 0===r&&(r=V.active()),null==t?void 0:t.root)return new R;var n,i=r&&L(r);return"object"==typeof(n=i)&&"string"==typeof n.spanId&&"string"==typeof n.traceId&&"number"==typeof n.traceFlags&&H(i)?new R(i):new R},e.prototype.startActiveSpan=function(e,t,r,n){if(!(arguments.length<2)){2==arguments.length?o=t:3==arguments.length?(i=t,o=r):(i=t,s=r,o=n);var i,s,o,a=null!=s?s:V.active(),l=this.startSpan(e,i,a),u=M(a,l);return V.with(u,o,void 0,l)}},e}(),z=new K,J=function(){function e(e,t,r,n){this._provider=e,this.name=t,this.version=r,this.options=n}return e.prototype.startSpan=function(e,t,r){return this._getTracer().startSpan(e,t,r)},e.prototype.startActiveSpan=function(e,t,r,n){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):z},e}(),W=new(function(){function e(){}return e.prototype.getTracer=function(e,t,r){return new K},e}()),Y=function(){function e(){}return e.prototype.getTracer=function(e,t,r){var n;return null!=(n=this.getDelegateTracer(e,t,r))?n:new J(this,e,t,r)},e.prototype.getDelegate=function(){var e;return null!=(e=this._delegate)?e:W},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,r){var n;return null==(n=this._delegate)?void 0:n.getTracer(e,t,r)},e}(),Z="trace",X=(function(){function e(){this._proxyTracerProvider=new Y,this.wrapSpanContext=$,this.isSpanContextValid=H,this.deleteSpan=j,this.getSpan=N,this.getActiveSpan=D,this.getSpanContext=L,this.setSpan=M,this.setSpanContext=U}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=p(Z,this._proxyTracerProvider,S.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return f(Z)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){g(Z,S.instance()),this._proxyTracerProvider=new Y},e})().getInstance()},7896,e=>{"use strict";e.s(["DiagConsoleLogger",()=>er,"DiagLogLevel",()=>en.DiagLogLevel,"INVALID_SPANID",()=>ef.INVALID_SPANID,"INVALID_SPAN_CONTEXT",()=>ef.INVALID_SPAN_CONTEXT,"INVALID_TRACEID",()=>ef.INVALID_TRACEID,"ProxyTracer",()=>ei.ProxyTracer,"ProxyTracerProvider",()=>es.ProxyTracerProvider,"ROOT_CONTEXT",()=>ee.ROOT_CONTEXT,"SamplingDecision",()=>r,"SpanKind",()=>n,"SpanStatusCode",()=>i,"TraceFlags",()=>eo.TraceFlags,"ValueType",()=>t,"baggageEntryMetadataFromString",()=>J,"context",()=>o,"createContextKey",()=>ee.createContextKey,"createNoopMeter",()=>x,"createTraceState",()=>eh,"default",()=>Q,"defaultTextMapGetter",()=>D,"defaultTextMapSetter",()=>M,"diag",()=>l,"isSpanContextValid",()=>ep.isSpanContextValid,"isValidSpanId",()=>ep.isValidSpanId,"isValidTraceId",()=>ep.isValidTraceId,"metrics",()=>P,"propagation",()=>Z,"trace",()=>eg.trace],7896),e.s(["default",()=>Q],25447);var t,r,n,i,s=e.i(93780),o=s.ContextAPI.getInstance(),a=e.i(1262),l=a.DiagAPI.instance(),u=function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),c=function(){function e(){}return e.prototype.createGauge=function(e,t){return S},e.prototype.createHistogram=function(e,t){return w},e.prototype.createCounter=function(e,t){return E},e.prototype.createUpDownCounter=function(e,t){return T},e.prototype.createObservableGauge=function(e,t){return A},e.prototype.createObservableCounter=function(e,t){return C},e.prototype.createObservableUpDownCounter=function(e,t){return O},e.prototype.addBatchObservableCallback=function(e,t){},e.prototype.removeBatchObservableCallback=function(e){},e}(),d=function(){},h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.add=function(e,t){},t}(d),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.add=function(e,t){},t}(d),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.record=function(e,t){},t}(d),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.record=function(e,t){},t}(d),m=function(){function e(){}return e.prototype.addCallback=function(e){},e.prototype.removeCallback=function(e){},e}(),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t}(m),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t}(m),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t}(m),b=new c,E=new h,S=new f,w=new g,T=new p,C=new y,A=new v,O=new _;function x(){return b}var I=new(function(){function e(){}return e.prototype.getMeter=function(e,t,r){return b},e}()),k=e.i(26256),R="metrics",P=(function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalMeterProvider=function(e){return(0,k.registerGlobal)(R,e,a.DiagAPI.instance())},e.prototype.getMeterProvider=function(){return(0,k.getGlobal)(R)||I},e.prototype.getMeter=function(e,t,r){return this.getMeterProvider().getMeter(e,t,r)},e.prototype.disable=function(){(0,k.unregisterGlobal)(R,a.DiagAPI.instance())},e})().getInstance(),N=function(){function e(){}return e.prototype.inject=function(e,t){},e.prototype.extract=function(e,t){return e},e.prototype.fields=function(){return[]},e}(),D={get:function(e,t){if(null!=e)return e[t]},keys:function(e){return null==e?[]:Object.keys(e)}},M={set:function(e,t,r){null!=e&&(e[t]=r)}},j=e.i(81493),U=(0,j.createContextKey)("OpenTelemetry Baggage Key");function L(e){return e.getValue(U)||void 0}function F(){return L(s.ContextAPI.getInstance().active())}function B(e,t){return e.setValue(U,t)}function q(e){return e.deleteValue(U)}var G=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o},H=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},$=function(){function e(e){this._entries=e?new Map(e):new Map}return e.prototype.getEntry=function(e){var t=this._entries.get(e);if(t)return Object.assign({},t)},e.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(e){var t=G(e,2);return[t[0],t[1]]})},e.prototype.setEntry=function(t,r){var n=new e(this._entries);return n._entries.set(t,r),n},e.prototype.removeEntry=function(t){var r=new e(this._entries);return r._entries.delete(t),r},e.prototype.removeEntries=function(){for(var t,r,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=new e(this._entries);try{for(var o=H(n),a=o.next();!a.done;a=o.next()){var l=a.value;s._entries.delete(l)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return s},e.prototype.clear=function(){return new e},e}(),V=Symbol("BaggageEntryMetadata"),K=a.DiagAPI.instance();function z(e){return void 0===e&&(e={}),new $(new Map(Object.entries(e)))}function J(e){return"string"!=typeof e&&(K.error("Cannot create baggage metadata from unknown type: "+typeof e),e=""),{__TYPE__:V,toString:function(){return e}}}var W="propagation",Y=new N,Z=(function(){function e(){this.createBaggage=z,this.getBaggage=L,this.getActiveBaggage=F,this.setBaggage=B,this.deleteBaggage=q}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(e){return(0,k.registerGlobal)(W,e,a.DiagAPI.instance())},e.prototype.inject=function(e,t,r){return void 0===r&&(r=M),this._getGlobalPropagator().inject(e,t,r)},e.prototype.extract=function(e,t,r){return void 0===r&&(r=D),this._getGlobalPropagator().extract(e,t,r)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){(0,k.unregisterGlobal)(W,a.DiagAPI.instance())},e.prototype._getGlobalPropagator=function(){return(0,k.getGlobal)(W)||Y},e})().getInstance(),X=e.i(84886);let Q={context:o,diag:l,metrics:P,propagation:Z,trace:X.trace};e.i(25447);var ee=j,et=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],er=function(){for(var e=0;e<et.length;e++)this[et[e].n]=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(console){var n=console[e];if("function"!=typeof n&&(n=console.log),"function"==typeof n)return n.apply(console,t)}}}(et[e].c)},en=e.i(87285);!function(e){e[e.INT=0]="INT",e[e.DOUBLE=1]="DOUBLE"}(t||(t={}));var ei=e.i(431),es=e.i(38901);!function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(r||(r={})),function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(n||(n={})),function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(i||(i={}));var eo=e.i(17863),ea="[_0-9a-z-*/]",el=RegExp("^(?:[a-z]"+ea+"{0,255}|"+("[a-z0-9]"+ea+"{0,240}@[a-z]")+ea+"{0,13})$"),eu=/^[ -~]{0,255}[!-~]$/,ec=/,|=/,ed=function(){function e(e){this._internalState=new Map,e&&this._parse(e)}return e.prototype.set=function(e,t){var r=this._clone();return r._internalState.has(e)&&r._internalState.delete(e),r._internalState.set(e,t),r},e.prototype.unset=function(e){var t=this._clone();return t._internalState.delete(e),t},e.prototype.get=function(e){return this._internalState.get(e)},e.prototype.serialize=function(){var e=this;return this._keys().reduce(function(t,r){return t.push(r+"="+e.get(r)),t},[]).join(",")},e.prototype._parse=function(e){!(e.length>512)&&(this._internalState=e.split(",").reverse().reduce(function(e,t){var r=t.trim(),n=r.indexOf("=");if(-1!==n){var i=r.slice(0,n),s=r.slice(n+1,t.length);el.test(i)&&eu.test(s)&&!ec.test(s)&&e.set(i,s)}return e},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},e.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},e.prototype._clone=function(){var t=new e;return t._internalState=new Map(this._internalState),t},e}();function eh(e){return new ed(e)}var ep=e.i(66276),ef=e.i(58316),eg=X},17413,(e,t,r)=>{(()=>{"use strict";var r={491:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ContextAPI=void 0;let n=r(223),i=r(172),s=r(930),o="context",a=new n.NoopContextManager;class l{constructor(){}static getInstance(){return this._instance||(this._instance=new l),this._instance}setGlobalContextManager(e){return(0,i.registerGlobal)(o,e,s.DiagAPI.instance())}active(){return this._getContextManager().active()}with(e,t,r,...n){return this._getContextManager().with(e,t,r,...n)}bind(e,t){return this._getContextManager().bind(e,t)}_getContextManager(){return(0,i.getGlobal)(o)||a}disable(){this._getContextManager().disable(),(0,i.unregisterGlobal)(o,s.DiagAPI.instance())}}t.ContextAPI=l},930:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagAPI=void 0;let n=r(56),i=r(912),s=r(957),o=r(172);class a{constructor(){function e(e){return function(...t){let r=(0,o.getGlobal)("diag");if(r)return r[e](...t)}}let t=this;t.setLogger=(e,r={logLevel:s.DiagLogLevel.INFO})=>{var n,a,l;if(e===t){let e=Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!=(n=e.stack)?n:e.message),!1}"number"==typeof r&&(r={logLevel:r});let u=(0,o.getGlobal)("diag"),c=(0,i.createLogLevelDiagLogger)(null!=(a=r.logLevel)?a:s.DiagLogLevel.INFO,e);if(u&&!r.suppressOverrideMessage){let e=null!=(l=Error().stack)?l:"<failed to generate stacktrace>";u.warn(`Current logger will be overwritten from ${e}`),c.warn(`Current logger will overwrite one already registered from ${e}`)}return(0,o.registerGlobal)("diag",c,t,!0)},t.disable=()=>{(0,o.unregisterGlobal)("diag",t)},t.createComponentLogger=e=>new n.DiagComponentLogger(e),t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}static instance(){return this._instance||(this._instance=new a),this._instance}}t.DiagAPI=a},653:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsAPI=void 0;let n=r(660),i=r(172),s=r(930),o="metrics";class a{constructor(){}static getInstance(){return this._instance||(this._instance=new a),this._instance}setGlobalMeterProvider(e){return(0,i.registerGlobal)(o,e,s.DiagAPI.instance())}getMeterProvider(){return(0,i.getGlobal)(o)||n.NOOP_METER_PROVIDER}getMeter(e,t,r){return this.getMeterProvider().getMeter(e,t,r)}disable(){(0,i.unregisterGlobal)(o,s.DiagAPI.instance())}}t.MetricsAPI=a},181:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PropagationAPI=void 0;let n=r(172),i=r(874),s=r(194),o=r(277),a=r(369),l=r(930),u="propagation",c=new i.NoopTextMapPropagator;class d{constructor(){this.createBaggage=a.createBaggage,this.getBaggage=o.getBaggage,this.getActiveBaggage=o.getActiveBaggage,this.setBaggage=o.setBaggage,this.deleteBaggage=o.deleteBaggage}static getInstance(){return this._instance||(this._instance=new d),this._instance}setGlobalPropagator(e){return(0,n.registerGlobal)(u,e,l.DiagAPI.instance())}inject(e,t,r=s.defaultTextMapSetter){return this._getGlobalPropagator().inject(e,t,r)}extract(e,t,r=s.defaultTextMapGetter){return this._getGlobalPropagator().extract(e,t,r)}fields(){return this._getGlobalPropagator().fields()}disable(){(0,n.unregisterGlobal)(u,l.DiagAPI.instance())}_getGlobalPropagator(){return(0,n.getGlobal)(u)||c}}t.PropagationAPI=d},997:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceAPI=void 0;let n=r(172),i=r(846),s=r(139),o=r(607),a=r(930),l="trace";class u{constructor(){this._proxyTracerProvider=new i.ProxyTracerProvider,this.wrapSpanContext=s.wrapSpanContext,this.isSpanContextValid=s.isSpanContextValid,this.deleteSpan=o.deleteSpan,this.getSpan=o.getSpan,this.getActiveSpan=o.getActiveSpan,this.getSpanContext=o.getSpanContext,this.setSpan=o.setSpan,this.setSpanContext=o.setSpanContext}static getInstance(){return this._instance||(this._instance=new u),this._instance}setGlobalTracerProvider(e){let t=(0,n.registerGlobal)(l,this._proxyTracerProvider,a.DiagAPI.instance());return t&&this._proxyTracerProvider.setDelegate(e),t}getTracerProvider(){return(0,n.getGlobal)(l)||this._proxyTracerProvider}getTracer(e,t){return this.getTracerProvider().getTracer(e,t)}disable(){(0,n.unregisterGlobal)(l,a.DiagAPI.instance()),this._proxyTracerProvider=new i.ProxyTracerProvider}}t.TraceAPI=u},277:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteBaggage=t.setBaggage=t.getActiveBaggage=t.getBaggage=void 0;let n=r(491),i=(0,r(780).createContextKey)("OpenTelemetry Baggage Key");function s(e){return e.getValue(i)||void 0}t.getBaggage=s,t.getActiveBaggage=function(){return s(n.ContextAPI.getInstance().active())},t.setBaggage=function(e,t){return e.setValue(i,t)},t.deleteBaggage=function(e){return e.deleteValue(i)}},993:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaggageImpl=void 0;class r{constructor(e){this._entries=e?new Map(e):new Map}getEntry(e){let t=this._entries.get(e);if(t)return Object.assign({},t)}getAllEntries(){return Array.from(this._entries.entries()).map(([e,t])=>[e,t])}setEntry(e,t){let n=new r(this._entries);return n._entries.set(e,t),n}removeEntry(e){let t=new r(this._entries);return t._entries.delete(e),t}removeEntries(...e){let t=new r(this._entries);for(let r of e)t._entries.delete(r);return t}clear(){return new r}}t.BaggageImpl=r},830:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.baggageEntryMetadataSymbol=void 0,t.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")},369:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.baggageEntryMetadataFromString=t.createBaggage=void 0;let n=r(930),i=r(993),s=r(830),o=n.DiagAPI.instance();t.createBaggage=function(e={}){return new i.BaggageImpl(new Map(Object.entries(e)))},t.baggageEntryMetadataFromString=function(e){return"string"!=typeof e&&(o.error(`Cannot create baggage metadata from unknown type: ${typeof e}`),e=""),{__TYPE__:s.baggageEntryMetadataSymbol,toString:()=>e}}},67:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.context=void 0,t.context=r(491).ContextAPI.getInstance()},223:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopContextManager=void 0;let n=r(780);t.NoopContextManager=class{active(){return n.ROOT_CONTEXT}with(e,t,r,...n){return t.call(r,...n)}bind(e,t){return t}enable(){return this}disable(){return this}}},780:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ROOT_CONTEXT=t.createContextKey=void 0,t.createContextKey=function(e){return Symbol.for(e)};class r{constructor(e){let t=this;t._currentContext=e?new Map(e):new Map,t.getValue=e=>t._currentContext.get(e),t.setValue=(e,n)=>{let i=new r(t._currentContext);return i._currentContext.set(e,n),i},t.deleteValue=e=>{let n=new r(t._currentContext);return n._currentContext.delete(e),n}}}t.ROOT_CONTEXT=new r},506:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.diag=void 0,t.diag=r(930).DiagAPI.instance()},56:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagComponentLogger=void 0;let n=r(172);function i(e,t,r){let i=(0,n.getGlobal)("diag");if(i)return r.unshift(t),i[e](...r)}t.DiagComponentLogger=class{constructor(e){this._namespace=e.namespace||"DiagComponentLogger"}debug(...e){return i("debug",this._namespace,e)}error(...e){return i("error",this._namespace,e)}info(...e){return i("info",this._namespace,e)}warn(...e){return i("warn",this._namespace,e)}verbose(...e){return i("verbose",this._namespace,e)}}},972:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagConsoleLogger=void 0;let r=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}];t.DiagConsoleLogger=class{constructor(){for(let e=0;e<r.length;e++)this[r[e].n]=function(e){return function(...t){if(console){let r=console[e];if("function"!=typeof r&&(r=console.log),"function"==typeof r)return r.apply(console,t)}}}(r[e].c)}}},912:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLogLevelDiagLogger=void 0;let n=r(957);t.createLogLevelDiagLogger=function(e,t){function r(r,n){let i=t[r];return"function"==typeof i&&e>=n?i.bind(t):function(){}}return e<n.DiagLogLevel.NONE?e=n.DiagLogLevel.NONE:e>n.DiagLogLevel.ALL&&(e=n.DiagLogLevel.ALL),t=t||{},{error:r("error",n.DiagLogLevel.ERROR),warn:r("warn",n.DiagLogLevel.WARN),info:r("info",n.DiagLogLevel.INFO),debug:r("debug",n.DiagLogLevel.DEBUG),verbose:r("verbose",n.DiagLogLevel.VERBOSE)}}},957:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagLogLevel=void 0,function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(t.DiagLogLevel||(t.DiagLogLevel={}))},172:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unregisterGlobal=t.getGlobal=t.registerGlobal=void 0;let n=r(200),i=r(521),s=r(130),o=i.VERSION.split(".")[0],a=Symbol.for(`opentelemetry.js.api.${o}`),l=n._globalThis;t.registerGlobal=function(e,t,r,n=!1){var s;let o=l[a]=null!=(s=l[a])?s:{version:i.VERSION};if(!n&&o[e]){let t=Error(`@opentelemetry/api: Attempted duplicate registration of API: ${e}`);return r.error(t.stack||t.message),!1}if(o.version!==i.VERSION){let t=Error(`@opentelemetry/api: Registration of version v${o.version} for ${e} does not match previously registered API v${i.VERSION}`);return r.error(t.stack||t.message),!1}return o[e]=t,r.debug(`@opentelemetry/api: Registered a global for ${e} v${i.VERSION}.`),!0},t.getGlobal=function(e){var t,r;let n=null==(t=l[a])?void 0:t.version;if(n&&(0,s.isCompatible)(n))return null==(r=l[a])?void 0:r[e]},t.unregisterGlobal=function(e,t){t.debug(`@opentelemetry/api: Unregistering a global for ${e} v${i.VERSION}.`);let r=l[a];r&&delete r[e]}},130:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCompatible=t._makeCompatibilityCheck=void 0;let n=r(521),i=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function s(e){let t=new Set([e]),r=new Set,n=e.match(i);if(!n)return()=>!1;let s={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(null!=s.prerelease)return function(t){return t===e};function o(e){return r.add(e),!1}return function(e){if(t.has(e))return!0;if(r.has(e))return!1;let n=e.match(i);if(!n)return o(e);let a={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(null!=a.prerelease||s.major!==a.major)return o(e);if(0===s.major)return s.minor===a.minor&&s.patch<=a.patch?(t.add(e),!0):o(e);return s.minor<=a.minor?(t.add(e),!0):o(e)}}t._makeCompatibilityCheck=s,t.isCompatible=s(n.VERSION)},886:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.metrics=void 0,t.metrics=r(653).MetricsAPI.getInstance()},901:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ValueType=void 0,function(e){e[e.INT=0]="INT",e[e.DOUBLE=1]="DOUBLE"}(t.ValueType||(t.ValueType={}))},102:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createNoopMeter=t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=t.NOOP_OBSERVABLE_GAUGE_METRIC=t.NOOP_OBSERVABLE_COUNTER_METRIC=t.NOOP_UP_DOWN_COUNTER_METRIC=t.NOOP_HISTOGRAM_METRIC=t.NOOP_COUNTER_METRIC=t.NOOP_METER=t.NoopObservableUpDownCounterMetric=t.NoopObservableGaugeMetric=t.NoopObservableCounterMetric=t.NoopObservableMetric=t.NoopHistogramMetric=t.NoopUpDownCounterMetric=t.NoopCounterMetric=t.NoopMetric=t.NoopMeter=void 0;class r{constructor(){}createHistogram(e,r){return t.NOOP_HISTOGRAM_METRIC}createCounter(e,r){return t.NOOP_COUNTER_METRIC}createUpDownCounter(e,r){return t.NOOP_UP_DOWN_COUNTER_METRIC}createObservableGauge(e,r){return t.NOOP_OBSERVABLE_GAUGE_METRIC}createObservableCounter(e,r){return t.NOOP_OBSERVABLE_COUNTER_METRIC}createObservableUpDownCounter(e,r){return t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC}addBatchObservableCallback(e,t){}removeBatchObservableCallback(e){}}t.NoopMeter=r;class n{}t.NoopMetric=n;class i extends n{add(e,t){}}t.NoopCounterMetric=i;class s extends n{add(e,t){}}t.NoopUpDownCounterMetric=s;class o extends n{record(e,t){}}t.NoopHistogramMetric=o;class a{addCallback(e){}removeCallback(e){}}t.NoopObservableMetric=a;class l extends a{}t.NoopObservableCounterMetric=l;class u extends a{}t.NoopObservableGaugeMetric=u;class c extends a{}t.NoopObservableUpDownCounterMetric=c,t.NOOP_METER=new r,t.NOOP_COUNTER_METRIC=new i,t.NOOP_HISTOGRAM_METRIC=new o,t.NOOP_UP_DOWN_COUNTER_METRIC=new s,t.NOOP_OBSERVABLE_COUNTER_METRIC=new l,t.NOOP_OBSERVABLE_GAUGE_METRIC=new u,t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=new c,t.createNoopMeter=function(){return t.NOOP_METER}},660:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_METER_PROVIDER=t.NoopMeterProvider=void 0;let n=r(102);class i{getMeter(e,t,r){return n.NOOP_METER}}t.NoopMeterProvider=i,t.NOOP_METER_PROVIDER=new i},200:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(46),t)},651:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r._globalThis=void 0,r._globalThis="object"==typeof globalThis?globalThis:e.g},46:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(651),t)},939:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.propagation=void 0,t.propagation=r(181).PropagationAPI.getInstance()},874:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTextMapPropagator=void 0,t.NoopTextMapPropagator=class{inject(e,t){}extract(e,t){return e}fields(){return[]}}},194:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultTextMapSetter=t.defaultTextMapGetter=void 0,t.defaultTextMapGetter={get(e,t){if(null!=e)return e[t]},keys:e=>null==e?[]:Object.keys(e)},t.defaultTextMapSetter={set(e,t,r){null!=e&&(e[t]=r)}}},845:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.trace=void 0,t.trace=r(997).TraceAPI.getInstance()},403:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NonRecordingSpan=void 0;let n=r(476);t.NonRecordingSpan=class{constructor(e=n.INVALID_SPAN_CONTEXT){this._spanContext=e}spanContext(){return this._spanContext}setAttribute(e,t){return this}setAttributes(e){return this}addEvent(e,t){return this}setStatus(e){return this}updateName(e){return this}end(e){}isRecording(){return!1}recordException(e,t){}}},614:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTracer=void 0;let n=r(491),i=r(607),s=r(403),o=r(139),a=n.ContextAPI.getInstance();t.NoopTracer=class{startSpan(e,t,r=a.active()){var n;if(null==t?void 0:t.root)return new s.NonRecordingSpan;let l=r&&(0,i.getSpanContext)(r);return"object"==typeof(n=l)&&"string"==typeof n.spanId&&"string"==typeof n.traceId&&"number"==typeof n.traceFlags&&(0,o.isSpanContextValid)(l)?new s.NonRecordingSpan(l):new s.NonRecordingSpan}startActiveSpan(e,t,r,n){let s,o,l;if(arguments.length<2)return;2==arguments.length?l=t:3==arguments.length?(s=t,l=r):(s=t,o=r,l=n);let u=null!=o?o:a.active(),c=this.startSpan(e,s,u),d=(0,i.setSpan)(u,c);return a.with(d,l,void 0,c)}}},124:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTracerProvider=void 0;let n=r(614);t.NoopTracerProvider=class{getTracer(e,t,r){return new n.NoopTracer}}},125:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTracer=void 0;let n=new(r(614)).NoopTracer;t.ProxyTracer=class{constructor(e,t,r,n){this._provider=e,this.name=t,this.version=r,this.options=n}startSpan(e,t,r){return this._getTracer().startSpan(e,t,r)}startActiveSpan(e,t,r,n){let i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)}_getTracer(){if(this._delegate)return this._delegate;let e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):n}}},846:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTracerProvider=void 0;let n=r(125),i=new(r(124)).NoopTracerProvider;t.ProxyTracerProvider=class{getTracer(e,t,r){var i;return null!=(i=this.getDelegateTracer(e,t,r))?i:new n.ProxyTracer(this,e,t,r)}getDelegate(){var e;return null!=(e=this._delegate)?e:i}setDelegate(e){this._delegate=e}getDelegateTracer(e,t,r){var n;return null==(n=this._delegate)?void 0:n.getTracer(e,t,r)}}},996:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SamplingDecision=void 0,function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(t.SamplingDecision||(t.SamplingDecision={}))},607:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSpanContext=t.setSpanContext=t.deleteSpan=t.setSpan=t.getActiveSpan=t.getSpan=void 0;let n=r(780),i=r(403),s=r(491),o=(0,n.createContextKey)("OpenTelemetry Context Key SPAN");function a(e){return e.getValue(o)||void 0}function l(e,t){return e.setValue(o,t)}t.getSpan=a,t.getActiveSpan=function(){return a(s.ContextAPI.getInstance().active())},t.setSpan=l,t.deleteSpan=function(e){return e.deleteValue(o)},t.setSpanContext=function(e,t){return l(e,new i.NonRecordingSpan(t))},t.getSpanContext=function(e){var t;return null==(t=a(e))?void 0:t.spanContext()}},325:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceStateImpl=void 0;let n=r(564);class i{constructor(e){this._internalState=new Map,e&&this._parse(e)}set(e,t){let r=this._clone();return r._internalState.has(e)&&r._internalState.delete(e),r._internalState.set(e,t),r}unset(e){let t=this._clone();return t._internalState.delete(e),t}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce((e,t)=>(e.push(t+"="+this.get(t)),e),[]).join(",")}_parse(e){!(e.length>512)&&(this._internalState=e.split(",").reverse().reduce((e,t)=>{let r=t.trim(),i=r.indexOf("=");if(-1!==i){let s=r.slice(0,i),o=r.slice(i+1,t.length);(0,n.validateKey)(s)&&(0,n.validateValue)(o)&&e.set(s,o)}return e},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let e=new i;return e._internalState=new Map(this._internalState),e}}t.TraceStateImpl=i},564:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validateValue=t.validateKey=void 0;let r="[_0-9a-z-*/]",n=`[a-z]${r}{0,255}`,i=`[a-z0-9]${r}{0,240}@[a-z]${r}{0,13}`,s=RegExp(`^(?:${n}|${i})$`),o=/^[ -~]{0,255}[!-~]$/,a=/,|=/;t.validateKey=function(e){return s.test(e)},t.validateValue=function(e){return o.test(e)&&!a.test(e)}},98:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTraceState=void 0;let n=r(325);t.createTraceState=function(e){return new n.TraceStateImpl(e)}},476:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.INVALID_SPAN_CONTEXT=t.INVALID_TRACEID=t.INVALID_SPANID=void 0;let n=r(475);t.INVALID_SPANID="0000000000000000",t.INVALID_TRACEID="00000000000000000000000000000000",t.INVALID_SPAN_CONTEXT={traceId:t.INVALID_TRACEID,spanId:t.INVALID_SPANID,traceFlags:n.TraceFlags.NONE}},357:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SpanKind=void 0,function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(t.SpanKind||(t.SpanKind={}))},139:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wrapSpanContext=t.isSpanContextValid=t.isValidSpanId=t.isValidTraceId=void 0;let n=r(476),i=r(403),s=/^([0-9a-f]{32})$/i,o=/^[0-9a-f]{16}$/i;function a(e){return s.test(e)&&e!==n.INVALID_TRACEID}function l(e){return o.test(e)&&e!==n.INVALID_SPANID}t.isValidTraceId=a,t.isValidSpanId=l,t.isSpanContextValid=function(e){return a(e.traceId)&&l(e.spanId)},t.wrapSpanContext=function(e){return new i.NonRecordingSpan(e)}},847:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SpanStatusCode=void 0,function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(t.SpanStatusCode||(t.SpanStatusCode={}))},475:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceFlags=void 0,function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(t.TraceFlags||(t.TraceFlags={}))},521:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=void 0,t.VERSION="1.6.0"}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var s=n[e]={exports:{}},o=!0;try{r[e].call(s.exports,s,s.exports,i),o=!1}finally{o&&delete n[e]}return s.exports}i.ab="/ROOT/node_modules/next/dist/compiled/@opentelemetry/api/";var s={};(()=>{Object.defineProperty(s,"__esModule",{value:!0}),s.trace=s.propagation=s.metrics=s.diag=s.context=s.INVALID_SPAN_CONTEXT=s.INVALID_TRACEID=s.INVALID_SPANID=s.isValidSpanId=s.isValidTraceId=s.isSpanContextValid=s.createTraceState=s.TraceFlags=s.SpanStatusCode=s.SpanKind=s.SamplingDecision=s.ProxyTracerProvider=s.ProxyTracer=s.defaultTextMapSetter=s.defaultTextMapGetter=s.ValueType=s.createNoopMeter=s.DiagLogLevel=s.DiagConsoleLogger=s.ROOT_CONTEXT=s.createContextKey=s.baggageEntryMetadataFromString=void 0;var e=i(369);Object.defineProperty(s,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return e.baggageEntryMetadataFromString}});var t=i(780);Object.defineProperty(s,"createContextKey",{enumerable:!0,get:function(){return t.createContextKey}}),Object.defineProperty(s,"ROOT_CONTEXT",{enumerable:!0,get:function(){return t.ROOT_CONTEXT}});var r=i(972);Object.defineProperty(s,"DiagConsoleLogger",{enumerable:!0,get:function(){return r.DiagConsoleLogger}});var n=i(957);Object.defineProperty(s,"DiagLogLevel",{enumerable:!0,get:function(){return n.DiagLogLevel}});var o=i(102);Object.defineProperty(s,"createNoopMeter",{enumerable:!0,get:function(){return o.createNoopMeter}});var a=i(901);Object.defineProperty(s,"ValueType",{enumerable:!0,get:function(){return a.ValueType}});var l=i(194);Object.defineProperty(s,"defaultTextMapGetter",{enumerable:!0,get:function(){return l.defaultTextMapGetter}}),Object.defineProperty(s,"defaultTextMapSetter",{enumerable:!0,get:function(){return l.defaultTextMapSetter}});var u=i(125);Object.defineProperty(s,"ProxyTracer",{enumerable:!0,get:function(){return u.ProxyTracer}});var c=i(846);Object.defineProperty(s,"ProxyTracerProvider",{enumerable:!0,get:function(){return c.ProxyTracerProvider}});var d=i(996);Object.defineProperty(s,"SamplingDecision",{enumerable:!0,get:function(){return d.SamplingDecision}});var h=i(357);Object.defineProperty(s,"SpanKind",{enumerable:!0,get:function(){return h.SpanKind}});var p=i(847);Object.defineProperty(s,"SpanStatusCode",{enumerable:!0,get:function(){return p.SpanStatusCode}});var f=i(475);Object.defineProperty(s,"TraceFlags",{enumerable:!0,get:function(){return f.TraceFlags}});var g=i(98);Object.defineProperty(s,"createTraceState",{enumerable:!0,get:function(){return g.createTraceState}});var m=i(139);Object.defineProperty(s,"isSpanContextValid",{enumerable:!0,get:function(){return m.isSpanContextValid}}),Object.defineProperty(s,"isValidTraceId",{enumerable:!0,get:function(){return m.isValidTraceId}}),Object.defineProperty(s,"isValidSpanId",{enumerable:!0,get:function(){return m.isValidSpanId}});var y=i(476);Object.defineProperty(s,"INVALID_SPANID",{enumerable:!0,get:function(){return y.INVALID_SPANID}}),Object.defineProperty(s,"INVALID_TRACEID",{enumerable:!0,get:function(){return y.INVALID_TRACEID}}),Object.defineProperty(s,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return y.INVALID_SPAN_CONTEXT}});let v=i(67);Object.defineProperty(s,"context",{enumerable:!0,get:function(){return v.context}});let _=i(506);Object.defineProperty(s,"diag",{enumerable:!0,get:function(){return _.diag}});let b=i(886);Object.defineProperty(s,"metrics",{enumerable:!0,get:function(){return b.metrics}});let E=i(939);Object.defineProperty(s,"propagation",{enumerable:!0,get:function(){return E.propagation}});let S=i(845);Object.defineProperty(s,"trace",{enumerable:!0,get:function(){return S.trace}}),s.default={context:v.context,diag:_.diag,metrics:b.metrics,propagation:E.propagation,trace:S.trace}})(),t.exports=s})()},42315,(e,t,r)=>{"use strict";t.exports=e.r(18622)},47540,(e,t,r)=>{"use strict";t.exports=e.r(42315).vendored["react-rsc"].React},19481,(e,t,r)=>{"use strict";var n=Object.defineProperty,i=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,o=Object.prototype.hasOwnProperty,a={};function l(e){var t;let r=["path"in e&&e.path&&`Path=${e.path}`,"expires"in e&&(e.expires||0===e.expires)&&`Expires=${("number"==typeof e.expires?new Date(e.expires):e.expires).toUTCString()}`,"maxAge"in e&&"number"==typeof e.maxAge&&`Max-Age=${e.maxAge}`,"domain"in e&&e.domain&&`Domain=${e.domain}`,"secure"in e&&e.secure&&"Secure","httpOnly"in e&&e.httpOnly&&"HttpOnly","sameSite"in e&&e.sameSite&&`SameSite=${e.sameSite}`,"partitioned"in e&&e.partitioned&&"Partitioned","priority"in e&&e.priority&&`Priority=${e.priority}`].filter(Boolean),n=`${e.name}=${encodeURIComponent(null!=(t=e.value)?t:"")}`;return 0===r.length?n:`${n}; ${r.join("; ")}`}function u(e){let t=new Map;for(let r of e.split(/; */)){if(!r)continue;let e=r.indexOf("=");if(-1===e){t.set(r,"true");continue}let[n,i]=[r.slice(0,e),r.slice(e+1)];try{t.set(n,decodeURIComponent(null!=i?i:"true"))}catch{}}return t}function c(e){if(!e)return;let[[t,r],...n]=u(e),{domain:i,expires:s,httponly:o,maxage:a,path:l,samesite:c,secure:p,partitioned:f,priority:g}=Object.fromEntries(n.map(([e,t])=>[e.toLowerCase().replace(/-/g,""),t]));{var m,y,v={name:t,value:decodeURIComponent(r),domain:i,...s&&{expires:new Date(s)},...o&&{httpOnly:!0},..."string"==typeof a&&{maxAge:Number(a)},path:l,...c&&{sameSite:d.includes(m=(m=c).toLowerCase())?m:void 0},...p&&{secure:!0},...g&&{priority:h.includes(y=(y=g).toLowerCase())?y:void 0},...f&&{partitioned:!0}};let e={};for(let t in v)v[t]&&(e[t]=v[t]);return e}}((e,t)=>{for(var r in t)n(e,r,{get:t[r],enumerable:!0})})(a,{RequestCookies:()=>p,ResponseCookies:()=>f,parseCookie:()=>u,parseSetCookie:()=>c,stringifyCookie:()=>l}),t.exports=((e,t,r,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of s(t))o.call(e,l)||l===r||n(e,l,{get:()=>t[l],enumerable:!(a=i(t,l))||a.enumerable});return e})(n({},"__esModule",{value:!0}),a);var d=["strict","lax","none"],h=["low","medium","high"],p=class{constructor(e){this._parsed=new Map,this._headers=e;let t=e.get("cookie");if(t)for(let[e,r]of u(t))this._parsed.set(e,{name:e,value:r})}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed);if(!e.length)return r.map(([e,t])=>t);let n="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(([e])=>e===n).map(([e,t])=>t)}has(e){return this._parsed.has(e)}set(...e){let[t,r]=1===e.length?[e[0].name,e[0].value]:e,n=this._parsed;return n.set(t,{name:t,value:r}),this._headers.set("cookie",Array.from(n).map(([e,t])=>l(t)).join("; ")),this}delete(e){let t=this._parsed,r=Array.isArray(e)?e.map(e=>t.delete(e)):t.delete(e);return this._headers.set("cookie",Array.from(t).map(([e,t])=>l(t)).join("; ")),r}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(e=>`${e.name}=${encodeURIComponent(e.value)}`).join("; ")}},f=class{constructor(e){var t,r,n;this._parsed=new Map,this._headers=e;let i=null!=(n=null!=(r=null==(t=e.getSetCookie)?void 0:t.call(e))?r:e.get("set-cookie"))?n:[];for(let e of Array.isArray(i)?i:function(e){if(!e)return[];var t,r,n,i,s,o=[],a=0;function l(){for(;a<e.length&&/\s/.test(e.charAt(a));)a+=1;return a<e.length}for(;a<e.length;){for(t=a,s=!1;l();)if(","===(r=e.charAt(a))){for(n=a,a+=1,l(),i=a;a<e.length&&"="!==(r=e.charAt(a))&&";"!==r&&","!==r;)a+=1;a<e.length&&"="===e.charAt(a)?(s=!0,a=i,o.push(e.substring(t,n)),t=a):a=n+1}else a+=1;(!s||a>=e.length)&&o.push(e.substring(t,e.length))}return o}(i)){let t=c(e);t&&this._parsed.set(t.name,t)}}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed.values());if(!e.length)return r;let n="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(e=>e.name===n)}has(e){return this._parsed.has(e)}set(...e){let[t,r,n]=1===e.length?[e[0].name,e[0].value,e[0]]:e,i=this._parsed;return i.set(t,function(e={name:"",value:""}){return"number"==typeof e.expires&&(e.expires=new Date(e.expires)),e.maxAge&&(e.expires=new Date(Date.now()+1e3*e.maxAge)),(null===e.path||void 0===e.path)&&(e.path="/"),e}({name:t,value:r,...n})),function(e,t){for(let[,r]of(t.delete("set-cookie"),e)){let e=l(r);t.append("set-cookie",e)}}(i,this._headers),this}delete(...e){let[t,r]="string"==typeof e[0]?[e[0]]:[e[0].name,e[0]];return this.set({...r,name:t,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(l).join("; ")}}},93118,(e,t,r)=>{(()=>{"use strict";"undefined"!=typeof __nccwpck_require__&&(__nccwpck_require__.ab="/ROOT/node_modules/next/dist/compiled/cookie/");var e={};(()=>{e.parse=function(e,r){if("string"!=typeof e)throw TypeError("argument str must be a string");for(var i={},s=e.split(n),o=(r||{}).decode||t,a=0;a<s.length;a++){var l=s[a],u=l.indexOf("=");if(!(u<0)){var c=l.substr(0,u).trim(),d=l.substr(++u,l.length).trim();'"'==d[0]&&(d=d.slice(1,-1)),void 0==i[c]&&(i[c]=function(e,t){try{return t(e)}catch(t){return e}}(d,o))}}return i},e.serialize=function(e,t,n){var s=n||{},o=s.encode||r;if("function"!=typeof o)throw TypeError("option encode is invalid");if(!i.test(e))throw TypeError("argument name is invalid");var a=o(t);if(a&&!i.test(a))throw TypeError("argument val is invalid");var l=e+"="+a;if(null!=s.maxAge){var u=s.maxAge-0;if(isNaN(u)||!isFinite(u))throw TypeError("option maxAge is invalid");l+="; Max-Age="+Math.floor(u)}if(s.domain){if(!i.test(s.domain))throw TypeError("option domain is invalid");l+="; Domain="+s.domain}if(s.path){if(!i.test(s.path))throw TypeError("option path is invalid");l+="; Path="+s.path}if(s.expires){if("function"!=typeof s.expires.toUTCString)throw TypeError("option expires is invalid");l+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(l+="; HttpOnly"),s.secure&&(l+="; Secure"),s.sameSite)switch("string"==typeof s.sameSite?s.sameSite.toLowerCase():s.sameSite){case!0:case"strict":l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"none":l+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return l};var t=decodeURIComponent,r=encodeURIComponent,n=/; */,i=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/})(),t.exports=e})()},44376,(e,t,r)=>{t.exports=e.x("node:module",()=>require("node:module"))},12842,(e,t,r)=>{"use strict";let n=/(?:\\(u(?:[a-f\d]{4}|\{[a-f\d]{1,6}\})|x[a-f\d]{2}|.))|(?:\{(~)?(\w+(?:\([^)]*\))?(?:\.\w+(?:\([^)]*\))?)*)(?:[ \t]|(?=\r?\n)))|(\})|((?:.|[\r\n\f])+?)/gi,i=/(?:^|\.)(\w+)(?:\(([^)]*)\))?/g,s=/^(['"])((?:\\.|(?!\1)[^\\])*)\1$/,o=/\\(u(?:[a-f\d]{4}|{[a-f\d]{1,6}})|x[a-f\d]{2}|.)|([^\\])/gi,a=new Map([["n","\n"],["r","\r"],["t","	"],["b","\b"],["f","\f"],["v","\v"],["0","\0"],["\\","\\"],["e","\x1b"],["a","\x07"]]);function l(e){let t="u"===e[0],r="{"===e[1];return t&&!r&&5===e.length||"x"===e[0]&&3===e.length?String.fromCharCode(parseInt(e.slice(1),16)):t&&r?String.fromCodePoint(parseInt(e.slice(2,-1),16)):a.get(e)||e}function u(e,t){let r={};for(let e of t)for(let t of e.styles)r[t[0]]=e.inverse?null:t.slice(1);let n=e;for(let[e,t]of Object.entries(r))if(Array.isArray(t)){if(!(e in n))throw Error(`Unknown Chalk style: ${e}`);n=t.length>0?n[e](...t):n[e]}return n}t.exports=(e,t)=>{let r=[],a=[],c=[];if(t.replace(n,(t,n,d,h,p,f)=>{if(n)c.push(l(n));else if(h){let t=c.join("");c=[],a.push(0===r.length?t:u(e,r)(t)),r.push({inverse:d,styles:function(e){let t;i.lastIndex=0;let r=[];for(;null!==(t=i.exec(e));){let e=t[1];if(t[2]){let n=function(e,t){let r,n=[];for(let i of t.trim().split(/\s*,\s*/g)){let t=Number(i);if(Number.isNaN(t))if(r=i.match(s))n.push(r[2].replace(o,(e,t,r)=>t?l(t):r));else throw Error(`Invalid Chalk template style argument: ${i} (in style '${e}')`);else n.push(t)}return n}(e,t[2]);r.push([e].concat(n))}else r.push([e])}return r}(h)})}else if(p){if(0===r.length)throw Error("Found extraneous } in Chalk template literal");a.push(u(e,r)(c.join(""))),c=[],r.pop()}else c.push(f)}),a.push(c.join("")),r.length>0)throw Error(`Chalk template literal is missing ${r.length} closing bracket${1===r.length?"":"s"} (\`}\`)`);return a.join("")}},77235,(e,t,r)=>{"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},49779,(e,t,r)=>{let n=e.r(77235),i={};for(let e of Object.keys(n))i[n[e]]=e;let s={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(let e of(t.exports=s,Object.keys(s))){if(!("channels"in s[e]))throw Error("missing channels property: "+e);if(!("labels"in s[e]))throw Error("missing channel labels property: "+e);if(s[e].labels.length!==s[e].channels)throw Error("channel and label counts mismatch: "+e);let{channels:t,labels:r}=s[e];delete s[e].channels,delete s[e].labels,Object.defineProperty(s[e],"channels",{value:t}),Object.defineProperty(s[e],"labels",{value:r})}s.rgb.hsl=function(e){let t,r=e[0]/255,n=e[1]/255,i=e[2]/255,s=Math.min(r,n,i),o=Math.max(r,n,i),a=o-s;o===s?t=0:r===o?t=(n-i)/a:n===o?t=2+(i-r)/a:i===o&&(t=4+(r-n)/a),(t=Math.min(60*t,360))<0&&(t+=360);let l=(s+o)/2;return[t,100*(o===s?0:l<=.5?a/(o+s):a/(2-o-s)),100*l]},s.rgb.hsv=function(e){let t,r,n,i,s,o=e[0]/255,a=e[1]/255,l=e[2]/255,u=Math.max(o,a,l),c=u-Math.min(o,a,l),d=function(e){return(u-e)/6/c+.5};return 0===c?(i=0,s=0):(s=c/u,t=d(o),r=d(a),n=d(l),o===u?i=n-r:a===u?i=1/3+t-n:l===u&&(i=2/3+r-t),i<0?i+=1:i>1&&(i-=1)),[360*i,100*s,100*u]},s.rgb.hwb=function(e){let t=e[0],r=e[1],n=e[2];return[s.rgb.hsl(e)[0],1/255*Math.min(t,Math.min(r,n))*100,100*(n=1-1/255*Math.max(t,Math.max(r,n)))]},s.rgb.cmyk=function(e){let t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.min(1-t,1-r,1-n);return[100*((1-t-i)/(1-i)||0),100*((1-r-i)/(1-i)||0),100*((1-n-i)/(1-i)||0),100*i]},s.rgb.keyword=function(e){let t,r=i[e];if(r)return r;let s=1/0;for(let r of Object.keys(n)){let i=n[r],o=(e[0]-i[0])**2+(e[1]-i[1])**2+(e[2]-i[2])**2;o<s&&(s=o,t=r)}return t},s.keyword.rgb=function(e){return n[e]},s.rgb.xyz=function(e){let t=e[0]/255,r=e[1]/255,n=e[2]/255;return[100*(.4124*(t=t>.04045?((t+.055)/1.055)**2.4:t/12.92)+.3576*(r=r>.04045?((r+.055)/1.055)**2.4:r/12.92)+.1805*(n=n>.04045?((n+.055)/1.055)**2.4:n/12.92)),100*(.2126*t+.7152*r+.0722*n),100*(.0193*t+.1192*r+.9505*n)]},s.rgb.lab=function(e){let t=s.rgb.xyz(e),r=t[0],n=t[1],i=t[2];return r/=95.047,n/=100,i/=108.883,[116*(n=n>.008856?n**(1/3):7.787*n+16/116)-16,500*((r=r>.008856?r**(1/3):7.787*r+16/116)-n),200*(n-(i=i>.008856?i**(1/3):7.787*i+16/116))]},s.hsl.rgb=function(e){let t,r,n,i=e[0]/360,s=e[1]/100,o=e[2]/100;if(0===s)return[n=255*o,n,n];t=o<.5?o*(1+s):o+s-o*s;let a=2*o-t,l=[0,0,0];for(let e=0;e<3;e++)(r=i+-(1/3*(e-1)))<0&&r++,r>1&&r--,n=6*r<1?a+(t-a)*6*r:2*r<1?t:3*r<2?a+(t-a)*(2/3-r)*6:a,l[e]=255*n;return l},s.hsl.hsv=function(e){let t=e[0],r=e[1]/100,n=e[2]/100,i=r,s=Math.max(n,.01);n*=2,r*=n<=1?n:2-n,i*=s<=1?s:2-s;let o=(n+r)/2;return[t,100*(0===n?2*i/(s+i):2*r/(n+r)),100*o]},s.hsv.rgb=function(e){let t=e[0]/60,r=e[1]/100,n=e[2]/100,i=Math.floor(t)%6,s=t-Math.floor(t),o=255*n*(1-r),a=255*n*(1-r*s),l=255*n*(1-r*(1-s));switch(n*=255,i){case 0:return[n,l,o];case 1:return[a,n,o];case 2:return[o,n,l];case 3:return[o,a,n];case 4:return[l,o,n];case 5:return[n,o,a]}},s.hsv.hsl=function(e){let t,r,n=e[0],i=e[1]/100,s=e[2]/100,o=Math.max(s,.01);r=(2-i)*s;let a=(2-i)*o;return[n,100*(t=(t=i*o/(a<=1?a:2-a))||0),100*(r/=2)]},s.hwb.rgb=function(e){let t,r,n,i,s=e[0]/360,o=e[1]/100,a=e[2]/100,l=o+a;l>1&&(o/=l,a/=l);let u=Math.floor(6*s),c=1-a;t=6*s-u,(1&u)!=0&&(t=1-t);let d=o+t*(c-o);switch(u){default:case 6:case 0:r=c,n=d,i=o;break;case 1:r=d,n=c,i=o;break;case 2:r=o,n=c,i=d;break;case 3:r=o,n=d,i=c;break;case 4:r=d,n=o,i=c;break;case 5:r=c,n=o,i=d}return[255*r,255*n,255*i]},s.cmyk.rgb=function(e){let t=e[0]/100,r=e[1]/100,n=e[2]/100,i=e[3]/100;return[255*(1-Math.min(1,t*(1-i)+i)),255*(1-Math.min(1,r*(1-i)+i)),255*(1-Math.min(1,n*(1-i)+i))]},s.xyz.rgb=function(e){let t,r,n,i=e[0]/100,s=e[1]/100,o=e[2]/100;return t=(t=3.2406*i+-1.5372*s+-.4986*o)>.0031308?1.055*t**(1/2.4)-.055:12.92*t,r=(r=-.9689*i+1.8758*s+.0415*o)>.0031308?1.055*r**(1/2.4)-.055:12.92*r,n=(n=.0557*i+-.204*s+1.057*o)>.0031308?1.055*n**(1/2.4)-.055:12.92*n,[255*(t=Math.min(Math.max(0,t),1)),255*(r=Math.min(Math.max(0,r),1)),255*(n=Math.min(Math.max(0,n),1))]},s.xyz.lab=function(e){let t=e[0],r=e[1],n=e[2];return t/=95.047,r/=100,n/=108.883,[116*(r=r>.008856?r**(1/3):7.787*r+16/116)-16,500*((t=t>.008856?t**(1/3):7.787*t+16/116)-r),200*(r-(n=n>.008856?n**(1/3):7.787*n+16/116))]},s.lab.xyz=function(e){let t,r,n,i=e[0],s=e[1],o=e[2];t=s/500+(r=(i+16)/116),n=r-o/200;let a=r**3,l=t**3,u=n**3;return r=(a>.008856?a:(r-16/116)/7.787)*100,[t=(l>.008856?l:(t-16/116)/7.787)*95.047,r,n=(u>.008856?u:(n-16/116)/7.787)*108.883]},s.lab.lch=function(e){let t,r=e[0],n=e[1],i=e[2];return(t=360*Math.atan2(i,n)/2/Math.PI)<0&&(t+=360),[r,Math.sqrt(n*n+i*i),t]},s.lch.lab=function(e){let t=e[0],r=e[1],n=e[2]/360*2*Math.PI;return[t,r*Math.cos(n),r*Math.sin(n)]},s.rgb.ansi16=function(e,t=null){let[r,n,i]=e,o=null===t?s.rgb.hsv(e)[2]:t;if(0===(o=Math.round(o/50)))return 30;let a=30+(Math.round(i/255)<<2|Math.round(n/255)<<1|Math.round(r/255));return 2===o&&(a+=60),a},s.hsv.ansi16=function(e){return s.rgb.ansi16(s.hsv.rgb(e),e[2])},s.rgb.ansi256=function(e){let t=e[0],r=e[1],n=e[2];return t===r&&r===n?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(n/255*5)},s.ansi16.rgb=function(e){let t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];let r=(~~(e>50)+1)*.5;return[(1&t)*r*255,(t>>1&1)*r*255,(t>>2&1)*r*255]},s.ansi256.rgb=function(e){let t;if(e>=232){let t=(e-232)*10+8;return[t,t,t]}return[Math.floor((e-=16)/36)/5*255,Math.floor((t=e%36)/6)/5*255,t%6/5*255]},s.rgb.hex=function(e){let t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},s.hex.rgb=function(e){let t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let r=t[0];3===t[0].length&&(r=r.split("").map(e=>e+e).join(""));let n=parseInt(r,16);return[n>>16&255,n>>8&255,255&n]},s.rgb.hcg=function(e){let t,r=e[0]/255,n=e[1]/255,i=e[2]/255,s=Math.max(Math.max(r,n),i),o=Math.min(Math.min(r,n),i),a=s-o;return t=a<1?o/(1-a):0,[360*((a<=0?0:s===r?(n-i)/a%6:s===n?2+(i-r)/a:4+(r-n)/a)/6%1),100*a,100*t]},s.hsl.hcg=function(e){let t=e[1]/100,r=e[2]/100,n=r<.5?2*t*r:2*t*(1-r),i=0;return n<1&&(i=(r-.5*n)/(1-n)),[e[0],100*n,100*i]},s.hsv.hcg=function(e){let t=e[1]/100,r=e[2]/100,n=t*r,i=0;return n<1&&(i=(r-n)/(1-n)),[e[0],100*n,100*i]},s.hcg.rgb=function(e){let t=e[0]/360,r=e[1]/100,n=e[2]/100;if(0===r)return[255*n,255*n,255*n];let i=[0,0,0],s=t%1*6,o=s%1,a=1-o,l=0;switch(Math.floor(s)){case 0:i[0]=1,i[1]=o,i[2]=0;break;case 1:i[0]=a,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=o;break;case 3:i[0]=0,i[1]=a,i[2]=1;break;case 4:i[0]=o,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=a}return l=(1-r)*n,[(r*i[0]+l)*255,(r*i[1]+l)*255,(r*i[2]+l)*255]},s.hcg.hsv=function(e){let t=e[1]/100,r=t+e[2]/100*(1-t),n=0;return r>0&&(n=t/r),[e[0],100*n,100*r]},s.hcg.hsl=function(e){let t=e[1]/100,r=e[2]/100*(1-t)+.5*t,n=0;return r>0&&r<.5?n=t/(2*r):r>=.5&&r<1&&(n=t/(2*(1-r))),[e[0],100*n,100*r]},s.hcg.hwb=function(e){let t=e[1]/100,r=t+e[2]/100*(1-t);return[e[0],(r-t)*100,(1-r)*100]},s.hwb.hcg=function(e){let t=e[1]/100,r=1-e[2]/100,n=r-t,i=0;return n<1&&(i=(r-n)/(1-n)),[e[0],100*n,100*i]},s.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},s.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},s.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},s.gray.hsl=function(e){return[0,0,e[0]]},s.gray.hsv=s.gray.hsl,s.gray.hwb=function(e){return[0,100,e[0]]},s.gray.cmyk=function(e){return[0,0,0,e[0]]},s.gray.lab=function(e){return[e[0],0,0]},s.gray.hex=function(e){let t=255&Math.round(e[0]/100*255),r=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(r.length)+r},s.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},61443,(e,t,r)=>{let n=e.r(49779);t.exports=function(e){let t=function(e){let t=function(){let e={},t=Object.keys(n);for(let r=t.length,n=0;n<r;n++)e[t[n]]={distance:-1,parent:null};return e}(),r=[e];for(t[e].distance=0;r.length;){let e=r.pop(),i=Object.keys(n[e]);for(let n=i.length,s=0;s<n;s++){let n=i[s],o=t[n];-1===o.distance&&(o.distance=t[e].distance+1,o.parent=e,r.unshift(n))}}return t}(e),r={},i=Object.keys(t);for(let e=i.length,s=0;s<e;s++){let e=i[s];null!==t[e].parent&&(r[e]=function(e,t){let r=[t[e].parent,e],i=n[t[e].parent][e],s=t[e].parent;for(;t[s].parent;)r.unshift(t[s].parent),i=function(e,t){return function(r){return t(e(r))}}(n[t[s].parent][s],i),s=t[s].parent;return i.conversion=r,i}(e,t))}return r}},79559,(e,t,r)=>{let n=e.r(49779),i=e.r(61443),s={};Object.keys(n).forEach(e=>{s[e]={},Object.defineProperty(s[e],"channels",{value:n[e].channels}),Object.defineProperty(s[e],"labels",{value:n[e].labels});let t=i(e);Object.keys(t).forEach(r=>{let n=t[r];s[e][r]=function(e){let t=function(...t){let r=t[0];if(null==r)return r;r.length>1&&(t=r);let n=e(t);if("object"==typeof n)for(let e=n.length,t=0;t<e;t++)n[t]=Math.round(n[t]);return n};return"conversion"in e&&(t.conversion=e.conversion),t}(n),s[e][r].raw=function(e){let t=function(...t){let r=t[0];return null==r?r:(r.length>1&&(t=r),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(n)})}),t.exports=s},4567,(e,t,r)=>{"use strict";let n,i=(e,t)=>(...r)=>{let n=e(...r);return`\u001B[${n+t}m`},s=(e,t)=>(...r)=>{let n=e(...r);return`\u001B[${38+t};5;${n}m`},o=(e,t)=>(...r)=>{let n=e(...r);return`\u001B[${38+t};2;${n[0]};${n[1]};${n[2]}m`},a=e=>e,l=(e,t,r)=>[e,t,r],u=(e,t,r)=>{Object.defineProperty(e,t,{get:()=>{let n=r();return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0}),n},enumerable:!0,configurable:!0})},c=(t,r,i,s)=>{void 0===n&&(n=e.r(79559));let o=10*!!s,a={};for(let[e,s]of Object.entries(n)){let n="ansi16"===e?"ansi":e;e===r?a[n]=t(i,o):"object"==typeof s&&(a[n]=t(s[r],o))}return a};Object.defineProperty(t,"exports",{enumerable:!0,get:function(){let e=new Map,t={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};for(let[r,n]of(t.color.gray=t.color.blackBright,t.bgColor.bgGray=t.bgColor.bgBlackBright,t.color.grey=t.color.blackBright,t.bgColor.bgGrey=t.bgColor.bgBlackBright,Object.entries(t))){for(let[r,i]of Object.entries(n))t[r]={open:`\u001B[${i[0]}m`,close:`\u001B[${i[1]}m`},n[r]=t[r],e.set(i[0],i[1]);Object.defineProperty(t,r,{value:n,enumerable:!1})}return Object.defineProperty(t,"codes",{value:e,enumerable:!1}),t.color.close="\x1b[39m",t.bgColor.close="\x1b[49m",u(t.color,"ansi",()=>c(i,"ansi16",a,!1)),u(t.color,"ansi256",()=>c(s,"ansi256",a,!1)),u(t.color,"ansi16m",()=>c(o,"rgb",l,!1)),u(t.bgColor,"ansi",()=>c(i,"ansi16",a,!0)),u(t.bgColor,"ansi256",()=>c(s,"ansi256",a,!0)),u(t.bgColor,"ansi16m",()=>c(o,"rgb",l,!0)),t}})},55225,(e,t,r)=>{"use strict";t.exports=(e,t=process.argv)=>{let r=e.startsWith("-")?"":1===e.length?"-":"--",n=t.indexOf(r+e),i=t.indexOf("--");return -1!==n&&(-1===i||n<i)}},81042,(e,t,r)=>{"use strict";let n;e.r(46786);let i=e.r(70722),s=e.r(55225),{env:o}=process;function a(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function l(e,t){if(0===n)return 0;if(s("color=16m")||s("color=full")||s("color=truecolor"))return 3;if(s("color=256"))return 2;if(e&&!t&&void 0===n)return 0;let r=n||0;if("dumb"===o.TERM)return r;if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(e=>e in o)||"codeship"===o.CI_NAME?1:r;if("TEAMCITY_VERSION"in o)return+!!/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION);if("truecolor"===o.COLORTERM)return 3;if("TERM_PROGRAM"in o){let e=parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)||"COLORTERM"in o?1:r}s("no-color")||s("no-colors")||s("color=false")||s("color=never")?n=0:(s("color")||s("colors")||s("color=true")||s("color=always"))&&(n=1),"FORCE_COLOR"in o&&(n="true"===o.FORCE_COLOR?1:"false"===o.FORCE_COLOR?0:0===o.FORCE_COLOR.length?1:Math.min(parseInt(o.FORCE_COLOR,10),3)),t.exports={supportsColor:function(e){return a(l(e,e&&e.isTTY))},stdout:a(l(!0,i.isatty(1))),stderr:a(l(!0,i.isatty(2)))}},81018,(e,t,r)=>{"use strict";t.exports={stringReplaceAll:(e,t,r)=>{let n=e.indexOf(t);if(-1===n)return e;let i=t.length,s=0,o="";do o+=e.substr(s,n-s)+t+r,s=n+i,n=e.indexOf(t,s);while(-1!==n)return o+e.substr(s)},stringEncaseCRLFWithFirstIndex:(e,t,r,n)=>{let i=0,s="";do{let o="\r"===e[n-1];s+=e.substr(i,(o?n-1:n)-i)+t+(o?"\r\n":"\n")+r,i=n+1,n=e.indexOf("\n",i)}while(-1!==n)return s+e.substr(i)}}},29166,(e,t,r)=>{"use strict";let n,i=e.r(4567),{stdout:s,stderr:o}=e.r(81042),{stringReplaceAll:a,stringEncaseCRLFWithFirstIndex:l}=e.r(81018),{isArray:u}=Array,c=["ansi","ansi","ansi256","ansi16m"],d=Object.create(null);class h{constructor(e){return p(e)}}let p=e=>{let t={};return((e,t={})=>{if(t.level&&!(Number.isInteger(t.level)&&t.level>=0&&t.level<=3))throw Error("The `level` option should be an integer from 0 to 3");let r=s?s.level:0;e.level=void 0===t.level?r:t.level})(t,e),t.template=(...e)=>b(t.template,...e),Object.setPrototypeOf(t,f.prototype),Object.setPrototypeOf(t.template,t),t.template.constructor=()=>{throw Error("`chalk.constructor()` is deprecated. Use `new chalk.Instance()` instead.")},t.template.Instance=h,t.template};function f(e){return p(e)}for(let[e,t]of Object.entries(i))d[e]={get(){let r=v(this,y(t.open,t.close,this._styler),this._isEmpty);return Object.defineProperty(this,e,{value:r}),r}};d.visible={get(){let e=v(this,this._styler,!0);return Object.defineProperty(this,"visible",{value:e}),e}};let g=["rgb","hex","keyword","hsl","hsv","hwb","ansi","ansi256"];for(let e of g)d[e]={get(){let{level:t}=this;return function(...r){return v(this,y(i.color[c[t]][e](...r),i.color.close,this._styler),this._isEmpty)}}};for(let e of g)d["bg"+e[0].toUpperCase()+e.slice(1)]={get(){let{level:t}=this;return function(...r){return v(this,y(i.bgColor[c[t]][e](...r),i.bgColor.close,this._styler),this._isEmpty)}}};let m=Object.defineProperties(()=>{},{...d,level:{enumerable:!0,get(){return this._generator.level},set(e){this._generator.level=e}}}),y=(e,t,r)=>{let n,i;return void 0===r?(n=e,i=t):(n=r.openAll+e,i=t+r.closeAll),{open:e,close:t,openAll:n,closeAll:i,parent:r}},v=(e,t,r)=>{let n=(...e)=>u(e[0])&&u(e[0].raw)?_(n,b(n,...e)):_(n,1===e.length?""+e[0]:e.join(" "));return Object.setPrototypeOf(n,m),n._generator=e,n._styler=t,n._isEmpty=r,n},_=(e,t)=>{if(e.level<=0||!t)return e._isEmpty?"":t;let r=e._styler;if(void 0===r)return t;let{openAll:n,closeAll:i}=r;if(-1!==t.indexOf("\x1b"))for(;void 0!==r;)t=a(t,r.close,r.open),r=r.parent;let s=t.indexOf("\n");return -1!==s&&(t=l(t,i,n,s)),n+t+i},b=(t,...r)=>{let[i]=r;if(!u(i)||!u(i.raw))return r.join(" ");let s=r.slice(1),o=[i.raw[0]];for(let e=1;e<i.length;e++)o.push(String(s[e-1]).replace(/[{}\\]/g,"\\$&"),String(i.raw[e]));return void 0===n&&(n=e.r(12842)),n(t,o.join(""))};Object.defineProperties(f.prototype,d);let E=p(void 0);E.supportsColor=s,E.stderr=p({level:o?o.level:0}),E.stderr.supportsColor=o,t.exports=E},81221,(e,t,r)=>{function n(e,t){if(!e)throw Error(t||"Assertion failed")}t.exports=n,n.equal=function(e,t,r){if(e!=t)throw Error(r||"Assertion failed: "+e+" != "+t)}},2508,(e,t,r)=>{"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},66397,(e,t,r)=>{try{var n=e.r(24361);if("function"!=typeof n.inherits)throw"";t.exports=n.inherits}catch(r){t.exports=e.r(2508)}},45657,(e,t,r)=>{"use strict";var n=e.r(81221);function i(e){return(e>>>24|e>>>8&65280|e<<8&0xff0000|(255&e)<<24)>>>0}function s(e){return 1===e.length?"0"+e:e}function o(e){if(7===e.length)return"0"+e;if(6===e.length)return"00"+e;if(5===e.length)return"000"+e;if(4===e.length)return"0000"+e;if(3===e.length)return"00000"+e;else if(2===e.length)return"000000"+e;else if(1===e.length)return"0000000"+e;else return e}r.inherits=e.r(66397),r.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/ig,"")).length%2!=0&&(e="0"+e),i=0;i<e.length;i+=2)r.push(parseInt(e[i]+e[i+1],16))}else for(var n=0,i=0;i<e.length;i++){var s,o,a=e.charCodeAt(i);a<128?r[n++]=a:(a<2048?r[n++]=a>>6|192:((s=e,o=i,(64512&s.charCodeAt(o))!=55296||o<0||o+1>=s.length?1:(64512&s.charCodeAt(o+1))!=56320)?r[n++]=a>>12|224:(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++i)),r[n++]=a>>18|240,r[n++]=a>>12&63|128),r[n++]=a>>6&63|128),r[n++]=63&a|128)}else for(i=0;i<e.length;i++)r[i]=0|e[i];return r},r.toHex=function(e){for(var t="",r=0;r<e.length;r++)t+=s(e[r].toString(16));return t},r.htonl=i,r.toHex32=function(e,t){for(var r="",n=0;n<e.length;n++){var s=e[n];"little"===t&&(s=i(s)),r+=o(s.toString(16))}return r},r.zero2=s,r.zero8=o,r.join32=function(e,t,r,i){var s,o=r-t;n(o%4==0);for(var a=Array(o/4),l=0,u=t;l<a.length;l++,u+=4)s="big"===i?e[u]<<24|e[u+1]<<16|e[u+2]<<8|e[u+3]:e[u+3]<<24|e[u+2]<<16|e[u+1]<<8|e[u],a[l]=s>>>0;return a},r.split32=function(e,t){for(var r=Array(4*e.length),n=0,i=0;n<e.length;n++,i+=4){var s=e[n];"big"===t?(r[i]=s>>>24,r[i+1]=s>>>16&255,r[i+2]=s>>>8&255,r[i+3]=255&s):(r[i+3]=s>>>24,r[i+2]=s>>>16&255,r[i+1]=s>>>8&255,r[i]=255&s)}return r},r.rotr32=function(e,t){return e>>>t|e<<32-t},r.rotl32=function(e,t){return e<<t|e>>>32-t},r.sum32=function(e,t){return e+t>>>0},r.sum32_3=function(e,t,r){return e+t+r>>>0},r.sum32_4=function(e,t,r,n){return e+t+r+n>>>0},r.sum32_5=function(e,t,r,n,i){return e+t+r+n+i>>>0},r.sum64=function(e,t,r,n){var i=e[t],s=n+e[t+1]>>>0;e[t]=+(s<n)+r+i>>>0,e[t+1]=s},r.sum64_hi=function(e,t,r,n){return+(t+n>>>0<t)+e+r>>>0},r.sum64_lo=function(e,t,r,n){return t+n>>>0},r.sum64_4_hi=function(e,t,r,n,i,s,o,a){var l,u=t;return e+r+i+o+(l=0+ +((u=u+n>>>0)<t)+ +((u=u+s>>>0)<s)+ +((u=u+a>>>0)<a))>>>0},r.sum64_4_lo=function(e,t,r,n,i,s,o,a){return t+n+s+a>>>0},r.sum64_5_hi=function(e,t,r,n,i,s,o,a,l,u){var c,d=t;return e+r+i+o+l+(c=0+ +((d=d+n>>>0)<t)+ +((d=d+s>>>0)<s)+ +((d=d+a>>>0)<a)+ +((d=d+u>>>0)<u))>>>0},r.sum64_5_lo=function(e,t,r,n,i,s,o,a,l,u){return t+n+s+a+u>>>0},r.rotr64_hi=function(e,t,r){return(t<<32-r|e>>>r)>>>0},r.rotr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0},r.shr64_hi=function(e,t,r){return e>>>r},r.shr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0}},19304,(e,t,r)=>{"use strict";var n=e.r(45657),i=e.r(81221);function s(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}r.BlockHash=s,s.prototype.update=function(e,t){if(e=n.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var r=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-r,e.length),0===this.pending.length&&(this.pending=null),e=n.join32(e,0,e.length-r,this.endian);for(var i=0;i<e.length;i+=this._delta32)this._update(e,i,i+this._delta32)}return this},s.prototype.digest=function(e){return this.update(this._pad()),i(null===this.pending),this._digest(e)},s.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,r=t-(e+this.padLength)%t,n=Array(r+this.padLength);n[0]=128;for(var i=1;i<r;i++)n[i]=0;if(e<<=3,"big"===this.endian){for(var s=8;s<this.padLength;s++)n[i++]=0;n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=e>>>24&255,n[i++]=e>>>16&255,n[i++]=e>>>8&255,n[i++]=255&e}else for(s=8,n[i++]=255&e,n[i++]=e>>>8&255,n[i++]=e>>>16&255,n[i++]=e>>>24&255,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0;s<this.padLength;s++)n[i++]=0;return n}},10173,(e,t,r)=>{"use strict";var n=e.r(45657).rotr32;function i(e,t,r){return e&t^e&r^t&r}r.ft_1=function(e,t,r,n){var s;return 0===e?(s=t)&r^~s&n:1===e||3===e?t^r^n:2===e?i(t,r,n):void 0},r.ch32=function(e,t,r){return e&t^~e&r},r.maj32=i,r.p32=function(e,t,r){return e^t^r},r.s0_256=function(e){return n(e,2)^n(e,13)^n(e,22)},r.s1_256=function(e){return n(e,6)^n(e,11)^n(e,25)},r.g0_256=function(e){return n(e,7)^n(e,18)^e>>>3},r.g1_256=function(e){return n(e,17)^n(e,19)^e>>>10}},30607,(e,t,r)=>{"use strict";var n=e.r(45657),i=e.r(19304),s=e.r(10173),o=n.rotl32,a=n.sum32,l=n.sum32_5,u=s.ft_1,c=i.BlockHash,d=[0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xca62c1d6];function h(){if(!(this instanceof h))return new h;c.call(this),this.h=[0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0],this.W=Array(80)}n.inherits(h,c),t.exports=h,h.blockSize=512,h.outSize=160,h.hmacStrength=80,h.padLength=64,h.prototype._update=function(e,t){for(var r=this.W,n=0;n<16;n++)r[n]=e[t+n];for(;n<r.length;n++)r[n]=o(r[n-3]^r[n-8]^r[n-14]^r[n-16],1);var i=this.h[0],s=this.h[1],c=this.h[2],h=this.h[3],p=this.h[4];for(n=0;n<r.length;n++){var f=~~(n/20),g=l(o(i,5),u(f,s,c,h),p,r[n],d[f]);p=h,h=c,c=o(s,30),s=i,i=g}this.h[0]=a(this.h[0],i),this.h[1]=a(this.h[1],s),this.h[2]=a(this.h[2],c),this.h[3]=a(this.h[3],h),this.h[4]=a(this.h[4],p)},h.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},2052,(e,t,r)=>{"use strict";var n=e.r(45657),i=e.r(19304),s=e.r(10173),o=e.r(81221),a=n.sum32,l=n.sum32_4,u=n.sum32_5,c=s.ch32,d=s.maj32,h=s.s0_256,p=s.s1_256,f=s.g0_256,g=s.g1_256,m=i.BlockHash,y=[0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2];function v(){if(!(this instanceof v))return new v;m.call(this),this.h=[0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19],this.k=y,this.W=Array(64)}n.inherits(v,m),t.exports=v,v.blockSize=512,v.outSize=256,v.hmacStrength=192,v.padLength=64,v.prototype._update=function(e,t){for(var r=this.W,n=0;n<16;n++)r[n]=e[t+n];for(;n<r.length;n++)r[n]=l(g(r[n-2]),r[n-7],f(r[n-15]),r[n-16]);var i=this.h[0],s=this.h[1],m=this.h[2],y=this.h[3],v=this.h[4],_=this.h[5],b=this.h[6],E=this.h[7];for(o(this.k.length===r.length),n=0;n<r.length;n++){var S=u(E,p(v),c(v,_,b),this.k[n],r[n]),w=a(h(i),d(i,s,m));E=b,b=_,_=v,v=a(y,S),y=m,m=s,s=i,i=a(S,w)}this.h[0]=a(this.h[0],i),this.h[1]=a(this.h[1],s),this.h[2]=a(this.h[2],m),this.h[3]=a(this.h[3],y),this.h[4]=a(this.h[4],v),this.h[5]=a(this.h[5],_),this.h[6]=a(this.h[6],b),this.h[7]=a(this.h[7],E)},v.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},43194,(e,t,r)=>{"use strict";var n=e.r(45657),i=e.r(2052);function s(){if(!(this instanceof s))return new s;i.call(this),this.h=[0xc1059ed8,0x367cd507,0x3070dd17,0xf70e5939,0xffc00b31,0x68581511,0x64f98fa7,0xbefa4fa4]}n.inherits(s,i),t.exports=s,s.blockSize=512,s.outSize=224,s.hmacStrength=192,s.padLength=64,s.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,7),"big"):n.split32(this.h.slice(0,7),"big")}},29938,(e,t,r)=>{"use strict";var n=e.r(45657),i=e.r(19304),s=e.r(81221),o=n.rotr64_hi,a=n.rotr64_lo,l=n.shr64_hi,u=n.shr64_lo,c=n.sum64,d=n.sum64_hi,h=n.sum64_lo,p=n.sum64_4_hi,f=n.sum64_4_lo,g=n.sum64_5_hi,m=n.sum64_5_lo,y=i.BlockHash,v=[0x428a2f98,0xd728ae22,0x71374491,0x23ef65cd,0xb5c0fbcf,0xec4d3b2f,0xe9b5dba5,0x8189dbbc,0x3956c25b,0xf348b538,0x59f111f1,0xb605d019,0x923f82a4,0xaf194f9b,0xab1c5ed5,0xda6d8118,0xd807aa98,0xa3030242,0x12835b01,0x45706fbe,0x243185be,0x4ee4b28c,0x550c7dc3,0xd5ffb4e2,0x72be5d74,0xf27b896f,0x80deb1fe,0x3b1696b1,0x9bdc06a7,0x25c71235,0xc19bf174,0xcf692694,0xe49b69c1,0x9ef14ad2,0xefbe4786,0x384f25e3,0xfc19dc6,0x8b8cd5b5,0x240ca1cc,0x77ac9c65,0x2de92c6f,0x592b0275,0x4a7484aa,0x6ea6e483,0x5cb0a9dc,0xbd41fbd4,0x76f988da,0x831153b5,0x983e5152,0xee66dfab,0xa831c66d,0x2db43210,0xb00327c8,0x98fb213f,0xbf597fc7,0xbeef0ee4,0xc6e00bf3,0x3da88fc2,0xd5a79147,0x930aa725,0x6ca6351,0xe003826f,0x14292967,0xa0e6e70,0x27b70a85,0x46d22ffc,0x2e1b2138,0x5c26c926,0x4d2c6dfc,0x5ac42aed,0x53380d13,0x9d95b3df,0x650a7354,0x8baf63de,0x766a0abb,0x3c77b2a8,0x81c2c92e,0x47edaee6,0x92722c85,0x1482353b,0xa2bfe8a1,0x4cf10364,0xa81a664b,0xbc423001,0xc24b8b70,0xd0f89791,0xc76c51a3,0x654be30,0xd192e819,0xd6ef5218,0xd6990624,0x5565a910,0xf40e3585,0x5771202a,0x106aa070,0x32bbd1b8,0x19a4c116,0xb8d2d0c8,0x1e376c08,0x5141ab53,0x2748774c,0xdf8eeb99,0x34b0bcb5,0xe19b48a8,0x391c0cb3,0xc5c95a63,0x4ed8aa4a,0xe3418acb,0x5b9cca4f,0x7763e373,0x682e6ff3,0xd6b2b8a3,0x748f82ee,0x5defb2fc,0x78a5636f,0x43172f60,0x84c87814,0xa1f0ab72,0x8cc70208,0x1a6439ec,0x90befffa,0x23631e28,0xa4506ceb,0xde82bde9,0xbef9a3f7,0xb2c67915,0xc67178f2,0xe372532b,0xca273ece,0xea26619c,0xd186b8c7,0x21c0c207,0xeada7dd6,0xcde0eb1e,0xf57d4f7f,0xee6ed178,0x6f067aa,0x72176fba,0xa637dc5,0xa2c898a6,0x113f9804,0xbef90dae,0x1b710b35,0x131c471b,0x28db77f5,0x23047d84,0x32caab7b,0x40c72493,0x3c9ebe0a,0x15c9bebc,0x431d67c4,0x9c100d4c,0x4cc5d4be,0xcb3e42b6,0x597f299c,0xfc657e2a,0x5fcb6fab,0x3ad6faec,0x6c44198c,0x4a475817];function _(){if(!(this instanceof _))return new _;y.call(this),this.h=[0x6a09e667,0xf3bcc908,0xbb67ae85,0x84caa73b,0x3c6ef372,0xfe94f82b,0xa54ff53a,0x5f1d36f1,0x510e527f,0xade682d1,0x9b05688c,0x2b3e6c1f,0x1f83d9ab,0xfb41bd6b,0x5be0cd19,0x137e2179],this.k=v,this.W=Array(160)}n.inherits(_,y),t.exports=_,_.blockSize=1024,_.outSize=512,_.hmacStrength=192,_.padLength=128,_.prototype._prepareBlock=function(e,t){for(var r=this.W,n=0;n<32;n++)r[n]=e[t+n];for(;n<r.length;n+=2){var i=function(e,t){var r=o(e,t,19)^o(t,e,29)^l(e,t,6);return r<0&&(r+=0x100000000),r}(r[n-4],r[n-3]),s=function(e,t){var r=a(e,t,19)^a(t,e,29)^u(e,t,6);return r<0&&(r+=0x100000000),r}(r[n-4],r[n-3]),c=r[n-14],d=r[n-13],h=function(e,t){var r=o(e,t,1)^o(e,t,8)^l(e,t,7);return r<0&&(r+=0x100000000),r}(r[n-30],r[n-29]),g=function(e,t){var r=a(e,t,1)^a(e,t,8)^u(e,t,7);return r<0&&(r+=0x100000000),r}(r[n-30],r[n-29]),m=r[n-32],y=r[n-31];r[n]=p(i,s,c,d,h,g,m,y),r[n+1]=f(i,s,c,d,h,g,m,y)}},_.prototype._update=function(e,t){this._prepareBlock(e,t);var r=this.W,n=this.h[0],i=this.h[1],l=this.h[2],u=this.h[3],p=this.h[4],f=this.h[5],y=this.h[6],v=this.h[7],_=this.h[8],b=this.h[9],E=this.h[10],S=this.h[11],w=this.h[12],T=this.h[13],C=this.h[14],A=this.h[15];s(this.k.length===r.length);for(var O=0;O<r.length;O+=2){var x=C,I=A,k=function(e,t){var r=o(e,t,14)^o(e,t,18)^o(t,e,9);return r<0&&(r+=0x100000000),r}(_,b),R=function(e,t){var r=a(e,t,14)^a(e,t,18)^a(t,e,9);return r<0&&(r+=0x100000000),r}(_,b),P=function(e,t,r,n,i){var s=e&r^~e&i;return s<0&&(s+=0x100000000),s}(_,0,E,0,w,T),N=function(e,t,r,n,i,s){var o=t&n^~t&s;return o<0&&(o+=0x100000000),o}(0,b,0,S,0,T),D=this.k[O],M=this.k[O+1],j=r[O],U=r[O+1],L=g(x,I,k,R,P,N,D,M,j,U),F=m(x,I,k,R,P,N,D,M,j,U);x=function(e,t){var r=o(e,t,28)^o(t,e,2)^o(t,e,7);return r<0&&(r+=0x100000000),r}(n,i),I=function(e,t){var r=a(e,t,28)^a(t,e,2)^a(t,e,7);return r<0&&(r+=0x100000000),r}(n,i);var B=d(x,I,k=function(e,t,r,n,i){var s=e&r^e&i^r&i;return s<0&&(s+=0x100000000),s}(n,0,l,0,p,f),R=function(e,t,r,n,i,s){var o=t&n^t&s^n&s;return o<0&&(o+=0x100000000),o}(0,i,0,u,0,f)),q=h(x,I,k,R);C=w,A=T,w=E,T=S,E=_,S=b,_=d(y,v,L,F),b=h(v,v,L,F),y=p,v=f,p=l,f=u,l=n,u=i,n=d(L,F,B,q),i=h(L,F,B,q)}c(this.h,0,n,i),c(this.h,2,l,u),c(this.h,4,p,f),c(this.h,6,y,v),c(this.h,8,_,b),c(this.h,10,E,S),c(this.h,12,w,T),c(this.h,14,C,A)},_.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},6456,(e,t,r)=>{"use strict";var n=e.r(45657),i=e.r(29938);function s(){if(!(this instanceof s))return new s;i.call(this),this.h=[0xcbbb9d5d,0xc1059ed8,0x629a292a,0x367cd507,0x9159015a,0x3070dd17,0x152fecd8,0xf70e5939,0x67332667,0xffc00b31,0x8eb44a87,0x68581511,0xdb0c2e0d,0x64f98fa7,0x47b5481d,0xbefa4fa4]}n.inherits(s,i),t.exports=s,s.blockSize=1024,s.outSize=384,s.hmacStrength=192,s.padLength=128,s.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,12),"big"):n.split32(this.h.slice(0,12),"big")}},37991,(e,t,r)=>{"use strict";r.sha1=e.r(30607),r.sha224=e.r(43194),r.sha256=e.r(2052),r.sha384=e.r(6456),r.sha512=e.r(29938)},45053,(e,t,r)=>{"use strict";var n=e.r(45657),i=e.r(19304),s=n.rotl32,o=n.sum32,a=n.sum32_3,l=n.sum32_4,u=i.BlockHash;function c(){if(!(this instanceof c))return new c;u.call(this),this.h=[0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0],this.endian="little"}function d(e,t,r,n){return e<=15?t^r^n:e<=31?t&r|~t&n:e<=47?(t|~r)^n:e<=63?t&n|r&~n:t^(r|~n)}n.inherits(c,u),r.ripemd160=c,c.blockSize=512,c.outSize=160,c.hmacStrength=192,c.padLength=64,c.prototype._update=function(e,t){for(var r=this.h[0],n=this.h[1],i=this.h[2],u=this.h[3],c=this.h[4],m=r,y=n,v=i,_=u,b=c,E=0;E<80;E++){var S,w,T=o(s(l(r,d(E,n,i,u),e[h[E]+t],(S=E)<=15?0:S<=31?0x5a827999:S<=47?0x6ed9eba1:S<=63?0x8f1bbcdc:0xa953fd4e),f[E]),c);r=c,c=u,u=s(i,10),i=n,n=T,T=o(s(l(m,d(79-E,y,v,_),e[p[E]+t],(w=E)<=15?0x50a28be6:w<=31?0x5c4dd124:w<=47?0x6d703ef3:0x7a6d76e9*!!(w<=63)),g[E]),b),m=b,b=_,_=s(v,10),v=y,y=T}T=a(this.h[1],i,_),this.h[1]=a(this.h[2],u,b),this.h[2]=a(this.h[3],c,m),this.h[3]=a(this.h[4],r,y),this.h[4]=a(this.h[0],n,v),this.h[0]=T},c.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"little"):n.split32(this.h,"little")};var h=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],f=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],g=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},16244,(e,t,r)=>{"use strict";var n=e.r(45657),i=e.r(81221);function s(e,t,r){if(!(this instanceof s))return new s(e,t,r);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(n.toArray(t,r))}t.exports=s,s.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),i(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(t=0,this.inner=new this.Hash().update(e);t<e.length;t++)e[t]^=106;this.outer=new this.Hash().update(e)},s.prototype.update=function(e,t){return this.inner.update(e,t),this},s.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},55598,(e,t,r)=>{r.utils=e.r(45657),r.common=e.r(19304),r.sha=e.r(37991),r.ripemd=e.r(45053),r.hmac=e.r(16244),r.sha1=r.sha.sha1,r.sha256=r.sha.sha256,r.sha224=r.sha.sha224,r.sha384=r.sha.sha384,r.sha512=r.sha.sha512,r.ripemd160=r.ripemd.ripemd160},14359,(e,t,r)=>{(t.exports=function(e,t,r,i){return JSON.stringify(e,n(t,i),r)}).getSerialize=n;function n(e,t){var r=[],n=[];return null==t&&(t=function(e,t){return r[0]===t?"[Circular ~]":"[Circular ~."+n.slice(0,r.indexOf(t)).join(".")+"]"}),function(i,s){if(r.length>0){var o=r.indexOf(this);~o?r.splice(o+1):r.push(this),~o?n.splice(o,1/0,i):n.push(i),~r.indexOf(s)&&(s=t.call(this,i,s))}else r.push(s);return null==e?s:e.call(this,i,s)}}},41528,(e,t,r)=>{function n(e,t,r,n){return Math.round(e/r)+" "+n+(t>=1.5*r?"s":"")}t.exports=function(e,t){t=t||{};var r,i,s,o,a=typeof e;if("string"===a&&e.length>0){var l=e;if(!((l=String(l)).length>100)){var u=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(l);if(u){var c=parseFloat(u[1]);switch((u[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*c;case"weeks":case"week":case"w":return 6048e5*c;case"days":case"day":case"d":return 864e5*c;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*c;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*c;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:break}}}return}if("number"===a&&isFinite(e)){return t.long?(i=Math.abs(r=e))>=864e5?n(r,i,864e5,"day"):i>=36e5?n(r,i,36e5,"hour"):i>=6e4?n(r,i,6e4,"minute"):i>=1e3?n(r,i,1e3,"second"):r+" ms":(o=Math.abs(s=e))>=864e5?Math.round(s/864e5)+"d":o>=36e5?Math.round(s/36e5)+"h":o>=6e4?Math.round(s/6e4)+"m":o>=1e3?Math.round(s/1e3)+"s":s+"ms"}throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},75334,(e,t,r)=>{var n=Object.defineProperty,i=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,o=Object.prototype.hasOwnProperty,a={};((e,t)=>{for(var r in t)n(e,r,{get:t[r],enumerable:!0})})(a,{errorConstructors:()=>l}),t.exports=((e,t,r,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of s(t))o.call(e,l)||l===r||n(e,l,{get:()=>t[l],enumerable:!(a=i(t,l))||a.enumerable});return e})(n({},"__esModule",{value:!0}),a);let l=new Map([Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(e=>[e.name,e]))},79482,(e,t,r)=>{var n=Object.defineProperty,i=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,o=Object.prototype.hasOwnProperty,a={};((e,t)=>{for(var r in t)n(e,r,{get:t[r],enumerable:!0})})(a,{deserializeError:()=>d,errorConstructors:()=>l.errorConstructors,serializeError:()=>c}),t.exports=((e,t,r,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of s(t))o.call(e,l)||l===r||n(e,l,{get:()=>t[l],enumerable:!(a=i(t,l))||a.enumerable});return e})(n({},"__esModule",{value:!0}),a);var l=e.r(75334);let u=[{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}];function c(e){let t={name:"Error",message:"",stack:""};for(let{property:r}of u)r in e&&(t[r]=e[r]);return globalThis.DOMException&&e instanceof globalThis.DOMException?t.name="DOMException":t.name=Object.getPrototypeOf(e).name,t}function d(e){var t,r;let n=new(t=e.name,null!=(r=l.errorConstructors.get(t))?r:Error);for(let{property:t,enumerable:r}of u)t in e&&Object.defineProperty(n,t,{value:e[t],enumerable:r,configurable:!0,writable:!0});return n}},64301,(e,t,r)=>{"use strict";t.exports=e=>RegExp("[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)|(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))",(e=Object.assign({onlyFirst:!1},e)).onlyFirst?void 0:"g")},7,(e,t,r)=>{"use strict";let n=e.r(64301),i=e=>"string"==typeof e?e.replace(n(),""):e;t.exports=i,t.exports.default=i},16525,(e,t,r)=>{t.exports=function(t){function r(e){let t,i,s,o=null;function a(...e){if(!a.enabled)return;let n=Number(new Date);a.diff=n-(t||n),a.prev=t,a.curr=n,t=n,e[0]=r.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let i=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(t,n)=>{if("%%"===t)return"%";i++;let s=r.formatters[n];if("function"==typeof s){let r=e[i];t=s.call(a,r),e.splice(i,1),i--}return t}),r.formatArgs.call(a,e),(a.log||r.log).apply(a,e)}return a.namespace=e,a.useColors=r.useColors(),a.color=r.selectColor(e),a.extend=n,a.destroy=r.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(i!==r.namespaces&&(i=r.namespaces,s=r.enabled(e)),s),set:e=>{o=e}}),"function"==typeof r.init&&r.init(a),a}function n(e,t){let n=r(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function i(e,t){let r=0,n=0,i=-1,s=0;for(;r<e.length;)if(n<t.length&&(t[n]===e[r]||"*"===t[n]))"*"===t[n]?(i=n,s=r):r++,n++;else{if(-1===i)return!1;n=i+1,r=++s}for(;n<t.length&&"*"===t[n];)n++;return n===t.length}return r.debug=r,r.default=r,r.coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){let e=[...r.names,...r.skips.map(e=>"-"+e)].join(",");return r.enable(""),e},r.enable=function(e){for(let t of(r.save(e),r.namespaces=e,r.names=[],r.skips=[],("string"==typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean)))"-"===t[0]?r.skips.push(t.slice(1)):r.names.push(t)},r.enabled=function(e){for(let t of r.skips)if(i(e,t))return!1;for(let t of r.names)if(i(e,t))return!0;return!1},r.humanize=e.r(41528),r.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach(e=>{r[e]=t[e]}),r.names=[],r.skips=[],r.formatters={},r.selectColor=function(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r)|0;return r.colors[Math.abs(t)%r.colors.length]},r.enable(r.load()),r}},23440,(e,t,r)=>{let n=e.r(70722),i=e.r(24361);r.init=function(e){e.inspectOpts={};let t=Object.keys(r.inspectOpts);for(let n=0;n<t.length;n++)e.inspectOpts[t[n]]=r.inspectOpts[t[n]]},r.log=function(...e){return process.stderr.write(i.formatWithOptions(r.inspectOpts,...e)+"\n")},r.formatArgs=function(e){let{namespace:n,useColors:i}=this;if(i){let r=this.color,i="\x1b[3"+(r<8?r:"8;5;"+r),s=`  ${i};1m${n} \u001B[0m`;e[0]=s+e[0].split("\n").join("\n"+s),e.push(i+"m+"+t.exports.humanize(this.diff)+"\x1b[0m")}else e[0]=(r.inspectOpts.hideDate?"":new Date().toISOString()+" ")+n+" "+e[0]},r.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},r.load=function(){return process.env.DEBUG},r.useColors=function(){return"colors"in r.inspectOpts?!!r.inspectOpts.colors:n.isatty(process.stderr.fd)},r.destroy=i.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),r.colors=[6,2,3,4,5,1];try{let t=e.r(81042);t&&(t.stderr||t).level>=2&&(r.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}r.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{let r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(e,t)=>t.toUpperCase()),n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e},{}),t.exports=e.r(16525)(r);let{formatters:s}=t.exports;s.o=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts).split("\n").map(e=>e.trim()).join(" ")},s.O=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts)}},28452,(e,t,r)=>{r.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;e.splice(1,0,r,"color: inherit");let n=0,i=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))}),e.splice(i,0,r)},r.save=function(e){try{e?r.storage.setItem("debug",e):r.storage.removeItem("debug")}catch(e){}},r.load=function(){let e;try{e=r.storage.getItem("debug")||r.storage.getItem("DEBUG")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},r.useColors=function(){let e;return!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},r.storage=function(){try{return localStorage}catch(e){}}(),r.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],r.log=console.debug||console.log||(()=>{}),t.exports=e.r(16525)(r);let{formatters:n}=t.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},17293,(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||process.__nwjs?t.exports=e.r(28452):t.exports=e.r(23440)},23065,(e,t,r)=>{"use strict";t.exports=function e(t){return null===t||"object"!=typeof t||null!=t.toJSON?JSON.stringify(t):Array.isArray(t)?"["+t.reduce((t,r,n)=>t+(0===n?"":",")+e(void 0===r||"symbol"==typeof r?null:r),"")+"]":"{"+Object.keys(t).sort().reduce((r,n,i)=>{if(void 0===t[n]||"symbol"==typeof t[n])return r;let s=0===r.length?"":",";return r+s+e(n)+":"+e(t[n])},"")+"}"}},21819,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},89870,(e,t,r)=>{"use strict";var n;Object.defineProperty(r,"__esModule",{value:!0}),r.GeminiAiAdapter=void 0,function(e){var t,r;(t=e.HarmCategory||(e.HarmCategory={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",(r=e.HarmBlockThreshold||(e.HarmBlockThreshold={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",r.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",r.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",r.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",r.BLOCK_NONE="BLOCK_NONE",r.OFF="OFF"}(n||(r.GeminiAiAdapter=n={}))},18977,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},10261,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},45332,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},28518,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(21819),r),i(e.r(89870),r),i(e.r(18977),r),i(e.r(10261),r),i(e.r(45332),r)},97711,(e,t,r)=>{"use strict";var n;Object.defineProperty(r,"__esModule",{value:!0}),r.envKeys=r.processEnv=r.allProcessEnv=void 0,r.allProcessEnv=()=>{try{return process.env}catch(e){}try{let e=Deno.env.toObject();if(e)return e}catch(e){}try{let e=Netlify.env.toObject();if(e)return e}catch(e){}return{}},r.processEnv=e=>(0,r.allProcessEnv)()[e],function(e){e.OpenAiApiKey="OPENAI_API_KEY",e.GeminiApiKey="GEMINI_API_KEY",e.AnthropicApiKey="ANTHROPIC_API_KEY",e.DeepSeekApiKey="DEEPSEEK_API_KEY",e.GrokApiKey="XAI_API_KEY",e.AzureOpenAiApiKey="AZURE_OPENAI_API_KEY"}(n||(r.envKeys=n={}))},66670,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.anthropic=void 0;let n=e.r(97711);r.anthropic=e=>{var t,r;let i=e.apiKey||(0,n.processEnv)(n.envKeys.AnthropicApiKey)||"",s=e.baseUrl||"https://api.anthropic.com/v1/";s.endsWith("/")||(s+="/");let o=new URL("messages",s),a={"anthropic-version":"2023-06-01"};return((null==(t=e.betaHeaders)?void 0:t.length)||0)>0&&(a["anthropic-beta"]=(null==(r=e.betaHeaders)?void 0:r.join(","))||""),{url:o.href,authKey:i,format:"anthropic",onCall(t,r){Object.assign(r,e.defaultParameters),r.model||(r.model=e.model)},headers:a,options:e}}},55943,(e,t,r)=>{"use strict";var n=e.e&&e.e.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};Object.defineProperty(r,"__esModule",{value:!0}),r.gemini=void 0;let i=e.r(97711);r.gemini=e=>{let t=e.apiKey||(0,i.processEnv)(i.envKeys.GeminiApiKey)||"",r=e.baseUrl||"https://generativelanguage.googleapis.com/v1beta/";return r.endsWith("/")||(r+="/"),{url:new URL(`models/${e.model}:generateContent?key=${t}`,r).href,authKey:t,format:"gemini",onCall(t,r){var i;if(!e.defaultParameters)return;let s=e.defaultParameters,{generationConfig:o}=s;Object.assign(r,Object.assign(Object.assign({},n(s,["generationConfig"])),r)),o&&(r.generationConfig=Object.assign(Object.assign(Object.assign({},o),r.generationConfig||{}),{thinkingConfig:Object.assign(Object.assign({},o.thinkingConfig),(null==(i=r.generationConfig)?void 0:i.thinkingConfig)||{})}))},headers:{},options:e}}},11206,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.openai=void 0;let n=e.r(97711);r.openai=e=>{let t=e.apiKey||(0,n.processEnv)(n.envKeys.OpenAiApiKey)||"",r=e.baseUrl||"https://api.openai.com/v1/";return r.endsWith("/")||(r+="/"),{url:new URL("chat/completions",r).href,authKey:t,format:"openai-chat",onCall(t,r){Object.assign(r,e.defaultParameters),r.model||(r.model=e.model)},options:e}}},41934,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.azureOpenai=void 0;let n=e.r(97711),i=e.r(11206);r.azureOpenai=e=>{if(!e.endpoint)throw Error("Azure OpenAI endpoint is required");let t=e.apiKey||(0,n.processEnv)(n.envKeys.AzureOpenAiApiKey)||"",r=(0,i.openai)({model:e.model,apiKey:t,baseUrl:e.endpoint,defaultParameters:e.defaultParameters}),s=new URL(`openai/deployments/${e.deployment}/chat/completions`,e.endpoint);return s.searchParams.set("api-version",e.apiVersion),Object.assign(Object.assign({},r),{url:s.href,format:"azure-openai",onCall(t,r){Object.assign(r,e.defaultParameters),r.model||(r.model=e.model)},headers:{"api-key":r.authKey,"Content-Type":"application/json"},options:e})}},6758,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deepseek=void 0;let n=e.r(97711);r.deepseek=e=>{let t=e.apiKey||(0,n.processEnv)(n.envKeys.DeepSeekApiKey)||"",r=e.baseUrl||"https://api.deepseek.com/v1/";return r.endsWith("/")||(r+="/"),{url:new URL("chat/completions",r).href,authKey:t,format:"openai-chat",onCall(t,r){Object.assign(r,e.defaultParameters),r.model||(r.model=e.model)},options:e}}},41161,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.grok=void 0;let n=e.r(97711),i=e.r(11206);r.grok=e=>{let t=e.apiKey||(0,n.processEnv)(n.envKeys.GrokApiKey),r=e.baseUrl||"https://api.x.ai/v1",s=e.model,o=(0,i.openai)(Object.assign(Object.assign({},e),{apiKey:t,baseUrl:r,model:s}));return o.format="grok",o}},3018,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(66670),r),i(e.r(55943),r),i(e.r(11206),r),i(e.r(41934),r),i(e.r(6758),r),i(e.r(41161),r)},90930,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},o=e.e&&e.e.__importStar||function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var s=e(t),o=0;o<s.length;o++)"default"!==s[o]&&n(r,t,s[o]);return i(r,t),r}}();Object.defineProperty(r,"__esModule",{value:!0}),r.models=void 0,s(e.r(28518),r),s(e.r(3018),r),r.models=o(e.r(3018))},29077,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GCE_LINUX_BIOS_PATHS=void 0,r.isGoogleCloudServerless=s,r.isGoogleComputeEngineLinux=o,r.isGoogleComputeEngineMACAddress=a,r.isGoogleComputeEngine=l,r.detectGCPResidency=function(){return s()||l()},e.r(22734);let n=e.r(46786);r.GCE_LINUX_BIOS_PATHS={BIOS_DATE:"/sys/class/dmi/id/bios_date",BIOS_VENDOR:"/sys/class/dmi/id/bios_vendor"};let i=/^42:01/;function s(){return!!(process.env.CLOUD_RUN_JOB||process.env.FUNCTION_NAME||process.env.K_SERVICE)}function o(){if("linux"!==(0,n.platform)())return!1}function a(){for(let e of Object.values((0,n.networkInterfaces)()))if(e){for(let{mac:t}of e)if(i.test(t))return!0}return!1}function l(){return o()||a()}},73588,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.req=r.json=r.toBuffer=void 0;let o=s(e.r(21517)),a=s(e.r(24836));async function l(e){let t=0,r=[];for await(let n of e)t+=n.length,r.push(n);return Buffer.concat(r,t)}r.toBuffer=l,r.json=async function(e){let t=(await l(e)).toString("utf8");try{return JSON.parse(t)}catch(e){throw e.message+=` (input: ${t})`,e}},r.req=function(e,t={}){let r=(("string"==typeof e?e:e.href).startsWith("https:")?a:o).request(e,t),n=new Promise((e,t)=>{r.once("response",e).once("error",t).end()});return r.then=n.then.bind(n),r}},28807,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},o=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.Agent=void 0;let a=s(e.r(4446)),l=s(e.r(21517)),u=e.r(24836);o(e.r(73588),r);let c=Symbol("AgentBaseInternalState");class d extends l.Agent{constructor(e){super(e),this[c]={}}isSecureEndpoint(e){if(e){if("boolean"==typeof e.secureEndpoint)return e.secureEndpoint;if("string"==typeof e.protocol)return"https:"===e.protocol}let{stack:t}=Error();return"string"==typeof t&&t.split("\n").some(e=>-1!==e.indexOf("(https.js:")||-1!==e.indexOf("node:https:"))}incrementSockets(e){if(this.maxSockets===1/0&&this.maxTotalSockets===1/0)return null;this.sockets[e]||(this.sockets[e]=[]);let t=new a.Socket({writable:!1});return this.sockets[e].push(t),this.totalSocketCount++,t}decrementSockets(e,t){if(!this.sockets[e]||null===t)return;let r=this.sockets[e],n=r.indexOf(t);-1!==n&&(r.splice(n,1),this.totalSocketCount--,0===r.length&&delete this.sockets[e])}getName(e){return this.isSecureEndpoint(e)?u.Agent.prototype.getName.call(this,e):super.getName(e)}createSocket(e,t,r){let n={...t,secureEndpoint:this.isSecureEndpoint(t)},i=this.getName(n),s=this.incrementSockets(i);Promise.resolve().then(()=>this.connect(e,n)).then(o=>{if(this.decrementSockets(i,s),o instanceof l.Agent)try{return o.addRequest(e,n)}catch(e){return r(e)}this[c].currentSocket=o,super.createSocket(e,t,r)},e=>{this.decrementSockets(i,s),r(e)})}createConnection(){let e=this[c].currentSocket;if(this[c].currentSocket=void 0,!e)throw Error("No socket was returned in the `connect()` function");return e}get defaultPort(){return this[c].defaultPort??("https:"===this.protocol?443:80)}set defaultPort(e){this[c]&&(this[c].defaultPort=e)}get protocol(){return this[c].protocol??(this.isSecureEndpoint()?"https:":"http:")}set protocol(e){this[c]&&(this[c].protocol=e)}}r.Agent=d},40107,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.parseProxyResponse=void 0;let i=(0,n(e.r(17293)).default)("https-proxy-agent:parse-proxy-response");r.parseProxyResponse=function(e){return new Promise((t,r)=>{let n=0,s=[];function o(){let l=e.read();l?function(l){s.push(l),n+=l.length;let u=Buffer.concat(s,n),c=u.indexOf("\r\n\r\n");if(-1===c){i("have not received end of HTTP headers yet..."),o();return}let d=u.slice(0,c).toString("ascii").split("\r\n"),h=d.shift();if(!h)return e.destroy(),r(Error("No header received from proxy CONNECT response"));let p=h.split(" "),f=+p[1],g=p.slice(2).join(" "),m={};for(let t of d){if(!t)continue;let n=t.indexOf(":");if(-1===n)return e.destroy(),r(Error(`Invalid header from proxy CONNECT response: "${t}"`));let i=t.slice(0,n).toLowerCase(),s=t.slice(n+1).trimStart(),o=m[i];"string"==typeof o?m[i]=[o,s]:Array.isArray(o)?o.push(s):m[i]=s}i("got proxy server response: %o %o",h,m),a(),t({connect:{statusCode:f,statusText:g,headers:m},buffered:u})}(l):e.once("readable",o)}function a(){e.removeListener("end",l),e.removeListener("error",u),e.removeListener("readable",o)}function l(){a(),i("onend"),r(Error("Proxy connection ended before receiving CONNECT response"))}function u(e){a(),i("onerror %o",e),r(e)}e.on("error",u),e.on("end",l),o()})}},12111,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},o=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.HttpsProxyAgent=void 0;let a=s(e.r(4446)),l=s(e.r(55004)),u=o(e.r(49719)),c=o(e.r(17293)),d=e.r(28807),h=e.r(92509),p=e.r(40107),f=(0,c.default)("https-proxy-agent"),g=e=>void 0===e.servername&&e.host&&!a.isIP(e.host)?{...e,servername:e.host}:e;class m extends d.Agent{constructor(e,t){super(t),this.options={path:void 0},this.proxy="string"==typeof e?new h.URL(e):e,this.proxyHeaders=t?.headers??{},f("Creating new HttpsProxyAgent instance: %o",this.proxy.href);let r=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),n=this.proxy.port?parseInt(this.proxy.port,10):"https:"===this.proxy.protocol?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...t?v(t,"headers"):null,host:r,port:n}}async connect(e,t){let r,{proxy:n}=this;if(!t.host)throw TypeError('No "host" provided');"https:"===n.protocol?(f("Creating `tls.Socket`: %o",this.connectOpts),r=l.connect(g(this.connectOpts))):(f("Creating `net.Socket`: %o",this.connectOpts),r=a.connect(this.connectOpts));let i="function"==typeof this.proxyHeaders?this.proxyHeaders():{...this.proxyHeaders},s=a.isIPv6(t.host)?`[${t.host}]`:t.host,o=`CONNECT ${s}:${t.port} HTTP/1.1\r
`;if(n.username||n.password){let e=`${decodeURIComponent(n.username)}:${decodeURIComponent(n.password)}`;i["Proxy-Authorization"]=`Basic ${Buffer.from(e).toString("base64")}`}for(let e of(i.Host=`${s}:${t.port}`,i["Proxy-Connection"]||(i["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close"),Object.keys(i)))o+=`${e}: ${i[e]}\r
`;let c=(0,p.parseProxyResponse)(r);r.write(`${o}\r
`);let{connect:d,buffered:h}=await c;if(e.emit("proxyConnect",d),this.emit("proxyConnect",d,e),200===d.statusCode)return(e.once("socket",y),t.secureEndpoint)?(f("Upgrading socket connection to TLS"),l.connect({...v(g(t),"host","path","port"),socket:r})):r;r.destroy();let m=new a.Socket({writable:!1});return m.readable=!0,e.once("socket",e=>{f("Replaying proxy buffer for failed request"),(0,u.default)(e.listenerCount("data")>0),e.push(h),e.push(null)}),m}}function y(e){e.resume()}function v(e,...t){let r,n={};for(r in e)t.includes(r)||(n[r]=e[r]);return n}m.protocols=["http","https"],r.HttpsProxyAgent=m},25705,(e,t,r)=>{"use strict";var n=Object.prototype.hasOwnProperty,i=Object.prototype.toString,s=Object.defineProperty,o=Object.getOwnPropertyDescriptor,a=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===i.call(e)},l=function(e){if(!e||"[object Object]"!==i.call(e))return!1;var t,r=n.call(e,"constructor"),s=e.constructor&&e.constructor.prototype&&n.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!r&&!s)return!1;for(t in e);return void 0===t||n.call(e,t)},u=function(e,t){s&&"__proto__"===t.name?s(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},c=function(e,t){if("__proto__"===t){if(!n.call(e,t))return;else if(o)return o(e,t).value}return e[t]};t.exports=function e(){var t,r,n,i,s,o,d=arguments[0],h=1,p=arguments.length,f=!1;for("boolean"==typeof d&&(f=d,d=arguments[1]||{},h=2),(null==d||"object"!=typeof d&&"function"!=typeof d)&&(d={});h<p;++h)if(t=arguments[h],null!=t)for(r in t)n=c(d,r),d!==(i=c(t,r))&&(f&&i&&(l(i)||(s=a(i)))?(s?(s=!1,o=n&&a(n)?n:[]):o=n&&l(n)?n:{},u(d,{name:r,newValue:e(f,o,i)})):void 0!==i&&u(d,{name:r,newValue:i}));return d}},55283,(e,t,r)=>{"use strict";var n={};function i(e,t){!t.unsigned&&--e;let r=t.unsigned?0:-Math.pow(2,e),n=Math.pow(2,e)-1,i=t.moduloBitLength?Math.pow(2,t.moduloBitLength):Math.pow(2,e),s=t.moduloBitLength?Math.pow(2,t.moduloBitLength-1):Math.pow(2,e-1);return function(e,o){o||(o={});let a=+e;if(o.enforceRange){if(!Number.isFinite(a))throw TypeError("Argument is not a finite number");if((a=(a<0?-1:1)*Math.floor(Math.abs(a)))<r||a>n)throw TypeError("Argument is not in byte range");return a}if(!isNaN(a)&&o.clamp){var l;return(a=(l=a)%1==.5&&(1&l)==0?Math.floor(l):Math.round(l))<r&&(a=r),a>n&&(a=n),a}if(!Number.isFinite(a)||0===a)return 0;if(a=(a<0?-1:1)*Math.floor(Math.abs(a))%i,!t.unsigned&&a>=s)return a-i;if(t.unsigned){if(a<0)a+=i;else if(-0===a)return 0}return a}}t.exports=n,n.void=function(){},n.boolean=function(e){return!!e},n.byte=i(8,{unsigned:!1}),n.octet=i(8,{unsigned:!0}),n.short=i(16,{unsigned:!1}),n["unsigned short"]=i(16,{unsigned:!0}),n.long=i(32,{unsigned:!1}),n["unsigned long"]=i(32,{unsigned:!0}),n["long long"]=i(32,{unsigned:!1,moduloBitLength:64}),n["unsigned long long"]=i(32,{unsigned:!0,moduloBitLength:64}),n.double=function(e){let t=+e;if(!Number.isFinite(t))throw TypeError("Argument is not a finite floating-point value");return t},n["unrestricted double"]=function(e){let t=+e;if(isNaN(t))throw TypeError("Argument is NaN");return t},n.float=n.double,n["unrestricted float"]=n["unrestricted double"],n.DOMString=function(e,t){return(t||(t={}),t.treatNullAsEmptyString&&null===e)?"":String(e)},n.ByteString=function(e,t){let r,n=String(e);for(let e=0;void 0!==(r=n.codePointAt(e));++e)if(r>255)throw TypeError("Argument is not a valid bytestring");return n},n.USVString=function(e){let t=String(e),r=t.length,n=[];for(let e=0;e<r;++e){let i=t.charCodeAt(e);if(i<55296||i>57343)n.push(String.fromCodePoint(i));else if(56320<=i&&i<=57343)n.push(String.fromCodePoint(65533));else if(e===r-1)n.push(String.fromCodePoint(65533));else{let r=t.charCodeAt(e+1);if(56320<=r&&r<=57343){let t=1023&i,s=1023&r;n.push(String.fromCodePoint(65536+1024*t+s)),++e}else n.push(String.fromCodePoint(65533))}}return n.join("")},n.Date=function(e,t){if(!(e instanceof Date))throw TypeError("Argument is not a Date object");if(!isNaN(e))return e},n.RegExp=function(e,t){return e instanceof RegExp||(e=new RegExp(e)),e}},78289,(e,t,r)=>{"use strict";t.exports.mixin=function(e,t){let r=Object.getOwnPropertyNames(t);for(let n=0;n<r.length;++n)Object.defineProperty(e,r[n],Object.getOwnPropertyDescriptor(t,r[n]))},t.exports.wrapperSymbol=Symbol("wrapper"),t.exports.implSymbol=Symbol("impl"),t.exports.wrapperForImpl=function(e){return e[t.exports.wrapperSymbol]},t.exports.implForWrapper=function(e){return e[t.exports.implSymbol]}},28555,(e,t,r)=>{"use strict";var n=e.r(92097),i=e.r(45736),s={TRANSITIONAL:0,NONTRANSITIONAL:1};function o(e){return e.split("\0").map(function(e){return e.normalize("NFC")}).join("\0")}function a(e){for(var t=0,r=i.length-1;t<=r;){var n=Math.floor((t+r)/2),s=i[n];if(s[0][0]<=e&&s[0][1]>=e)return s;s[0][0]>e?r=n-1:t=n+1}return null}var l=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g;function u(e){return e.replace(l,"_").length}var c=/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E4-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u192B\u1930-\u193B\u19B0-\u19C0\u19C8\u19C9\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFC-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C4\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2D]|\uD800[\uDDFD\uDEE0\uDF76-\uDF7A]|\uD802[\uDE01-\uDE03\uDE05\uDE06\uDE0C-\uDE0F\uDE38-\uDE3A\uDE3F\uDEE5\uDEE6]|\uD804[\uDC00-\uDC02\uDC38-\uDC46\uDC7F-\uDC82\uDCB0-\uDCBA\uDD00-\uDD02\uDD27-\uDD34\uDD73\uDD80-\uDD82\uDDB3-\uDDC0\uDE2C-\uDE37\uDEDF-\uDEEA\uDF01-\uDF03\uDF3C\uDF3E-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF57\uDF62\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDCB0-\uDCC3\uDDAF-\uDDB5\uDDB8-\uDDC0\uDE30-\uDE40\uDEAB-\uDEB7]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF51-\uDF7E\uDF8F-\uDF92]|\uD82F[\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD83A[\uDCD0-\uDCD6]|\uDB40[\uDD00-\uDDEF]/;function d(e,t,r){var i=function(e,t,r){for(var n=!1,i="",o=u(e),l=0;l<o;++l){var c=e.codePointAt(l),d=a(c);switch(d[1]){case"disallowed":n=!0,i+=String.fromCodePoint(c);break;case"ignored":break;case"mapped":i+=String.fromCodePoint.apply(String,d[2]);break;case"deviation":r===s.TRANSITIONAL?i+=String.fromCodePoint.apply(String,d[2]):i+=String.fromCodePoint(c);break;case"valid":i+=String.fromCodePoint(c);break;case"disallowed_STD3_mapped":t?(n=!0,i+=String.fromCodePoint(c)):i+=String.fromCodePoint.apply(String,d[2]);break;case"disallowed_STD3_valid":t&&(n=!0),i+=String.fromCodePoint(c)}}return{string:i,error:n}}(e,t,r);i.string=o(i.string);for(var l=i.string.split("."),h=0;h<l.length;++h)try{var p=function(e,t){"xn--"===e.substr(0,4)&&(e=n.toUnicode(e),s.NONTRANSITIONAL);var r=!1;(o(e)!==e||"-"===e[3]&&"-"===e[4]||"-"===e[0]||"-"===e[e.length-1]||-1!==e.indexOf(".")||0===e.search(c))&&(r=!0);for(var i=u(e),l=0;l<i;++l){var h=a(e.codePointAt(l));if(d===s.TRANSITIONAL&&"valid"!==h[1]||d===s.NONTRANSITIONAL&&"valid"!==h[1]&&"deviation"!==h[1]){r=!0;break}}return{label:e,error:r}}(l[h]);l[h]=p.label,i.error=i.error||p.error}catch(e){i.error=!0}return{string:l.join("."),error:i.error}}t.exports.toASCII=function(e,t,r,i){var s=d(e,t,r),o=s.string.split(".");if(o=o.map(function(e){try{return n.toASCII(e)}catch(t){return s.error=!0,e}}),i){var a=o.slice(0,o.length-1).join(".").length;(a.length>253||0===a.length)&&(s.error=!0);for(var l=0;l<o.length;++l)if(o.length>63||0===o.length){s.error=!0;break}}return s.error?null:o.join(".")},t.exports.toUnicode=function(e,t){var r=d(e,t,s.NONTRANSITIONAL);return{domain:r.string,error:r.error}},t.exports.PROCESSING_OPTIONS=s},22216,(e,t,r)=>{"use strict";let n=e.r(92097),i=e.r(28555),s={ftp:21,file:null,gopher:70,http:80,https:443,ws:80,wss:443},o=Symbol("failure");function a(e){return n.ucs2.decode(e).length}function l(e,t){let r=e[t];return isNaN(r)?void 0:String.fromCodePoint(r)}function u(e){return e>=48&&e<=57}function c(e){return e>=65&&e<=90||e>=97&&e<=122}function d(e){return u(e)||e>=65&&e<=70||e>=97&&e<=102}function h(e){return"."===e||"%2e"===e.toLowerCase()}function p(e){return 2===e.length&&c(e.codePointAt(0))&&(":"===e[1]||"|"===e[1])}function f(e){return void 0!==s[e]}function g(e){return f(e.scheme)}function m(e){let t=e.toString(16).toUpperCase();return 1===t.length&&(t="0"+t),"%"+t}function y(e){return e<=31||e>126}let v=new Set([32,34,35,60,62,63,96,123,125]);function _(e){return y(e)||v.has(e)}let b=new Set([47,58,59,61,64,91,92,93,94,124]);function E(e){return _(e)||b.has(e)}function S(e,t){let r=String.fromCodePoint(e);if(t(e)){let e=new Buffer(r),t="";for(let r=0;r<e.length;++r)t+=m(e[r]);return t}return r}function w(e,t){if("["===e[0])return"]"!==e[e.length-1]?o:function(e){let t=[0,0,0,0,0,0,0,0],r=0,i=null,s=0;if(58===(e=n.ucs2.decode(e))[s]){if(58!==e[s+1])return o;s+=2,i=++r}for(;s<e.length;){if(8===r)return o;if(58===e[s]){if(null!==i)return o;++s,i=++r;continue}let n=0,a=0;for(;a<4&&d(e[s]);)n=16*n+parseInt(l(e,s),16),++s,++a;if(46===e[s]){if(0===a||(s-=a,r>6))return o;let n=0;for(;void 0!==e[s];){let i=null;if(n>0)if(46!==e[s]||!(n<4))return o;else++s;if(!u(e[s]))return o;for(;u(e[s]);){let t=parseInt(l(e,s));if(null===i)i=t;else{if(0===i)return o;i=10*i+t}if(i>255)return o;++s}t[r]=256*t[r]+i,(2==++n||4===n)&&++r}if(4!==n)return o;break}if(58===e[s]){if(void 0===e[++s])return o}else if(void 0!==e[s])return o;t[r]=n,++r}if(null!==i){let e=r-i;for(r=7;0!==r&&e>0;){let n=t[i+e-1];t[i+e-1]=t[r],t[r]=n,--r,--e}}else if(null===i&&8!==r)return o;return t}(e.substring(1,e.length-1));if(!t){var r=e;if(-1!==r.search(/\u0000|\u0009|\u000A|\u000D|\u0020|#|\/|:|\?|@|\[|\\|\]/))return o;let t="",i=n.ucs2.decode(r);for(let e=0;e<i.length;++e)t+=S(i[e],y);return t}let s=function(e){let t=new Buffer(e),r=[];for(let e=0;e<t.length;++e)37!==t[e]?r.push(t[e]):37===t[e]&&d(t[e+1])&&d(t[e+2])?(r.push(parseInt(t.slice(e+1,e+3).toString(),16)),e+=2):r.push(t[e]);return new Buffer(r).toString()}(e),a=i.toASCII(s,!1,i.PROCESSING_OPTIONS.NONTRANSITIONAL,!1);if(null===a||-1!==a.search(/\u0000|\u0009|\u000A|\u000D|\u0020|#|%|\/|:|\?|@|\[|\\|\]/))return o;let c=function(e){let t=e.split(".");if(""===t[t.length-1]&&t.length>1&&t.pop(),t.length>4)return e;let r=[];for(let n of t){if(""===n)return e;let t=function(e){let t=10;return(e.length>=2&&"0"===e.charAt(0)&&"x"===e.charAt(1).toLowerCase()?(e=e.substring(2),t=16):e.length>=2&&"0"===e.charAt(0)&&(e=e.substring(1),t=8),""===e)?0:(10===t?/[^0-9]/:16===t?/[^0-9A-Fa-f]/:/[^0-7]/).test(e)?o:parseInt(e,t)}(n);if(t===o)return e;r.push(t)}for(let e=0;e<r.length-1;++e)if(r[e]>255)return o;if(r[r.length-1]>=Math.pow(256,5-r.length))return o;let n=r.pop(),i=0;for(let e of r)n+=e*Math.pow(256,3-i),++i;return n}(a);return"number"==typeof c||c===o?c:a}function T(e){if("number"==typeof e){let t="",r=e;for(let e=1;e<=4;++e)t=String(r%256)+t,4!==e&&(t="."+t),r=Math.floor(r/256);return t}return e instanceof Array?"["+function(e){let t="",r=function(e){let t=null,r=1,n=null,i=0;for(let s=0;s<e.length;++s)0!==e[s]?(i>r&&(t=n,r=i),n=null,i=0):(null===n&&(n=s),++i);return i>r&&(t=n,r=i),{idx:t,len:r}}(e).idx,n=!1;for(let i=0;i<=7;++i)if(!n||0!==e[i]){if(n&&(n=!1),r===i){t+=0===i?"::":":",n=!0;continue}t+=e[i].toString(16),7!==i&&(t+=":")}return t}(e)+"]":e}function C(e){let t=e.path;if(0!==t.length){var r;"file"===e.scheme&&1===t.length&&(r=t[0],/^[A-Za-z]:$/.test(r))||t.pop()}}function A(e){return""!==e.username||""!==e.password}function O(e,t,r,i,s){if(this.pointer=0,this.input=e,this.base=t||null,this.encodingOverride=r||"utf-8",this.stateOverride=s,this.url=i,this.failure=!1,this.parseError=!1,!this.url){this.url={scheme:"",username:"",password:"",host:null,port:null,path:[],query:null,fragment:null,cannotBeABaseURL:!1};let e=this.input.replace(/^[\u0000-\u001F\u0020]+|[\u0000-\u001F\u0020]+$/g,"");e!==this.input&&(this.parseError=!0),this.input=e}let a=this.input.replace(/\u0009|\u000A|\u000D/g,"");for(a!==this.input&&(this.parseError=!0),this.input=a,this.state=s||"scheme start",this.buffer="",this.atFlag=!1,this.arrFlag=!1,this.passwordTokenSeenFlag=!1,this.input=n.ucs2.decode(this.input);this.pointer<=this.input.length;++this.pointer){let e=this.input[this.pointer],t=isNaN(e)?void 0:String.fromCodePoint(e),r=this["parse "+this.state](e,t);if(r){if(r===o){this.failure=!0;break}}else break}}O.prototype["parse scheme start"]=function(e,t){if(c(e))this.buffer+=t.toLowerCase(),this.state="scheme";else{if(this.stateOverride)return this.parseError=!0,o;this.state="no scheme",--this.pointer}return!0},O.prototype["parse scheme"]=function(e,t){if(c(e)||u(e)||43===e||45===e||46===e)this.buffer+=t.toLowerCase();else if(58===e){if(this.stateOverride&&(g(this.url)&&!f(this.buffer)||!g(this.url)&&f(this.buffer)||(A(this.url)||null!==this.url.port)&&"file"===this.buffer||"file"===this.url.scheme&&(""===this.url.host||null===this.url.host))||(this.url.scheme=this.buffer,this.buffer="",this.stateOverride))return!1;"file"===this.url.scheme?((47!==this.input[this.pointer+1]||47!==this.input[this.pointer+2])&&(this.parseError=!0),this.state="file"):g(this.url)&&null!==this.base&&this.base.scheme===this.url.scheme?this.state="special relative or authority":g(this.url)?this.state="special authority slashes":47===this.input[this.pointer+1]?(this.state="path or authority",++this.pointer):(this.url.cannotBeABaseURL=!0,this.url.path.push(""),this.state="cannot-be-a-base-URL path")}else{if(this.stateOverride)return this.parseError=!0,o;this.buffer="",this.state="no scheme",this.pointer=-1}return!0},O.prototype["parse no scheme"]=function(e){return null===this.base||this.base.cannotBeABaseURL&&35!==e?o:(this.base.cannotBeABaseURL&&35===e?(this.url.scheme=this.base.scheme,this.url.path=this.base.path.slice(),this.url.query=this.base.query,this.url.fragment="",this.url.cannotBeABaseURL=!0,this.state="fragment"):("file"===this.base.scheme?this.state="file":this.state="relative",--this.pointer),!0)},O.prototype["parse special relative or authority"]=function(e){return 47===e&&47===this.input[this.pointer+1]?(this.state="special authority ignore slashes",++this.pointer):(this.parseError=!0,this.state="relative",--this.pointer),!0},O.prototype["parse path or authority"]=function(e){return 47===e?this.state="authority":(this.state="path",--this.pointer),!0},O.prototype["parse relative"]=function(e){return this.url.scheme=this.base.scheme,isNaN(e)?(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(),this.url.query=this.base.query):47===e?this.state="relative slash":63===e?(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(),this.url.query="",this.state="query"):35===e?(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(),this.url.query=this.base.query,this.url.fragment="",this.state="fragment"):g(this.url)&&92===e?(this.parseError=!0,this.state="relative slash"):(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(0,this.base.path.length-1),this.state="path",--this.pointer),!0},O.prototype["parse relative slash"]=function(e){return g(this.url)&&(47===e||92===e)?(92===e&&(this.parseError=!0),this.state="special authority ignore slashes"):47===e?this.state="authority":(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.state="path",--this.pointer),!0},O.prototype["parse special authority slashes"]=function(e){return 47===e&&47===this.input[this.pointer+1]?(this.state="special authority ignore slashes",++this.pointer):(this.parseError=!0,this.state="special authority ignore slashes",--this.pointer),!0},O.prototype["parse special authority ignore slashes"]=function(e){return 47!==e&&92!==e?(this.state="authority",--this.pointer):this.parseError=!0,!0},O.prototype["parse authority"]=function(e,t){if(64===e){this.parseError=!0,this.atFlag&&(this.buffer="%40"+this.buffer),this.atFlag=!0;let e=a(this.buffer);for(let t=0;t<e;++t){let e=this.buffer.codePointAt(t);if(58===e&&!this.passwordTokenSeenFlag){this.passwordTokenSeenFlag=!0;continue}let r=S(e,E);this.passwordTokenSeenFlag?this.url.password+=r:this.url.username+=r}this.buffer=""}else if(isNaN(e)||47===e||63===e||35===e||g(this.url)&&92===e){if(this.atFlag&&""===this.buffer)return this.parseError=!0,o;this.pointer-=a(this.buffer)+1,this.buffer="",this.state="host"}else this.buffer+=t;return!0},O.prototype["parse hostname"]=O.prototype["parse host"]=function(e,t){if(this.stateOverride&&"file"===this.url.scheme)--this.pointer,this.state="file host";else if(58!==e||this.arrFlag)if(isNaN(e)||47===e||63===e||35===e||g(this.url)&&92===e){if(--this.pointer,g(this.url)&&""===this.buffer)return this.parseError=!0,o;if(this.stateOverride&&""===this.buffer&&(A(this.url)||null!==this.url.port))return this.parseError=!0,!1;let e=w(this.buffer,g(this.url));if(e===o)return o;if(this.url.host=e,this.buffer="",this.state="path start",this.stateOverride)return!1}else 91===e?this.arrFlag=!0:93===e&&(this.arrFlag=!1),this.buffer+=t;else{if(""===this.buffer)return this.parseError=!0,o;let e=w(this.buffer,g(this.url));if(e===o)return o;if(this.url.host=e,this.buffer="",this.state="port","hostname"===this.stateOverride)return!1}return!0},O.prototype["parse port"]=function(e,t){if(u(e))this.buffer+=t;else{if(!(isNaN(e)||47===e||63===e||35===e||g(this.url)&&92===e)&&!this.stateOverride)return this.parseError=!0,o;if(""!==this.buffer){let e=parseInt(this.buffer);if(e>65535)return this.parseError=!0,o;this.url.port=e===s[this.url.scheme]?null:e,this.buffer=""}if(this.stateOverride)return!1;this.state="path start",--this.pointer}return!0};let x=new Set([47,92,63,35]);O.prototype["parse file"]=function(e){if(this.url.scheme="file",47===e||92===e)92===e&&(this.parseError=!0),this.state="file slash";else if(null!==this.base&&"file"===this.base.scheme)if(isNaN(e))this.url.host=this.base.host,this.url.path=this.base.path.slice(),this.url.query=this.base.query;else if(63===e)this.url.host=this.base.host,this.url.path=this.base.path.slice(),this.url.query="",this.state="query";else if(35===e)this.url.host=this.base.host,this.url.path=this.base.path.slice(),this.url.query=this.base.query,this.url.fragment="",this.state="fragment";else{var t;this.input.length-this.pointer-1!=0&&(t=this.input[this.pointer+1],c(e)&&(58===t||124===t))&&(!(this.input.length-this.pointer-1>=2)||x.has(this.input[this.pointer+2]))?this.parseError=!0:(this.url.host=this.base.host,this.url.path=this.base.path.slice(),C(this.url)),this.state="path",--this.pointer}else this.state="path",--this.pointer;return!0},O.prototype["parse file slash"]=function(e){if(47===e||92===e)92===e&&(this.parseError=!0),this.state="file host";else{if(null!==this.base&&"file"===this.base.scheme){var t;2===(t=this.base.path[0]).length&&c(t.codePointAt(0))&&":"===t[1]?this.url.path.push(this.base.path[0]):this.url.host=this.base.host}this.state="path",--this.pointer}return!0},O.prototype["parse file host"]=function(e,t){if(isNaN(e)||47===e||92===e||63===e||35===e)if(--this.pointer,!this.stateOverride&&p(this.buffer))this.parseError=!0,this.state="path";else if(""===this.buffer){if(this.url.host="",this.stateOverride)return!1;this.state="path start"}else{let e=w(this.buffer,g(this.url));if(e===o)return o;if("localhost"===e&&(e=""),this.url.host=e,this.stateOverride)return!1;this.buffer="",this.state="path start"}else this.buffer+=t;return!0},O.prototype["parse path start"]=function(e){return g(this.url)?(92===e&&(this.parseError=!0),this.state="path",47!==e&&92!==e&&--this.pointer):this.stateOverride||63!==e?this.stateOverride||35!==e?void 0!==e&&(this.state="path",47!==e&&--this.pointer):(this.url.fragment="",this.state="fragment"):(this.url.query="",this.state="query"),!0},O.prototype["parse path"]=function(e){if(isNaN(e)||47===e||g(this.url)&&92===e||!this.stateOverride&&(63===e||35===e)){var t;if((g(this.url)&&92===e&&(this.parseError=!0),".."===(t=(t=this.buffer).toLowerCase())||"%2e."===t||".%2e"===t||"%2e%2e"===t)?(C(this.url),47===e||g(this.url)&&92===e||this.url.path.push("")):h(this.buffer)&&47!==e&&!(g(this.url)&&92===e)?this.url.path.push(""):h(this.buffer)||("file"===this.url.scheme&&0===this.url.path.length&&p(this.buffer)&&(""!==this.url.host&&null!==this.url.host&&(this.parseError=!0,this.url.host=""),this.buffer=this.buffer[0]+":"),this.url.path.push(this.buffer)),this.buffer="","file"===this.url.scheme&&(void 0===e||63===e||35===e))for(;this.url.path.length>1&&""===this.url.path[0];)this.parseError=!0,this.url.path.shift();63===e&&(this.url.query="",this.state="query"),35===e&&(this.url.fragment="",this.state="fragment")}else 37!==e||d(this.input[this.pointer+1])&&d(this.input[this.pointer+2])||(this.parseError=!0),this.buffer+=S(e,_);return!0},O.prototype["parse cannot-be-a-base-URL path"]=function(e){return 63===e?(this.url.query="",this.state="query"):35===e?(this.url.fragment="",this.state="fragment"):(isNaN(e)||37===e||(this.parseError=!0),37!==e||d(this.input[this.pointer+1])&&d(this.input[this.pointer+2])||(this.parseError=!0),isNaN(e)||(this.url.path[0]=this.url.path[0]+S(e,y))),!0},O.prototype["parse query"]=function(e,t){if(isNaN(e)||!this.stateOverride&&35===e){g(this.url)&&"ws"!==this.url.scheme&&"wss"!==this.url.scheme||(this.encodingOverride="utf-8");let t=new Buffer(this.buffer);for(let e=0;e<t.length;++e)t[e]<33||t[e]>126||34===t[e]||35===t[e]||60===t[e]||62===t[e]?this.url.query+=m(t[e]):this.url.query+=String.fromCodePoint(t[e]);this.buffer="",35===e&&(this.url.fragment="",this.state="fragment")}else 37!==e||d(this.input[this.pointer+1])&&d(this.input[this.pointer+2])||(this.parseError=!0),this.buffer+=t;return!0},O.prototype["parse fragment"]=function(e){return isNaN(e)||(0===e?this.parseError=!0:(37!==e||d(this.input[this.pointer+1])&&d(this.input[this.pointer+2])||(this.parseError=!0),this.url.fragment+=S(e,y))),!0},t.exports.serializeURL=function(e,t){let r=e.scheme+":";if(null!==e.host?(r+="//",(""!==e.username||""!==e.password)&&(r+=e.username,""!==e.password&&(r+=":"+e.password),r+="@"),r+=T(e.host),null!==e.port&&(r+=":"+e.port)):null===e.host&&"file"===e.scheme&&(r+="//"),e.cannotBeABaseURL)r+=e.path[0];else for(let t of e.path)r+="/"+t;return null!==e.query&&(r+="?"+e.query),t||null===e.fragment||(r+="#"+e.fragment),r},t.exports.serializeURLOrigin=function(e){switch(e.scheme){case"blob":try{return t.exports.serializeURLOrigin(t.exports.parseURL(e.path[0]))}catch(e){return"null"}case"ftp":case"gopher":case"http":case"https":case"ws":case"wss":var r;let n;return n=(r={scheme:e.scheme,host:e.host,port:e.port}).scheme+"://"+T(r.host),null!==r.port&&(n+=":"+r.port),n;case"file":return"file://";default:return"null"}},t.exports.basicURLParse=function(e,t){void 0===t&&(t={});let r=new O(e,t.baseURL,t.encodingOverride,t.url,t.stateOverride);return r.failure?"failure":r.url},t.exports.setTheUsername=function(e,t){e.username="";let r=n.ucs2.decode(t);for(let t=0;t<r.length;++t)e.username+=S(r[t],E)},t.exports.setThePassword=function(e,t){e.password="";let r=n.ucs2.decode(t);for(let t=0;t<r.length;++t)e.password+=S(r[t],E)},t.exports.serializeHost=T,t.exports.cannotHaveAUsernamePasswordPort=function(e){return null===e.host||""===e.host||e.cannotBeABaseURL||"file"===e.scheme},t.exports.serializeInteger=function(e){return String(e)},t.exports.parseURL=function(e,r){return void 0===r&&(r={}),t.exports.basicURLParse(e,{baseURL:r.baseURL,encodingOverride:r.encodingOverride})}},81860,(e,t,r)=>{"use strict";let n=e.r(22216);r.implementation=class{constructor(e){let t=e[0],r=e[1],i=null;if(void 0!==r&&"failure"===(i=n.basicURLParse(r)))throw TypeError("Invalid base URL");let s=n.basicURLParse(t,{baseURL:i});if("failure"===s)throw TypeError("Invalid URL");this._url=s}get href(){return n.serializeURL(this._url)}set href(e){let t=n.basicURLParse(e);if("failure"===t)throw TypeError("Invalid URL");this._url=t}get origin(){return n.serializeURLOrigin(this._url)}get protocol(){return this._url.scheme+":"}set protocol(e){n.basicURLParse(e+":",{url:this._url,stateOverride:"scheme start"})}get username(){return this._url.username}set username(e){n.cannotHaveAUsernamePasswordPort(this._url)||n.setTheUsername(this._url,e)}get password(){return this._url.password}set password(e){n.cannotHaveAUsernamePasswordPort(this._url)||n.setThePassword(this._url,e)}get host(){let e=this._url;return null===e.host?"":null===e.port?n.serializeHost(e.host):n.serializeHost(e.host)+":"+n.serializeInteger(e.port)}set host(e){this._url.cannotBeABaseURL||n.basicURLParse(e,{url:this._url,stateOverride:"host"})}get hostname(){return null===this._url.host?"":n.serializeHost(this._url.host)}set hostname(e){this._url.cannotBeABaseURL||n.basicURLParse(e,{url:this._url,stateOverride:"hostname"})}get port(){return null===this._url.port?"":n.serializeInteger(this._url.port)}set port(e){n.cannotHaveAUsernamePasswordPort(this._url)||(""===e?this._url.port=null:n.basicURLParse(e,{url:this._url,stateOverride:"port"}))}get pathname(){return this._url.cannotBeABaseURL?this._url.path[0]:0===this._url.path.length?"":"/"+this._url.path.join("/")}set pathname(e){this._url.cannotBeABaseURL||(this._url.path=[],n.basicURLParse(e,{url:this._url,stateOverride:"path start"}))}get search(){return null===this._url.query||""===this._url.query?"":"?"+this._url.query}set search(e){let t=this._url;if(""===e){t.query=null;return}let r="?"===e[0]?e.substring(1):e;t.query="",n.basicURLParse(r,{url:t,stateOverride:"query"})}get hash(){return null===this._url.fragment||""===this._url.fragment?"":"#"+this._url.fragment}set hash(e){if(""===e){this._url.fragment=null;return}let t="#"===e[0]?e.substring(1):e;this._url.fragment="",n.basicURLParse(t,{url:this._url,stateOverride:"fragment"})}toJSON(){return this.href}}},81842,(e,t,r)=>{"use strict";let n=e.r(55283),i=e.r(78289),s=e.r(81860),o=i.implSymbol;function a(e){if(!this||this[o]||!(this instanceof a))throw TypeError("Failed to construct 'URL': Please use the 'new' operator, this DOM object constructor cannot be called as a function.");if(arguments.length<1)throw TypeError("Failed to construct 'URL': 1 argument required, but only "+arguments.length+" present.");let r=[];for(let e=0;e<arguments.length&&e<2;++e)r[e]=arguments[e];r[0]=n.USVString(r[0]),void 0!==r[1]&&(r[1]=n.USVString(r[1])),t.exports.setup(this,r)}a.prototype.toJSON=function(){if(!this||!t.exports.is(this))throw TypeError("Illegal invocation");let e=[];for(let t=0;t<arguments.length&&t<0;++t)e[t]=arguments[t];return this[o].toJSON.apply(this[o],e)},Object.defineProperty(a.prototype,"href",{get(){return this[o].href},set(e){e=n.USVString(e),this[o].href=e},enumerable:!0,configurable:!0}),a.prototype.toString=function(){if(!this||!t.exports.is(this))throw TypeError("Illegal invocation");return this.href},Object.defineProperty(a.prototype,"origin",{get(){return this[o].origin},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"protocol",{get(){return this[o].protocol},set(e){e=n.USVString(e),this[o].protocol=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"username",{get(){return this[o].username},set(e){e=n.USVString(e),this[o].username=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"password",{get(){return this[o].password},set(e){e=n.USVString(e),this[o].password=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"host",{get(){return this[o].host},set(e){e=n.USVString(e),this[o].host=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"hostname",{get(){return this[o].hostname},set(e){e=n.USVString(e),this[o].hostname=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"port",{get(){return this[o].port},set(e){e=n.USVString(e),this[o].port=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"pathname",{get(){return this[o].pathname},set(e){e=n.USVString(e),this[o].pathname=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"search",{get(){return this[o].search},set(e){e=n.USVString(e),this[o].search=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"hash",{get(){return this[o].hash},set(e){e=n.USVString(e),this[o].hash=e},enumerable:!0,configurable:!0}),t.exports={is:e=>!!e&&e[o]instanceof s.implementation,create(e,t){let r=Object.create(a.prototype);return this.setup(r,e,t),r},setup(e,t,r){r||(r={}),r.wrapper=e,e[o]=new s.implementation(t,r),e[o][i.wrapperSymbol]=e},interface:a,expose:{Window:{URL:a},Worker:{URL:a}}}},18907,(e,t,r)=>{"use strict";r.URL=e.r(81842).interface,r.serializeURL=e.r(22216).serializeURL,r.serializeURLOrigin=e.r(22216).serializeURLOrigin,r.basicURLParse=e.r(22216).basicURLParse,r.setTheUsername=e.r(22216).setTheUsername,r.setThePassword=e.r(22216).setThePassword,r.serializeHost=e.r(22216).serializeHost,r.serializeInteger=e.r(22216).serializeInteger,r.parseURL=e.r(22216).parseURL},56569,e=>{"use strict";let t;e.s(["AbortError",()=>$,"FetchError",()=>h,"Headers",()=>x,"Request",()=>H,"Response",()=>M,"default",()=>Y]);var r=e.i(88947),n=e.i(21517),i=e.i(92509),s=e.i(18907),o=e.i(24836),a=e.i(6461);let l=r.default.Readable,u=Symbol("buffer"),c=Symbol("type");class d{constructor(){this[c]="";let e=arguments[0],t=arguments[1],r=[];if(e){let t=Number(e.length);for(let n=0;n<t;n++){let t,i=e[n];(t=i instanceof Buffer?i:ArrayBuffer.isView(i)?Buffer.from(i.buffer,i.byteOffset,i.byteLength):i instanceof ArrayBuffer?Buffer.from(i):i instanceof d?i[u]:Buffer.from("string"==typeof i?i:String(i))).length,r.push(t)}}this[u]=Buffer.concat(r);let n=t&&void 0!==t.type&&String(t.type).toLowerCase();n&&!/[^\u0020-\u007E]/.test(n)&&(this[c]=n)}get size(){return this[u].length}get type(){return this[c]}text(){return Promise.resolve(this[u].toString())}arrayBuffer(){let e=this[u];return Promise.resolve(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength))}stream(){let e=new l;return e._read=function(){},e.push(this[u]),e.push(null),e}toString(){return"[object Blob]"}slice(){let e,t=this.size,r=arguments[0],n=arguments[1];e=void 0===r?0:r<0?Math.max(t+r,0):Math.min(r,t);let i=Math.max((void 0===n?t:n<0?Math.max(t+n,0):Math.min(n,t))-e,0),s=this[u].slice(e,e+i),o=new d([],{type:arguments[2]});return o[u]=s,o}}function h(e,t,r){Error.call(this,e),this.message=e,this.type=t,r&&(this.code=this.errno=r.code),Error.captureStackTrace(this,this.constructor)}Object.defineProperties(d.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(d.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0}),h.prototype=Object.create(Error.prototype),h.prototype.constructor=h,h.prototype.name="FetchError";try{t=(()=>{let e=Error("Cannot find module 'encoding'");throw e.code="MODULE_NOT_FOUND",e})().convert}catch(e){}let p=Symbol("Body internals"),f=r.default.PassThrough;function g(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.size,s=n.timeout;null==e?e=null:y(e)?e=Buffer.from(e.toString()):v(e)||Buffer.isBuffer(e)||("[object ArrayBuffer]"===Object.prototype.toString.call(e)?e=Buffer.from(e):ArrayBuffer.isView(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof r.default||(e=Buffer.from(String(e)))),this[p]={body:e,disturbed:!1,error:null},this.size=void 0===i?0:i,this.timeout=void 0===s?0:s,e instanceof r.default&&e.on("error",function(e){let r="AbortError"===e.name?e:new h(`Invalid response body while trying to fetch ${t.url}: ${e.message}`,"system",e);t[p].error=r})}function m(){var e=this;if(this[p].disturbed)return g.Promise.reject(TypeError(`body used already for: ${this.url}`));if(this[p].disturbed=!0,this[p].error)return g.Promise.reject(this[p].error);let t=this.body;if(null===t)return g.Promise.resolve(Buffer.alloc(0));if(v(t)&&(t=t.stream()),Buffer.isBuffer(t))return g.Promise.resolve(t);if(!(t instanceof r.default))return g.Promise.resolve(Buffer.alloc(0));let n=[],i=0,s=!1;return new g.Promise(function(r,o){let a;e.timeout&&(a=setTimeout(function(){s=!0,o(new h(`Response timeout while trying to fetch ${e.url} (over ${e.timeout}ms)`,"body-timeout"))},e.timeout)),t.on("error",function(t){"AbortError"===t.name?(s=!0,o(t)):o(new h(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,"system",t))}),t.on("data",function(t){if(!s&&null!==t){if(e.size&&i+t.length>e.size){s=!0,o(new h(`content size at ${e.url} over limit: ${e.size}`,"max-size"));return}i+=t.length,n.push(t)}}),t.on("end",function(){if(!s){clearTimeout(a);try{r(Buffer.concat(n,i))}catch(t){o(new h(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t))}}})})}function y(e){return"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&("URLSearchParams"===e.constructor.name||"[object URLSearchParams]"===Object.prototype.toString.call(e)||"function"==typeof e.sort)}function v(e){return"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}function _(e){let t,n,i=e.body;if(e.bodyUsed)throw Error("cannot clone body after it is used");return i instanceof r.default&&"function"!=typeof i.getBoundary&&(t=new f,n=new f,i.pipe(t),i.pipe(n),e[p].body=t,i=n),i}function b(e){if(null===e)return null;if("string"==typeof e)return"text/plain;charset=UTF-8";if(y(e))return"application/x-www-form-urlencoded;charset=UTF-8";if(v(e))return e.type||null;if(Buffer.isBuffer(e))return null;else if("[object ArrayBuffer]"===Object.prototype.toString.call(e))return null;else if(ArrayBuffer.isView(e))return null;else if("function"==typeof e.getBoundary)return`multipart/form-data;boundary=${e.getBoundary()}`;else if(e instanceof r.default)return null;else return"text/plain;charset=UTF-8"}function E(e){let t=e.body;return null===t?0:v(t)?t.size:Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync?t._lengthRetrievers&&0==t._lengthRetrievers.length||t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null:null}g.prototype={get body(){return this[p].body},get bodyUsed(){return this[p].disturbed},arrayBuffer(){return m.call(this).then(function(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)})},blob(){let e=this.headers&&this.headers.get("content-type")||"";return m.call(this).then(function(t){return Object.assign(new d([],{type:e.toLowerCase()}),{[u]:t})})},json(){var e=this;return m.call(this).then(function(t){try{return JSON.parse(t.toString())}catch(t){return g.Promise.reject(new h(`invalid json response body at ${e.url} reason: ${t.message}`,"invalid-json"))}})},text(){return m.call(this).then(function(e){return e.toString()})},buffer(){return m.call(this)},textConverted(){var e=this;return m.call(this).then(function(r){return function(e,r){let n,i;if("function"!=typeof t)throw Error("The package `encoding` must be installed to use the textConverted() function");let s=r.get("content-type"),o="utf-8";return s&&(n=/charset=([^;]*)/i.exec(s)),i=e.slice(0,1024).toString(),!n&&i&&(n=/<meta.+?charset=(['"])(.+?)\1/i.exec(i)),!n&&i&&(!(n=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(i))&&(n=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(i))&&n.pop(),n&&(n=/charset=(.*)/i.exec(n.pop()))),!n&&i&&(n=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(i)),n&&("gb2312"===(o=n.pop())||"gbk"===o)&&(o="gb18030"),t(e,"UTF-8",o).toString()}(r,e.headers)})}},Object.defineProperties(g.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),g.mixIn=function(e){for(let t of Object.getOwnPropertyNames(g.prototype))if(!(t in e)){let r=Object.getOwnPropertyDescriptor(g.prototype,t);Object.defineProperty(e,t,r)}},g.Promise=e.g.Promise;let S=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,w=/[^\t\x20-\x7e\x80-\xff]/;function T(e){if(e=`${e}`,S.test(e)||""===e)throw TypeError(`${e} is not a legal HTTP header name`)}function C(e){if(e=`${e}`,w.test(e))throw TypeError(`${e} is not a legal HTTP header value`)}function A(e,t){for(let r in t=t.toLowerCase(),e)if(r.toLowerCase()===t)return r}let O=Symbol("map");class x{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[O]=Object.create(null),e instanceof x){let t=e.raw();for(let e of Object.keys(t))for(let r of t[e])this.append(e,r);return}if(null==e);else if("object"==typeof e){let t=e[Symbol.iterator];if(null!=t){if("function"!=typeof t)throw TypeError("Header pairs must be iterable");let r=[];for(let t of e){if("object"!=typeof t||"function"!=typeof t[Symbol.iterator])throw TypeError("Each header pair must be iterable");r.push(Array.from(t))}for(let e of r){if(2!==e.length)throw TypeError("Each header pair must be a name/value tuple");this.append(e[0],e[1])}}else for(let t of Object.keys(e)){let r=e[t];this.append(t,r)}}else throw TypeError("Provided initializer must be an object")}get(e){T(e=`${e}`);let t=A(this[O],e);return void 0===t?null:this[O][t].join(", ")}forEach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=I(this),n=0;for(;n<r.length;){var i=r[n];let s=i[0],o=i[1];e.call(t,o,s,this),r=I(this),n++}}set(e,t){e=`${e}`,t=`${t}`,T(e),C(t);let r=A(this[O],e);this[O][void 0!==r?r:e]=[t]}append(e,t){e=`${e}`,t=`${t}`,T(e),C(t);let r=A(this[O],e);void 0!==r?this[O][r].push(t):this[O][e]=[t]}has(e){return T(e=`${e}`),void 0!==A(this[O],e)}delete(e){T(e=`${e}`);let t=A(this[O],e);void 0!==t&&delete this[O][t]}raw(){return this[O]}keys(){return R(this,"key")}values(){return R(this,"value")}[Symbol.iterator](){return R(this,"key+value")}}function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key+value";return Object.keys(e[O]).sort().map("key"===t?function(e){return e.toLowerCase()}:"value"===t?function(t){return e[O][t].join(", ")}:function(t){return[t.toLowerCase(),e[O][t].join(", ")]})}x.prototype.entries=x.prototype[Symbol.iterator],Object.defineProperty(x.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(x.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});let k=Symbol("internal");function R(e,t){let r=Object.create(P);return r[k]={target:e,kind:t,index:0},r}let P=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==P)throw TypeError("Value of `this` is not a HeadersIterator");var e=this[k];let t=e.target,r=e.kind,n=e.index,i=I(t,r);return n>=i.length?{value:void 0,done:!0}:(this[k].index=n+1,{value:i[n],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));Object.defineProperty(P,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});let N=Symbol("Response internals"),D=n.default.STATUS_CODES;class M{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};g.call(this,e,t);let r=t.status||200,n=new x(t.headers);if(null!=e&&!n.has("Content-Type")){let t=b(e);t&&n.append("Content-Type",t)}this[N]={url:t.url,status:r,statusText:t.statusText||D[r],headers:n,counter:t.counter}}get url(){return this[N].url||""}get status(){return this[N].status}get ok(){return this[N].status>=200&&this[N].status<300}get redirected(){return this[N].counter>0}get statusText(){return this[N].statusText}get headers(){return this[N].headers}clone(){return new M(_(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}g.mixIn(M.prototype),Object.defineProperties(M.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(M.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});let j=Symbol("Request internals"),U=i.default.URL||s.default.URL,L=i.default.parse,F=i.default.format;function B(e){return/^[a-zA-Z][a-zA-Z\d+\-.]*:/.exec(e)&&(e=new U(e).toString()),L(e)}let q="destroy"in r.default.Readable.prototype;function G(e){return"object"==typeof e&&"object"==typeof e[j]}class H{constructor(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};G(e)?t=B(e.url):(t=e&&e.href?B(e.href):B(`${e}`),e={});let n=r.method||e.method||"GET";if(n=n.toUpperCase(),(null!=r.body||G(e)&&null!==e.body)&&("GET"===n||"HEAD"===n))throw TypeError("Request with GET/HEAD method cannot have body");let i=null!=r.body?r.body:G(e)&&null!==e.body?_(e):null;g.call(this,i,{timeout:r.timeout||e.timeout||0,size:r.size||e.size||0});let s=new x(r.headers||e.headers||{});if(null!=i&&!s.has("Content-Type")){let e=b(i);e&&s.append("Content-Type",e)}let o=G(e)?e.signal:null;if("signal"in r&&(o=r.signal),null!=o&&!function(e){let t=e&&"object"==typeof e&&Object.getPrototypeOf(e);return!!(t&&"AbortSignal"===t.constructor.name)}(o))throw TypeError("Expected signal to be an instanceof AbortSignal");this[j]={method:n,redirect:r.redirect||e.redirect||"follow",headers:s,parsedURL:t,signal:o},this.follow=void 0!==r.follow?r.follow:void 0!==e.follow?e.follow:20,this.compress=void 0!==r.compress?r.compress:void 0===e.compress||e.compress,this.counter=r.counter||e.counter||0,this.agent=r.agent||e.agent}get method(){return this[j].method}get url(){return F(this[j].parsedURL)}get headers(){return this[j].headers}get redirect(){return this[j].redirect}get signal(){return this[j].signal}clone(){return new H(this)}}function $(e){Error.call(this,e),this.type="aborted",this.message=e,Error.captureStackTrace(this,this.constructor)}g.mixIn(H.prototype),Object.defineProperty(H.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(H.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}}),$.prototype=Object.create(Error.prototype),$.prototype.constructor=$,$.prototype.name="AbortError";let V=i.default.URL||s.default.URL,K=r.default.PassThrough,z=function(e,t){let r=new V(t).hostname,n=new V(e).hostname;return r===n||"."===r[r.length-n.length-1]&&r.endsWith(n)};function J(e,t){if(!J.Promise)throw Error("native promise missing, set fetch.Promise to your favorite alternative");return g.Promise=J.Promise,new J.Promise(function(i,s){var l,u;let c,d,p=new H(e,t),f=function(e){let t=e[j].parsedURL,n=new x(e[j].headers);if(n.has("Accept")||n.set("Accept","*/*"),!t.protocol||!t.hostname)throw TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(t.protocol))throw TypeError("Only HTTP(S) protocols are supported");if(e.signal&&e.body instanceof r.default.Readable&&!q)throw Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let i=null;if(null==e.body&&/^(POST|PUT)$/i.test(e.method)&&(i="0"),null!=e.body){let t=E(e);"number"==typeof t&&(i=String(t))}i&&n.set("Content-Length",i),n.has("User-Agent")||n.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),e.compress&&!n.has("Accept-Encoding")&&n.set("Accept-Encoding","gzip,deflate");let s=e.agent;return"function"==typeof s&&(s=s(t)),Object.assign({},t,{method:e.method,headers:function(e){let t=Object.assign({__proto__:null},e[O]),r=A(e[O],"Host");return void 0!==r&&(t[r]=t[r][0]),t}(n),agent:s})}(p),g=("https:"===f.protocol?o.default:n.default).request,m=p.signal,y=null,_=function(){let e=new $("The user aborted a request.");s(e),p.body&&p.body instanceof r.default.Readable&&W(p.body,e),y&&y.body&&y.body.emit("error",e)};if(m&&m.aborted)return void _();let b=function(){_(),C()},T=g(f);function C(){T.abort(),m&&m.removeEventListener("abort",b),clearTimeout(c)}m&&m.addEventListener("abort",b),p.timeout&&T.once("socket",function(e){c=setTimeout(function(){s(new h(`network timeout at: ${p.url}`,"request-timeout")),C()},p.timeout)}),T.on("error",function(e){s(new h(`request to ${p.url} failed, reason: ${e.message}`,"system",e)),y&&y.body&&W(y.body,e),C()}),l=T,u=function(e){(!m||!m.aborted)&&y&&y.body&&W(y.body,e)},l.on("socket",function(e){d=e}),l.on("response",function(e){let t=e.headers;"chunked"!==t["transfer-encoding"]||t["content-length"]||e.once("close",function(e){if(d&&d.listenerCount("data")>0&&!e){let e=Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",u(e)}})}),14>parseInt(process.version.substring(1))&&T.on("socket",function(e){e.addListener("close",function(t){let r=e.listenerCount("data")>0;if(y&&r&&!t&&!(m&&m.aborted)){let e=Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",y.body.emit("error",e)}})}),T.on("response",function(e){clearTimeout(c);let t=function(e){let t=new x;for(let r of Object.keys(e))if(!S.test(r))if(Array.isArray(e[r]))for(let n of e[r])w.test(n)||(void 0===t[O][r]?t[O][r]=[n]:t[O][r].push(n));else w.test(e[r])||(t[O][r]=[e[r]]);return t}(e.headers);if(J.isRedirect(e.statusCode)){let n=t.get("Location"),o=null;try{o=null===n?null:new V(n,p.url).toString()}catch(e){if("manual"!==p.redirect){s(new h(`uri requested responds with an invalid redirect URL: ${n}`,"invalid-redirect")),C();return}}switch(p.redirect){case"error":s(new h(`uri requested responds with a redirect, redirect mode is set to error: ${p.url}`,"no-redirect")),C();return;case"manual":if(null!==o)try{t.set("Location",o)}catch(e){s(e)}break;case"follow":var r;if(null===o)break;if(p.counter>=p.follow){s(new h(`maximum redirect reached at: ${p.url}`,"max-redirect")),C();return}let a={headers:new x(p.headers),follow:p.follow,counter:p.counter+1,agent:p.agent,compress:p.compress,method:p.method,body:p.body,signal:p.signal,timeout:p.timeout,size:p.size};if(!z(p.url,o)||(r=p.url,new V(o).protocol!==new V(r).protocol))for(let e of["authorization","www-authenticate","cookie","cookie2"])a.headers.delete(e);if(303!==e.statusCode&&p.body&&null===E(p)){s(new h("Cannot follow redirect with body being a readable stream","unsupported-redirect")),C();return}(303===e.statusCode||(301===e.statusCode||302===e.statusCode)&&"POST"===p.method)&&(a.method="GET",a.body=void 0,a.headers.delete("content-length")),i(J(new H(o,a))),C();return}}e.once("end",function(){m&&m.removeEventListener("abort",b)});let n=e.pipe(new K),o={url:p.url,status:e.statusCode,statusText:e.statusMessage,headers:t,size:p.size,timeout:p.timeout,counter:p.counter},l=t.get("Content-Encoding");if(!p.compress||"HEAD"===p.method||null===l||204===e.statusCode||304===e.statusCode)return void i(y=new M(n,o));let u={flush:a.default.Z_SYNC_FLUSH,finishFlush:a.default.Z_SYNC_FLUSH};if("gzip"==l||"x-gzip"==l)return void i(y=new M(n=n.pipe(a.default.createGunzip(u)),o));if("deflate"==l||"x-deflate"==l){let t=e.pipe(new K);t.once("data",function(e){i(y=new M(n=(15&e[0])==8?n.pipe(a.default.createInflate()):n.pipe(a.default.createInflateRaw()),o))}),t.on("end",function(){y||i(y=new M(n,o))});return}if("br"==l&&"function"==typeof a.default.createBrotliDecompress)return void i(y=new M(n=n.pipe(a.default.createBrotliDecompress()),o));i(y=new M(n,o))});let I=p.body;null===I?T.end():v(I)?I.stream().pipe(T):Buffer.isBuffer(I)?(T.write(I),T.end()):I.pipe(T)})}function W(e,t){e.destroy?e.destroy(t):(e.emit("error",t),e.end())}J.isRedirect=function(e){return 301===e||302===e||303===e||307===e||308===e},J.Promise=e.g.Promise;let Y=J},36745,(e,t,r)=>{"use strict";let n=e=>null!==e&&"object"==typeof e&&"function"==typeof e.pipe;n.writable=e=>n(e)&&!1!==e.writable&&"function"==typeof e._write&&"object"==typeof e._writableState,n.readable=e=>n(e)&&!1!==e.readable&&"function"==typeof e._read&&"object"==typeof e._readableState,n.duplex=e=>n.writable(e)&&n.readable(e),n.transform=e=>n.duplex(e)&&"function"==typeof e._transform,t.exports=n},22337,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.pkg=void 0,r.pkg=e.r(451)},28908,(e,t,r)=>{"use strict";var n,i=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.GaxiosError=r.GAXIOS_ERROR_SYMBOL=void 0,r.defaultErrorRedactor=function e(t){let r="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.";function n(e){if(e)for(let t of Object.keys(e))/^authentication$/i.test(t)&&(e[t]=r),/^authorization$/i.test(t)&&(e[t]=r),/secret/i.test(t)&&(e[t]=r)}function i(e,t){if("object"==typeof e&&null!==e&&"string"==typeof e[t]){let n=e[t];(/grant_type=/i.test(n)||/assertion=/i.test(n)||/secret/i.test(n))&&(e[t]=r)}}function o(e){"object"==typeof e&&null!==e&&("grant_type"in e&&(e.grant_type=r),"assertion"in e&&(e.assertion=r),"client_secret"in e&&(e.client_secret=r))}if(t.config){n(t.config.headers),i(t.config,"data"),o(t.config.data),i(t.config,"body"),o(t.config.body);try{let e=new s.URL("",t.config.url);e.searchParams.has("token")&&e.searchParams.set("token",r),e.searchParams.has("client_secret")&&e.searchParams.set("client_secret",r),t.config.url=e.toString()}catch(e){}}return t.response&&(e({config:t.response.config}),n(t.response.headers),i(t.response,"data"),o(t.response.data)),t};let s=e.r(92509),o=e.r(22337),a=i(e.r(25705));r.GAXIOS_ERROR_SYMBOL=Symbol.for(`${o.pkg.name}-gaxios-error`);class l extends Error{static[(n=r.GAXIOS_ERROR_SYMBOL,Symbol.hasInstance)](e){return!!e&&"object"==typeof e&&r.GAXIOS_ERROR_SYMBOL in e&&e[r.GAXIOS_ERROR_SYMBOL]===o.pkg.version||Function.prototype[Symbol.hasInstance].call(l,e)}constructor(e,t,r,i){var s;if(super(e),this.config=t,this.response=r,this.error=i,this[n]=o.pkg.version,this.config=(0,a.default)(!0,{},t),this.response&&(this.response.config=(0,a.default)(!0,{},this.response.config)),this.response){try{this.response.data=function(e,t){switch(e){case"stream":default:return t;case"json":return JSON.parse(JSON.stringify(t));case"arraybuffer":return JSON.parse(Buffer.from(t).toString("utf8"));case"blob":return JSON.parse(t.text())}}(this.config.responseType,null==(s=this.response)?void 0:s.data)}catch(e){}this.status=this.response.status}i&&"code"in i&&i.code&&(this.code=i.code),t.errorRedactor&&t.errorRedactor({config:this.config,response:this.response})}}r.GaxiosError=l},13485,(e,t,r)=>{"use strict";async function n(e){var t,r;let n=s(e);if(!e||!e.config||!n&&!e.config.retry)return{shouldRetry:!1};(n=n||{}).currentRetryAttempt=n.currentRetryAttempt||0,n.retry=void 0===n.retry||null===n.retry?3:n.retry,n.httpMethodsToRetry=n.httpMethodsToRetry||["GET","HEAD","PUT","OPTIONS","DELETE"],n.noResponseRetries=void 0===n.noResponseRetries||null===n.noResponseRetries?2:n.noResponseRetries,n.retryDelayMultiplier=n.retryDelayMultiplier?n.retryDelayMultiplier:2,n.timeOfFirstRequest=n.timeOfFirstRequest?n.timeOfFirstRequest:Date.now(),n.totalTimeout=n.totalTimeout?n.totalTimeout:Number.MAX_SAFE_INTEGER,n.maxRetryDelay=n.maxRetryDelay?n.maxRetryDelay:Number.MAX_SAFE_INTEGER,n.statusCodesToRetry=n.statusCodesToRetry||[[100,199],[408,408],[429,429],[500,599]],e.config.retryConfig=n;let o=n.shouldRetry||i;if(!await o(e))return{shouldRetry:!1,config:e.config};let a=Math.min(((t=n).currentRetryAttempt?0:null!=(r=t.retryDelay)?r:100)+(Math.pow(t.retryDelayMultiplier,t.currentRetryAttempt)-1)/2*1e3,t.totalTimeout-(Date.now()-t.timeOfFirstRequest),t.maxRetryDelay);e.config.retryConfig.currentRetryAttempt+=1;let l=n.retryBackoff?n.retryBackoff(e,a):new Promise(e=>{setTimeout(e,a)});return n.onRetryAttempt&&n.onRetryAttempt(e),await l,{shouldRetry:!0,config:e.config}}function i(e){var t;let r=s(e);if("AbortError"===e.name||(null==(t=e.error)?void 0:t.name)==="AbortError"||!r||0===r.retry||!e.response&&(r.currentRetryAttempt||0)>=r.noResponseRetries||!e.config.method||0>r.httpMethodsToRetry.indexOf(e.config.method.toUpperCase()))return!1;if(e.response&&e.response.status){let t=!1;for(let[n,i]of r.statusCodesToRetry){let r=e.response.status;if(r>=n&&r<=i){t=!0;break}}if(!t)return!1}return r.currentRetryAttempt=r.currentRetryAttempt||0,!(r.currentRetryAttempt>=r.retry)}function s(e){if(e&&e.config&&e.config.retryConfig)return e.config.retryConfig}Object.defineProperty(r,"__esModule",{value:!0}),r.getRetryConfig=n},79403,e=>{"use strict";let t,r;e.s(["NIL",()=>E,"parse",()=>g,"stringify",()=>d,"v1",()=>f,"v3",()=>y,"v4",()=>_,"v5",()=>b,"validate",()=>l,"version",()=>S],79403),e.s([],55276),e.i(55276);var n=e.i(54799);let i=new Uint8Array(256),s=i.length;function o(){return s>i.length-16&&(n.default.randomFillSync(i),s=0),i.slice(s,s+=16)}let a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,l=function(e){return"string"==typeof e&&a.test(e)},u=[];for(let e=0;e<256;++e)u.push((e+256).toString(16).slice(1));function c(e,t=0){return u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]}let d=function(e,t=0){let r=c(e,t);if(!l(r))throw TypeError("Stringified UUID is invalid");return r},h=0,p=0,f=function(e,n,i){let s=n&&i||0,a=n||Array(16),l=(e=e||{}).node||t,u=void 0!==e.clockseq?e.clockseq:r;if(null==l||null==u){let n=e.random||(e.rng||o)();null==l&&(l=t=[1|n[0],n[1],n[2],n[3],n[4],n[5]]),null==u&&(u=r=(n[6]<<8|n[7])&16383)}let d=void 0!==e.msecs?e.msecs:Date.now(),f=void 0!==e.nsecs?e.nsecs:p+1,g=d-h+(f-p)/1e4;if(g<0&&void 0===e.clockseq&&(u=u+1&16383),(g<0||d>h)&&void 0===e.nsecs&&(f=0),f>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");h=d,p=f,r=u;let m=((0xfffffff&(d+=122192928e5))*1e4+f)%0x100000000;a[s++]=m>>>24&255,a[s++]=m>>>16&255,a[s++]=m>>>8&255,a[s++]=255&m;let y=d/0x100000000*1e4&0xfffffff;a[s++]=y>>>8&255,a[s++]=255&y,a[s++]=y>>>24&15|16,a[s++]=y>>>16&255,a[s++]=u>>>8|128,a[s++]=255&u;for(let e=0;e<6;++e)a[s+e]=l[e];return n||c(a)},g=function(e){let t;if(!l(e))throw TypeError("Invalid UUID");let r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/0x10000000000&255,r[11]=t/0x100000000&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};function m(e,t,r){function n(e,n,i,s){var o;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=g(n)),(null==(o=n)?void 0:o.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let a=new Uint8Array(16+e.length);if(a.set(n),a.set(e,n.length),(a=r(a))[6]=15&a[6]|t,a[8]=63&a[8]|128,i){s=s||0;for(let e=0;e<16;++e)i[s+e]=a[e];return i}return c(a)}try{n.name=e}catch(e){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}let y=m("v3",48,function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),n.default.createHash("md5").update(e).digest()}),v={randomUUID:n.default.randomUUID},_=function(e,t,r){if(v.randomUUID&&!t&&!e)return v.randomUUID();let n=(e=e||{}).random||(e.rng||o)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return c(n)},b=m("v5",80,function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),n.default.createHash("sha1").update(e).digest()}),E="00000000-0000-0000-0000-000000000000",S=function(e){if(!l(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},41140,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GaxiosInterceptorManager=void 0;class n extends Set{}r.GaxiosInterceptorManager=n},59820,(e,t,r)=>{"use strict";var n,i,s,o,a,l,u,c=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),d=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),h=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&c(t,e,r);return d(t,e),t},p=e.e&&e.e.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},f=e.e&&e.e.__classPrivateFieldSet||function(e,t,r,n,i){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},g=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.Gaxios=void 0;let m=g(e.r(25705)),y=e.r(24836),v=g(e.r(56569)),_=g(e.r(45706)),b=g(e.r(36745)),E=e.r(92509),S=e.r(28908),w=e.r(13485),T=e.r(88947),C=e.r(79403),A=e.r(41140),O=(0,v.default);function x(e,t){for(let r of(t=t.toLowerCase(),Object.keys((null==e?void 0:e.headers)||{})))if(t===r.toLowerCase())return e.headers[r]}class I{constructor(e){n.add(this),this.agentCache=new Map,this.defaults=e||{},this.interceptors={request:new A.GaxiosInterceptorManager,response:new A.GaxiosInterceptorManager}}async request(e={}){return e=await p(this,n,"m",a).call(this,e),e=await p(this,n,"m",s).call(this,e),p(this,n,"m",o).call(this,this._request(e))}async _defaultAdapter(e){let t=e.fetchImplementation||O,r=await t(e.url,e),n=await this.getResponseData(e,r);return this.translateResponse(e,r,n)}async _request(e={}){var t;try{let t;if(t=e.adapter?await e.adapter(e,this._defaultAdapter.bind(this)):await this._defaultAdapter(e),!e.validateStatus(t.status)){if("stream"===e.responseType){let e="";await new Promise(r=>{(null==t?void 0:t.data).on("data",t=>{e+=t}),(null==t?void 0:t.data).on("end",r)}),t.data=e}throw new S.GaxiosError(`Request failed with status code ${t.status}`,e,t)}return t}catch(s){let r=s instanceof S.GaxiosError?s:new S.GaxiosError(s.message,e,void 0,s),{shouldRetry:n,config:i}=await (0,w.getRetryConfig)(r);if(n&&i)return r.config.retryConfig.currentRetryAttempt=i.retryConfig.currentRetryAttempt,e.retryConfig=null==(t=r.config)?void 0:t.retryConfig,this._request(e);throw r}}async getResponseData(e,t){switch(e.responseType){case"stream":return t.body;case"json":{let e=await t.text();try{e=JSON.parse(e)}catch(e){}return e}case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"text":return t.text();default:return this.getResponseDataFromContentType(t)}}validateStatus(e){return e>=200&&e<300}paramsSerializer(e){return _.default.stringify(e)}translateResponse(e,t,r){let n={};return t.headers.forEach((e,t)=>{n[t]=e}),{config:e,data:r,headers:n,status:t.status,statusText:t.statusText,request:{responseURL:t.url}}}async getResponseDataFromContentType(e){let t=e.headers.get("Content-Type");if(null===t)return e.text();if((t=t.toLowerCase()).includes("application/json")){let t=await e.text();try{t=JSON.parse(t)}catch(e){}return t}return t.match(/^text\//)?e.text():e.blob()}async *getMultipartRequest(e,t){let r=`--${t}--`;for(let r of e){let e=r.headers["Content-Type"]||"application/octet-stream",n=`--${t}\r
Content-Type: ${e}\r
\r
`;yield n,"string"==typeof r.content?yield r.content:yield*r.content,yield"\r\n"}yield r}}r.Gaxios=I,n=new WeakSet,i=function(e,t=[]){var r,n;let i=new E.URL(e),s=[...t];for(let e of(null==(n=null!=(r=process.env.NO_PROXY)?r:process.env.no_proxy)?void 0:n.split(","))||[])s.push(e.trim());for(let e of s)if(e instanceof RegExp){if(e.test(i.toString()))return!1}else if(e instanceof E.URL){if(e.origin===i.origin)return!1}else if(e.startsWith("*.")||e.startsWith(".")){let t=e.replace(/^\*\./,".");if(i.hostname.endsWith(t))return!1}else if(e===i.origin||e===i.hostname||e===i.href)return!1;return!0},s=async function(e){let t=Promise.resolve(e);for(let e of this.interceptors.request.values())e&&(t=t.then(e.resolved,e.rejected));return t},o=async function(e){let t=Promise.resolve(e);for(let e of this.interceptors.response.values())e&&(t=t.then(e.resolved,e.rejected));return t},a=async function(e){var t,r,s,o;let a=(0,m.default)(!0,{},this.defaults,e);if(!a.url)throw Error("URL is required.");let l=a.baseUrl||a.baseURL;if(l&&(a.url=l.toString()+a.url),a.paramsSerializer=a.paramsSerializer||this.paramsSerializer,a.params&&Object.keys(a.params).length>0){let e=a.paramsSerializer(a.params);e.startsWith("?")&&(e=e.slice(1));let t=a.url.toString().includes("?")?"&":"?";a.url=a.url+t+e}if("number"==typeof e.maxContentLength&&(a.size=e.maxContentLength),"number"==typeof e.maxRedirects&&(a.follow=e.maxRedirects),a.headers=a.headers||{},void 0===a.multipart&&a.data){let e="undefined"!=typeof FormData&&(null==a?void 0:a.data)instanceof FormData;b.default.readable(a.data)?a.body=a.data:"undefined"!=typeof Buffer&&Buffer.isBuffer(a.data)?(a.body=a.data,x(a,"Content-Type")||(a.headers["Content-Type"]="application/json")):"object"==typeof a.data?e||("application/x-www-form-urlencoded"===x(a,"content-type")?a.body=a.paramsSerializer(a.data):(x(a,"Content-Type")||(a.headers["Content-Type"]="application/json"),a.body=JSON.stringify(a.data))):a.body=a.data}else if(a.multipart&&a.multipart.length>0){let e=(0,C.v4)();a.headers["Content-Type"]=`multipart/related; boundary=${e}`;let t=new T.PassThrough;a.body=t,(0,T.pipeline)(this.getMultipartRequest(a.multipart,e),t,()=>{})}a.validateStatus=a.validateStatus||this.validateStatus,a.responseType=a.responseType||"unknown",a.headers.Accept||"json"!==a.responseType||(a.headers.Accept="application/json"),a.method=a.method||"GET";let c=a.proxy||(null==(t=null==process?void 0:process.env)?void 0:t.HTTPS_PROXY)||(null==(r=null==process?void 0:process.env)?void 0:r.https_proxy)||(null==(s=null==process?void 0:process.env)?void 0:s.HTTP_PROXY)||(null==(o=null==process?void 0:process.env)?void 0:o.http_proxy),d=p(this,n,"m",i).call(this,a.url,a.noProxy);if(a.agent);else if(c&&d){let e=await p(I,I,"m",u).call(I);this.agentCache.has(c)?a.agent=this.agentCache.get(c):(a.agent=new e(c,{cert:a.cert,key:a.key}),this.agentCache.set(c,a.agent))}else a.cert&&a.key&&(this.agentCache.has(a.key)?a.agent=this.agentCache.get(a.key):(a.agent=new y.Agent({cert:a.cert,key:a.key}),this.agentCache.set(a.key,a.agent)));return"function"!=typeof a.errorRedactor&&!1!==a.errorRedactor&&(a.errorRedactor=S.defaultErrorRedactor),a},u=async function(){return f(this,I,p(this,I,"f",l)||(await Promise.resolve().then(()=>h(e.r(12111)))).HttpsProxyAgent,"f",l),p(this,I,"f",l)},l={value:void 0}},66037,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.instance=r.Gaxios=r.GaxiosError=void 0,r.request=a;let s=e.r(59820);Object.defineProperty(r,"Gaxios",{enumerable:!0,get:function(){return s.Gaxios}});var o=e.r(28908);async function a(e){return r.instance.request(e)}Object.defineProperty(r,"GaxiosError",{enumerable:!0,get:function(){return o.GaxiosError}}),i(e.r(41140),r),r.instance=new s.Gaxios},45905,(e,t,r)=>{!function(r){"use strict";var n,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,o=Math.floor,a="[BigNumber Error] ",l=a+"Number primitive has more than 15 significant digits: ",u=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function c(e){var t=0|e;return e>0||e===t?t:t-1}function d(e){for(var t,r,n=1,i=e.length,s=e[0]+"";n<i;){for(r=14-(t=e[n++]+"").length;r--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function h(e,t){var r,n,i=e.c,s=t.c,o=e.s,a=t.s,l=e.e,u=t.e;if(!o||!a)return null;if(r=i&&!i[0],n=s&&!s[0],r||n)return r?n?0:-a:o;if(o!=a)return o;if(r=o<0,n=l==u,!i||!s)return n?0:!i^r?1:-1;if(!n)return l>u^r?1:-1;for(o=0,a=(l=i.length)<(u=s.length)?l:u;o<a;o++)if(i[o]!=s[o])return i[o]>s[o]^r?1:-1;return l==u?0:l>u^r?1:-1}function p(e,t,r,n){if(e<t||e>r||e!==o(e))throw Error(a+(n||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function f(e){var t=e.c.length-1;return c(e.e/14)==t&&e.c[t]%2!=0}function g(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function m(e,t,r){var n,i;if(t<0){for(i=r+".";++t;i+=r);e=i+e}else if(n=e.length,++t>n){for(i=r,t-=n;--t;i+=r);e+=i}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}if((n=function e(t){var r,n,y,v,_,b,E,S,w,T=L.prototype={constructor:L,toString:null,valueOf:null},C=new L(1),A=20,O=4,x=-7,I=21,k=-1e7,R=1e7,P=!1,N=1,D=0,M={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},j="0123456789abcdefghijklmnopqrstuvwxyz",U=!0;function L(e,t){var r,n,s,a,u,c,d,h,f=this;if(!(f instanceof L))return new L(e,t);if(null==t){if(e&&!0===e._isBigNumber){f.s=e.s,!e.c||e.e>R?f.c=f.e=null:e.e<k?f.c=[f.e=0]:(f.e=e.e,f.c=e.c.slice());return}if((c="number"==typeof e)&&0*e==0){if(f.s=1/e<0?(e=-e,-1):1,e===~~e){for(a=0,u=e;u>=10;u/=10,a++);a>R?f.c=f.e=null:(f.e=a,f.c=[e]);return}h=String(e)}else{if(!i.test(h=String(e)))return w(f,h,c);f.s=45==h.charCodeAt(0)?(h=h.slice(1),-1):1}(a=h.indexOf("."))>-1&&(h=h.replace(".","")),(u=h.search(/e/i))>0?(a<0&&(a=u),a+=+h.slice(u+1),h=h.substring(0,u)):a<0&&(a=h.length)}else{if(p(t,2,j.length,"Base"),10==t&&U)return G(f=new L(e),A+f.e+1,O);if(h=String(e),c="number"==typeof e){if(0*e!=0)return w(f,h,c,t);if(f.s=1/e<0?(h=h.slice(1),-1):1,L.DEBUG&&h.replace(/^0\.0*|\./,"").length>15)throw Error(l+e)}else f.s=45===h.charCodeAt(0)?(h=h.slice(1),-1):1;for(r=j.slice(0,t),a=u=0,d=h.length;u<d;u++)if(0>r.indexOf(n=h.charAt(u))){if("."==n){if(u>a){a=d;continue}}else if(!s&&(h==h.toUpperCase()&&(h=h.toLowerCase())||h==h.toLowerCase()&&(h=h.toUpperCase()))){s=!0,u=-1,a=0;continue}return w(f,String(e),c,t)}c=!1,(a=(h=S(h,t,10,f.s)).indexOf("."))>-1?h=h.replace(".",""):a=h.length}for(u=0;48===h.charCodeAt(u);u++);for(d=h.length;48===h.charCodeAt(--d););if(h=h.slice(u,++d)){if(d-=u,c&&L.DEBUG&&d>15&&(e>0x1fffffffffffff||e!==o(e)))throw Error(l+f.s*e);if((a=a-u-1)>R)f.c=f.e=null;else if(a<k)f.c=[f.e=0];else{if(f.e=a,f.c=[],u=(a+1)%14,a<0&&(u+=14),u<d){for(u&&f.c.push(+h.slice(0,u)),d-=14;u<d;)f.c.push(+h.slice(u,u+=14));u=14-(h=h.slice(u)).length}else u-=d;for(;u--;h+="0");f.c.push(+h)}}else f.c=[f.e=0]}function F(e,t,r,n){var i,s,o,a,l;if(null==r?r=O:p(r,0,8),!e.c)return e.toString();if(i=e.c[0],o=e.e,null==t)l=d(e.c),l=1==n||2==n&&(o<=x||o>=I)?g(l,o):m(l,o,"0");else if(s=(e=G(new L(e),t,r)).e,a=(l=d(e.c)).length,1==n||2==n&&(t<=s||s<=x)){for(;a<t;l+="0",a++);l=g(l,s)}else if(t-=o+(2===n&&s>o),l=m(l,s,"0"),s+1>a){if(--t>0)for(l+=".";t--;l+="0");}else if((t+=s-a)>0)for(s+1==a&&(l+=".");t--;l+="0");return e.s<0&&i?"-"+l:l}function B(e,t){for(var r,n,i=1,s=new L(e[0]);i<e.length;i++)(n=new L(e[i])).s&&(r=h(s,n))!==t&&(0!==r||s.s!==t)||(s=n);return s}function q(e,t,r){for(var n=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,n++);return(r=n+14*r-1)>R?e.c=e.e=null:r<k?e.c=[e.e=0]:(e.e=r,e.c=t),e}function G(e,t,r,n){var i,a,l,c,d,h,p,f=e.c;if(f){e:{for(i=1,c=f[0];c>=10;c/=10,i++);if((a=t-i)<0)a+=14,l=t,p=o((d=f[h=0])/u[i-l-1]%10);else if((h=s((a+1)/14))>=f.length)if(n){for(;f.length<=h;f.push(0));d=p=0,i=1,a%=14,l=a-14+1}else break e;else{for(i=1,d=c=f[h];c>=10;c/=10,i++);a%=14,p=(l=a-14+i)<0?0:o(d/u[i-l-1]%10)}if(n=n||t<0||null!=f[h+1]||(l<0?d:d%u[i-l-1]),n=r<4?(p||n)&&(0==r||r==(e.s<0?3:2)):p>5||5==p&&(4==r||n||6==r&&(a>0?l>0?d/u[i-l]:0:f[h-1])%10&1||r==(e.s<0?8:7)),t<1||!f[0])return f.length=0,n?(t-=e.e+1,f[0]=u[(14-t%14)%14],e.e=-t||0):f[0]=e.e=0,e;if(0==a?(f.length=h,c=1,h--):(f.length=h+1,c=u[14-a],f[h]=l>0?o(d/u[i-l]%u[l])*c:0),n)for(;;)if(0==h){for(a=1,l=f[0];l>=10;l/=10,a++);for(l=f[0]+=c,c=1;l>=10;l/=10,c++);a!=c&&(e.e++,1e14==f[0]&&(f[0]=1));break}else{if(f[h]+=c,1e14!=f[h])break;f[h--]=0,c=1}for(a=f.length;0===f[--a];f.pop());}e.e>R?e.c=e.e=null:e.e<k&&(e.c=[e.e=0])}return e}function H(e){var t,r=e.e;return null===r?e.toString():(t=d(e.c),t=r<=x||r>=I?g(t,r):m(t,r,"0"),e.s<0?"-"+t:t)}return L.clone=e,L.ROUND_UP=0,L.ROUND_DOWN=1,L.ROUND_CEIL=2,L.ROUND_FLOOR=3,L.ROUND_HALF_UP=4,L.ROUND_HALF_DOWN=5,L.ROUND_HALF_EVEN=6,L.ROUND_HALF_CEIL=7,L.ROUND_HALF_FLOOR=8,L.EUCLID=9,L.config=L.set=function(e){var t,r;if(null!=e)if("object"==typeof e){if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(p(r=e[t],0,1e9,t),A=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(p(r=e[t],0,8,t),O=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(p(r[0],-1e9,0,t),p(r[1],0,1e9,t),x=r[0],I=r[1]):(p(r,-1e9,1e9,t),x=-(I=r<0?-r:r))),e.hasOwnProperty(t="RANGE"))if((r=e[t])&&r.pop)p(r[0],-1e9,-1,t),p(r[1],1,1e9,t),k=r[0],R=r[1];else if(p(r,-1e9,1e9,t),r)k=-(R=r<0?-r:r);else throw Error(a+t+" cannot be zero: "+r);if(e.hasOwnProperty(t="CRYPTO"))if(!!(r=e[t])===r)if(r)if("undefined"!=typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))P=r;else throw P=!r,Error(a+"crypto unavailable");else P=r;else throw Error(a+t+" not true or false: "+r);if(e.hasOwnProperty(t="MODULO_MODE")&&(p(r=e[t],0,9,t),N=r),e.hasOwnProperty(t="POW_PRECISION")&&(p(r=e[t],0,1e9,t),D=r),e.hasOwnProperty(t="FORMAT"))if("object"==typeof(r=e[t]))M=r;else throw Error(a+t+" not an object: "+r);if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(a+t+" invalid: "+r);U="0123456789"==r.slice(0,10),j=r}}else throw Error(a+"Object expected: "+e);return{DECIMAL_PLACES:A,ROUNDING_MODE:O,EXPONENTIAL_AT:[x,I],RANGE:[k,R],CRYPTO:P,MODULO_MODE:N,POW_PRECISION:D,FORMAT:M,ALPHABET:j}},L.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!L.DEBUG)return!0;var t,r,n=e.c,i=e.e,s=e.s;e:if("[object Array]"==({}).toString.call(n)){if((1===s||-1===s)&&i>=-1e9&&i<=1e9&&i===o(i)){if(0===n[0]){if(0===i&&1===n.length)return!0;break e}if((t=(i+1)%14)<1&&(t+=14),String(n[0]).length==t){for(t=0;t<n.length;t++)if((r=n[t])<0||r>=1e14||r!==o(r))break e;if(0!==r)return!0}}}else if(null===n&&null===i&&(null===s||1===s||-1===s))return!0;throw Error(a+"Invalid BigNumber: "+e)},L.maximum=L.max=function(){return B(arguments,-1)},L.minimum=L.min=function(){return B(arguments,1)},r=0x20000000000000*Math.random()&2097151?function(){return o(0x20000000000000*Math.random())}:function(){return(0x40000000*Math.random()|0)*8388608+(8388608*Math.random()|0)},L.random=function(e){var t,n,i,l,c,d=0,h=[],f=new L(C);if(null==e?e=A:p(e,0,1e9),l=s(e/14),P)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(l*=2));d<l;)(c=131072*t[d]+(t[d+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[d]=n[0],t[d+1]=n[1]):(h.push(c%1e14),d+=2);d=l/2}else if(crypto.randomBytes){for(t=crypto.randomBytes(l*=7);d<l;)(c=(31&t[d])*0x1000000000000+0x10000000000*t[d+1]+0x100000000*t[d+2]+0x1000000*t[d+3]+(t[d+4]<<16)+(t[d+5]<<8)+t[d+6])>=9e15?crypto.randomBytes(7).copy(t,d):(h.push(c%1e14),d+=7);d=l/7}else throw P=!1,Error(a+"crypto unavailable");if(!P)for(;d<l;)(c=r())<9e15&&(h[d++]=c%1e14);for(l=h[--d],e%=14,l&&e&&(c=u[14-e],h[d]=o(l/c)*c);0===h[d];h.pop(),d--);if(d<0)h=[i=0];else{for(i=-1;0===h[0];h.splice(0,1),i-=14);for(d=1,c=h[0];c>=10;c/=10,d++);d<14&&(i-=14-d)}return f.e=i,f.c=h,f},L.sum=function(){for(var e=1,t=arguments,r=new L(t[0]);e<t.length;)r=r.plus(t[e++]);return r},S=function(){var e="0123456789";function t(e,t,r,n){for(var i,s,o=[0],a=0,l=e.length;a<l;){for(s=o.length;s--;o[s]*=t);for(o[0]+=n.indexOf(e.charAt(a++)),i=0;i<o.length;i++)o[i]>r-1&&(null==o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/r|0,o[i]%=r)}return o.reverse()}return function(r,n,i,s,o){var a,l,u,c,h,p,f,g,y=r.indexOf("."),v=A,_=O;for(y>=0&&(c=D,D=0,r=r.replace(".",""),p=(g=new L(n)).pow(r.length-y),D=c,g.c=t(m(d(p.c),p.e,"0"),10,i,e),g.e=g.c.length),u=c=(f=t(r,n,i,o?(a=j,e):(a=e,j))).length;0==f[--c];f.pop());if(!f[0])return a.charAt(0);if(y<0?--u:(p.c=f,p.e=u,p.s=s,f=(p=E(p,g,v,_,i)).c,h=p.r,u=p.e),y=f[l=u+v+1],c=i/2,h=h||l<0||null!=f[l+1],h=_<4?(null!=y||h)&&(0==_||_==(p.s<0?3:2)):y>c||y==c&&(4==_||h||6==_&&1&f[l-1]||_==(p.s<0?8:7)),l<1||!f[0])r=h?m(a.charAt(1),-v,a.charAt(0)):a.charAt(0);else{if(f.length=l,h)for(--i;++f[--l]>i;)f[l]=0,l||(++u,f=[1].concat(f));for(c=f.length;!f[--c];);for(y=0,r="";y<=c;r+=a.charAt(f[y++]));r=m(r,u,a.charAt(0))}return r}}(),E=function(){function e(e,t,r){var n,i,s,o,a=0,l=e.length,u=t%1e7,c=t/1e7|0;for(e=e.slice();l--;)n=c*(s=e[l]%1e7)+(o=e[l]/1e7|0)*u,a=((i=u*s+n%1e7*1e7+a)/r|0)+(n/1e7|0)+c*o,e[l]=i%r;return a&&(e=[a].concat(e)),e}function t(e,t,r,n){var i,s;if(r!=n)s=r>n?1:-1;else for(i=s=0;i<r;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function r(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=+(e[r]<t[r]),e[r]=i*n+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(n,i,s,a,l){var u,d,h,p,f,g,m,y,v,_,b,E,S,w,T,C,A,O=n.s==i.s?1:-1,x=n.c,I=i.c;if(!x||!x[0]||!I||!I[0])return new L(!n.s||!i.s||(x?I&&x[0]==I[0]:!I)?NaN:x&&0==x[0]||!I?0*O:O/0);for(v=(y=new L(O)).c=[],O=s+(d=n.e-i.e)+1,l||(l=1e14,d=c(n.e/14)-c(i.e/14),O=O/14|0),h=0;I[h]==(x[h]||0);h++);if(I[h]>(x[h]||0)&&d--,O<0)v.push(1),p=!0;else{for(w=x.length,C=I.length,h=0,O+=2,(f=o(l/(I[0]+1)))>1&&(I=e(I,f,l),x=e(x,f,l),C=I.length,w=x.length),S=C,b=(_=x.slice(0,C)).length;b<C;_[b++]=0);A=[0].concat(A=I.slice()),T=I[0],I[1]>=l/2&&T++;do{if(f=0,(u=t(I,_,C,b))<0){if(E=_[0],C!=b&&(E=E*l+(_[1]||0)),(f=o(E/T))>1)for(f>=l&&(f=l-1),m=(g=e(I,f,l)).length,b=_.length;1==t(g,_,m,b);)f--,r(g,C<m?A:I,m,l),m=g.length,u=1;else 0==f&&(u=f=1),m=(g=I.slice()).length;if(m<b&&(g=[0].concat(g)),r(_,g,b,l),b=_.length,-1==u)for(;1>t(I,_,C,b);)f++,r(_,C<b?A:I,b,l),b=_.length}else 0===u&&(f++,_=[0]);v[h++]=f,_[0]?_[b++]=x[S]||0:(_=[x[S]],b=1)}while((S++<w||null!=_[0])&&O--)p=null!=_[0],v[0]||v.splice(0,1)}if(1e14==l){for(h=1,O=v[0];O>=10;O/=10,h++);G(y,s+(y.e=h+14*d-1)+1,a,p)}else y.e=d,y.r=+p;return y}}(),n=/^(-?)0([xbo])(?=\w[\w.]*$)/i,y=/^([^.]+)\.$/,v=/^\.([^.]+)$/,_=/^-?(Infinity|NaN)$/,b=/^\s*\+(?=[\w.])|^\s+|\s+$/g,w=function(e,t,r,i){var s,o=r?t:t.replace(b,"");if(_.test(o))e.s=isNaN(o)?null:o<0?-1:1;else{if(!r&&(o=o.replace(n,function(e,t,r){return s="x"==(r=r.toLowerCase())?16:"b"==r?2:8,i&&i!=s?e:t}),i&&(s=i,o=o.replace(y,"$1").replace(v,"0.$1")),t!=o))return new L(o,s);if(L.DEBUG)throw Error(a+"Not a"+(i?" base "+i:"")+" number: "+t);e.s=null}e.c=e.e=null},T.absoluteValue=T.abs=function(){var e=new L(this);return e.s<0&&(e.s=1),e},T.comparedTo=function(e,t){return h(this,new L(e,t))},T.decimalPlaces=T.dp=function(e,t){var r,n,i;if(null!=e)return p(e,0,1e9),null==t?t=O:p(t,0,8),G(new L(this),e+this.e+1,t);if(!(r=this.c))return null;if(n=((i=r.length-1)-c(this.e/14))*14,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},T.dividedBy=T.div=function(e,t){return E(this,new L(e,t),A,O)},T.dividedToIntegerBy=T.idiv=function(e,t){return E(this,new L(e,t),0,1)},T.exponentiatedBy=T.pow=function(e,t){var r,n,i,l,u,c,d,h,p,g=this;if((e=new L(e)).c&&!e.isInteger())throw Error(a+"Exponent not an integer: "+H(e));if(null!=t&&(t=new L(t)),c=e.e>14,!g.c||!g.c[0]||1==g.c[0]&&!g.e&&1==g.c.length||!e.c||!e.c[0])return p=new L(Math.pow(+H(g),c?e.s*(2-f(e)):+H(e))),t?p.mod(t):p;if(d=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new L(NaN);(n=!d&&g.isInteger()&&t.isInteger())&&(g=g.mod(t))}else{if(e.e>9&&(g.e>0||g.e<-1||(0==g.e?g.c[0]>1||c&&g.c[1]>=24e7:g.c[0]<8e13||c&&g.c[0]<=9999975e7)))return l=g.s<0&&f(e)?-0:0,g.e>-1&&(l=1/l),new L(d?1/l:l);D&&(l=s(D/14+2))}for(c?(r=new L(.5),d&&(e.s=1),h=f(e)):h=(i=Math.abs(+H(e)))%2,p=new L(C);;){if(h){if(!(p=p.times(g)).c)break;l?p.c.length>l&&(p.c.length=l):n&&(p=p.mod(t))}if(i){if(0===(i=o(i/2)))break;h=i%2}else if(G(e=e.times(r),e.e+1,1),e.e>14)h=f(e);else{if(0==(i=+H(e)))break;h=i%2}g=g.times(g),l?g.c&&g.c.length>l&&(g.c.length=l):n&&(g=g.mod(t))}return n?p:(d&&(p=C.div(p)),t?p.mod(t):l?G(p,D,O,u):p)},T.integerValue=function(e){var t=new L(this);return null==e?e=O:p(e,0,8),G(t,t.e+1,e)},T.isEqualTo=T.eq=function(e,t){return 0===h(this,new L(e,t))},T.isFinite=function(){return!!this.c},T.isGreaterThan=T.gt=function(e,t){return h(this,new L(e,t))>0},T.isGreaterThanOrEqualTo=T.gte=function(e,t){return 1===(t=h(this,new L(e,t)))||0===t},T.isInteger=function(){return!!this.c&&c(this.e/14)>this.c.length-2},T.isLessThan=T.lt=function(e,t){return 0>h(this,new L(e,t))},T.isLessThanOrEqualTo=T.lte=function(e,t){return -1===(t=h(this,new L(e,t)))||0===t},T.isNaN=function(){return!this.s},T.isNegative=function(){return this.s<0},T.isPositive=function(){return this.s>0},T.isZero=function(){return!!this.c&&0==this.c[0]},T.minus=function(e,t){var r,n,i,s,o=this.s;if(t=(e=new L(e,t)).s,!o||!t)return new L(NaN);if(o!=t)return e.s=-t,this.plus(e);var a=this.e/14,l=e.e/14,u=this.c,d=e.c;if(!a||!l){if(!u||!d)return u?(e.s=-t,e):new L(d?this:NaN);if(!u[0]||!d[0])return d[0]?(e.s=-t,e):new L(u[0]?this:3==O?-0:0)}if(a=c(a),l=c(l),u=u.slice(),o=a-l){for((s=o<0)?(o=-o,i=u):(l=a,i=d),i.reverse(),t=o;t--;i.push(0));i.reverse()}else for(n=(s=(o=u.length)<(t=d.length))?o:t,o=t=0;t<n;t++)if(u[t]!=d[t]){s=u[t]<d[t];break}if(s&&(i=u,u=d,d=i,e.s=-e.s),(t=(n=d.length)-(r=u.length))>0)for(;t--;u[r++]=0);for(t=1e14-1;n>o;){if(u[--n]<d[n]){for(r=n;r&&!u[--r];u[r]=t);--u[r],u[n]+=1e14}u[n]-=d[n]}for(;0==u[0];u.splice(0,1),--l);return u[0]?q(e,u,l):(e.s=3==O?-1:1,e.c=[e.e=0],e)},T.modulo=T.mod=function(e,t){var r,n;return(e=new L(e,t),this.c&&e.s&&(!e.c||e.c[0]))?e.c&&(!this.c||this.c[0])?(9==N?(n=e.s,e.s=1,r=E(this,e,0,3),e.s=n,r.s*=n):r=E(this,e,0,N),(e=this.minus(r.times(e))).c[0]||1!=N||(e.s=this.s),e):new L(this):new L(NaN)},T.multipliedBy=T.times=function(e,t){var r,n,i,s,o,a,l,u,d,h,p,f,g,m=this.c,y=(e=new L(e,t)).c;if(!m||!y||!m[0]||!y[0])return this.s&&e.s&&(!m||m[0]||y)&&(!y||y[0]||m)?(e.s*=this.s,m&&y?(e.c=[0],e.e=0):e.c=e.e=null):e.c=e.e=e.s=null,e;for(n=c(this.e/14)+c(e.e/14),e.s*=this.s,(l=m.length)<(h=y.length)&&(g=m,m=y,y=g,i=l,l=h,h=i),i=l+h,g=[];i--;g.push(0));for(i=h;--i>=0;){for(r=0,p=y[i]%1e7,f=y[i]/1e7|0,s=i+(o=l);s>i;)a=f*(u=m[--o]%1e7)+(d=m[o]/1e7|0)*p,r=((u=p*u+a%1e7*1e7+g[s]+r)/1e14|0)+(a/1e7|0)+f*d,g[s--]=u%1e14;g[s]=r}return r?++n:g.splice(0,1),q(e,g,n)},T.negated=function(){var e=new L(this);return e.s=-e.s||null,e},T.plus=function(e,t){var r,n=this.s;if(t=(e=new L(e,t)).s,!n||!t)return new L(NaN);if(n!=t)return e.s=-t,this.minus(e);var i=this.e/14,s=e.e/14,o=this.c,a=e.c;if(!i||!s){if(!o||!a)return new L(n/0);if(!o[0]||!a[0])return a[0]?e:new L(o[0]?this:0*n)}if(i=c(i),s=c(s),o=o.slice(),n=i-s){for(n>0?(s=i,r=a):(n=-n,r=o),r.reverse();n--;r.push(0));r.reverse()}for((n=o.length)-(t=a.length)<0&&(r=a,a=o,o=r,t=n),n=0;t;)n=(o[--t]=o[t]+a[t]+n)/1e14|0,o[t]=1e14===o[t]?0:o[t]%1e14;return n&&(o=[n].concat(o),++s),q(e,o,s)},T.precision=T.sd=function(e,t){var r,n,i;if(null!=e&&!!e!==e)return p(e,1,1e9),null==t?t=O:p(t,0,8),G(new L(this),e,t);if(!(r=this.c))return null;if(n=14*(i=r.length-1)+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];i>=10;i/=10,n++);}return e&&this.e+1>n&&(n=this.e+1),n},T.shiftedBy=function(e){return p(e,-0x1fffffffffffff,0x1fffffffffffff),this.times("1e"+e)},T.squareRoot=T.sqrt=function(){var e,t,r,n,i,s=this.c,o=this.s,a=this.e,l=A+4,u=new L("0.5");if(1!==o||!s||!s[0])return new L(!o||o<0&&(!s||s[0])?NaN:s?this:1/0);if(0==(o=Math.sqrt(+H(this)))||o==1/0?(((t=d(s)).length+a)%2==0&&(t+="0"),o=Math.sqrt(+t),a=c((a+1)/2)-(a<0||a%2),r=new L(t=o==1/0?"5e"+a:(t=o.toExponential()).slice(0,t.indexOf("e")+1)+a)):r=new L(o+""),r.c[0]){for((o=(a=r.e)+l)<3&&(o=0);;)if(i=r,r=u.times(i.plus(E(this,i,l,1))),d(i.c).slice(0,o)===(t=d(r.c)).slice(0,o)){if(r.e<a&&--o,"9999"!=(t=t.slice(o-3,o+1))&&(n||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(G(r,r.e+A+2,1),e=!r.times(r).eq(this));break}if(!n&&(G(i,i.e+A+2,0),i.times(i).eq(this))){r=i;break}l+=4,o+=4,n=1}}return G(r,r.e+A+1,O,e)},T.toExponential=function(e,t){return null!=e&&(p(e,0,1e9),e++),F(this,e,t,1)},T.toFixed=function(e,t){return null!=e&&(p(e,0,1e9),e=e+this.e+1),F(this,e,t)},T.toFormat=function(e,t,r){var n;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=M;else if("object"!=typeof r)throw Error(a+"Argument not an object: "+r);if(n=this.toFixed(e,t),this.c){var i,s=n.split("."),o=+r.groupSize,l=+r.secondaryGroupSize,u=r.groupSeparator||"",c=s[0],d=s[1],h=this.s<0,p=h?c.slice(1):c,f=p.length;if(l&&(i=o,o=l,l=i,f-=i),o>0&&f>0){for(i=f%o||o,c=p.substr(0,i);i<f;i+=o)c+=u+p.substr(i,o);l>0&&(c+=u+p.slice(i)),h&&(c="-"+c)}n=d?c+(r.decimalSeparator||"")+((l=+r.fractionGroupSize)?d.replace(RegExp("\\d{"+l+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):d):c}return(r.prefix||"")+n+(r.suffix||"")},T.toFraction=function(e){var t,r,n,i,s,o,l,c,h,p,f,g,m=this.c;if(null!=e&&(!(l=new L(e)).isInteger()&&(l.c||1!==l.s)||l.lt(C)))throw Error(a+"Argument "+(l.isInteger()?"out of range: ":"not an integer: ")+H(l));if(!m)return new L(this);for(t=new L(C),h=r=new L(C),n=c=new L(C),g=d(m),s=t.e=g.length-this.e-1,t.c[0]=u[(o=s%14)<0?14+o:o],e=!e||l.comparedTo(t)>0?s>0?t:h:l,o=R,R=1/0,l=new L(g),c.c[0]=0;p=E(l,t,0,1),1!=(i=r.plus(p.times(n))).comparedTo(e);)r=n,n=i,h=c.plus(p.times(i=h)),c=i,t=l.minus(p.times(i=t)),l=i;return i=E(e.minus(r),n,0,1),c=c.plus(i.times(h)),r=r.plus(i.times(n)),c.s=h.s=this.s,s*=2,f=1>E(h,n,s,O).minus(this).abs().comparedTo(E(c,r,s,O).minus(this).abs())?[h,n]:[c,r],R=o,f},T.toNumber=function(){return+H(this)},T.toPrecision=function(e,t){return null!=e&&p(e,1,1e9),F(this,e,t,2)},T.toString=function(e){var t,r=this,n=r.s,i=r.e;return null===i?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(null==e?t=i<=x||i>=I?g(d(r.c),i):m(d(r.c),i,"0"):10===e&&U?t=m(d((r=G(new L(r),A+i+1,O)).c),r.e,"0"):(p(e,2,j.length,"Base"),t=S(m(d(r.c),i,"0"),10,e,n,!0)),n<0&&r.c[0]&&(t="-"+t)),t},T.valueOf=T.toJSON=function(){return H(this)},T._isBigNumber=!0,null!=t&&L.set(t),L}()).default=n.BigNumber=n,"function"==typeof define&&define.amd)e.r,void 0!==n&&e.v(n);else t.exports?t.exports=n:(r||(r="undefined"!=typeof self&&self?self:window),r.BigNumber=n)}(e.e)},64349,(e,t,r)=>{var n=e.r(45905),i=t.exports;!function(){"use strict";var e,t,r,s=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function a(e){return s.lastIndex=0,s.test(e)?'"'+e.replace(s,function(e){var t=o[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}"function"!=typeof i.stringify&&(i.stringify=function(i,s,o){var l;if(e="",t="","number"==typeof o)for(l=0;l<o;l+=1)t+=" ";else"string"==typeof o&&(t=o);if(r=s,s&&"function"!=typeof s&&("object"!=typeof s||"number"!=typeof s.length))throw Error("JSON.stringify");return function i(s,o){var l,u,c,d,h,p=e,f=o[s],g=null!=f&&(f instanceof n||n.isBigNumber(f));switch(f&&"object"==typeof f&&"function"==typeof f.toJSON&&(f=f.toJSON(s)),"function"==typeof r&&(f=r.call(o,s,f)),typeof f){case"string":if(g)return f;return a(f);case"number":return isFinite(f)?String(f):"null";case"boolean":case"null":case"bigint":return String(f);case"object":if(!f)return"null";if(e+=t,h=[],"[object Array]"===Object.prototype.toString.apply(f)){for(l=0,d=f.length;l<d;l+=1)h[l]=i(l,f)||"null";return c=0===h.length?"[]":e?"[\n"+e+h.join(",\n"+e)+"\n"+p+"]":"["+h.join(",")+"]",e=p,c}if(r&&"object"==typeof r)for(l=0,d=r.length;l<d;l+=1)"string"==typeof r[l]&&(c=i(u=r[l],f))&&h.push(a(u)+(e?": ":":")+c);else Object.keys(f).forEach(function(t){var r=i(t,f);r&&h.push(a(t)+(e?": ":":")+r)});return c=0===h.length?"{}":e?"{\n"+e+h.join(",\n"+e)+"\n"+p+"}":"{"+h.join(",")+"}",e=p,c}}("",{"":i})})}()},67104,(e,t,r)=>{var n=null;let i=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,s=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;t.exports=function(t){"use strict";var r={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(null!=t){if(!0===t.strict&&(r.strict=!0),!0===t.storeAsString&&(r.storeAsString=!0),r.alwaysParseAsBig=!0===t.alwaysParseAsBig&&t.alwaysParseAsBig,r.useNativeBigInt=!0===t.useNativeBigInt&&t.useNativeBigInt,void 0!==t.constructorAction)if("error"===t.constructorAction||"ignore"===t.constructorAction||"preserve"===t.constructorAction)r.constructorAction=t.constructorAction;else throw Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${t.constructorAction}`);if(void 0!==t.protoAction)if("error"===t.protoAction||"ignore"===t.protoAction||"preserve"===t.protoAction)r.protoAction=t.protoAction;else throw Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${t.protoAction}`)}var o,a,l,u,c={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},d=function(e){throw{name:"SyntaxError",message:e,at:o,text:l}},h=function(e){return e&&e!==a&&d("Expected '"+e+"' instead of '"+a+"'"),a=l.charAt(o),o+=1,a},p=function(){var t,i="";for("-"===a&&(i="-",h("-"));a>="0"&&a<="9";)i+=a,h();if("."===a)for(i+=".";h()&&a>="0"&&a<="9";)i+=a;if("e"===a||"E"===a)for(i+=a,h(),("-"===a||"+"===a)&&(i+=a,h());a>="0"&&a<="9";)i+=a,h();if(isFinite(t=+i))return(null==n&&(n=e.r(45905)),i.length>15)?r.storeAsString?i:r.useNativeBigInt?BigInt(i):new n(i):r.alwaysParseAsBig?r.useNativeBigInt?BigInt(t):new n(t):t;d("Bad number")},f=function(){var e,t,r,n="";if('"'===a)for(var i=o;h();){if('"'===a)return o-1>i&&(n+=l.substring(i,o-1)),h(),n;if("\\"===a){if(o-1>i&&(n+=l.substring(i,o-1)),h(),"u"===a){for(t=0,r=0;t<4&&isFinite(e=parseInt(h(),16));t+=1)r=16*r+e;n+=String.fromCharCode(r)}else if("string"==typeof c[a])n+=c[a];else break;i=o}}d("Bad string")},g=function(){for(;a&&a<=" ";)h()},m=function(){switch(a){case"t":return h("t"),h("r"),h("u"),h("e"),!0;case"f":return h("f"),h("a"),h("l"),h("s"),h("e"),!1;case"n":return h("n"),h("u"),h("l"),h("l"),null}d("Unexpected '"+a+"'")},y=function(){var e=[];if("["===a){if(h("["),g(),"]"===a)return h("]"),e;for(;a;){if(e.push(u()),g(),"]"===a)return h("]"),e;h(","),g()}}d("Bad array")},v=function(){var e,t=Object.create(null);if("{"===a){if(h("{"),g(),"}"===a)return h("}"),t;for(;a;){if(e=f(),g(),h(":"),!0===r.strict&&Object.hasOwnProperty.call(t,e)&&d('Duplicate key "'+e+'"'),!0===i.test(e)?"error"===r.protoAction?d("Object contains forbidden prototype property"):"ignore"===r.protoAction?u():t[e]=u():!0===s.test(e)?"error"===r.constructorAction?d("Object contains forbidden constructor property"):"ignore"===r.constructorAction?u():t[e]=u():t[e]=u(),g(),"}"===a)return h("}"),t;h(","),g()}}d("Bad object")};return u=function(){switch(g(),a){case"{":return v();case"[":return y();case'"':return f();case"-":return p();default:return a>="0"&&a<="9"?p():m()}},function(e,t){var r;return l=e+"",o=0,a=" ",r=u(),g(),a&&d("Syntax error"),"function"==typeof t?function e(r,n){var i,s=r[n];return s&&"object"==typeof s&&Object.keys(s).forEach(function(t){void 0!==(i=e(s,t))?s[t]=i:delete s[t]}),t.call(r,n,s)}({"":r},""):r}}},1158,(e,t,r)=>{var n=e.r(64349).stringify,i=e.r(67104);t.exports=function(e){return{parse:i(e),stringify:n}},t.exports.parse=i(),t.exports.stringify=n},6737,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Colours=void 0;class n{static isEnabled(e){return e.isTTY&&("function"!=typeof e.getColorDepth||e.getColorDepth()>2)}static refresh(){n.enabled=n.isEnabled(process.stderr),this.enabled?(n.reset="\x1b[0m",n.bright="\x1b[1m",n.dim="\x1b[2m",n.red="\x1b[31m",n.green="\x1b[32m",n.yellow="\x1b[33m",n.blue="\x1b[34m",n.magenta="\x1b[35m",n.cyan="\x1b[36m",n.white="\x1b[37m",n.grey="\x1b[90m"):(n.reset="",n.bright="",n.dim="",n.red="",n.green="",n.yellow="",n.blue="",n.magenta="",n.cyan="",n.white="",n.grey="")}}r.Colours=n,n.enabled=!1,n.reset="",n.bright="",n.dim="",n.red="",n.green="",n.yellow="",n.blue="",n.magenta="",n.cyan="",n.white="",n.grey="",n.refresh()},90812,(e,t,r)=>{"use strict";let n;var i,s=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return o(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.env=r.DebugLogBackendBase=r.placeholder=r.AdhocDebugLogger=r.LogSeverity=void 0,r.getNodeBackend=g,r.getDebugBackend=function(e){return new m(e)},r.getStructuredBackend=function(e){return new y(e)},r.setBackend=function(e){n=e,v.clear()},r.log=_;let l=e.r(87769),u=a(e.r(59639)),c=a(e.r(12057)),d=e.r(6737);!function(e){e.DEFAULT="DEFAULT",e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR"}(i||(r.LogSeverity=i={}));class h extends l.EventEmitter{constructor(e,t){super(),this.namespace=e,this.upstream=t,this.func=Object.assign(this.invoke.bind(this),{instance:this,on:(e,t)=>this.on(e,t)}),this.func.debug=(...e)=>this.invokeSeverity(i.DEBUG,...e),this.func.info=(...e)=>this.invokeSeverity(i.INFO,...e),this.func.warn=(...e)=>this.invokeSeverity(i.WARNING,...e),this.func.error=(...e)=>this.invokeSeverity(i.ERROR,...e),this.func.sublog=e=>_(e,this.func)}invoke(e,...t){this.upstream&&this.upstream(e,...t),this.emit("log",e,t)}invokeSeverity(e,...t){this.invoke({severity:e},...t)}}r.AdhocDebugLogger=h,r.placeholder=new h("",()=>{}).func;class p{constructor(){var e;this.cached=new Map,this.filters=[],this.filtersSet=!1;let t=null!=(e=u.env[r.env.nodeEnables])?e:"*";"all"===t&&(t="*"),this.filters=t.split(",")}log(e,t,...r){try{this.filtersSet||(this.setFilters(),this.filtersSet=!0);let n=this.cached.get(e);n||(n=this.makeLogger(e),this.cached.set(e,n)),n(t,...r)}catch(e){console.error(e)}}}r.DebugLogBackendBase=p;class f extends p{constructor(){super(...arguments),this.enabledRegexp=/.*/g}isEnabled(e){return this.enabledRegexp.test(e)}makeLogger(e){return this.enabledRegexp.test(e)?(t,...r)=>{var n;let s,o=`${d.Colours.green}${e}${d.Colours.reset}`,a=`${d.Colours.yellow}${u.pid}${d.Colours.reset}`;switch(t.severity){case i.ERROR:s=`${d.Colours.red}${t.severity}${d.Colours.reset}`;break;case i.INFO:s=`${d.Colours.magenta}${t.severity}${d.Colours.reset}`;break;case i.WARNING:s=`${d.Colours.yellow}${t.severity}${d.Colours.reset}`;break;default:s=null!=(n=t.severity)?n:i.DEFAULT}let l=c.formatWithOptions({colors:d.Colours.enabled},...r),h=Object.assign({},t);delete h.severity;let p=Object.getOwnPropertyNames(h).length?JSON.stringify(h):"",f=p?`${d.Colours.grey}${p}${d.Colours.reset}`:"";console.error("%s [%s|%s] %s%s",a,o,s,l,p?` ${f}`:"")}:()=>{}}setFilters(){let e=this.filters.join(",").replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^");this.enabledRegexp=RegExp(`^${e}$`,"i")}}function g(){return new f}class m extends p{constructor(e){super(),this.debugPkg=e}makeLogger(e){let t=this.debugPkg(e);return(e,...r)=>{t(r[0],...r.slice(1))}}setFilters(){var e;let t=null!=(e=u.env.NODE_DEBUG)?e:"";u.env.NODE_DEBUG=`${t}${t?",":""}${this.filters.join(",")}`}}class y extends p{constructor(e){super(),this.upstream=null!=e?e:new f}makeLogger(e){let t=this.upstream.makeLogger(e);return(e,...r)=>{var n;let s=JSON.stringify(Object.assign({severity:null!=(n=e.severity)?n:i.INFO,message:c.format(...r)},e));t(e,s)}}setFilters(){this.upstream.setFilters()}}r.env={nodeEnables:"GOOGLE_SDK_NODE_LOGGING"};let v=new Map;function _(e,t){let i;if(!u.env[r.env.nodeEnables]||!e)return r.placeholder;t&&(e=`${t.instance.namespace}:${e}`);let s=v.get(e);if(s)return s.func;if(null===n)return r.placeholder;void 0===n&&(n=g());let o=new h(e,(t,...r)=>{if(i!==n){if(null===n)return;void 0===n&&(n=g()),i=n}null==n||n.log(e,t,...r)});return v.set(e,o),o.func}},47637,(e,t,r)=>{"use strict";var n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e.r(90812),r)},82e3,(e,t,r)=>{"use strict";let n;var i=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.gcpResidencyCache=r.METADATA_SERVER_DETECTION=r.HEADERS=r.HEADER_VALUE=r.HEADER_NAME=r.SECONDARY_HOST_ADDRESS=r.HOST_ADDRESS=r.BASE_PATH=void 0,r.instance=function(e){return h("instance",e)},r.project=function(e){return h("project",e)},r.universe=function(e){return h("universe",e)},r.bulk=f,r.isAvailable=g,r.resetIsAvailableCache=function(){n=void 0},r.getGCPResidency=m,r.setGCPResidency=y,r.requestTimeout=v;let o=e.r(66037),a=e.r(1158),l=e.r(29077),u=e.r(47637);r.BASE_PATH="/computeMetadata/v1",r.HOST_ADDRESS="http://169.254.169.254",r.SECONDARY_HOST_ADDRESS="http://metadata.google.internal.",r.HEADER_NAME="Metadata-Flavor",r.HEADER_VALUE="Google",r.HEADERS=Object.freeze({[r.HEADER_NAME]:r.HEADER_VALUE});let c=u.log("gcp metadata");function d(e){return e||(e=process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST||r.HOST_ADDRESS),/^https?:\/\//.test(e)||(e=`http://${e}`),new URL(r.BASE_PATH,e).href}async function h(e,t={},n=3,i=!1){let s="",l={},u={};("object"==typeof e?(s=e.metadataKey,l=e.params||l,u=e.headers||u,n=e.noResponseRetries||n,i=e.fastFail||i):s=e,"string"==typeof t)?s+=`/${t}`:(Object.keys(t).forEach(e=>{switch(e){case"params":case"property":case"headers":break;case"qs":throw Error("'qs' is not a valid configuration option. Please use 'params' instead.");default:throw Error(`'${e}' is not a valid configuration option.`)}}),t.property&&(s+=`/${t.property}`),u=t.headers||u,l=t.params||l);let f=i?p:o.request,g={url:`${d()}/${s}`,headers:{...r.HEADERS,...u},retryConfig:{noResponseRetries:n},params:l,responseType:"text",timeout:v()};c.info("instance request %j",g);let m=await f(g);if(c.info("instance metadata is %s",m.data),m.headers[r.HEADER_NAME.toLowerCase()]!==r.HEADER_VALUE)throw Error(`Invalid response from metadata service: incorrect ${r.HEADER_NAME} header. Expected '${r.HEADER_VALUE}', got ${m.headers[r.HEADER_NAME.toLowerCase()]?`'${m.headers[r.HEADER_NAME.toLowerCase()]}'`:"no header"}`);if("string"==typeof m.data)try{return a.parse(m.data)}catch(e){}return m.data}async function p(e){var t;let n={...e,url:null==(t=e.url)?void 0:t.toString().replace(d(),d(r.SECONDARY_HOST_ADDRESS))},i=!1,s=(0,o.request)(e).then(e=>(i=!0,e)).catch(e=>{if(i)return a;throw i=!0,e}),a=(0,o.request)(n).then(e=>(i=!0,e)).catch(e=>{if(i)return s;throw i=!0,e});return Promise.race([s,a])}async function f(e){let t={};return await Promise.all(e.map(e=>(async()=>{let r=await h(e);t[e.metadataKey]=r})())),t}async function g(){if(process.env.METADATA_SERVER_DETECTION){let e=process.env.METADATA_SERVER_DETECTION.trim().toLocaleLowerCase();if(!(e in r.METADATA_SERVER_DETECTION))throw RangeError(`Unknown \`METADATA_SERVER_DETECTION\` env variable. Got \`${e}\`, but it should be \`${Object.keys(r.METADATA_SERVER_DETECTION).join("`, `")}\`, or unset`);switch(e){case"assume-present":return!0;case"none":return!1;case"bios-only":return m()}}try{return void 0===n&&(n=h("instance",void 0,process.env.DETECT_GCP_RETRIES?Number(process.env.DETECT_GCP_RETRIES):0,!(process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST))),await n,!0}catch(e){if(process.env.DEBUG_AUTH&&console.info(e),"request-timeout"===e.type||e.response&&404===e.response.status)return!1;if(!(e.response&&404===e.response.status)&&(!e.code||!["EHOSTDOWN","EHOSTUNREACH","ENETUNREACH","ENOENT","ENOTFOUND","ECONNREFUSED"].includes(e.code))){let t="UNKNOWN";e.code&&(t=e.code),process.emitWarning(`received unexpected error = ${e.message} code = ${t}`,"MetadataLookupWarning")}return!1}}function m(){return null===r.gcpResidencyCache&&y(),r.gcpResidencyCache}function y(e=null){r.gcpResidencyCache=null!==e?e:(0,l.detectGCPResidency)()}function v(){return 3e3*!m()}r.METADATA_SERVER_DETECTION=Object.freeze({"assume-present":"don't try to ping the metadata server, but assume it's present",none:"don't try to ping the metadata server, but don't try to use it either","bios-only":"treat the result of a BIOS probe as canonical (don't fall back to pinging)","ping-only":"skip the BIOS probe, and go straight to pinging"}),r.gcpResidencyCache=null,s(e.r(29077),r)},6920,(e,t,r)=>{"use strict";r.byteLength=function(e){var t=u(e),r=t[0],n=t[1];return(r+n)*3/4-n},r.toByteArray=function(e){var t,r,n=u(e),o=n[0],a=n[1],l=new s((o+a)*3/4-a),c=0,d=a>0?o-4:o;for(r=0;r<d;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],l[c++]=t>>16&255,l[c++]=t>>8&255,l[c++]=255&t;return 2===a&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,l[c++]=255&t),1===a&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,l[c++]=t>>8&255,l[c++]=255&t),l},r.fromByteArray=function(e){for(var t,r=e.length,i=r%3,s=[],o=0,a=r-i;o<a;o+=16383)s.push(function(e,t,r){for(var i,s=[],o=t;o<r;o+=3)i=(e[o]<<16&0xff0000)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(n[i>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return s.join("")}(e,o,o+16383>a?a:o+16383));return 1===i?s.push(n[(t=e[r-1])>>2]+n[t<<4&63]+"=="):2===i&&s.push(n[(t=(e[r-2]<<8)+e[r-1])>>10]+n[t>>4&63]+n[t<<2&63]+"="),s.join("")};for(var n=[],i=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=o.length;a<l;++a)n[a]=o[a],i[o.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}i[45]=62,i[95]=63},69216,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BrowserCrypto=void 0;let n=e.r(6920),i=e.r(1426);class s{constructor(){throw Error("SubtleCrypto not found. Make sure it's an https:// website.")}async sha256DigestBase64(e){let t=new TextEncoder().encode(e),r=await window.crypto.subtle.digest("SHA-256",t);return n.fromByteArray(new Uint8Array(r))}randomBytesBase64(e){let t=new Uint8Array(e);return window.crypto.getRandomValues(t),n.fromByteArray(t)}static padBase64(e){for(;e.length%4!=0;)e+="=";return e}async verify(e,t,r){let i={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},o=new TextEncoder().encode(t),a=n.toByteArray(s.padBase64(r)),l=await window.crypto.subtle.importKey("jwk",e,i,!0,["verify"]);return await window.crypto.subtle.verify(i,l,a,o)}async sign(e,t){let r={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},i=new TextEncoder().encode(t),s=await window.crypto.subtle.importKey("jwk",e,r,!0,["sign"]),o=await window.crypto.subtle.sign(r,s,i);return n.fromByteArray(new Uint8Array(o))}decodeBase64StringUtf8(e){let t=n.toByteArray(s.padBase64(e));return new TextDecoder().decode(t)}encodeBase64StringUtf8(e){let t=new TextEncoder().encode(e);return n.fromByteArray(t)}async sha256DigestHex(e){let t=new TextEncoder().encode(e),r=await window.crypto.subtle.digest("SHA-256",t);return(0,i.fromArrayBufferToHex)(r)}async signWithHmacSha256(e,t){let r="string"==typeof e?e:String.fromCharCode(...new Uint16Array(e)),n=new TextEncoder,i=await window.crypto.subtle.importKey("raw",n.encode(r),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return window.crypto.subtle.sign("HMAC",i,n.encode(t))}}r.BrowserCrypto=s},21962,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.NodeCrypto=void 0;let n=e.r(54799);r.NodeCrypto=class{async sha256DigestBase64(e){return n.createHash("sha256").update(e).digest("base64")}randomBytesBase64(e){return n.randomBytes(e).toString("base64")}async verify(e,t,r){let i=n.createVerify("RSA-SHA256");return i.update(t),i.end(),i.verify(e,r,"base64")}async sign(e,t){let r=n.createSign("RSA-SHA256");return r.update(t),r.end(),r.sign(e,"base64")}decodeBase64StringUtf8(e){return Buffer.from(e,"base64").toString("utf-8")}encodeBase64StringUtf8(e){return Buffer.from(e,"utf-8").toString("base64")}async sha256DigestHex(e){return n.createHash("sha256").update(e).digest("hex")}async signWithHmacSha256(e,t){var r,i;let s="string"==typeof e?e:(r=e,Buffer.from(r));return(i=n.createHmac("sha256",s).update(t).digest()).buffer.slice(i.byteOffset,i.byteOffset+i.byteLength)}}},1426,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createCrypto=function(){return function(){;}(),new n.NodeCrypto},r.hasBrowserCrypto=i,r.fromArrayBufferToHex=function(e){return Array.from(new Uint8Array(e)).map(e=>e.toString(16).padStart(2,"0")).join("")},e.r(69216);let n=e.r(21962);function i(){return!1}},37556,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.validate=function(e){for(let t of[{invalid:"uri",expected:"url"},{invalid:"json",expected:"data"},{invalid:"qs",expected:"params"}])if(e[t.invalid])throw Error(`'${t.invalid}' is not a valid configuration option. Please use '${t.expected}' instead. This library is using Axios for requests. Please see https://github.com/axios/axios to learn more about the valid request options.`)}},96299,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DefaultTransporter=void 0;let n=e.r(66037),i=e.r(37556),s=e.r(91829),o="google-api-nodejs-client";class a{constructor(){this.instance=new n.Gaxios}configure(e={}){e.headers=e.headers||{};{let t=e.headers["User-Agent"];if(t?t.includes(`${o}/`)||(e.headers["User-Agent"]=`${t} ${a.USER_AGENT}`):e.headers["User-Agent"]=a.USER_AGENT,!e.headers["x-goog-api-client"]){let t=process.version.replace(/^v/,"");e.headers["x-goog-api-client"]=`gl-node/${t}`}}return e}request(e){return e=this.configure(e),(0,i.validate)(e),this.instance.request(e).catch(e=>{throw this.processError(e)})}get defaults(){return this.instance.defaults}set defaults(e){this.instance.defaults=e}processError(e){let t=e.response,r=t?t.data:null;return t&&r&&r.error&&200!==t.status?"string"==typeof r.error?(e.message=r.error,e.status=t.status):Array.isArray(r.error.errors)?(e.message=r.error.errors.map(e=>e.message).join("\n"),e.code=r.error.code,e.errors=r.error.errors):(e.message=r.error.message,e.code=r.error.code):t&&t.status>=400&&(e.message=r,e.status=t.status),e}}r.DefaultTransporter=a,a.USER_AGENT=`${o}/${s.version}`},23469,(e,t,r)=>{var n=e.r(874),i=n.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=n:(s(n,r),r.Buffer=o),o.prototype=Object.create(i.prototype),s(i,o),o.from=function(e,t,r){if("number"==typeof e)throw TypeError("Argument must not be a number");return i(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return n.SlowBuffer(e)}},65880,(e,t,r)=>{"use strict";function n(e){return(e/8|0)+ +(e%8!=0)}var i={ES256:n(256),ES384:n(384),ES512:n(521)};t.exports=function(e){var t=i[e];if(t)return t;throw Error('Unknown algorithm "'+e+'"')}},32955,(e,t,r)=>{"use strict";var n=e.r(23469).Buffer,i=e.r(65880);function s(e){if(n.isBuffer(e))return e;if("string"==typeof e)return n.from(e,"base64");throw TypeError("ECDSA signature must be a Base64 string or a Buffer")}function o(e,t,r){for(var n=0;t+n<r&&0===e[t+n];)++n;return e[t+n]>=128&&--n,n}t.exports={derToJose:function(e,t){e=s(e);var r=i(t),o=r+1,a=e.length,l=0;if(48!==e[l++])throw Error('Could not find expected "seq"');var u=e[l++];if(129===u&&(u=e[l++]),a-l<u)throw Error('"seq" specified length of "'+u+'", only "'+(a-l)+'" remaining');if(2!==e[l++])throw Error('Could not find expected "int" for "r"');var c=e[l++];if(a-l-2<c)throw Error('"r" specified length of "'+c+'", only "'+(a-l-2)+'" available');if(o<c)throw Error('"r" specified length of "'+c+'", max of "'+o+'" is acceptable');var d=l;if(l+=c,2!==e[l++])throw Error('Could not find expected "int" for "s"');var h=e[l++];if(a-l!==h)throw Error('"s" specified length of "'+h+'", expected "'+(a-l)+'"');if(o<h)throw Error('"s" specified length of "'+h+'", max of "'+o+'" is acceptable');var p=l;if((l+=h)!==a)throw Error('Expected to consume entire buffer, but "'+(a-l)+'" bytes remain');var f=r-c,g=r-h,m=n.allocUnsafe(f+c+g+h);for(l=0;l<f;++l)m[l]=0;e.copy(m,l,d+Math.max(-f,0),d+c),l=r;for(var y=l;l<y+g;++l)m[l]=0;return e.copy(m,l,p+Math.max(-g,0),p+h),m=(m=m.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(e,t){e=s(e);var r=i(t),a=e.length;if(a!==2*r)throw TypeError('"'+t+'" signatures must be "'+2*r+'" bytes, saw "'+a+'"');var l=o(e,0,r),u=o(e,r,e.length),c=r-l,d=r-u,h=2+c+1+1+d,p=h<128,f=n.allocUnsafe((p?2:3)+h),g=0;return f[g++]=48,p?f[g++]=h:(f[g++]=129,f[g++]=255&h),f[g++]=2,f[g++]=c,l<0?(f[g++]=0,g+=e.copy(f,g,0,r)):g+=e.copy(f,g,l,r),f[g++]=2,f[g++]=d,u<0?(f[g++]=0,e.copy(f,g,r)):e.copy(f,g,r+u),f}}},15733,(e,t,r)=>{"use strict";var n,i,s,o,a=e.e&&e.e.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};function l(e){return e.replace(/([_][^_])/g,e=>e.slice(1).toUpperCase())}Object.defineProperty(r,"__esModule",{value:!0}),r.LRUCache=void 0,r.snakeToCamel=l,r.originalOrCamelOptions=function(e){return{get:function(t){var r;let n=e||{};return null!=(r=n[t])?r:n[l(t)]}}},r.LRUCache=class{constructor(e){n.add(this),i.set(this,new Map),this.capacity=e.capacity,this.maxAge=e.maxAge}set(e,t){a(this,n,"m",s).call(this,e,t),a(this,n,"m",o).call(this)}get(e){let t=a(this,i,"f").get(e);if(t)return a(this,n,"m",s).call(this,e,t.value),a(this,n,"m",o).call(this),t.value}},i=new WeakMap,n=new WeakSet,s=function(e,t){a(this,i,"f").delete(e),a(this,i,"f").set(e,{value:t,lastAccessed:Date.now()})},o=function(){let e=this.maxAge?Date.now()-this.maxAge:0,t=a(this,i,"f").entries().next();for(;!t.done&&(a(this,i,"f").size>this.capacity||t.value[1].lastAccessed<e);)a(this,i,"f").delete(t.value[0]),t=a(this,i,"f").entries().next()}},11656,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AuthClient=r.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=r.DEFAULT_UNIVERSE=void 0;let n=e.r(27699),i=e.r(66037),s=e.r(96299),o=e.r(15733);r.DEFAULT_UNIVERSE="googleapis.com",r.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=3e5;class a extends n.EventEmitter{constructor(e={}){var t,n,i,a,l;super(),this.credentials={},this.eagerRefreshThresholdMillis=r.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS,this.forceRefreshOnFailure=!1,this.universeDomain=r.DEFAULT_UNIVERSE;let u=(0,o.originalOrCamelOptions)(e);this.apiKey=e.apiKey,this.projectId=null!=(t=u.get("project_id"))?t:null,this.quotaProjectId=u.get("quota_project_id"),this.credentials=null!=(n=u.get("credentials"))?n:{},this.universeDomain=null!=(i=u.get("universe_domain"))?i:r.DEFAULT_UNIVERSE,this.transporter=null!=(a=e.transporter)?a:new s.DefaultTransporter,e.transporterOptions&&(this.transporter.defaults=e.transporterOptions),e.eagerRefreshThresholdMillis&&(this.eagerRefreshThresholdMillis=e.eagerRefreshThresholdMillis),this.forceRefreshOnFailure=null!=(l=e.forceRefreshOnFailure)&&l}get gaxios(){return this.transporter instanceof i.Gaxios?this.transporter:this.transporter instanceof s.DefaultTransporter||"instance"in this.transporter&&this.transporter.instance instanceof i.Gaxios?this.transporter.instance:null}setCredentials(e){this.credentials=e}addSharedMetadataHeaders(e){return!e["x-goog-user-project"]&&this.quotaProjectId&&(e["x-goog-user-project"]=this.quotaProjectId),e}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}r.AuthClient=a},42602,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LoginTicket=void 0,r.LoginTicket=class{constructor(e,t){this.envelope=e,this.payload=t}getEnvelope(){return this.envelope}getPayload(){return this.payload}getUserId(){let e=this.getPayload();return e&&e.sub?e.sub:null}getAttributes(){return{envelope:this.getEnvelope(),payload:this.getPayload()}}}},701,(e,t,r)=>{"use strict";var n,i,s;Object.defineProperty(r,"__esModule",{value:!0}),r.OAuth2Client=r.ClientAuthentication=r.CertificateFormat=r.CodeChallengeMethod=void 0;let o=e.r(66037),a=e.r(45706),l=e.r(88947),u=e.r(32955),c=e.r(1426),d=e.r(11656),h=e.r(42602);!function(e){e.Plain="plain",e.S256="S256"}(n||(r.CodeChallengeMethod=n={})),function(e){e.PEM="PEM",e.JWK="JWK"}(i||(r.CertificateFormat=i={})),function(e){e.ClientSecretPost="ClientSecretPost",e.ClientSecretBasic="ClientSecretBasic",e.None="None"}(s||(r.ClientAuthentication=s={}));class p extends d.AuthClient{constructor(e,t,r){let n=e&&"object"==typeof e?e:{clientId:e,clientSecret:t,redirectUri:r};super(n),this.certificateCache={},this.certificateExpiry=null,this.certificateCacheFormat=i.PEM,this.refreshTokenPromises=new Map,this._clientId=n.clientId,this._clientSecret=n.clientSecret,this.redirectUri=n.redirectUri,this.endpoints={tokenInfoUrl:"https://oauth2.googleapis.com/tokeninfo",oauth2AuthBaseUrl:"https://accounts.google.com/o/oauth2/v2/auth",oauth2TokenUrl:"https://oauth2.googleapis.com/token",oauth2RevokeUrl:"https://oauth2.googleapis.com/revoke",oauth2FederatedSignonPemCertsUrl:"https://www.googleapis.com/oauth2/v1/certs",oauth2FederatedSignonJwkCertsUrl:"https://www.googleapis.com/oauth2/v3/certs",oauth2IapPublicKeyUrl:"https://www.gstatic.com/iap/verify/public_key",...n.endpoints},this.clientAuthentication=n.clientAuthentication||s.ClientSecretPost,this.issuers=n.issuers||["accounts.google.com","https://accounts.google.com",this.universeDomain]}generateAuthUrl(e={}){if(e.code_challenge_method&&!e.code_challenge)throw Error("If a code_challenge_method is provided, code_challenge must be included.");return e.response_type=e.response_type||"code",e.client_id=e.client_id||this._clientId,e.redirect_uri=e.redirect_uri||this.redirectUri,Array.isArray(e.scope)&&(e.scope=e.scope.join(" ")),this.endpoints.oauth2AuthBaseUrl.toString()+"?"+a.stringify(e)}generateCodeVerifier(){throw Error("generateCodeVerifier is removed, please use generateCodeVerifierAsync instead.")}async generateCodeVerifierAsync(){let e=(0,c.createCrypto)(),t=e.randomBytesBase64(96).replace(/\+/g,"~").replace(/=/g,"_").replace(/\//g,"-"),r=(await e.sha256DigestBase64(t)).split("=")[0].replace(/\+/g,"-").replace(/\//g,"_");return{codeVerifier:t,codeChallenge:r}}getToken(e,t){let r="string"==typeof e?{code:e}:e;if(!t)return this.getTokenAsync(r);this.getTokenAsync(r).then(e=>t(null,e.tokens,e.res),e=>t(e,null,e.response))}async getTokenAsync(e){let t=this.endpoints.oauth2TokenUrl.toString(),r={"Content-Type":"application/x-www-form-urlencoded"},n={client_id:e.client_id||this._clientId,code_verifier:e.codeVerifier,code:e.code,grant_type:"authorization_code",redirect_uri:e.redirect_uri||this.redirectUri};if(this.clientAuthentication===s.ClientSecretBasic){let e=Buffer.from(`${this._clientId}:${this._clientSecret}`);r.Authorization=`Basic ${e.toString("base64")}`}this.clientAuthentication===s.ClientSecretPost&&(n.client_secret=this._clientSecret);let i=await this.transporter.request({...p.RETRY_CONFIG,method:"POST",url:t,data:a.stringify(n),headers:r}),o=i.data;return i.data&&i.data.expires_in&&(o.expiry_date=new Date().getTime()+1e3*i.data.expires_in,delete o.expires_in),this.emit("tokens",o),{tokens:o,res:i}}async refreshToken(e){if(!e)return this.refreshTokenNoCache(e);if(this.refreshTokenPromises.has(e))return this.refreshTokenPromises.get(e);let t=this.refreshTokenNoCache(e).then(t=>(this.refreshTokenPromises.delete(e),t),t=>{throw this.refreshTokenPromises.delete(e),t});return this.refreshTokenPromises.set(e,t),t}async refreshTokenNoCache(e){var t;let r;if(!e)throw Error("No refresh token is set.");let n=this.endpoints.oauth2TokenUrl.toString(),i={refresh_token:e,client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token"};try{r=await this.transporter.request({...p.RETRY_CONFIG,method:"POST",url:n,data:a.stringify(i),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}catch(e){throw e instanceof o.GaxiosError&&"invalid_grant"===e.message&&(null==(t=e.response)?void 0:t.data)&&/ReAuth/i.test(e.response.data.error_description)&&(e.message=JSON.stringify(e.response.data)),e}let s=r.data;return r.data&&r.data.expires_in&&(s.expiry_date=new Date().getTime()+1e3*r.data.expires_in,delete s.expires_in),this.emit("tokens",s),{tokens:s,res:r}}refreshAccessToken(e){if(!e)return this.refreshAccessTokenAsync();this.refreshAccessTokenAsync().then(t=>e(null,t.credentials,t.res),e)}async refreshAccessTokenAsync(){let e=await this.refreshToken(this.credentials.refresh_token),t=e.tokens;return t.refresh_token=this.credentials.refresh_token,this.credentials=t,{credentials:this.credentials,res:e.res}}getAccessToken(e){if(!e)return this.getAccessTokenAsync();this.getAccessTokenAsync().then(t=>e(null,t.token,t.res),e)}async getAccessTokenAsync(){if(!(!this.credentials.access_token||this.isTokenExpiring()))return{token:this.credentials.access_token};{if(!this.credentials.refresh_token)if(this.refreshHandler){let e=await this.processAndValidateRefreshHandler();if(null==e?void 0:e.access_token)return this.setCredentials(e),{token:this.credentials.access_token}}else throw Error("No refresh token or refresh handler callback is set.");let e=await this.refreshAccessTokenAsync();if(!e.credentials||e.credentials&&!e.credentials.access_token)throw Error("Could not refresh access token.");return{token:e.credentials.access_token,res:e.res}}}async getRequestHeaders(e){return(await this.getRequestMetadataAsync(e)).headers}async getRequestMetadataAsync(e){let t=this.credentials;if(!t.access_token&&!t.refresh_token&&!this.apiKey&&!this.refreshHandler)throw Error("No access, refresh token, API key or refresh handler callback is set.");if(t.access_token&&!this.isTokenExpiring()){t.token_type=t.token_type||"Bearer";let e={Authorization:t.token_type+" "+t.access_token};return{headers:this.addSharedMetadataHeaders(e)}}if(this.refreshHandler){let e=await this.processAndValidateRefreshHandler();if(null==e?void 0:e.access_token){this.setCredentials(e);let t={Authorization:"Bearer "+this.credentials.access_token};return{headers:this.addSharedMetadataHeaders(t)}}}if(this.apiKey)return{headers:{"X-Goog-Api-Key":this.apiKey}};let r=null,n=null;try{n=(r=await this.refreshToken(t.refresh_token)).tokens}catch(e){throw e.response&&(403===e.response.status||404===e.response.status)&&(e.message=`Could not refresh access token: ${e.message}`),e}let i=this.credentials;i.token_type=i.token_type||"Bearer",n.refresh_token=i.refresh_token,this.credentials=n;let s={Authorization:i.token_type+" "+n.access_token};return{headers:this.addSharedMetadataHeaders(s),res:r.res}}static getRevokeTokenUrl(e){return new p().getRevokeTokenURL(e).toString()}getRevokeTokenURL(e){let t=new URL(this.endpoints.oauth2RevokeUrl);return t.searchParams.append("token",e),t}revokeToken(e,t){let r={...p.RETRY_CONFIG,url:this.getRevokeTokenURL(e).toString(),method:"POST"};if(!t)return this.transporter.request(r);this.transporter.request(r).then(e=>t(null,e),t)}revokeCredentials(e){if(!e)return this.revokeCredentialsAsync();this.revokeCredentialsAsync().then(t=>e(null,t),e)}async revokeCredentialsAsync(){let e=this.credentials.access_token;if(this.credentials={},e)return this.revokeToken(e);throw Error("No access token to revoke.")}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}async requestAsync(e,t=!1){let r;try{let t=await this.getRequestMetadataAsync(e.url);e.headers=e.headers||{},t.headers&&t.headers["x-goog-user-project"]&&(e.headers["x-goog-user-project"]=t.headers["x-goog-user-project"]),t.headers&&t.headers.Authorization&&(e.headers.Authorization=t.headers.Authorization),this.apiKey&&(e.headers["X-Goog-Api-Key"]=this.apiKey),r=await this.transporter.request(e)}catch(n){let r=n.response;if(r){let n=r.status,i=this.credentials&&this.credentials.access_token&&this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure),s=this.credentials&&this.credentials.access_token&&!this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure)&&this.refreshHandler,o=r.config.data instanceof l.Readable,a=401===n||403===n;if(!t&&a&&!o&&i)return await this.refreshAccessTokenAsync(),this.requestAsync(e,!0);if(!t&&a&&!o&&s){let t=await this.processAndValidateRefreshHandler();return(null==t?void 0:t.access_token)&&this.setCredentials(t),this.requestAsync(e,!0)}}throw n}return r}verifyIdToken(e,t){if(t&&"function"!=typeof t)throw Error("This method accepts an options object as the first parameter, which includes the idToken, audience, and maxExpiry.");if(!t)return this.verifyIdTokenAsync(e);this.verifyIdTokenAsync(e).then(e=>t(null,e),t)}async verifyIdTokenAsync(e){if(!e.idToken)throw Error("The verifyIdToken method requires an ID Token");let t=await this.getFederatedSignonCertsAsync();return await this.verifySignedJwtWithCertsAsync(e.idToken,t.certs,e.audience,this.issuers,e.maxExpiry)}async getTokenInfo(e){let{data:t}=await this.transporter.request({...p.RETRY_CONFIG,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${e}`},url:this.endpoints.tokenInfoUrl.toString()}),r=Object.assign({expiry_date:new Date().getTime()+1e3*t.expires_in,scopes:t.scope.split(" ")},t);return delete r.expires_in,delete r.scope,r}getFederatedSignonCerts(e){if(!e)return this.getFederatedSignonCertsAsync();this.getFederatedSignonCertsAsync().then(t=>e(null,t.certs,t.res),e)}async getFederatedSignonCertsAsync(){let e,t,r=new Date().getTime(),n=(0,c.hasBrowserCrypto)()?i.JWK:i.PEM;if(this.certificateExpiry&&r<this.certificateExpiry.getTime()&&this.certificateCacheFormat===n)return{certs:this.certificateCache,format:n};switch(n){case i.PEM:t=this.endpoints.oauth2FederatedSignonPemCertsUrl.toString();break;case i.JWK:t=this.endpoints.oauth2FederatedSignonJwkCertsUrl.toString();break;default:throw Error(`Unsupported certificate format ${n}`)}try{e=await this.transporter.request({...p.RETRY_CONFIG,url:t})}catch(e){throw e instanceof Error&&(e.message=`Failed to retrieve verification certificates: ${e.message}`),e}let s=e?e.headers["cache-control"]:void 0,o=-1;if(s){let e=RegExp("max-age=([0-9]*)").exec(s);e&&2===e.length&&(o=1e3*Number(e[1]))}let a={};switch(n){case i.PEM:a=e.data;break;case i.JWK:for(let t of e.data.keys)a[t.kid]=t;break;default:throw Error(`Unsupported certificate format ${n}`)}let l=new Date;return this.certificateExpiry=-1===o?null:new Date(l.getTime()+o),this.certificateCache=a,this.certificateCacheFormat=n,{certs:a,format:n,res:e}}getIapPublicKeys(e){if(!e)return this.getIapPublicKeysAsync();this.getIapPublicKeysAsync().then(t=>e(null,t.pubkeys,t.res),e)}async getIapPublicKeysAsync(){let e,t=this.endpoints.oauth2IapPublicKeyUrl.toString();try{e=await this.transporter.request({...p.RETRY_CONFIG,url:t})}catch(e){throw e instanceof Error&&(e.message=`Failed to retrieve verification certificates: ${e.message}`),e}return{pubkeys:e.data,res:e}}verifySignedJwtWithCerts(){throw Error("verifySignedJwtWithCerts is removed, please use verifySignedJwtWithCertsAsync instead.")}async verifySignedJwtWithCertsAsync(e,t,r,n,i){let s,o,a=(0,c.createCrypto)();i||(i=p.DEFAULT_MAX_TOKEN_LIFETIME_SECS_);let l=e.split(".");if(3!==l.length)throw Error("Wrong number of segments in token: "+e);let d=l[0]+"."+l[1],f=l[2];try{s=JSON.parse(a.decodeBase64StringUtf8(l[0]))}catch(e){throw e instanceof Error&&(e.message=`Can't parse token envelope: ${l[0]}': ${e.message}`),e}if(!s)throw Error("Can't parse token envelope: "+l[0]);try{o=JSON.parse(a.decodeBase64StringUtf8(l[1]))}catch(e){throw e instanceof Error&&(e.message=`Can't parse token payload '${l[0]}`),e}if(!o)throw Error("Can't parse token payload: "+l[1]);if(!Object.prototype.hasOwnProperty.call(t,s.kid))throw Error("No pem found for envelope: "+JSON.stringify(s));let g=t[s.kid];if("ES256"===s.alg&&(f=u.joseToDer(f,"ES256").toString("base64")),!await a.verify(g,d,f))throw Error("Invalid token signature: "+e);if(!o.iat)throw Error("No issue time in token: "+JSON.stringify(o));if(!o.exp)throw Error("No expiration time in token: "+JSON.stringify(o));let m=Number(o.iat);if(isNaN(m))throw Error("iat field using invalid format");let y=Number(o.exp);if(isNaN(y))throw Error("exp field using invalid format");let v=new Date().getTime()/1e3;if(y>=v+i)throw Error("Expiration time too far in future: "+JSON.stringify(o));let _=m-p.CLOCK_SKEW_SECS_,b=y+p.CLOCK_SKEW_SECS_;if(v<_)throw Error("Token used too early, "+v+" < "+_+": "+JSON.stringify(o));if(v>b)throw Error("Token used too late, "+v+" > "+b+": "+JSON.stringify(o));if(n&&0>n.indexOf(o.iss))throw Error("Invalid issuer, expected one of ["+n+"], but got "+o.iss);if(null!=r){let e=o.aud;if(!(r.constructor===Array?r.indexOf(e)>-1:e===r))throw Error("Wrong recipient, payload audience != requiredAudience")}return new h.LoginTicket(s,o)}async processAndValidateRefreshHandler(){if(this.refreshHandler){let e=await this.refreshHandler();if(!e.access_token)throw Error("No access token is returned by the refreshHandler callback.");return e}}isTokenExpiring(){let e=this.credentials.expiry_date;return!!e&&e<=new Date().getTime()+this.eagerRefreshThresholdMillis}}r.OAuth2Client=p,p.GOOGLE_TOKEN_INFO_URL="https://oauth2.googleapis.com/tokeninfo",p.CLOCK_SKEW_SECS_=300,p.DEFAULT_MAX_TOKEN_LIFETIME_SECS_=86400},70814,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Compute=void 0;let n=e.r(66037),i=e.r(82e3),s=e.r(701);class o extends s.OAuth2Client{constructor(e={}){super(e),this.credentials={expiry_date:1,refresh_token:"compute-placeholder"},this.serviceAccountEmail=e.serviceAccountEmail||"default",this.scopes=Array.isArray(e.scopes)?e.scopes:e.scopes?[e.scopes]:[]}async refreshTokenNoCache(e){let t,r=`service-accounts/${this.serviceAccountEmail}/token`;try{let e={property:r};this.scopes.length>0&&(e.params={scopes:this.scopes.join(",")}),t=await i.instance(e)}catch(e){throw e instanceof n.GaxiosError&&(e.message=`Could not refresh access token: ${e.message}`,this.wrapError(e)),e}let s=t;return t&&t.expires_in&&(s.expiry_date=new Date().getTime()+1e3*t.expires_in,delete s.expires_in),this.emit("tokens",s),{tokens:s,res:null}}async fetchIdToken(e){let t,r=`service-accounts/${this.serviceAccountEmail}/identity?format=full&audience=${e}`;try{t=await i.instance({property:r})}catch(e){throw e instanceof Error&&(e.message=`Could not fetch ID token: ${e.message}`),e}return t}wrapError(e){let t=e.response;t&&t.status&&(e.status=t.status,403===t.status?e.message="A Forbidden error was returned while attempting to retrieve an access token for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have the correct permission scopes specified: "+e.message:404===t.status&&(e.message="A Not Found error was returned while attempting to retrieve an accesstoken for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have any permission scopes specified: "+e.message))}}r.Compute=o},80732,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.IdTokenClient=void 0;let n=e.r(701);class i extends n.OAuth2Client{constructor(e){super(e),this.targetAudience=e.targetAudience,this.idTokenProvider=e.idTokenProvider}async getRequestMetadataAsync(e){if(!this.credentials.id_token||!this.credentials.expiry_date||this.isTokenExpiring()){let e=await this.idTokenProvider.fetchIdToken(this.targetAudience);this.credentials={id_token:e,expiry_date:this.getIdTokenExpiryDate(e)}}return{headers:{Authorization:"Bearer "+this.credentials.id_token}}}getIdTokenExpiryDate(e){let t=e.split(".")[1];if(t)return 1e3*JSON.parse(Buffer.from(t,"base64").toString("ascii")).exp}}r.IdTokenClient=i},80243,(e,t,r)=>{"use strict";var n;let i;Object.defineProperty(r,"__esModule",{value:!0}),r.GCPEnv=void 0,r.clear=function(){i=void 0},r.getEnv=o;let s=e.r(82e3);async function o(){return i||(i=a())}async function a(){n.NONE;return process.env.GAE_SERVICE||process.env.GAE_MODULE_NAME?n.APP_ENGINE:process.env.FUNCTION_NAME||process.env.FUNCTION_TARGET?n.CLOUD_FUNCTIONS:await u()?await l()?n.KUBERNETES_ENGINE:process.env.K_CONFIGURATION?n.CLOUD_RUN:n.COMPUTE_ENGINE:n.NONE}async function l(){try{return await s.instance("attributes/cluster-name"),!0}catch(e){return!1}}async function u(){return s.isAvailable()}!function(e){e.APP_ENGINE="APP_ENGINE",e.KUBERNETES_ENGINE="KUBERNETES_ENGINE",e.CLOUD_FUNCTIONS="CLOUD_FUNCTIONS",e.COMPUTE_ENGINE="COMPUTE_ENGINE",e.CLOUD_RUN="CLOUD_RUN",e.NONE="NONE"}(n||(r.GCPEnv=n={}))},41949,(e,t,r)=>{var n=e.r(23469).Buffer,i=e.r(88947);function s(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=n.alloc(0),this;if("function"==typeof e.pipe)return this.buffer=n.alloc(0),e.pipe(this),this;if(e.length||"object"==typeof e)return this.buffer=e,this.writable=!1,process.nextTick((function(){this.emit("end",e),this.readable=!1,this.emit("close")}).bind(this)),this;throw TypeError("Unexpected data type ("+typeof e+")")}e.r(24361).inherits(s,i),s.prototype.write=function(e){this.buffer=n.concat([this.buffer,n.from(e)]),this.emit("data",e)},s.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1},t.exports=s},22691,(e,t,r)=>{"use strict";var n=e.r(874).Buffer,i=e.r(874).SlowBuffer;function s(e,t){if(!n.isBuffer(e)||!n.isBuffer(t)||e.length!==t.length)return!1;for(var r=0,i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}t.exports=s,s.install=function(){n.prototype.equal=i.prototype.equal=function(e){return s(this,e)}};var o=n.prototype.equal,a=i.prototype.equal;s.restore=function(){n.prototype.equal=o,i.prototype.equal=a}},57067,(e,t,r)=>{var n,i=e.r(23469).Buffer,s=e.r(54799),o=e.r(32955),a=e.r(24361),l="secret must be a string or buffer",u="key must be a string or a buffer",c="function"==typeof s.createPublicKey;function d(e){if(!i.isBuffer(e)&&"string"!=typeof e&&(!c||"object"!=typeof e||"string"!=typeof e.type||"string"!=typeof e.asymmetricKeyType||"function"!=typeof e.export))throw g(u)}function h(e){if(!i.isBuffer(e)&&"string"!=typeof e&&"object"!=typeof e)throw g("key must be a string, a buffer or an object")}function p(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function f(e){var t=4-(e=e.toString()).length%4;if(4!==t)for(var r=0;r<t;++r)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function g(e){var t=[].slice.call(arguments,1);return TypeError(a.format.bind(a,e).apply(null,t))}function m(e){var t;return t=e,i.isBuffer(t)||"string"==typeof t||(e=JSON.stringify(e)),e}function y(e){return function(t,r){!function(e){if(!i.isBuffer(e)){if("string"!=typeof e){if(!c||"object"!=typeof e||"secret"!==e.type||"function"!=typeof e.export)throw g(l)}}}(r),t=m(t);var n=s.createHmac("sha"+e,r);return p((n.update(t),n.digest("base64")))}}c&&(u+=" or a KeyObject",l+="or a KeyObject");var v="timingSafeEqual"in s?function(e,t){return e.byteLength===t.byteLength&&s.timingSafeEqual(e,t)}:function(t,r){return n||(n=e.r(22691)),n(t,r)};function _(e){return function(t,r,n){var s=y(e)(t,n);return v(i.from(r),i.from(s))}}function b(e){return function(t,r){h(r),t=m(t);var n=s.createSign("RSA-SHA"+e);return p((n.update(t),n.sign(r,"base64")))}}function E(e){return function(t,r,n){d(n),t=m(t),r=f(r);var i=s.createVerify("RSA-SHA"+e);return i.update(t),i.verify(n,r,"base64")}}function S(e){return function(t,r){h(r),t=m(t);var n=s.createSign("RSA-SHA"+e);return p((n.update(t),n.sign({key:r,padding:s.constants.RSA_PKCS1_PSS_PADDING,saltLength:s.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function w(e){return function(t,r,n){d(n),t=m(t),r=f(r);var i=s.createVerify("RSA-SHA"+e);return i.update(t),i.verify({key:n,padding:s.constants.RSA_PKCS1_PSS_PADDING,saltLength:s.constants.RSA_PSS_SALTLEN_DIGEST},r,"base64")}}function T(e){var t=b(e);return function(){var r=t.apply(null,arguments);return o.derToJose(r,"ES"+e)}}function C(e){var t=E(e);return function(r,n,i){return t(r,n=o.joseToDer(n,"ES"+e).toString("base64"),i)}}function A(){return function(){return""}}function O(){return function(e,t){return""===t}}t.exports=function(e){var t=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/);if(!t)throw g('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',e);var r=(t[1]||t[3]).toLowerCase(),n=t[2];return{sign:({hs:y,rs:b,ps:S,es:T,none:A})[r](n),verify:({hs:_,rs:E,ps:w,es:C,none:O})[r](n)}}},76872,(e,t,r)=>{var n=e.r(874).Buffer;t.exports=function(e){return"string"==typeof e?e:"number"==typeof e||n.isBuffer(e)?e.toString():JSON.stringify(e)}},14743,(e,t,r)=>{var n=e.r(23469).Buffer,i=e.r(41949),s=e.r(57067),o=e.r(88947),a=e.r(76872),l=e.r(24361);function u(e,t){return n.from(e,t).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function c(e){var t,r,n,i=e.header,o=e.payload,c=e.secret||e.privateKey,d=e.encoding,h=s(i.alg),p=(t=(t=d)||"utf8",r=u(a(i),"binary"),n=u(a(o),t),l.format("%s.%s",r,n)),f=h.sign(p,c);return l.format("%s.%s",p,f)}function d(e){var t=new i(e.secret||e.privateKey||e.key);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=t,this.payload=new i(e.payload),this.secret.once("close",(function(){!this.payload.writable&&this.readable&&this.sign()}).bind(this)),this.payload.once("close",(function(){!this.secret.writable&&this.readable&&this.sign()}).bind(this))}l.inherits(d,o),d.prototype.sign=function(){try{var e=c({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},d.sign=c,t.exports=d},48233,(e,t,r)=>{var n=e.r(23469).Buffer,i=e.r(41949),s=e.r(57067),o=e.r(88947),a=e.r(76872),l=e.r(24361),u=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function c(e){var t=e.split(".",1)[0],r=n.from(t,"base64").toString("binary");if("[object Object]"===Object.prototype.toString.call(r))return r;try{return JSON.parse(r)}catch(e){return}}function d(e){return e.split(".")[2]}function h(e){return u.test(e)&&!!c(e)}function p(e,t,r){if(!t){var n=Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}var i=d(e=a(e)),o=e.split(".",2).join(".");return s(t).verify(o,i,r)}function f(e,t){if(t=t||{},!h(e=a(e)))return null;var r,i,s=c(e);if(!s)return null;var o=(r=r||"utf8",i=e.split(".")[1],n.from(i,"base64").toString(r));return("JWT"===s.typ||t.json)&&(o=JSON.parse(o,t.encoding)),{header:s,payload:o,signature:d(e)}}function g(e){var t=new i((e=e||{}).secret||e.publicKey||e.key);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=t,this.signature=new i(e.signature),this.secret.once("close",(function(){!this.signature.writable&&this.readable&&this.verify()}).bind(this)),this.signature.once("close",(function(){!this.secret.writable&&this.readable&&this.verify()}).bind(this))}l.inherits(g,o),g.prototype.verify=function(){try{var e=p(this.signature.buffer,this.algorithm,this.key.buffer),t=f(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},g.decode=f,g.isValid=h,g.verify=p,t.exports=g},58184,(e,t,r)=>{var n=e.r(14743),i=e.r(48233);r.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],r.sign=n.sign,r.verify=i.verify,r.decode=i.decode,r.isValid=i.isValid,r.createSign=function(e){return new n(e)},r.createVerify=function(e){return new i(e)}},3618,(e,t,r)=>{"use strict";var n,i,s,o,a,l,u,c,d=e.e&&e.e.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},h=e.e&&e.e.__classPrivateFieldSet||function(e,t,r,n,i){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r};Object.defineProperty(r,"__esModule",{value:!0}),r.GoogleToken=void 0;let p=e.r(22734),f=e.r(66037),g=e.r(58184),m=e.r(14747),y=(0,e.r(24361).promisify)(p.readFile),v="https://www.googleapis.com/oauth2/v4/token";class _ extends Error{constructor(e,t){super(e),this.code=t}}r.GoogleToken=class{get accessToken(){return this.rawToken?this.rawToken.access_token:void 0}get idToken(){return this.rawToken?this.rawToken.id_token:void 0}get tokenType(){return this.rawToken?this.rawToken.token_type:void 0}get refreshToken(){return this.rawToken?this.rawToken.refresh_token:void 0}constructor(e){n.add(this),this.transporter={request:e=>(0,f.request)(e)},i.set(this,void 0),d(this,n,"m",u).call(this,e)}hasExpired(){let e=new Date().getTime();return!this.rawToken||!this.expiresAt||e>=this.expiresAt}isTokenExpiring(){var e;let t=new Date().getTime(),r=null!=(e=this.eagerRefreshThresholdMillis)?e:0;return!this.rawToken||!this.expiresAt||this.expiresAt<=t+r}getToken(e,t={}){if("object"==typeof e&&(t=e,e=void 0),t=Object.assign({forceRefresh:!1},t),e){let r=e;d(this,n,"m",s).call(this,t).then(e=>r(null,e),e);return}return d(this,n,"m",s).call(this,t)}async getCredentials(e){switch(m.extname(e)){case".json":{let t=JSON.parse(await y(e,"utf8")),r=t.private_key,n=t.client_email;if(!r||!n)throw new _("private_key and client_email are required.","MISSING_CREDENTIALS");return{privateKey:r,clientEmail:n}}case".der":case".crt":case".pem":return{privateKey:await y(e,"utf8")};case".p12":case".pfx":throw new _("*.p12 certificates are not supported after v6.1.2. Consider utilizing *.json format or converting *.p12 to *.pem using the OpenSSL CLI.","UNKNOWN_CERTIFICATE_TYPE");default:throw new _("Unknown certificate type. Type is determined based on file extension. Current supported extensions are *.json, and *.pem.","UNKNOWN_CERTIFICATE_TYPE")}}revokeToken(e){return e?void d(this,n,"m",l).call(this).then(()=>e(),e):d(this,n,"m",l).call(this)}},i=new WeakMap,n=new WeakSet,s=async function(e){if(d(this,i,"f")&&!e.forceRefresh)return d(this,i,"f");try{return await h(this,i,d(this,n,"m",o).call(this,e),"f")}finally{h(this,i,void 0,"f")}},o=async function(e){if(!1===this.isTokenExpiring()&&!1===e.forceRefresh)return Promise.resolve(this.rawToken);if(!this.key&&!this.keyFile)throw Error("No key or keyFile set.");if(!this.key&&this.keyFile){let e=await this.getCredentials(this.keyFile);this.key=e.privateKey,this.iss=e.clientEmail||this.iss,e.clientEmail||d(this,n,"m",a).call(this)}return d(this,n,"m",c).call(this)},a=function(){if(!this.iss)throw new _("email is required.","MISSING_CREDENTIALS")},l=async function(){if(!this.accessToken)throw Error("No token to revoke.");let e="https://accounts.google.com/o/oauth2/revoke?token="+this.accessToken;await this.transporter.request({url:e,retry:!0}),d(this,n,"m",u).call(this,{email:this.iss,sub:this.sub,key:this.key,keyFile:this.keyFile,scope:this.scope,additionalClaims:this.additionalClaims})},u=function(e={}){this.keyFile=e.keyFile,this.key=e.key,this.rawToken=void 0,this.iss=e.email||e.iss,this.sub=e.sub,this.additionalClaims=e.additionalClaims,"object"==typeof e.scope?this.scope=e.scope.join(" "):this.scope=e.scope,this.eagerRefreshThresholdMillis=e.eagerRefreshThresholdMillis,e.transporter&&(this.transporter=e.transporter)},c=async function(){var e,t;let r=Math.floor(new Date().getTime()/1e3),n=this.additionalClaims||{},i=Object.assign({iss:this.iss,scope:this.scope,aud:v,exp:r+3600,iat:r,sub:this.sub},n),s=g.sign({header:{alg:"RS256"},payload:i,secret:this.key});try{let e=await this.transporter.request({method:"POST",url:v,data:{grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:s},headers:{"Content-Type":"application/x-www-form-urlencoded"},responseType:"json",retryConfig:{httpMethodsToRetry:["POST"]}});return this.rawToken=e.data,this.expiresAt=null===e.data.expires_in||void 0===e.data.expires_in?void 0:(r+e.data.expires_in)*1e3,this.rawToken}catch(n){this.rawToken=void 0,this.tokenExpires=void 0;let r=n.response&&(null==(e=n.response)?void 0:e.data)?null==(t=n.response)?void 0:t.data:{};if(r.error){let e=r.error_description?`: ${r.error_description}`:"";n.message=`${r.error}${e}`}throw n}}},10247,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.JWTAccess=void 0;let n=e.r(58184),i=e.r(15733),s={alg:"RS256",typ:"JWT"};class o{constructor(e,t,r,n){this.cache=new i.LRUCache({capacity:500,maxAge:36e5}),this.email=e,this.key=t,this.keyId=r,this.eagerRefreshThresholdMillis=null!=n?n:3e5}getCachedKey(e,t){let r=e;if(t&&Array.isArray(t)&&t.length?r=e?`${e}_${t.join("_")}`:`${t.join("_")}`:"string"==typeof t&&(r=e?`${e}_${t}`:t),!r)throw Error("Scopes or url must be provided");return r}getRequestHeaders(e,t,r){let i,a=this.getCachedKey(e,r),l=this.cache.get(a),u=Date.now();if(l&&l.expiration-u>this.eagerRefreshThresholdMillis)return l.headers;let c=Math.floor(Date.now()/1e3),d=o.getExpirationTime(c);if(Array.isArray(r)&&(r=r.join(" ")),i=r?{iss:this.email,sub:this.email,scope:r,exp:d,iat:c}:{iss:this.email,sub:this.email,aud:e,exp:d,iat:c},t){for(let e in i)if(t[e])throw Error(`The '${e}' property is not allowed when passing additionalClaims. This claim is included in the JWT by default.`)}let h=this.keyId?{...s,kid:this.keyId}:s,p=Object.assign(i,t),f=n.sign({header:h,payload:p,secret:this.key}),g={Authorization:`Bearer ${f}`};return this.cache.set(a,{expiration:1e3*d,headers:g}),g}static getExpirationTime(e){return e+3600}fromJSON(e){if(!e)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!e.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!e.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=e.client_email,this.key=e.private_key,this.keyId=e.private_key_id,this.projectId=e.project_id}fromStream(e,t){if(!t)return this.fromStreamAsync(e);this.fromStreamAsync(e).then(()=>t(),t)}fromStreamAsync(e){return new Promise((t,r)=>{e||r(Error("Must pass in a stream containing the service account auth settings."));let n="";e.setEncoding("utf8").on("data",e=>n+=e).on("error",r).on("end",()=>{try{let e=JSON.parse(n);this.fromJSON(e),t()}catch(e){r(e)}})})}}r.JWTAccess=o},24553,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.JWT=void 0;let n=e.r(3618),i=e.r(10247),s=e.r(701),o=e.r(11656);class a extends s.OAuth2Client{constructor(e,t,r,n,i,s){let o=e&&"object"==typeof e?e:{email:e,keyFile:t,key:r,keyId:s,scopes:n,subject:i};super(o),this.email=o.email,this.keyFile=o.keyFile,this.key=o.key,this.keyId=o.keyId,this.scopes=o.scopes,this.subject=o.subject,this.additionalClaims=o.additionalClaims,this.credentials={refresh_token:"jwt-placeholder",expiry_date:1}}createScoped(e){let t=new a(this);return t.scopes=e,t}async getRequestMetadataAsync(e){e=this.defaultServicePath?`https://${this.defaultServicePath}/`:e;let t=!this.hasUserScopes()&&e||this.useJWTAccessWithScope&&this.hasAnyScopes()||this.universeDomain!==o.DEFAULT_UNIVERSE;if(this.subject&&this.universeDomain!==o.DEFAULT_UNIVERSE)throw RangeError(`Service Account user is configured for the credential. Domain-wide delegation is not supported in universes other than ${o.DEFAULT_UNIVERSE}`);if(!this.apiKey&&t)if(this.additionalClaims&&this.additionalClaims.target_audience){let{tokens:e}=await this.refreshToken();return{headers:this.addSharedMetadataHeaders({Authorization:`Bearer ${e.id_token}`})}}else{let t;this.access||(this.access=new i.JWTAccess(this.email,this.key,this.keyId,this.eagerRefreshThresholdMillis)),this.hasUserScopes()?t=this.scopes:e||(t=this.defaultScopes);let r=this.useJWTAccessWithScope||this.universeDomain!==o.DEFAULT_UNIVERSE,n=await this.access.getRequestHeaders(null!=e?e:void 0,this.additionalClaims,r?t:void 0);return{headers:this.addSharedMetadataHeaders(n)}}return this.hasAnyScopes()||this.apiKey?super.getRequestMetadataAsync(e):{headers:{}}}async fetchIdToken(e){let t=new n.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:{target_audience:e},transporter:this.transporter});if(await t.getToken({forceRefresh:!0}),!t.idToken)throw Error("Unknown error: Failed to fetch ID token");return t.idToken}hasUserScopes(){return!!this.scopes&&this.scopes.length>0}hasAnyScopes(){return!!this.scopes&&!!(this.scopes.length>0)||!!this.defaultScopes&&!!(this.defaultScopes.length>0)}authorize(e){if(!e)return this.authorizeAsync();this.authorizeAsync().then(t=>e(null,t),e)}async authorizeAsync(){let e=await this.refreshToken();if(!e)throw Error("No result returned");return this.credentials=e.tokens,this.credentials.refresh_token="jwt-placeholder",this.key=this.gtoken.key,this.email=this.gtoken.iss,e.tokens}async refreshTokenNoCache(e){let t=this.createGToken(),r={access_token:(await t.getToken({forceRefresh:this.isTokenExpiring()})).access_token,token_type:"Bearer",expiry_date:t.expiresAt,id_token:t.idToken};return this.emit("tokens",r),{res:null,tokens:r}}createGToken(){return this.gtoken||(this.gtoken=new n.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:this.additionalClaims,transporter:this.transporter})),this.gtoken}fromJSON(e){if(!e)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!e.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!e.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=e.client_email,this.key=e.private_key,this.keyId=e.private_key_id,this.projectId=e.project_id,this.quotaProjectId=e.quota_project_id,this.universeDomain=e.universe_domain||this.universeDomain}fromStream(e,t){if(!t)return this.fromStreamAsync(e);this.fromStreamAsync(e).then(()=>t(),t)}fromStreamAsync(e){return new Promise((t,r)=>{if(!e)throw Error("Must pass in a stream containing the service account auth settings.");let n="";e.setEncoding("utf8").on("error",r).on("data",e=>n+=e).on("end",()=>{try{let e=JSON.parse(n);this.fromJSON(e),t()}catch(e){r(e)}})})}fromAPIKey(e){if("string"!=typeof e)throw Error("Must provide an API Key string.");this.apiKey=e}async getCredentials(){if(this.key)return{private_key:this.key,client_email:this.email};if(this.keyFile){let e=this.createGToken(),t=await e.getCredentials(this.keyFile);return{private_key:t.privateKey,client_email:t.clientEmail}}throw Error("A key or a keyFile must be provided to getCredentials.")}}r.JWT=a},16260,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.UserRefreshClient=r.USER_REFRESH_ACCOUNT_TYPE=void 0;let n=e.r(701),i=e.r(45706);r.USER_REFRESH_ACCOUNT_TYPE="authorized_user";class s extends n.OAuth2Client{constructor(e,t,r,n,i){let s=e&&"object"==typeof e?e:{clientId:e,clientSecret:t,refreshToken:r,eagerRefreshThresholdMillis:n,forceRefreshOnFailure:i};super(s),this._refreshToken=s.refreshToken,this.credentials.refresh_token=s.refreshToken}async refreshTokenNoCache(e){return super.refreshTokenNoCache(this._refreshToken)}async fetchIdToken(e){return(await this.transporter.request({...s.RETRY_CONFIG,url:this.endpoints.oauth2TokenUrl,headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",data:(0,i.stringify)({client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token",refresh_token:this._refreshToken,target_audience:e})})).data.id_token}fromJSON(e){if(!e)throw Error("Must pass in a JSON object containing the user refresh token");if("authorized_user"!==e.type)throw Error('The incoming JSON object does not have the "authorized_user" type');if(!e.client_id)throw Error("The incoming JSON object does not contain a client_id field");if(!e.client_secret)throw Error("The incoming JSON object does not contain a client_secret field");if(!e.refresh_token)throw Error("The incoming JSON object does not contain a refresh_token field");this._clientId=e.client_id,this._clientSecret=e.client_secret,this._refreshToken=e.refresh_token,this.credentials.refresh_token=e.refresh_token,this.quotaProjectId=e.quota_project_id,this.universeDomain=e.universe_domain||this.universeDomain}fromStream(e,t){if(!t)return this.fromStreamAsync(e);this.fromStreamAsync(e).then(()=>t(),t)}async fromStreamAsync(e){return new Promise((t,r)=>{if(!e)return r(Error("Must pass in a stream containing the user refresh token."));let n="";e.setEncoding("utf8").on("error",r).on("data",e=>n+=e).on("end",()=>{try{let e=JSON.parse(n);return this.fromJSON(e),t()}catch(e){return r(e)}})})}static fromJSON(e){let t=new s;return t.fromJSON(e),t}}r.UserRefreshClient=s},36126,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Impersonated=r.IMPERSONATED_ACCOUNT_TYPE=void 0;let n=e.r(701),i=e.r(66037),s=e.r(15733);r.IMPERSONATED_ACCOUNT_TYPE="impersonated_service_account";class o extends n.OAuth2Client{constructor(e={}){var t,r,i,o,a,l;if(super(e),this.credentials={expiry_date:1,refresh_token:"impersonated-placeholder"},this.sourceClient=null!=(t=e.sourceClient)?t:new n.OAuth2Client,this.targetPrincipal=null!=(r=e.targetPrincipal)?r:"",this.delegates=null!=(i=e.delegates)?i:[],this.targetScopes=null!=(o=e.targetScopes)?o:[],this.lifetime=null!=(a=e.lifetime)?a:3600,(0,s.originalOrCamelOptions)(e).get("universe_domain")){if(this.sourceClient.universeDomain!==this.universeDomain)throw RangeError(`Universe domain ${this.sourceClient.universeDomain} in source credentials does not match ${this.universeDomain} universe domain set for impersonated credentials.`)}else this.universeDomain=this.sourceClient.universeDomain;this.endpoint=null!=(l=e.endpoint)?l:`https://iamcredentials.${this.universeDomain}`}async sign(e){await this.sourceClient.getAccessToken();let t=`projects/-/serviceAccounts/${this.targetPrincipal}`,r=`${this.endpoint}/v1/${t}:signBlob`,n={delegates:this.delegates,payload:Buffer.from(e).toString("base64")};return(await this.sourceClient.request({...o.RETRY_CONFIG,url:r,data:n,method:"POST"})).data}getTargetPrincipal(){return this.targetPrincipal}async refreshToken(){var e,t,r,n,s,a;try{await this.sourceClient.getAccessToken();let e="projects/-/serviceAccounts/"+this.targetPrincipal,t=`${this.endpoint}/v1/${e}:generateAccessToken`,r={delegates:this.delegates,scope:this.targetScopes,lifetime:this.lifetime+"s"},n=await this.sourceClient.request({...o.RETRY_CONFIG,url:t,data:r,method:"POST"}),i=n.data;return this.credentials.access_token=i.accessToken,this.credentials.expiry_date=Date.parse(i.expireTime),{tokens:this.credentials,res:n}}catch(u){if(!(u instanceof Error))throw u;let o=0,l="";if(u instanceof i.GaxiosError&&(o=null==(r=null==(t=null==(e=null==u?void 0:u.response)?void 0:e.data)?void 0:t.error)?void 0:r.status,l=null==(a=null==(s=null==(n=null==u?void 0:u.response)?void 0:n.data)?void 0:s.error)?void 0:a.message),o&&l)throw u.message=`${o}: unable to impersonate: ${l}`,u;throw u.message=`unable to impersonate: ${u}`,u}}async fetchIdToken(e,t){var r,n;await this.sourceClient.getAccessToken();let i=`projects/-/serviceAccounts/${this.targetPrincipal}`,s=`${this.endpoint}/v1/${i}:generateIdToken`,a={delegates:this.delegates,audience:e,includeEmail:null==(r=null==t?void 0:t.includeEmail)||r,useEmailAzp:null==(n=null==t?void 0:t.includeEmail)||n};return(await this.sourceClient.request({...o.RETRY_CONFIG,url:s,data:a,method:"POST"})).data.token}}r.Impersonated=o},46944,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.OAuthClientAuthHandler=void 0,r.getErrorFromOAuthErrorResponse=function(e,t){let r=e.error,n=e.error_description,i=e.error_uri,s=`Error code ${r}`;void 0!==n&&(s+=`: ${n}`),void 0!==i&&(s+=` - ${i}`);let o=Error(s);if(t){let e=Object.keys(t);t.stack&&e.push("stack"),e.forEach(e=>{"message"!==e&&Object.defineProperty(o,e,{value:t[e],writable:!1,enumerable:!0})})}return o};let n=e.r(45706),i=e.r(1426),s=["PUT","POST","PATCH"];r.OAuthClientAuthHandler=class{constructor(e){this.clientAuthentication=e,this.crypto=(0,i.createCrypto)()}applyClientAuthenticationOptions(e,t){this.injectAuthenticatedHeaders(e,t),t||this.injectAuthenticatedRequestBody(e)}injectAuthenticatedHeaders(e,t){var r;if(t)e.headers=e.headers||{},Object.assign(e.headers,{Authorization:`Bearer ${t}}`});else if((null==(r=this.clientAuthentication)?void 0:r.confidentialClientType)==="basic"){e.headers=e.headers||{};let t=this.clientAuthentication.clientId,r=this.clientAuthentication.clientSecret||"",n=this.crypto.encodeBase64StringUtf8(`${t}:${r}`);Object.assign(e.headers,{Authorization:`Basic ${n}`})}}injectAuthenticatedRequestBody(e){var t;if((null==(t=this.clientAuthentication)?void 0:t.confidentialClientType)==="request-body"){let t=(e.method||"GET").toUpperCase();if(-1!==s.indexOf(t)){let t,r=e.headers||{};for(let e in r)if("content-type"===e.toLowerCase()&&r[e]){t=r[e].toLowerCase();break}if("application/x-www-form-urlencoded"===t){e.data=e.data||"";let t=n.parse(e.data);Object.assign(t,{client_id:this.clientAuthentication.clientId,client_secret:this.clientAuthentication.clientSecret||""}),e.data=n.stringify(t)}else if("application/json"===t)e.data=e.data||{},Object.assign(e.data,{client_id:this.clientAuthentication.clientId,client_secret:this.clientAuthentication.clientSecret||""});else throw Error(`${t} content-types are not supported with ${this.clientAuthentication.confidentialClientType} client authentication`)}else throw Error(`${t} HTTP method does not support ${this.clientAuthentication.confidentialClientType} client authentication`)}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}},5332,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.StsCredentials=void 0;let n=e.r(66037),i=e.r(45706),s=e.r(96299),o=e.r(46944);class a extends o.OAuthClientAuthHandler{constructor(e,t){super(t),this.tokenExchangeEndpoint=e,this.transporter=new s.DefaultTransporter}async exchangeToken(e,t,r){var s,l,u;let c={grant_type:e.grantType,resource:e.resource,audience:e.audience,scope:null==(s=e.scope)?void 0:s.join(" "),requested_token_type:e.requestedTokenType,subject_token:e.subjectToken,subject_token_type:e.subjectTokenType,actor_token:null==(l=e.actingParty)?void 0:l.actorToken,actor_token_type:null==(u=e.actingParty)?void 0:u.actorTokenType,options:r&&JSON.stringify(r)};Object.keys(c).forEach(e=>{void 0===c[e]&&delete c[e]});let d={"Content-Type":"application/x-www-form-urlencoded"};Object.assign(d,t||{});let h={...a.RETRY_CONFIG,url:this.tokenExchangeEndpoint.toString(),method:"POST",headers:d,data:i.stringify(c),responseType:"json"};this.applyClientAuthenticationOptions(h);try{let e=await this.transporter.request(h),t=e.data;return t.res=e,t}catch(e){if(e instanceof n.GaxiosError&&e.response)throw(0,o.getErrorFromOAuthErrorResponse)(e.response.data,e);throw e}}}r.StsCredentials=a},6560,(e,t,r)=>{"use strict";var n,i,s,o=e.e&&e.e.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},a=e.e&&e.e.__classPrivateFieldSet||function(e,t,r,n,i){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r};Object.defineProperty(r,"__esModule",{value:!0}),r.BaseExternalAccountClient=r.DEFAULT_UNIVERSE=r.CLOUD_RESOURCE_MANAGER=r.EXTERNAL_ACCOUNT_TYPE=r.EXPIRATION_TIME_OFFSET=void 0;let l=e.r(88947),u=e.r(11656),c=e.r(5332),d=e.r(15733),h="https://www.googleapis.com/auth/cloud-platform";r.EXPIRATION_TIME_OFFSET=3e5,r.EXTERNAL_ACCOUNT_TYPE="external_account",r.CLOUD_RESOURCE_MANAGER="https://cloudresourcemanager.googleapis.com/v1/projects/";let p=e.r(91829);var f=e.r(11656);Object.defineProperty(r,"DEFAULT_UNIVERSE",{enumerable:!0,get:function(){return f.DEFAULT_UNIVERSE}});class g extends u.AuthClient{constructor(e,t){var s;super({...e,...t}),n.add(this),i.set(this,null);let o=(0,d.originalOrCamelOptions)(e),a=o.get("type");if(a&&a!==r.EXTERNAL_ACCOUNT_TYPE)throw Error(`Expected "${r.EXTERNAL_ACCOUNT_TYPE}" type but received "${e.type}"`);let l=o.get("client_id"),u=o.get("client_secret"),p=null!=(s=o.get("token_url"))?s:"https://sts.{universeDomain}/v1/token".replace("{universeDomain}",this.universeDomain),f=o.get("subject_token_type"),g=o.get("workforce_pool_user_project"),m=o.get("service_account_impersonation_url"),y=o.get("service_account_impersonation"),v=(0,d.originalOrCamelOptions)(y).get("token_lifetime_seconds");this.cloudResourceManagerURL=new URL(o.get("cloud_resource_manager_url")||`https://cloudresourcemanager.${this.universeDomain}/v1/projects/`),l&&(this.clientAuth={confidentialClientType:"basic",clientId:l,clientSecret:u}),this.stsCredential=new c.StsCredentials(p,this.clientAuth),this.scopes=o.get("scopes")||[h],this.cachedAccessToken=null,this.audience=o.get("audience"),this.subjectTokenType=f,this.workforcePoolUserProject=g;let _=RegExp("//iam\\.googleapis\\.com/locations/[^/]+/workforcePools/[^/]+/providers/.+");if(this.workforcePoolUserProject&&!this.audience.match(_))throw Error("workforcePoolUserProject should not be set for non-workforce pool credentials.");this.serviceAccountImpersonationUrl=m,this.serviceAccountImpersonationLifetime=v,this.serviceAccountImpersonationLifetime?this.configLifetimeRequested=!0:(this.configLifetimeRequested=!1,this.serviceAccountImpersonationLifetime=3600),this.projectNumber=this.getProjectNumber(this.audience),this.supplierContext={audience:this.audience,subjectTokenType:this.subjectTokenType,transporter:this.transporter}}getServiceAccountEmail(){var e;if(this.serviceAccountImpersonationUrl){if(this.serviceAccountImpersonationUrl.length>256)throw RangeError(`URL is too long: ${this.serviceAccountImpersonationUrl}`);let t=/serviceAccounts\/(?<email>[^:]+):generateAccessToken$/.exec(this.serviceAccountImpersonationUrl);return(null==(e=null==t?void 0:t.groups)?void 0:e.email)||null}return null}setCredentials(e){super.setCredentials(e),this.cachedAccessToken=e}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let e=await this.getAccessToken(),t={Authorization:`Bearer ${e.token}`};return this.addSharedMetadataHeaders(t)}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}async getProjectId(){let e=this.projectNumber||this.workforcePoolUserProject;if(this.projectId)return this.projectId;if(e){let t=await this.getRequestHeaders(),r=await this.transporter.request({...g.RETRY_CONFIG,headers:t,url:`${this.cloudResourceManagerURL.toString()}${e}`,responseType:"json"});return this.projectId=r.data.projectId,this.projectId}return null}async requestAsync(e,t=!1){let r;try{let t=await this.getRequestHeaders();e.headers=e.headers||{},t&&t["x-goog-user-project"]&&(e.headers["x-goog-user-project"]=t["x-goog-user-project"]),t&&t.Authorization&&(e.headers.Authorization=t.Authorization),r=await this.transporter.request(e)}catch(n){let r=n.response;if(r){let n=r.status,i=r.config.data instanceof l.Readable;if(!t&&(401===n||403===n)&&!i&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(e,!0)}throw n}return r}async refreshAccessTokenAsync(){a(this,i,o(this,i,"f")||o(this,n,"m",s).call(this),"f");try{return await o(this,i,"f")}finally{a(this,i,null,"f")}}getProjectNumber(e){let t=e.match(/\/projects\/([^/]+)/);return t?t[1]:null}async getImpersonatedAccessToken(e){let t={...g.RETRY_CONFIG,url:this.serviceAccountImpersonationUrl,method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},data:{scope:this.getScopesArray(),lifetime:this.serviceAccountImpersonationLifetime+"s"},responseType:"json"},r=await this.transporter.request(t),n=r.data;return{access_token:n.accessToken,expiry_date:new Date(n.expireTime).getTime(),res:r}}isExpired(e){let t=new Date().getTime();return!!e.expiry_date&&t>=e.expiry_date-this.eagerRefreshThresholdMillis}getScopesArray(){return"string"==typeof this.scopes?[this.scopes]:this.scopes||[h]}getMetricsHeaderValue(){let e=process.version.replace(/^v/,""),t=void 0!==this.serviceAccountImpersonationUrl,r=this.credentialSourceType?this.credentialSourceType:"unknown";return`gl-node/${e} auth/${p.version} google-byoid-sdk source/${r} sa-impersonation/${t} config-lifetime/${this.configLifetimeRequested}`}}r.BaseExternalAccountClient=g,i=new WeakMap,n=new WeakSet,s=async function(){let e=await this.retrieveSubjectToken(),t={grantType:"urn:ietf:params:oauth:grant-type:token-exchange",audience:this.audience,requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:e,subjectTokenType:this.subjectTokenType,scope:this.serviceAccountImpersonationUrl?[h]:this.getScopesArray()},r=!this.clientAuth&&this.workforcePoolUserProject?{userProject:this.workforcePoolUserProject}:void 0,n={"x-goog-api-client":this.getMetricsHeaderValue()},i=await this.stsCredential.exchangeToken(t,n,r);return this.serviceAccountImpersonationUrl?this.cachedAccessToken=await this.getImpersonatedAccessToken(i.access_token):i.expires_in?this.cachedAccessToken={access_token:i.access_token,expiry_date:new Date().getTime()+1e3*i.expires_in,res:i.res}:this.cachedAccessToken={access_token:i.access_token,res:i.res},this.credentials={},Object.assign(this.credentials,this.cachedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedAccessToken.expiry_date,access_token:this.cachedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedAccessToken}},37289,(e,t,r)=>{"use strict";var n,i,s;Object.defineProperty(r,"__esModule",{value:!0}),r.FileSubjectTokenSupplier=void 0;let o=e.r(24361),a=e.r(22734),l=(0,o.promisify)(null!=(n=a.readFile)?n:()=>{}),u=(0,o.promisify)(null!=(i=a.realpath)?i:()=>{}),c=(0,o.promisify)(null!=(s=a.lstat)?s:()=>{});r.FileSubjectTokenSupplier=class{constructor(e){this.filePath=e.filePath,this.formatType=e.formatType,this.subjectTokenFieldName=e.subjectTokenFieldName}async getSubjectToken(e){let t,r=this.filePath;try{if(r=await u(r),!(await c(r)).isFile())throw Error()}catch(e){throw e instanceof Error&&(e.message=`The file at ${r} does not exist, or it is not a file. ${e.message}`),e}let n=await l(r,{encoding:"utf8"});if("text"===this.formatType?t=n:"json"===this.formatType&&this.subjectTokenFieldName&&(t=JSON.parse(n)[this.subjectTokenFieldName]),!t)throw Error("Unable to parse the subject_token from the credential_source file");return t}}},63057,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.UrlSubjectTokenSupplier=void 0,r.UrlSubjectTokenSupplier=class{constructor(e){this.url=e.url,this.formatType=e.formatType,this.subjectTokenFieldName=e.subjectTokenFieldName,this.headers=e.headers,this.additionalGaxiosOptions=e.additionalGaxiosOptions}async getSubjectToken(e){let t,r={...this.additionalGaxiosOptions,url:this.url,method:"GET",headers:this.headers,responseType:this.formatType};if("text"===this.formatType?t=(await e.transporter.request(r)).data:"json"===this.formatType&&this.subjectTokenFieldName&&(t=(await e.transporter.request(r)).data[this.subjectTokenFieldName]),!t)throw Error("Unable to parse the subject_token from the credential_source URL");return t}}},76868,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.IdentityPoolClient=void 0;let n=e.r(6560),i=e.r(15733),s=e.r(37289),o=e.r(63057);class a extends n.BaseExternalAccountClient{constructor(e,t){super(e,t);let r=(0,i.originalOrCamelOptions)(e),n=r.get("credential_source"),l=r.get("subject_token_supplier");if(!n&&!l)throw Error("A credential source or subject token supplier must be specified.");if(n&&l)throw Error("Only one of credential source or subject token supplier can be specified.");if(l)this.subjectTokenSupplier=l,this.credentialSourceType="programmatic";else{let e=(0,i.originalOrCamelOptions)(n),t=(0,i.originalOrCamelOptions)(e.get("format")),r=t.get("type")||"text",l=t.get("subject_token_field_name");if("json"!==r&&"text"!==r)throw Error(`Invalid credential_source format "${r}"`);if("json"===r&&!l)throw Error("Missing subject_token_field_name for JSON credential_source format");let u=e.get("file"),c=e.get("url"),d=e.get("headers");if(u&&c)throw Error('No valid Identity Pool "credential_source" provided, must be either file or url.');if(u&&!c)this.credentialSourceType="file",this.subjectTokenSupplier=new s.FileSubjectTokenSupplier({filePath:u,formatType:r,subjectTokenFieldName:l});else if(!u&&c)this.credentialSourceType="url",this.subjectTokenSupplier=new o.UrlSubjectTokenSupplier({url:c,formatType:r,subjectTokenFieldName:l,headers:d,additionalGaxiosOptions:a.RETRY_CONFIG});else throw Error('No valid Identity Pool "credential_source" provided, must be either file or url.')}}async retrieveSubjectToken(){return this.subjectTokenSupplier.getSubjectToken(this.supplierContext)}}r.IdentityPoolClient=a},87573,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AwsRequestSigner=void 0;let n=e.r(1426),i="AWS4-HMAC-SHA256";async function s(e,t,r){return await e.signWithHmacSha256(t,r)}async function o(e,t,r,n,i){let o=await s(e,`AWS4${t}`,r),a=await s(e,o,n),l=await s(e,a,i);return await s(e,l,"aws4_request")}async function a(e){let t=e.additionalAmzHeaders||{},r=e.requestPayload||"",a=e.host.split(".")[0],l=new Date,u=l.toISOString().replace(/[-:]/g,"").replace(/\.[0-9]+/,""),c=l.toISOString().replace(/[-]/g,"").replace(/T.*/,""),d={};Object.keys(t).forEach(e=>{d[e.toLowerCase()]=t[e]}),e.securityCredentials.token&&(d["x-amz-security-token"]=e.securityCredentials.token);let h=Object.assign({host:e.host},d.date?{}:{"x-amz-date":u},d),p="",f=Object.keys(h).sort();f.forEach(e=>{p+=`${e}:${h[e]}
`});let g=f.join(";"),m=await e.crypto.sha256DigestHex(r),y=`${e.method}
${e.canonicalUri}
${e.canonicalQuerystring}
${p}
${g}
${m}`,v=`${c}/${e.region}/${a}/aws4_request`,_=`${i}
${u}
${v}
`+await e.crypto.sha256DigestHex(y),b=await o(e.crypto,e.securityCredentials.secretAccessKey,c,e.region,a),E=await s(e.crypto,b,_),S=`${i} Credential=${e.securityCredentials.accessKeyId}/${v}, SignedHeaders=${g}, Signature=${(0,n.fromArrayBufferToHex)(E)}`;return{amzDate:d.date?void 0:u,authorizationHeader:S,canonicalQuerystring:e.canonicalQuerystring}}r.AwsRequestSigner=class{constructor(e,t){this.getCredentials=e,this.region=t,this.crypto=(0,n.createCrypto)()}async getRequestOptions(e){if(!e.url)throw Error('"url" is required in "amzOptions"');let t="object"==typeof e.data?JSON.stringify(e.data):e.data,r=e.url,n=e.method||"GET",i=e.body||t,s=e.headers,o=await this.getCredentials(),l=new URL(r),u=await a({crypto:this.crypto,host:l.host,canonicalUri:l.pathname,canonicalQuerystring:l.search.substr(1),method:n,region:this.region,securityCredentials:o,requestPayload:i,additionalAmzHeaders:s}),c=Object.assign(u.amzDate?{"x-amz-date":u.amzDate}:{},{Authorization:u.authorizationHeader,host:l.host},s||{});o.token&&Object.assign(c,{"x-amz-security-token":o.token});let d={url:r,method:n,headers:c};return void 0!==i&&(d.body=i),d}}},41033,(e,t,r)=>{"use strict";var n,i,s,o,a,l,u=e.e&&e.e.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.DefaultAwsSecurityCredentialsSupplier=void 0,r.DefaultAwsSecurityCredentialsSupplier=class{constructor(e){n.add(this),this.regionUrl=e.regionUrl,this.securityCredentialsUrl=e.securityCredentialsUrl,this.imdsV2SessionTokenUrl=e.imdsV2SessionTokenUrl,this.additionalGaxiosOptions=e.additionalGaxiosOptions}async getAwsRegion(e){if(u(this,n,"a",a))return u(this,n,"a",a);let t={};if(!u(this,n,"a",a)&&this.imdsV2SessionTokenUrl&&(t["x-aws-ec2-metadata-token"]=await u(this,n,"m",i).call(this,e.transporter)),!this.regionUrl)throw Error('Unable to determine AWS region due to missing "options.credential_source.region_url"');let r={...this.additionalGaxiosOptions,url:this.regionUrl,method:"GET",responseType:"text",headers:t},s=await e.transporter.request(r);return s.data.substr(0,s.data.length-1)}async getAwsSecurityCredentials(e){if(u(this,n,"a",l))return u(this,n,"a",l);let t={};this.imdsV2SessionTokenUrl&&(t["x-aws-ec2-metadata-token"]=await u(this,n,"m",i).call(this,e.transporter));let r=await u(this,n,"m",s).call(this,t,e.transporter),a=await u(this,n,"m",o).call(this,r,t,e.transporter);return{accessKeyId:a.AccessKeyId,secretAccessKey:a.SecretAccessKey,token:a.Token}}},n=new WeakSet,i=async function(e){let t={...this.additionalGaxiosOptions,url:this.imdsV2SessionTokenUrl,method:"PUT",responseType:"text",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"300"}};return(await e.request(t)).data},s=async function(e,t){if(!this.securityCredentialsUrl)throw Error('Unable to determine AWS role name due to missing "options.credential_source.url"');let r={...this.additionalGaxiosOptions,url:this.securityCredentialsUrl,method:"GET",responseType:"text",headers:e};return(await t.request(r)).data},o=async function(e,t,r){return(await r.request({...this.additionalGaxiosOptions,url:`${this.securityCredentialsUrl}/${e}`,responseType:"json",headers:t})).data},a=function(){return process.env.AWS_REGION||process.env.AWS_DEFAULT_REGION||null},l=function(){return process.env.AWS_ACCESS_KEY_ID&&process.env.AWS_SECRET_ACCESS_KEY?{accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY,token:process.env.AWS_SESSION_TOKEN}:null}},90220,(e,t,r)=>{"use strict";var n,i,s=e.e&&e.e.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.AwsClient=void 0;let o=e.r(87573),a=e.r(6560),l=e.r(41033),u=e.r(15733);class c extends a.BaseExternalAccountClient{constructor(e,t){super(e,t);let r=(0,u.originalOrCamelOptions)(e),o=r.get("credential_source"),a=r.get("aws_security_credentials_supplier");if(!o&&!a)throw Error("A credential source or AWS security credentials supplier must be specified.");if(o&&a)throw Error("Only one of credential source or AWS security credentials supplier can be specified.");if(a)this.awsSecurityCredentialsSupplier=a,this.regionalCredVerificationUrl=s(n,n,"f",i),this.credentialSourceType="programmatic";else{let e=(0,u.originalOrCamelOptions)(o);this.environmentId=e.get("environment_id");let t=e.get("region_url"),r=e.get("url"),n=e.get("imdsv2_session_token_url");this.awsSecurityCredentialsSupplier=new l.DefaultAwsSecurityCredentialsSupplier({regionUrl:t,securityCredentialsUrl:r,imdsV2SessionTokenUrl:n}),this.regionalCredVerificationUrl=e.get("regional_cred_verification_url"),this.credentialSourceType="aws",this.validateEnvironmentId()}this.awsRequestSigner=null,this.region=""}validateEnvironmentId(){var e;let t=null==(e=this.environmentId)?void 0:e.match(/^(aws)(\d+)$/);if(t&&this.regionalCredVerificationUrl){if(1!==parseInt(t[2],10))throw Error(`aws version "${t[2]}" is not supported in the current build.`)}else throw Error('No valid AWS "credential_source" provided')}async retrieveSubjectToken(){this.awsRequestSigner||(this.region=await this.awsSecurityCredentialsSupplier.getAwsRegion(this.supplierContext),this.awsRequestSigner=new o.AwsRequestSigner(async()=>this.awsSecurityCredentialsSupplier.getAwsSecurityCredentials(this.supplierContext),this.region));let e=await this.awsRequestSigner.getRequestOptions({...n.RETRY_CONFIG,url:this.regionalCredVerificationUrl.replace("{region}",this.region),method:"POST"}),t=[],r=Object.assign({"x-goog-cloud-target-resource":this.audience},e.headers);for(let e in r)t.push({key:e,value:r[e]});return encodeURIComponent(JSON.stringify({url:e.url,method:e.method,headers:t}))}}r.AwsClient=c,n=c,i={value:"https://sts.{region}.amazonaws.com?Action=GetCallerIdentity&Version=2011-06-15"},c.AWS_EC2_METADATA_IPV4_ADDRESS="169.254.169.254",c.AWS_EC2_METADATA_IPV6_ADDRESS="fd00:ec2::254"},71006,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.InvalidSubjectTokenError=r.InvalidMessageFieldError=r.InvalidCodeFieldError=r.InvalidTokenTypeFieldError=r.InvalidExpirationTimeFieldError=r.InvalidSuccessFieldError=r.InvalidVersionFieldError=r.ExecutableResponseError=r.ExecutableResponse=void 0;let n="urn:ietf:params:oauth:token-type:saml2",i="urn:ietf:params:oauth:token-type:id_token",s="urn:ietf:params:oauth:token-type:jwt";r.ExecutableResponse=class{constructor(e){if(!e.version)throw new a("Executable response must contain a 'version' field.");if(void 0===e.success)throw new l("Executable response must contain a 'success' field.");if(this.version=e.version,this.success=e.success,this.success){if(this.expirationTime=e.expiration_time,this.tokenType=e.token_type,this.tokenType!==n&&this.tokenType!==i&&this.tokenType!==s)throw new u(`Executable response must contain a 'token_type' field when successful and it must be one of ${i}, ${s}, or ${n}.`);if(this.tokenType===n){if(!e.saml_response)throw new h(`Executable response must contain a 'saml_response' field when token_type=${n}.`);this.subjectToken=e.saml_response}else{if(!e.id_token)throw new h(`Executable response must contain a 'id_token' field when token_type=${i} or ${s}.`);this.subjectToken=e.id_token}}else{if(!e.code)throw new c("Executable response must contain a 'code' field when unsuccessful.");if(!e.message)throw new d("Executable response must contain a 'message' field when unsuccessful.");this.errorCode=e.code,this.errorMessage=e.message}}isValid(){return!this.isExpired()&&this.success}isExpired(){return void 0!==this.expirationTime&&this.expirationTime<Math.round(Date.now()/1e3)}};class o extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}r.ExecutableResponseError=o;class a extends o{}r.InvalidVersionFieldError=a;class l extends o{}r.InvalidSuccessFieldError=l,r.InvalidExpirationTimeFieldError=class extends o{};class u extends o{}r.InvalidTokenTypeFieldError=u;class c extends o{}r.InvalidCodeFieldError=c;class d extends o{}r.InvalidMessageFieldError=d;class h extends o{}r.InvalidSubjectTokenError=h},20336,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PluggableAuthHandler=void 0;let n=e.r(23238),i=e.r(71006),s=e.r(33405),o=e.r(22734);class a{constructor(e){if(!e.command)throw Error("No command provided.");if(this.commandComponents=a.parseCommand(e.command),this.timeoutMillis=e.timeoutMillis,!this.timeoutMillis)throw Error("No timeoutMillis provided.");this.outputFile=e.outputFile}retrieveResponseFromExecutable(e){return new Promise((t,r)=>{let o=s.spawn(this.commandComponents[0],this.commandComponents.slice(1),{env:{...process.env,...Object.fromEntries(e)}}),a="";o.stdout.on("data",e=>{a+=e}),o.stderr.on("data",e=>{a+=e});let l=setTimeout(()=>(o.removeAllListeners(),o.kill(),r(Error("The executable failed to finish within the timeout specified."))),this.timeoutMillis);o.on("close",e=>{if(clearTimeout(l),0!==e)return r(new n.ExecutableError(a,e.toString()));try{let e=JSON.parse(a),r=new i.ExecutableResponse(e);return t(r)}catch(e){if(e instanceof i.ExecutableResponseError)return r(e);return r(new i.ExecutableResponseError(`The executable returned an invalid response: ${a}`))}})})}async retrieveCachedResponse(){let e;if(!this.outputFile||0===this.outputFile.length)return;try{e=await o.promises.realpath(this.outputFile)}catch(e){return}if(!(await o.promises.lstat(e)).isFile())return;let t=await o.promises.readFile(e,{encoding:"utf8"});if(""!==t)try{let e=JSON.parse(t);if(new i.ExecutableResponse(e).isValid())return new i.ExecutableResponse(e);return}catch(e){if(e instanceof i.ExecutableResponseError)throw e;throw new i.ExecutableResponseError(`The output file contained an invalid response: ${t}`)}}static parseCommand(e){let t=e.match(/(?:[^\s"]+|"[^"]*")+/g);if(!t)throw Error(`Provided command: "${e}" could not be parsed.`);for(let e=0;e<t.length;e++)'"'===t[e][0]&&'"'===t[e].slice(-1)&&(t[e]=t[e].slice(1,-1));return t}}r.PluggableAuthHandler=a},23238,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PluggableAuthClient=r.ExecutableError=void 0;let n=e.r(6560),i=e.r(71006),s=e.r(20336);class o extends Error{constructor(e,t){super(`The executable failed with exit code: ${t} and error message: ${e}.`),this.code=t,Object.setPrototypeOf(this,new.target.prototype)}}r.ExecutableError=o;class a extends n.BaseExternalAccountClient{constructor(e,t){if(super(e,t),!e.credential_source.executable||(this.command=e.credential_source.executable.command,!this.command))throw Error('No valid Pluggable Auth "credential_source" provided.');if(void 0===e.credential_source.executable.timeout_millis)this.timeoutMillis=3e4;else if(this.timeoutMillis=e.credential_source.executable.timeout_millis,this.timeoutMillis<5e3||this.timeoutMillis>12e4)throw Error("Timeout must be between 5000120000 milliseconds.");this.outputFile=e.credential_source.executable.output_file,this.handler=new s.PluggableAuthHandler({command:this.command,timeoutMillis:this.timeoutMillis,outputFile:this.outputFile}),this.credentialSourceType="executable"}async retrieveSubjectToken(){let e;if("1"!==process.env.GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES)throw Error("Pluggable Auth executables need to be explicitly allowed to run by setting the GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES environment Variable to 1.");if(this.outputFile&&(e=await this.handler.retrieveCachedResponse()),!e){let t=new Map;t.set("GOOGLE_EXTERNAL_ACCOUNT_AUDIENCE",this.audience),t.set("GOOGLE_EXTERNAL_ACCOUNT_TOKEN_TYPE",this.subjectTokenType),t.set("GOOGLE_EXTERNAL_ACCOUNT_INTERACTIVE","0"),this.outputFile&&t.set("GOOGLE_EXTERNAL_ACCOUNT_OUTPUT_FILE",this.outputFile);let r=this.getServiceAccountEmail();r&&t.set("GOOGLE_EXTERNAL_ACCOUNT_IMPERSONATED_EMAIL",r),e=await this.handler.retrieveResponseFromExecutable(t)}if(e.version>1)throw Error("Version of executable is not currently supported, maximum supported version is 1.");if(!e.success)throw new o(e.errorMessage,e.errorCode);if(this.outputFile&&!e.expirationTime)throw new i.InvalidExpirationTimeFieldError("The executable response must contain the `expiration_time` field for successful responses when an output_file has been specified in the configuration.");if(e.isExpired())throw Error("Executable response is expired.");return e.subjectToken}}r.PluggableAuthClient=a},45037,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ExternalAccountClient=void 0;let n=e.r(6560),i=e.r(76868),s=e.r(90220),o=e.r(23238);r.ExternalAccountClient=class{constructor(){throw Error("ExternalAccountClients should be initialized via: ExternalAccountClient.fromJSON(), directly via explicit constructors, eg. new AwsClient(options), new IdentityPoolClient(options), newPluggableAuthClientOptions, or via new GoogleAuth(options).getClient()")}static fromJSON(e,t){var r,a;return e&&e.type===n.EXTERNAL_ACCOUNT_TYPE?(null==(r=e.credential_source)?void 0:r.environment_id)?new s.AwsClient(e,t):(null==(a=e.credential_source)?void 0:a.executable)?new o.PluggableAuthClient(e,t):new i.IdentityPoolClient(e,t):null}}},74158,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ExternalAccountAuthorizedUserClient=r.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE=void 0;let n=e.r(11656),i=e.r(46944),s=e.r(66037),o=e.r(88947),a=e.r(6560);r.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE="external_account_authorized_user";class l extends i.OAuthClientAuthHandler{constructor(e,t,r){super(r),this.url=e,this.transporter=t}async refreshToken(e,t){let r=new URLSearchParams({grant_type:"refresh_token",refresh_token:e}),n={"Content-Type":"application/x-www-form-urlencoded",...t},o={...l.RETRY_CONFIG,url:this.url,method:"POST",headers:n,data:r.toString(),responseType:"json"};this.applyClientAuthenticationOptions(o);try{let e=await this.transporter.request(o),t=e.data;return t.res=e,t}catch(e){if(e instanceof s.GaxiosError&&e.response)throw(0,i.getErrorFromOAuthErrorResponse)(e.response.data,e);throw e}}}class u extends n.AuthClient{constructor(e,t){var r;super({...e,...t}),e.universe_domain&&(this.universeDomain=e.universe_domain),this.refreshToken=e.refresh_token;let n={confidentialClientType:"basic",clientId:e.client_id,clientSecret:e.client_secret};this.externalAccountAuthorizedUserHandler=new l(null!=(r=e.token_url)?r:"https://sts.{universeDomain}/v1/oauthtoken".replace("{universeDomain}",this.universeDomain),this.transporter,n),this.cachedAccessToken=null,this.quotaProjectId=e.quota_project_id,"number"!=typeof(null==t?void 0:t.eagerRefreshThresholdMillis)?this.eagerRefreshThresholdMillis=a.EXPIRATION_TIME_OFFSET:this.eagerRefreshThresholdMillis=t.eagerRefreshThresholdMillis,this.forceRefreshOnFailure=!!(null==t?void 0:t.forceRefreshOnFailure)}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let e=await this.getAccessToken(),t={Authorization:`Bearer ${e.token}`};return this.addSharedMetadataHeaders(t)}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}async requestAsync(e,t=!1){let r;try{let t=await this.getRequestHeaders();e.headers=e.headers||{},t&&t["x-goog-user-project"]&&(e.headers["x-goog-user-project"]=t["x-goog-user-project"]),t&&t.Authorization&&(e.headers.Authorization=t.Authorization),r=await this.transporter.request(e)}catch(n){let r=n.response;if(r){let n=r.status,i=r.config.data instanceof o.Readable;if(!t&&(401===n||403===n)&&!i&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(e,!0)}throw n}return r}async refreshAccessTokenAsync(){let e=await this.externalAccountAuthorizedUserHandler.refreshToken(this.refreshToken);return this.cachedAccessToken={access_token:e.access_token,expiry_date:new Date().getTime()+1e3*e.expires_in,res:e.res},void 0!==e.refresh_token&&(this.refreshToken=e.refresh_token),this.cachedAccessToken}isExpired(e){let t=new Date().getTime();return!!e.expiry_date&&t>=e.expiry_date-this.eagerRefreshThresholdMillis}}r.ExternalAccountAuthorizedUserClient=u},64794,(e,t,r)=>{"use strict";var n,i,s,o,a=e.e&&e.e.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},l=e.e&&e.e.__classPrivateFieldSet||function(e,t,r,n,i){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r};Object.defineProperty(r,"__esModule",{value:!0}),r.GoogleAuth=r.GoogleAuthExceptionMessages=r.CLOUD_SDK_CLIENT_ID=void 0;let u=e.r(33405),c=e.r(22734),d=e.r(82e3),h=e.r(46786),p=e.r(14747),f=e.r(1426),g=e.r(96299),m=e.r(70814),y=e.r(80732),v=e.r(80243),_=e.r(24553),b=e.r(16260),E=e.r(36126),S=e.r(45037),w=e.r(6560),T=e.r(11656),C=e.r(74158),A=e.r(15733);r.CLOUD_SDK_CLIENT_ID="764086051850-6qr4p6gpi6hn506pt8ejuq83di341hur.apps.googleusercontent.com",r.GoogleAuthExceptionMessages={API_KEY_WITH_CREDENTIALS:"API Keys and Credentials are mutually exclusive authentication methods and cannot be used together.",NO_PROJECT_ID_FOUND:"Unable to detect a Project Id in the current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_CREDENTIALS_FOUND:"Unable to find credentials in current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_ADC_FOUND:"Could not load the default credentials. Browse to https://cloud.google.com/docs/authentication/getting-started for more information.",NO_UNIVERSE_DOMAIN_FOUND:"Unable to detect a Universe Domain in the current environment.\nTo learn more about Universe Domain retrieval, visit: \nhttps://cloud.google.com/compute/docs/metadata/predefined-metadata-keys"};class O{get isGCE(){return this.checkIsGCE}constructor(e={}){if(n.add(this),this.checkIsGCE=void 0,this.jsonContent=null,this.cachedCredential=null,i.set(this,null),this.clientOptions={},this._cachedProjectId=e.projectId||null,this.cachedCredential=e.authClient||null,this.keyFilename=e.keyFilename||e.keyFile,this.scopes=e.scopes,this.clientOptions=e.clientOptions||{},this.jsonContent=e.credentials||null,this.apiKey=e.apiKey||this.clientOptions.apiKey||null,this.apiKey&&(this.jsonContent||this.clientOptions.credentials))throw RangeError(r.GoogleAuthExceptionMessages.API_KEY_WITH_CREDENTIALS);e.universeDomain&&(this.clientOptions.universeDomain=e.universeDomain)}setGapicJWTValues(e){e.defaultServicePath=this.defaultServicePath,e.useJWTAccessWithScope=this.useJWTAccessWithScope,e.defaultScopes=this.defaultScopes}getProjectId(e){if(!e)return this.getProjectIdAsync();this.getProjectIdAsync().then(t=>e(null,t),e)}async getProjectIdOptional(){try{return await this.getProjectId()}catch(e){if(e instanceof Error&&e.message===r.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)return null;throw e}}async findAndCacheProjectId(){let e=null;if((e=await this.getProductionProjectId())||(e=await this.getFileProjectId()),e||(e=await this.getDefaultServiceProjectId()),e||(e=await this.getGCEProjectId()),e||(e=await this.getExternalAccountClientProjectId()),e)return this._cachedProjectId=e,e;throw Error(r.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)}async getProjectIdAsync(){return this._cachedProjectId?this._cachedProjectId:(this._findProjectIdPromise||(this._findProjectIdPromise=this.findAndCacheProjectId()),this._findProjectIdPromise)}async getUniverseDomainFromMetadataServer(){var e;let t;try{(t=await d.universe("universe-domain"))||(t=T.DEFAULT_UNIVERSE)}catch(r){if(r&&(null==(e=null==r?void 0:r.response)?void 0:e.status)===404)t=T.DEFAULT_UNIVERSE;else throw r}return t}async getUniverseDomain(){let e=(0,A.originalOrCamelOptions)(this.clientOptions).get("universe_domain");try{null!=e||(e=(await this.getClient()).universeDomain)}catch(t){null!=e||(e=T.DEFAULT_UNIVERSE)}return e}getAnyScopes(){return this.scopes||this.defaultScopes}getApplicationDefault(e={},t){let r;if("function"==typeof e?t=e:r=e,!t)return this.getApplicationDefaultAsync(r);this.getApplicationDefaultAsync(r).then(e=>t(null,e.credential,e.projectId),t)}async getApplicationDefaultAsync(e={}){let t;if(this.cachedCredential)return await a(this,n,"m",s).call(this,this.cachedCredential,null);if((t=await this._tryGetApplicationCredentialsFromEnvironmentVariable(e))||(t=await this._tryGetApplicationCredentialsFromWellKnownFile(e)))return t instanceof _.JWT?t.scopes=this.scopes:t instanceof w.BaseExternalAccountClient&&(t.scopes=this.getAnyScopes()),await a(this,n,"m",s).call(this,t);if(await this._checkIsGCE())return e.scopes=this.getAnyScopes(),await a(this,n,"m",s).call(this,new m.Compute(e));throw Error(r.GoogleAuthExceptionMessages.NO_ADC_FOUND)}async _checkIsGCE(){return void 0===this.checkIsGCE&&(this.checkIsGCE=d.getGCPResidency()||await d.isAvailable()),this.checkIsGCE}async _tryGetApplicationCredentialsFromEnvironmentVariable(e){let t=process.env.GOOGLE_APPLICATION_CREDENTIALS||process.env.google_application_credentials;if(!t||0===t.length)return null;try{return this._getApplicationCredentialsFromFilePath(t,e)}catch(e){throw e instanceof Error&&(e.message=`Unable to read the credential file specified by the GOOGLE_APPLICATION_CREDENTIALS environment variable: ${e.message}`),e}}async _tryGetApplicationCredentialsFromWellKnownFile(e){let t=null;if(this._isWindows())t=process.env.APPDATA;else{let e=process.env.HOME;e&&(t=p.join(e,".config"))}return(t&&(t=p.join(t,"gcloud","application_default_credentials.json"),c.existsSync(t)||(t=null)),t)?await this._getApplicationCredentialsFromFilePath(t,e):null}async _getApplicationCredentialsFromFilePath(e,t={}){if(!e||0===e.length)throw Error("The file path is invalid.");try{if(e=c.realpathSync(e),!c.lstatSync(e).isFile())throw Error()}catch(t){throw t instanceof Error&&(t.message=`The file at ${e} does not exist, or it is not a file. ${t.message}`),t}let r=c.createReadStream(e);return this.fromStream(r,t)}fromImpersonatedJSON(e){var t,r,n,i;if(!e)throw Error("Must pass in a JSON object containing an  impersonated refresh token");if(e.type!==E.IMPERSONATED_ACCOUNT_TYPE)throw Error(`The incoming JSON object does not have the "${E.IMPERSONATED_ACCOUNT_TYPE}" type`);if(!e.source_credentials)throw Error("The incoming JSON object does not contain a source_credentials field");if(!e.service_account_impersonation_url)throw Error("The incoming JSON object does not contain a service_account_impersonation_url field");let s=this.fromJSON(e.source_credentials);if((null==(t=e.service_account_impersonation_url)?void 0:t.length)>256)throw RangeError(`Target principal is too long: ${e.service_account_impersonation_url}`);let o=null==(n=null==(r=/(?<target>[^/]+):(generateAccessToken|generateIdToken)$/.exec(e.service_account_impersonation_url))?void 0:r.groups)?void 0:n.target;if(!o)throw RangeError(`Cannot extract target principal from ${e.service_account_impersonation_url}`);let a=null!=(i=this.getAnyScopes())?i:[];return new E.Impersonated({...e,sourceClient:s,targetPrincipal:o,targetScopes:Array.isArray(a)?a:[a]})}fromJSON(e,t={}){let r,n=(0,A.originalOrCamelOptions)(t).get("universe_domain");return e.type===b.USER_REFRESH_ACCOUNT_TYPE?(r=new b.UserRefreshClient(t)).fromJSON(e):e.type===E.IMPERSONATED_ACCOUNT_TYPE?r=this.fromImpersonatedJSON(e):e.type===w.EXTERNAL_ACCOUNT_TYPE?(r=S.ExternalAccountClient.fromJSON(e,t)).scopes=this.getAnyScopes():e.type===C.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE?r=new C.ExternalAccountAuthorizedUserClient(e,t):(t.scopes=this.scopes,r=new _.JWT(t),this.setGapicJWTValues(r),r.fromJSON(e)),n&&(r.universeDomain=n),r}_cacheClientFromJSON(e,t){let r=this.fromJSON(e,t);return this.jsonContent=e,this.cachedCredential=r,r}fromStream(e,t={},r){let n={};if("function"==typeof t?r=t:n=t,!r)return this.fromStreamAsync(e,n);this.fromStreamAsync(e,n).then(e=>r(null,e),r)}fromStreamAsync(e,t){return new Promise((r,n)=>{if(!e)throw Error("Must pass in a stream containing the Google auth settings.");let i=[];e.setEncoding("utf8").on("error",n).on("data",e=>i.push(e)).on("end",()=>{try{try{let e=JSON.parse(i.join("")),n=this._cacheClientFromJSON(e,t);return r(n)}catch(t){if(!this.keyFilename)throw t;let e=new _.JWT({...this.clientOptions,keyFile:this.keyFilename});return this.cachedCredential=e,this.setGapicJWTValues(e),r(e)}}catch(e){return n(e)}})})}fromAPIKey(e,t={}){return new _.JWT({...t,apiKey:e})}_isWindows(){let e=h.platform();return!!e&&!!(e.length>=3)&&"win"===e.substring(0,3).toLowerCase()}async getDefaultServiceProjectId(){return new Promise(e=>{(0,u.exec)("gcloud config config-helper --format json",(t,r)=>{if(!t&&r)try{let t=JSON.parse(r).configuration.properties.core.project;e(t);return}catch(e){}e(null)})})}getProductionProjectId(){return process.env.GCLOUD_PROJECT||process.env.GOOGLE_CLOUD_PROJECT||process.env.gcloud_project||process.env.google_cloud_project}async getFileProjectId(){if(this.cachedCredential)return this.cachedCredential.projectId;if(this.keyFilename){let e=await this.getClient();if(e&&e.projectId)return e.projectId}let e=await this._tryGetApplicationCredentialsFromEnvironmentVariable();return e?e.projectId:null}async getExternalAccountClientProjectId(){if(!this.jsonContent||this.jsonContent.type!==w.EXTERNAL_ACCOUNT_TYPE)return null;let e=await this.getClient();return await e.getProjectId()}async getGCEProjectId(){try{return await d.project("project-id")}catch(e){return null}}getCredentials(e){if(!e)return this.getCredentialsAsync();this.getCredentialsAsync().then(t=>e(null,t),e)}async getCredentialsAsync(){let e=await this.getClient();if(e instanceof E.Impersonated)return{client_email:e.getTargetPrincipal()};if(e instanceof w.BaseExternalAccountClient){let t=e.getServiceAccountEmail();if(t)return{client_email:t,universe_domain:e.universeDomain}}if(this.jsonContent)return{client_email:this.jsonContent.client_email,private_key:this.jsonContent.private_key,universe_domain:this.jsonContent.universe_domain};if(await this._checkIsGCE()){let[e,t]=await Promise.all([d.instance("service-accounts/default/email"),this.getUniverseDomain()]);return{client_email:e,universe_domain:t}}throw Error(r.GoogleAuthExceptionMessages.NO_CREDENTIALS_FOUND)}async getClient(){if(this.cachedCredential)return this.cachedCredential;l(this,i,a(this,i,"f")||a(this,n,"m",o).call(this),"f");try{return await a(this,i,"f")}finally{l(this,i,null,"f")}}async getIdTokenClient(e){let t=await this.getClient();if(!("fetchIdToken"in t))throw Error("Cannot fetch ID token in this environment, use GCE or set the GOOGLE_APPLICATION_CREDENTIALS environment variable to a service account credentials JSON file.");return new y.IdTokenClient({targetAudience:e,idTokenProvider:t})}async getAccessToken(){let e=await this.getClient();return(await e.getAccessToken()).token}async getRequestHeaders(e){return(await this.getClient()).getRequestHeaders(e)}async authorizeRequest(e){let t=(e=e||{}).url||e.uri,r=await this.getClient(),n=await r.getRequestHeaders(t);return e.headers=Object.assign(e.headers||{},n),e}async request(e){return(await this.getClient()).request(e)}getEnv(){return(0,v.getEnv)()}async sign(e,t){let r=await this.getClient(),n=await this.getUniverseDomain();if(t=t||`https://iamcredentials.${n}/v1/projects/-/serviceAccounts/`,r instanceof E.Impersonated)return(await r.sign(e)).signedBlob;let i=(0,f.createCrypto)();if(r instanceof _.JWT&&r.key)return await i.sign(r.key,e);let s=await this.getCredentials();if(!s.client_email)throw Error("Cannot sign data without `client_email`.");return this.signBlob(i,s.client_email,e,t)}async signBlob(e,t,r,n){let i=new URL(n+`${t}:signBlob`);return(await this.request({method:"POST",url:i.href,data:{payload:e.encodeBase64StringUtf8(r)},retry:!0,retryConfig:{httpMethodsToRetry:["POST"]}})).data.signedBlob}}r.GoogleAuth=O,i=new WeakMap,n=new WeakSet,s=async function(e,t=process.env.GOOGLE_CLOUD_QUOTA_PROJECT||null){let r=await this.getProjectIdOptional();return t&&(e.quotaProjectId=t),this.cachedCredential=e,{credential:e,projectId:r}},o=async function(){if(this.jsonContent)return this._cacheClientFromJSON(this.jsonContent,this.clientOptions);if(this.keyFilename){let e=p.resolve(this.keyFilename),t=c.createReadStream(e);return await this.fromStreamAsync(t,this.clientOptions)}if(this.apiKey){let e=await this.fromAPIKey(this.apiKey,this.clientOptions);e.scopes=this.scopes;let{credential:t}=await a(this,n,"m",s).call(this,e);return t}{let{credential:e}=await this.getApplicationDefaultAsync(this.clientOptions);return e}},O.DefaultTransporter=g.DefaultTransporter},3994,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.IAMAuth=void 0,r.IAMAuth=class{constructor(e,t){this.selector=e,this.token=t,this.selector=e,this.token=t}getRequestHeaders(){return{"x-goog-iam-authority-selector":this.selector,"x-goog-iam-authorization-token":this.token}}}},56777,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DownscopedClient=r.EXPIRATION_TIME_OFFSET=r.MAX_ACCESS_BOUNDARY_RULES_COUNT=void 0;let n=e.r(88947),i=e.r(11656),s=e.r(5332);r.MAX_ACCESS_BOUNDARY_RULES_COUNT=10,r.EXPIRATION_TIME_OFFSET=3e5;class o extends i.AuthClient{constructor(e,t,n,i){if(super({...n,quotaProjectId:i}),this.authClient=e,this.credentialAccessBoundary=t,0===t.accessBoundary.accessBoundaryRules.length)throw Error("At least one access boundary rule needs to be defined.");if(t.accessBoundary.accessBoundaryRules.length>r.MAX_ACCESS_BOUNDARY_RULES_COUNT)throw Error(`The provided access boundary has more than ${r.MAX_ACCESS_BOUNDARY_RULES_COUNT} access boundary rules.`);for(let e of t.accessBoundary.accessBoundaryRules)if(0===e.availablePermissions.length)throw Error("At least one permission should be defined in access boundary rules.");this.stsCredential=new s.StsCredentials(`https://sts.${this.universeDomain}/v1/token`),this.cachedDownscopedAccessToken=null}setCredentials(e){if(!e.expiry_date)throw Error("The access token expiry_date field is missing in the provided credentials.");super.setCredentials(e),this.cachedDownscopedAccessToken=e}async getAccessToken(){return(!this.cachedDownscopedAccessToken||this.isExpired(this.cachedDownscopedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedDownscopedAccessToken.access_token,expirationTime:this.cachedDownscopedAccessToken.expiry_date,res:this.cachedDownscopedAccessToken.res}}async getRequestHeaders(){let e=await this.getAccessToken(),t={Authorization:`Bearer ${e.token}`};return this.addSharedMetadataHeaders(t)}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}async requestAsync(e,t=!1){let r;try{let t=await this.getRequestHeaders();e.headers=e.headers||{},t&&t["x-goog-user-project"]&&(e.headers["x-goog-user-project"]=t["x-goog-user-project"]),t&&t.Authorization&&(e.headers.Authorization=t.Authorization),r=await this.transporter.request(e)}catch(i){let r=i.response;if(r){let i=r.status,s=r.config.data instanceof n.Readable;if(!t&&(401===i||403===i)&&!s&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(e,!0)}throw i}return r}async refreshAccessTokenAsync(){var e;let t=(await this.authClient.getAccessToken()).token,r=await this.stsCredential.exchangeToken({grantType:"urn:ietf:params:oauth:grant-type:token-exchange",requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:t,subjectTokenType:"urn:ietf:params:oauth:token-type:access_token"},void 0,this.credentialAccessBoundary),n=(null==(e=this.authClient.credentials)?void 0:e.expiry_date)||null,i=r.expires_in?new Date().getTime()+1e3*r.expires_in:n;return this.cachedDownscopedAccessToken={access_token:r.access_token,expiry_date:i,res:r.res},this.credentials={},Object.assign(this.credentials,this.cachedDownscopedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedDownscopedAccessToken.expiry_date,access_token:this.cachedDownscopedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedDownscopedAccessToken}isExpired(e){let t=new Date().getTime();return!!e.expiry_date&&t>=e.expiry_date-this.eagerRefreshThresholdMillis}}r.DownscopedClient=o},53534,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PassThroughClient=void 0;let n=e.r(11656);class i extends n.AuthClient{async request(e){return this.transporter.request(e)}async getAccessToken(){return{}}async getRequestHeaders(){return{}}}r.PassThroughClient=i,new i().getAccessToken()},47334,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GoogleAuth=r.auth=r.DefaultTransporter=r.PassThroughClient=r.ExecutableError=r.PluggableAuthClient=r.DownscopedClient=r.BaseExternalAccountClient=r.ExternalAccountClient=r.IdentityPoolClient=r.AwsRequestSigner=r.AwsClient=r.UserRefreshClient=r.LoginTicket=r.ClientAuthentication=r.OAuth2Client=r.CodeChallengeMethod=r.Impersonated=r.JWT=r.JWTAccess=r.IdTokenClient=r.IAMAuth=r.GCPEnv=r.Compute=r.DEFAULT_UNIVERSE=r.AuthClient=r.gaxios=r.gcpMetadata=void 0;let n=e.r(64794);Object.defineProperty(r,"GoogleAuth",{enumerable:!0,get:function(){return n.GoogleAuth}}),r.gcpMetadata=e.r(82e3),r.gaxios=e.r(66037);var i=e.r(11656);Object.defineProperty(r,"AuthClient",{enumerable:!0,get:function(){return i.AuthClient}}),Object.defineProperty(r,"DEFAULT_UNIVERSE",{enumerable:!0,get:function(){return i.DEFAULT_UNIVERSE}});var s=e.r(70814);Object.defineProperty(r,"Compute",{enumerable:!0,get:function(){return s.Compute}});var o=e.r(80243);Object.defineProperty(r,"GCPEnv",{enumerable:!0,get:function(){return o.GCPEnv}});var a=e.r(3994);Object.defineProperty(r,"IAMAuth",{enumerable:!0,get:function(){return a.IAMAuth}});var l=e.r(80732);Object.defineProperty(r,"IdTokenClient",{enumerable:!0,get:function(){return l.IdTokenClient}});var u=e.r(10247);Object.defineProperty(r,"JWTAccess",{enumerable:!0,get:function(){return u.JWTAccess}});var c=e.r(24553);Object.defineProperty(r,"JWT",{enumerable:!0,get:function(){return c.JWT}});var d=e.r(36126);Object.defineProperty(r,"Impersonated",{enumerable:!0,get:function(){return d.Impersonated}});var h=e.r(701);Object.defineProperty(r,"CodeChallengeMethod",{enumerable:!0,get:function(){return h.CodeChallengeMethod}}),Object.defineProperty(r,"OAuth2Client",{enumerable:!0,get:function(){return h.OAuth2Client}}),Object.defineProperty(r,"ClientAuthentication",{enumerable:!0,get:function(){return h.ClientAuthentication}});var p=e.r(42602);Object.defineProperty(r,"LoginTicket",{enumerable:!0,get:function(){return p.LoginTicket}});var f=e.r(16260);Object.defineProperty(r,"UserRefreshClient",{enumerable:!0,get:function(){return f.UserRefreshClient}});var g=e.r(90220);Object.defineProperty(r,"AwsClient",{enumerable:!0,get:function(){return g.AwsClient}});var m=e.r(87573);Object.defineProperty(r,"AwsRequestSigner",{enumerable:!0,get:function(){return m.AwsRequestSigner}});var y=e.r(76868);Object.defineProperty(r,"IdentityPoolClient",{enumerable:!0,get:function(){return y.IdentityPoolClient}});var v=e.r(45037);Object.defineProperty(r,"ExternalAccountClient",{enumerable:!0,get:function(){return v.ExternalAccountClient}});var _=e.r(6560);Object.defineProperty(r,"BaseExternalAccountClient",{enumerable:!0,get:function(){return _.BaseExternalAccountClient}});var b=e.r(56777);Object.defineProperty(r,"DownscopedClient",{enumerable:!0,get:function(){return b.DownscopedClient}});var E=e.r(23238);Object.defineProperty(r,"PluggableAuthClient",{enumerable:!0,get:function(){return E.PluggableAuthClient}}),Object.defineProperty(r,"ExecutableError",{enumerable:!0,get:function(){return E.ExecutableError}});var S=e.r(53534);Object.defineProperty(r,"PassThroughClient",{enumerable:!0,get:function(){return S.PassThroughClient}});var w=e.r(96299);Object.defineProperty(r,"DefaultTransporter",{enumerable:!0,get:function(){return w.DefaultTransporter}}),r.auth=new n.GoogleAuth},74836,(e,t,r)=>{"use strict";let n=["nodebuffer","arraybuffer","fragments"],i="undefined"!=typeof Blob;i&&n.push("blob"),t.exports={BINARY_TYPES:n,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:i,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},97970,(e,t,r)=>{"use strict";let{EMPTY_BUFFER:n}=e.r(74836),i=Buffer[Symbol.species];function s(e,t,r,n,i){for(let s=0;s<i;s++)r[n+s]=e[s]^t[3&s]}function o(e,t){for(let r=0;r<e.length;r++)e[r]^=t[3&r]}function a(e){let t;return(a.readOnly=!0,Buffer.isBuffer(e))?e:(e instanceof ArrayBuffer?t=new i(e):ArrayBuffer.isView(e)?t=new i(e.buffer,e.byteOffset,e.byteLength):(t=Buffer.from(e),a.readOnly=!1),t)}if(t.exports={concat:function(e,t){if(0===e.length)return n;if(1===e.length)return e[0];let r=Buffer.allocUnsafe(t),s=0;for(let t=0;t<e.length;t++){let n=e[t];r.set(n,s),s+=n.length}return s<t?new i(r.buffer,r.byteOffset,s):r},mask:s,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:a,unmask:o},!process.env.WS_NO_BUFFER_UTIL)try{let e=(()=>{let e=Error("Cannot find module 'bufferutil'");throw e.code="MODULE_NOT_FOUND",e})();t.exports.mask=function(t,r,n,i,o){o<48?s(t,r,n,i,o):e.mask(t,r,n,i,o)},t.exports.unmask=function(t,r){t.length<32?o(t,r):e.unmask(t,r)}}catch(e){}},62048,(e,t,r)=>{"use strict";let n=Symbol("kDone"),i=Symbol("kRun");t.exports=class{constructor(e){this[n]=()=>{this.pending--,this[i]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[i]()}[i](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[n])}}}},80295,(e,t,r)=>{"use strict";let n,i=e.r(6461),s=e.r(97970),o=e.r(62048),{kStatusCode:a}=e.r(74836),l=Buffer[Symbol.species],u=Buffer.from([0,0,255,255]),c=Symbol("permessage-deflate"),d=Symbol("total-length"),h=Symbol("callback"),p=Symbol("buffers"),f=Symbol("error");function g(e){this[p].push(e),this[d]+=e.length}function m(e){if(this[d]+=e.length,this[c]._maxPayload<1||this[d]<=this[c]._maxPayload)return void this[p].push(e);this[f]=RangeError("Max payload size exceeded"),this[f].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[f][a]=1009,this.removeListener("data",m),this.reset()}function y(e){if(this[c]._inflate=null,this[f])return void this[h](this[f]);e[a]=1007,this[h](e)}t.exports=class{constructor(e,t,r){this._maxPayload=0|r,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,n||(n=new o(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[h];this._deflate.close(),this._deflate=null,e&&e(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let t=this._options,r=e.find(e=>(!1!==t.serverNoContextTakeover||!e.server_no_context_takeover)&&(!e.server_max_window_bits||!1!==t.serverMaxWindowBits&&("number"!=typeof t.serverMaxWindowBits||!(t.serverMaxWindowBits>e.server_max_window_bits)))&&("number"!=typeof t.clientMaxWindowBits||!!e.client_max_window_bits));if(!r)throw Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(r.server_no_context_takeover=!0),t.clientNoContextTakeover&&(r.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(r.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?r.client_max_window_bits=t.clientMaxWindowBits:(!0===r.client_max_window_bits||!1===t.clientMaxWindowBits)&&delete r.client_max_window_bits,r}acceptAsClient(e){let t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach(e=>{Object.keys(e).forEach(t=>{let r=e[t];if(r.length>1)throw Error(`Parameter "${t}" must have only a single value`);if(r=r[0],"client_max_window_bits"===t){if(!0!==r){let e=+r;if(!Number.isInteger(e)||e<8||e>15)throw TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${t}": ${r}`)}else if("server_max_window_bits"===t){let e=+r;if(!Number.isInteger(e)||e<8||e>15)throw TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else if("client_no_context_takeover"===t||"server_no_context_takeover"===t){if(!0!==r)throw TypeError(`Invalid value for parameter "${t}": ${r}`)}else throw Error(`Unknown parameter "${t}"`);e[t]=r})}),e}decompress(e,t,r){n.add(n=>{this._decompress(e,t,(e,t)=>{n(),r(e,t)})})}compress(e,t,r){n.add(n=>{this._compress(e,t,(e,t)=>{n(),r(e,t)})})}_decompress(e,t,r){let n=this._isServer?"client":"server";if(!this._inflate){let e=`${n}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=i.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[c]=this,this._inflate[d]=0,this._inflate[p]=[],this._inflate.on("error",y),this._inflate.on("data",m)}this._inflate[h]=r,this._inflate.write(e),t&&this._inflate.write(u),this._inflate.flush(()=>{let e=this._inflate[f];if(e){this._inflate.close(),this._inflate=null,r(e);return}let i=s.concat(this._inflate[p],this._inflate[d]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[d]=0,this._inflate[p]=[],t&&this.params[`${n}_no_context_takeover`]&&this._inflate.reset()),r(null,i)})}_compress(e,t,r){let n=this._isServer?"server":"client";if(!this._deflate){let e=`${n}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=i.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[d]=0,this._deflate[p]=[],this._deflate.on("data",g)}this._deflate[h]=r,this._deflate.write(e),this._deflate.flush(i.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let e=s.concat(this._deflate[p],this._deflate[d]);t&&(e=new l(e.buffer,e.byteOffset,e.length-4)),this._deflate[h]=null,this._deflate[d]=0,this._deflate[p]=[],t&&this.params[`${n}_no_context_takeover`]&&this._deflate.reset(),r(null,e)})}}},58739,(e,t,r)=>{"use strict";let{isUtf8:n}=e.r(874),{hasBlob:i}=e.r(74836);function s(e){let t=e.length,r=0;for(;r<t;)if((128&e[r])==0)r++;else if((224&e[r])==192){if(r+1===t||(192&e[r+1])!=128||(254&e[r])==192)return!1;r+=2}else if((240&e[r])==224){if(r+2>=t||(192&e[r+1])!=128||(192&e[r+2])!=128||224===e[r]&&(224&e[r+1])==128||237===e[r]&&(224&e[r+1])==160)return!1;r+=3}else{if((248&e[r])!=240||r+3>=t||(192&e[r+1])!=128||(192&e[r+2])!=128||(192&e[r+3])!=128||240===e[r]&&(240&e[r+1])==128||244===e[r]&&e[r+1]>143||e[r]>244)return!1;r+=4}return!0}if(t.exports={isBlob:function(e){return i&&"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&("Blob"===e[Symbol.toStringTag]||"File"===e[Symbol.toStringTag])},isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:s,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},n)t.exports.isValidUTF8=function(e){return e.length<24?s(e):n(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let e=(()=>{let e=Error("Cannot find module 'utf-8-validate'");throw e.code="MODULE_NOT_FOUND",e})();t.exports.isValidUTF8=function(t){return t.length<32?s(t):e(t)}}catch(e){}},29485,(e,t,r)=>{"use strict";let{Writable:n}=e.r(88947),i=e.r(80295),{BINARY_TYPES:s,EMPTY_BUFFER:o,kStatusCode:a,kWebSocket:l}=e.r(74836),{concat:u,toArrayBuffer:c,unmask:d}=e.r(97970),{isValidStatusCode:h,isValidUTF8:p}=e.r(58739),f=Buffer[Symbol.species];t.exports=class extends n{constructor(e={}){super(),this._allowSynchronousEvents=void 0===e.allowSynchronousEvents||e.allowSynchronousEvents,this._binaryType=e.binaryType||s[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[l]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(e,t,r){if(8===this._opcode&&0==this._state)return r();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(r)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let t=this._buffers[0];return this._buffers[0]=new f(t.buffer,t.byteOffset+e,t.length-e),new f(t.buffer,t.byteOffset,e)}let t=Buffer.allocUnsafe(e);do{let r=this._buffers[0],n=t.length-e;e>=r.length?t.set(this._buffers.shift(),n):(t.set(new Uint8Array(r.buffer,r.byteOffset,e),n),this._buffers[0]=new f(r.buffer,r.byteOffset+e,r.length-e)),e-=r.length}while(e>0)return t}startLoop(e){this._loop=!0;do switch(this._state){case 0:this.getInfo(e);break;case 1:this.getPayloadLength16(e);break;case 2:this.getPayloadLength64(e);break;case 3:this.getMask();break;case 4:this.getData(e);break;case 5:case 6:this._loop=!1;return}while(this._loop)this._errored||e()}getInfo(e){if(this._bufferedBytes<2){this._loop=!1;return}let t=this.consume(2);if((48&t[0])!=0)return void e(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));let r=(64&t[0])==64;if(r&&!this._extensions[i.extensionName])return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._fin=(128&t[0])==128,this._opcode=15&t[0],this._payloadLength=127&t[1],0===this._opcode){if(r)return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(!this._fragmented)return void e(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));this._compressed=r}else{if(!(this._opcode>7)||!(this._opcode<11))return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));if(!this._fin)return void e(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));if(r)return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return void e(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&t[1])==128,this._isServer){if(!this._masked)return void e(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}else if(this._masked)return void e(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(e)}getPayloadLength16(e){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e)}getPayloadLength64(e){if(this._bufferedBytes<8){this._loop=!1;return}let t=this.consume(8),r=t.readUInt32BE(0);if(r>2097151)return void e(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH"));this._payloadLength=0x100000000*r+t.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return void e(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(e){let t=o;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}t=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!=0&&d(t,this._mask)}if(this._opcode>7)return void this.controlMessage(t,e);if(this._compressed){this._state=5,this.decompress(t,e);return}t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}decompress(e,t){this._extensions[i.extensionName].decompress(e,this._fin,(e,r)=>{if(e)return t(e);if(r.length){if(this._messageLength+=r.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return void t(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(r)}this.dataMessage(t),0===this._state&&this.startLoop(t)})}dataMessage(e){if(!this._fin){this._state=0;return}let t=this._messageLength,r=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let n;n="nodebuffer"===this._binaryType?u(r,t):"arraybuffer"===this._binaryType?c(u(r,t)):"blob"===this._binaryType?new Blob(r):r,this._allowSynchronousEvents?(this.emit("message",n,!0),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",n,!0),this._state=0,this.startLoop(e)}))}else{let n=u(r,t);if(!this._skipUTF8Validation&&!p(n))return void e(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));5===this._state||this._allowSynchronousEvents?(this.emit("message",n,!1),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",n,!1),this._state=0,this.startLoop(e)}))}}controlMessage(e,t){if(8===this._opcode){if(0===e.length)this._loop=!1,this.emit("conclude",1005,o),this.end();else{let r=e.readUInt16BE(0);if(!h(r))return void t(this.createError(RangeError,`invalid status code ${r}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE"));let n=new f(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!p(n))return void t(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));this._loop=!1,this.emit("conclude",r,n),this.end()}this._state=0;return}this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",e),this._state=0):(this._state=6,setImmediate(()=>{this.emit(9===this._opcode?"ping":"pong",e),this._state=0,this.startLoop(t)}))}createError(e,t,r,n,i){this._loop=!1,this._errored=!0;let s=new e(r?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(s,this.createError),s.code=i,s[a]=n,s}}},16735,(e,t,r)=>{"use strict";let n,{Duplex:i}=e.r(88947),{randomFillSync:s}=e.r(54799),o=e.r(80295),{EMPTY_BUFFER:a,kWebSocket:l,NOOP:u}=e.r(74836),{isBlob:c,isValidStatusCode:d}=e.r(58739),{mask:h,toBuffer:p}=e.r(97970),f=Symbol("kByteLength"),g=Buffer.alloc(4),m=8192;class y{constructor(e,t,r){this._extensions=t||{},r&&(this._generateMask=r,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=u,this[l]=void 0}static frame(e,t){let r,i,o=!1,a=2,l=!1;t.mask&&(r=t.maskBuffer||g,t.generateMask?t.generateMask(r):(8192===m&&(void 0===n&&(n=Buffer.alloc(8192)),s(n,0,8192),m=0),r[0]=n[m++],r[1]=n[m++],r[2]=n[m++],r[3]=n[m++]),l=(r[0]|r[1]|r[2]|r[3])==0,a=6),"string"==typeof e?i=(!t.mask||l)&&void 0!==t[f]?t[f]:(e=Buffer.from(e)).length:(i=e.length,o=t.mask&&t.readOnly&&!l);let u=i;i>=65536?(a+=8,u=127):i>125&&(a+=2,u=126);let c=Buffer.allocUnsafe(o?i+a:a);return(c[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(c[0]|=64),c[1]=u,126===u?c.writeUInt16BE(i,2):127===u&&(c[2]=c[3]=0,c.writeUIntBE(i,4,6)),t.mask)?(c[1]|=128,c[a-4]=r[0],c[a-3]=r[1],c[a-2]=r[2],c[a-1]=r[3],l)?[c,e]:o?(h(e,r,c,a,i),[c]):(h(e,r,e,0,i),[c,e]):[c,e]}close(e,t,r,n){let i;if(void 0===e)i=a;else if("number"==typeof e&&d(e))if(void 0!==t&&t.length){let r=Buffer.byteLength(t);if(r>123)throw RangeError("The message must not be greater than 123 bytes");(i=Buffer.allocUnsafe(2+r)).writeUInt16BE(e,0),"string"==typeof t?i.write(t,2):i.set(t,2)}else(i=Buffer.allocUnsafe(2)).writeUInt16BE(e,0);else throw TypeError("First argument must be a valid error code number");let s={[f]:i.length,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,i,!1,s,n]):this.sendFrame(y.frame(i,s),n)}ping(e,t,r){let n,i;if("string"==typeof e?(n=Buffer.byteLength(e),i=!1):c(e)?(n=e.size,i=!1):(n=(e=p(e)).length,i=p.readOnly),n>125)throw RangeError("The data size must not be greater than 125 bytes");let s={[f]:n,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:i,rsv1:!1};c(e)?0!==this._state?this.enqueue([this.getBlobData,e,!1,s,r]):this.getBlobData(e,!1,s,r):0!==this._state?this.enqueue([this.dispatch,e,!1,s,r]):this.sendFrame(y.frame(e,s),r)}pong(e,t,r){let n,i;if("string"==typeof e?(n=Buffer.byteLength(e),i=!1):c(e)?(n=e.size,i=!1):(n=(e=p(e)).length,i=p.readOnly),n>125)throw RangeError("The data size must not be greater than 125 bytes");let s={[f]:n,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:i,rsv1:!1};c(e)?0!==this._state?this.enqueue([this.getBlobData,e,!1,s,r]):this.getBlobData(e,!1,s,r):0!==this._state?this.enqueue([this.dispatch,e,!1,s,r]):this.sendFrame(y.frame(e,s),r)}send(e,t,r){let n,i,s=this._extensions[o.extensionName],a=t.binary?2:1,l=t.compress;"string"==typeof e?(n=Buffer.byteLength(e),i=!1):c(e)?(n=e.size,i=!1):(n=(e=p(e)).length,i=p.readOnly),this._firstFragment?(this._firstFragment=!1,l&&s&&s.params[s._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(l=n>=s._threshold),this._compress=l):(l=!1,a=0),t.fin&&(this._firstFragment=!0);let u={[f]:n,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:i,rsv1:l};c(e)?0!==this._state?this.enqueue([this.getBlobData,e,this._compress,u,r]):this.getBlobData(e,this._compress,u,r):0!==this._state?this.enqueue([this.dispatch,e,this._compress,u,r]):this.dispatch(e,this._compress,u,r)}getBlobData(e,t,r,n){this._bufferedBytes+=r[f],this._state=2,e.arrayBuffer().then(e=>{if(this._socket.destroyed){let e=Error("The socket was closed while the blob was being read");process.nextTick(v,this,e,n);return}this._bufferedBytes-=r[f];let i=p(e);t?this.dispatch(i,t,r,n):(this._state=0,this.sendFrame(y.frame(i,r),n),this.dequeue())}).catch(e=>{process.nextTick(_,this,e,n)})}dispatch(e,t,r,n){if(!t)return void this.sendFrame(y.frame(e,r),n);let i=this._extensions[o.extensionName];this._bufferedBytes+=r[f],this._state=1,i.compress(e,r.fin,(e,t)=>{if(this._socket.destroyed)return void v(this,Error("The socket was closed while data was being compressed"),n);this._bufferedBytes-=r[f],this._state=0,r.readOnly=!1,this.sendFrame(y.frame(t,r),n),this.dequeue()})}dequeue(){for(;0===this._state&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][f],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][f],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}function v(e,t,r){"function"==typeof r&&r(t);for(let r=0;r<e._queue.length;r++){let n=e._queue[r],i=n[n.length-1];"function"==typeof i&&i(t)}}function _(e,t,r){v(e,t,r),e.onerror(t)}t.exports=y},70494,(e,t,r)=>{"use strict";let{kForOnEventAttribute:n,kListener:i}=e.r(74836),s=Symbol("kCode"),o=Symbol("kData"),a=Symbol("kError"),l=Symbol("kMessage"),u=Symbol("kReason"),c=Symbol("kTarget"),d=Symbol("kType"),h=Symbol("kWasClean");class p{constructor(e){this[c]=null,this[d]=e}get target(){return this[c]}get type(){return this[d]}}Object.defineProperty(p.prototype,"target",{enumerable:!0}),Object.defineProperty(p.prototype,"type",{enumerable:!0});class f extends p{constructor(e,t={}){super(e),this[s]=void 0===t.code?0:t.code,this[u]=void 0===t.reason?"":t.reason,this[h]=void 0!==t.wasClean&&t.wasClean}get code(){return this[s]}get reason(){return this[u]}get wasClean(){return this[h]}}Object.defineProperty(f.prototype,"code",{enumerable:!0}),Object.defineProperty(f.prototype,"reason",{enumerable:!0}),Object.defineProperty(f.prototype,"wasClean",{enumerable:!0});class g extends p{constructor(e,t={}){super(e),this[a]=void 0===t.error?null:t.error,this[l]=void 0===t.message?"":t.message}get error(){return this[a]}get message(){return this[l]}}Object.defineProperty(g.prototype,"error",{enumerable:!0}),Object.defineProperty(g.prototype,"message",{enumerable:!0});class m extends p{constructor(e,t={}){super(e),this[o]=void 0===t.data?null:t.data}get data(){return this[o]}}function y(e,t,r){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,r):e.call(t,r)}Object.defineProperty(m.prototype,"data",{enumerable:!0}),t.exports={CloseEvent:f,ErrorEvent:g,Event:p,EventTarget:{addEventListener(e,t,r={}){let s;for(let s of this.listeners(e))if(!r[n]&&s[i]===t&&!s[n])return;if("message"===e)s=function(e,r){let n=new m("message",{data:r?e:e.toString()});n[c]=this,y(t,this,n)};else if("close"===e)s=function(e,r){let n=new f("close",{code:e,reason:r.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});n[c]=this,y(t,this,n)};else if("error"===e)s=function(e){let r=new g("error",{error:e,message:e.message});r[c]=this,y(t,this,r)};else{if("open"!==e)return;s=function(){let e=new p("open");e[c]=this,y(t,this,e)}}s[n]=!!r[n],s[i]=t,r.once?this.once(e,s):this.on(e,s)},removeEventListener(e,t){for(let r of this.listeners(e))if(r[i]===t&&!r[n]){this.removeListener(e,r);break}}},MessageEvent:m}},96903,(e,t,r)=>{"use strict";let{tokenChars:n}=e.r(58739);function i(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}t.exports={format:function(e){return Object.keys(e).map(t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map(e=>[t].concat(Object.keys(e).map(t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map(e=>!0===e?t:`${t}=${e}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(e){let t,r,s=Object.create(null),o=Object.create(null),a=!1,l=!1,u=!1,c=-1,d=-1,h=-1,p=0;for(;p<e.length;p++)if(d=e.charCodeAt(p),void 0===t)if(-1===h&&1===n[d])-1===c&&(c=p);else if(0!==p&&(32===d||9===d))-1===h&&-1!==c&&(h=p);else if(59===d||44===d){if(-1===c)throw SyntaxError(`Unexpected character at index ${p}`);-1===h&&(h=p);let r=e.slice(c,h);44===d?(i(s,r,o),o=Object.create(null)):t=r,c=h=-1}else throw SyntaxError(`Unexpected character at index ${p}`);else if(void 0===r)if(-1===h&&1===n[d])-1===c&&(c=p);else if(32===d||9===d)-1===h&&-1!==c&&(h=p);else if(59===d||44===d){if(-1===c)throw SyntaxError(`Unexpected character at index ${p}`);-1===h&&(h=p),i(o,e.slice(c,h),!0),44===d&&(i(s,t,o),o=Object.create(null),t=void 0),c=h=-1}else if(61===d&&-1!==c&&-1===h)r=e.slice(c,p),c=h=-1;else throw SyntaxError(`Unexpected character at index ${p}`);else if(l){if(1!==n[d])throw SyntaxError(`Unexpected character at index ${p}`);-1===c?c=p:a||(a=!0),l=!1}else if(u)if(1===n[d])-1===c&&(c=p);else if(34===d&&-1!==c)u=!1,h=p;else if(92===d)l=!0;else throw SyntaxError(`Unexpected character at index ${p}`);else if(34===d&&61===e.charCodeAt(p-1))u=!0;else if(-1===h&&1===n[d])-1===c&&(c=p);else if(-1!==c&&(32===d||9===d))-1===h&&(h=p);else if(59===d||44===d){if(-1===c)throw SyntaxError(`Unexpected character at index ${p}`);-1===h&&(h=p);let n=e.slice(c,h);a&&(n=n.replace(/\\/g,""),a=!1),i(o,r,n),44===d&&(i(s,t,o),o=Object.create(null),t=void 0),r=void 0,c=h=-1}else throw SyntaxError(`Unexpected character at index ${p}`);if(-1===c||u||32===d||9===d)throw SyntaxError("Unexpected end of input");-1===h&&(h=p);let f=e.slice(c,h);return void 0===t?i(s,f,o):(void 0===r?i(o,f,!0):a?i(o,r,f.replace(/\\/g,"")):i(o,r,f),i(s,t,o)),s}}},35065,(e,t,r)=>{"use strict";let n=e.r(27699),i=e.r(24836),s=e.r(21517),o=e.r(4446),a=e.r(55004),{randomBytes:l,createHash:u}=e.r(54799),{Duplex:c,Readable:d}=e.r(88947),{URL:h}=e.r(92509),p=e.r(80295),f=e.r(29485),g=e.r(16735),{isBlob:m}=e.r(58739),{BINARY_TYPES:y,EMPTY_BUFFER:v,GUID:_,kForOnEventAttribute:b,kListener:E,kStatusCode:S,kWebSocket:w,NOOP:T}=e.r(74836),{EventTarget:{addEventListener:C,removeEventListener:A}}=e.r(70494),{format:O,parse:x}=e.r(96903),{toBuffer:I}=e.r(97970),k=Symbol("kAborted"),R=[8,13],P=["CONNECTING","OPEN","CLOSING","CLOSED"],N=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class D extends n{constructor(e,t,r){super(),this._binaryType=y[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=v,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=D.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(r=t,t=[]):t=[t]),function e(t,r,n,o){let a,c,d,f,g={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:R[1],maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...o,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(t._autoPong=g.autoPong,!R.includes(g.protocolVersion))throw RangeError(`Unsupported protocol version: ${g.protocolVersion} (supported versions: ${R.join(", ")})`);if(r instanceof h)a=r;else try{a=new h(r)}catch(e){throw SyntaxError(`Invalid URL: ${r}`)}"http:"===a.protocol?a.protocol="ws:":"https:"===a.protocol&&(a.protocol="wss:"),t._url=a.href;let m="wss:"===a.protocol,y="ws+unix:"===a.protocol;if("ws:"===a.protocol||m||y?y&&!a.pathname?c="The URL's pathname is empty":a.hash&&(c="The URL contains a fragment identifier"):c='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"',c){let e=SyntaxError(c);if(0!==t._redirects)return void M(t,e);throw e}let v=m?443:80,b=l(16).toString("base64"),E=m?i.request:s.request,S=new Set;if(g.createConnection=g.createConnection||(m?U:j),g.defaultPort=g.defaultPort||v,g.port=a.port||v,g.host=a.hostname.startsWith("[")?a.hostname.slice(1,-1):a.hostname,g.headers={...g.headers,"Sec-WebSocket-Version":g.protocolVersion,"Sec-WebSocket-Key":b,Connection:"Upgrade",Upgrade:"websocket"},g.path=a.pathname+a.search,g.timeout=g.handshakeTimeout,g.perMessageDeflate&&(d=new p(!0!==g.perMessageDeflate?g.perMessageDeflate:{},!1,g.maxPayload),g.headers["Sec-WebSocket-Extensions"]=O({[p.extensionName]:d.offer()})),n.length){for(let e of n){if("string"!=typeof e||!N.test(e)||S.has(e))throw SyntaxError("An invalid or duplicated subprotocol was specified");S.add(e)}g.headers["Sec-WebSocket-Protocol"]=n.join(",")}if(g.origin&&(g.protocolVersion<13?g.headers["Sec-WebSocket-Origin"]=g.origin:g.headers.Origin=g.origin),(a.username||a.password)&&(g.auth=`${a.username}:${a.password}`),y){let e=g.path.split(":");g.socketPath=e[0],g.path=e[1]}if(g.followRedirects){if(0===t._redirects){t._originalIpc=y,t._originalSecure=m,t._originalHostOrSocketPath=y?g.socketPath:a.host;let e=o&&o.headers;if(o={...o,headers:{}},e)for(let[t,r]of Object.entries(e))o.headers[t.toLowerCase()]=r}else if(0===t.listenerCount("redirect")){let e=y?!!t._originalIpc&&g.socketPath===t._originalHostOrSocketPath:!t._originalIpc&&a.host===t._originalHostOrSocketPath;e&&(!t._originalSecure||m)||(delete g.headers.authorization,delete g.headers.cookie,e||delete g.headers.host,g.auth=void 0)}g.auth&&!o.headers.authorization&&(o.headers.authorization="Basic "+Buffer.from(g.auth).toString("base64")),f=t._req=E(g),t._redirects&&t.emit("redirect",t.url,f)}else f=t._req=E(g);g.timeout&&f.on("timeout",()=>{L(t,f,"Opening handshake has timed out")}),f.on("error",e=>{null===f||f[k]||(f=t._req=null,M(t,e))}),f.on("response",i=>{let s=i.headers.location,a=i.statusCode;if(s&&g.followRedirects&&a>=300&&a<400){let i;if(++t._redirects>g.maxRedirects)return void L(t,f,"Maximum redirects exceeded");f.abort();try{i=new h(s,r)}catch(e){M(t,SyntaxError(`Invalid URL: ${s}`));return}e(t,i,n,o)}else t.emit("unexpected-response",f,i)||L(t,f,`Unexpected server response: ${i.statusCode}`)}),f.on("upgrade",(e,r,n)=>{let i;if(t.emit("upgrade",e),t.readyState!==D.CONNECTING)return;f=t._req=null;let s=e.headers.upgrade;if(void 0===s||"websocket"!==s.toLowerCase())return void L(t,r,"Invalid Upgrade header");let o=u("sha1").update(b+_).digest("base64");if(e.headers["sec-websocket-accept"]!==o)return void L(t,r,"Invalid Sec-WebSocket-Accept header");let a=e.headers["sec-websocket-protocol"];if(void 0!==a?S.size?S.has(a)||(i="Server sent an invalid subprotocol"):i="Server sent a subprotocol but none was requested":S.size&&(i="Server sent no subprotocol"),i)return void L(t,r,i);a&&(t._protocol=a);let l=e.headers["sec-websocket-extensions"];if(void 0!==l){let e;if(!d)return void L(t,r,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");try{e=x(l)}catch(e){L(t,r,"Invalid Sec-WebSocket-Extensions header");return}let n=Object.keys(e);if(1!==n.length||n[0]!==p.extensionName)return void L(t,r,"Server indicated an extension that was not requested");try{d.accept(e[p.extensionName])}catch(e){L(t,r,"Invalid Sec-WebSocket-Extensions header");return}t._extensions[p.extensionName]=d}t.setSocket(r,n,{allowSynchronousEvents:g.allowSynchronousEvents,generateMask:g.generateMask,maxPayload:g.maxPayload,skipUTF8Validation:g.skipUTF8Validation})}),g.finishRequest?g.finishRequest(f,t):f.end()}(this,e,t,r)):(this._autoPong=r.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){y.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,r){let n=new f({allowSynchronousEvents:r.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:r.maxPayload,skipUTF8Validation:r.skipUTF8Validation}),i=new g(e,this._extensions,r.generateMask);this._receiver=n,this._sender=i,this._socket=e,n[w]=this,i[w]=this,e[w]=this,n.on("conclude",B),n.on("drain",q),n.on("error",G),n.on("message",$),n.on("ping",V),n.on("pong",K),i.onerror=J,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",Y),e.on("data",Z),e.on("end",X),e.on("error",Q),this._readyState=D.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=D.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[p.extensionName]&&this._extensions[p.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=D.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==D.CLOSED){if(this.readyState===D.CONNECTING)return void L(this,this._req,"WebSocket was closed before the connection was established");if(this.readyState===D.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=D.CLOSING,this._sender.close(e,t,!this._isServer,e=>{!e&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),W(this)}}pause(){this.readyState!==D.CONNECTING&&this.readyState!==D.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,r){if(this.readyState===D.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState!==D.OPEN)return void F(this,e,r);void 0===t&&(t=!this._isServer),this._sender.ping(e||v,t,r)}pong(e,t,r){if(this.readyState===D.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState!==D.OPEN)return void F(this,e,r);void 0===t&&(t=!this._isServer),this._sender.pong(e||v,t,r)}resume(){this.readyState!==D.CONNECTING&&this.readyState!==D.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,r){if(this.readyState===D.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(r=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==D.OPEN)return void F(this,e,r);let n={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[p.extensionName]||(n.compress=!1),this._sender.send(e||v,n,r)}terminate(){if(this.readyState!==D.CLOSED){if(this.readyState===D.CONNECTING)return void L(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=D.CLOSING,this._socket.destroy())}}}function M(e,t){e._readyState=D.CLOSING,e._errorEmitted=!0,e.emit("error",t),e.emitClose()}function j(e){return e.path=e.socketPath,o.connect(e)}function U(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=o.isIP(e.host)?"":e.host),a.connect(e)}function L(e,t,r){e._readyState=D.CLOSING;let n=Error(r);Error.captureStackTrace(n,L),t.setHeader?(t[k]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(M,e,n)):(t.destroy(n),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function F(e,t,r){if(t){let r=m(t)?t.size:I(t).length;e._socket?e._sender._bufferedBytes+=r:e._bufferedAmount+=r}if(r){let t=Error(`WebSocket is not open: readyState ${e.readyState} (${P[e.readyState]})`);process.nextTick(r,t)}}function B(e,t){let r=this[w];r._closeFrameReceived=!0,r._closeMessage=t,r._closeCode=e,void 0!==r._socket[w]&&(r._socket.removeListener("data",Z),process.nextTick(z,r._socket),1005===e?r.close():r.close(e,t))}function q(){let e=this[w];e.isPaused||e._socket.resume()}function G(e){let t=this[w];void 0!==t._socket[w]&&(t._socket.removeListener("data",Z),process.nextTick(z,t._socket),t.close(e[S])),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e))}function H(){this[w].emitClose()}function $(e,t){this[w].emit("message",e,t)}function V(e){let t=this[w];t._autoPong&&t.pong(e,!this._isServer,T),t.emit("ping",e)}function K(e){this[w].emit("pong",e)}function z(e){e.resume()}function J(e){let t=this[w];t.readyState!==D.CLOSED&&(t.readyState===D.OPEN&&(t._readyState=D.CLOSING,W(t)),this._socket.end(),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e)))}function W(e){e._closeTimer=setTimeout(e._socket.destroy.bind(e._socket),3e4)}function Y(){let e,t=this[w];this.removeListener("close",Y),this.removeListener("data",Z),this.removeListener("end",X),t._readyState=D.CLOSING,this._readableState.endEmitted||t._closeFrameReceived||t._receiver._writableState.errorEmitted||null===(e=t._socket.read())||t._receiver.write(e),t._receiver.end(),this[w]=void 0,clearTimeout(t._closeTimer),t._receiver._writableState.finished||t._receiver._writableState.errorEmitted?t.emitClose():(t._receiver.on("error",H),t._receiver.on("finish",H))}function Z(e){this[w]._receiver.write(e)||this.pause()}function X(){let e=this[w];e._readyState=D.CLOSING,e._receiver.end(),this.end()}function Q(){let e=this[w];this.removeListener("error",Q),this.on("error",T),e&&(e._readyState=D.CLOSING,this.destroy())}Object.defineProperty(D,"CONNECTING",{enumerable:!0,value:P.indexOf("CONNECTING")}),Object.defineProperty(D.prototype,"CONNECTING",{enumerable:!0,value:P.indexOf("CONNECTING")}),Object.defineProperty(D,"OPEN",{enumerable:!0,value:P.indexOf("OPEN")}),Object.defineProperty(D.prototype,"OPEN",{enumerable:!0,value:P.indexOf("OPEN")}),Object.defineProperty(D,"CLOSING",{enumerable:!0,value:P.indexOf("CLOSING")}),Object.defineProperty(D.prototype,"CLOSING",{enumerable:!0,value:P.indexOf("CLOSING")}),Object.defineProperty(D,"CLOSED",{enumerable:!0,value:P.indexOf("CLOSED")}),Object.defineProperty(D.prototype,"CLOSED",{enumerable:!0,value:P.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(e=>{Object.defineProperty(D.prototype,e,{enumerable:!0})}),["open","error","close","message"].forEach(e=>{Object.defineProperty(D.prototype,`on${e}`,{enumerable:!0,get(){for(let t of this.listeners(e))if(t[b])return t[E];return null},set(t){for(let t of this.listeners(e))if(t[b]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[b]:!0})}})}),D.prototype.addEventListener=C,D.prototype.removeEventListener=A,t.exports=D},21365,(e,t,r)=>{"use strict";e.r(35065);let{Duplex:n}=e.r(88947);function i(e){e.emit("close")}function s(){!this.destroyed&&this._writableState.finished&&this.destroy()}function o(e){this.removeListener("error",o),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}t.exports=function(e,t){let r=!0,a=new n({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",function(t,r){let n=!r&&a._readableState.objectMode?t.toString():t;a.push(n)||e.pause()}),e.once("error",function(e){a.destroyed||(r=!1,a.destroy(e))}),e.once("close",function(){a.destroyed||a.push(null)}),a._destroy=function(t,n){if(e.readyState===e.CLOSED){n(t),process.nextTick(i,a);return}let s=!1;e.once("error",function(e){s=!0,n(e)}),e.once("close",function(){s||n(t),process.nextTick(i,a)}),r&&e.terminate()},a._final=function(t){if(e.readyState===e.CONNECTING)return void e.once("open",function(){a._final(t)});null!==e._socket&&(e._socket._writableState.finished?(t(),a._readableState.endEmitted&&a.destroy()):(e._socket.once("finish",function(){t()}),e.close()))},a._read=function(){e.isPaused&&e.resume()},a._write=function(t,r,n){if(e.readyState===e.CONNECTING)return void e.once("open",function(){a._write(t,r,n)});e.send(t,n)},a.on("end",s),a.on("error",o),a}},42977,(e,t,r)=>{"use strict";let{tokenChars:n}=e.r(58739);t.exports={parse:function(e){let t=new Set,r=-1,i=-1,s=0;for(;s<e.length;s++){let o=e.charCodeAt(s);if(-1===i&&1===n[o])-1===r&&(r=s);else if(0!==s&&(32===o||9===o))-1===i&&-1!==r&&(i=s);else if(44===o){if(-1===r)throw SyntaxError(`Unexpected character at index ${s}`);-1===i&&(i=s);let n=e.slice(r,i);if(t.has(n))throw SyntaxError(`The "${n}" subprotocol is duplicated`);t.add(n),r=i=-1}else throw SyntaxError(`Unexpected character at index ${s}`)}if(-1===r||-1!==i)throw SyntaxError("Unexpected end of input");let o=e.slice(r,s);if(t.has(o))throw SyntaxError(`The "${o}" subprotocol is duplicated`);return t.add(o),t}}},17198,(e,t,r)=>{"use strict";let n=e.r(27699),i=e.r(21517),{Duplex:s}=e.r(88947),{createHash:o}=e.r(54799),a=e.r(96903),l=e.r(80295),u=e.r(42977),c=e.r(35065),{GUID:d,kWebSocket:h}=e.r(74836),p=/^[+/0-9A-Za-z]{22}==$/;function f(e){e._state=2,e.emit("close")}function g(){this.destroy()}function m(e,t,r,n){r=r||i.STATUS_CODES[t],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...n},e.once("finish",e.destroy),e.end(`HTTP/1.1 ${t} ${i.STATUS_CODES[t]}\r
`+Object.keys(n).map(e=>`${e}: ${n[e]}`).join("\r\n")+"\r\n\r\n"+r)}function y(e,t,r,n,i,s){if(e.listenerCount("wsClientError")){let n=Error(i);Error.captureStackTrace(n,y),e.emit("wsClientError",n,r,t)}else m(r,n,i,s)}t.exports=class extends n{constructor(e,t){if(super(),null==(e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:c,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=i.createServer((e,t)=>{let r=i.STATUS_CODES[426];t.writeHead(426,{"Content-Length":r.length,"Content-Type":"text/plain"}),t.end(r)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){let e=this.emit.bind(this,"connection");this._removeListeners=function(e,t){for(let r of Object.keys(t))e.on(r,t[r]);return function(){for(let r of Object.keys(t))e.removeListener(r,t[r])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,r,n)=>{this.handleUpgrade(t,r,n,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(2===this._state){e&&this.once("close",()=>{e(Error("The server is not running"))}),process.nextTick(f,this);return}if(e&&this.once("close",e),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(f,this);else{let e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close(()=>{f(this)})}}shouldHandle(e){if(this.options.path){let t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,r,n){t.on("error",g);let i=e.headers["sec-websocket-key"],s=e.headers.upgrade,o=+e.headers["sec-websocket-version"];if("GET"!==e.method)return void y(this,e,t,405,"Invalid HTTP method");if(void 0===s||"websocket"!==s.toLowerCase())return void y(this,e,t,400,"Invalid Upgrade header");if(void 0===i||!p.test(i))return void y(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");if(13!==o&&8!==o)return void y(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});if(!this.shouldHandle(e))return void m(t,400);let c=e.headers["sec-websocket-protocol"],d=new Set;if(void 0!==c)try{d=u.parse(c)}catch(r){y(this,e,t,400,"Invalid Sec-WebSocket-Protocol header");return}let h=e.headers["sec-websocket-extensions"],f={};if(this.options.perMessageDeflate&&void 0!==h){let r=new l(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let e=a.parse(h);e[l.extensionName]&&(r.accept(e[l.extensionName]),f[l.extensionName]=r)}catch(r){y(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let s={origin:e.headers[`${8===o?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(s,(s,o,a,l)=>{if(!s)return m(t,o||401,a,l);this.completeUpgrade(f,i,d,e,t,r,n)});if(!this.options.verifyClient(s))return m(t,401)}this.completeUpgrade(f,i,d,e,t,r,n)}completeUpgrade(e,t,r,n,i,s,u){if(!i.readable||!i.writable)return i.destroy();if(i[h])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return m(i,503);let c=o("sha1").update(t+d).digest("base64"),p=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${c}`],y=new this.options.WebSocket(null,void 0,this.options);if(r.size){let e=this.options.handleProtocols?this.options.handleProtocols(r,n):r.values().next().value;e&&(p.push(`Sec-WebSocket-Protocol: ${e}`),y._protocol=e)}if(e[l.extensionName]){let t=e[l.extensionName].params,r=a.format({[l.extensionName]:[t]});p.push(`Sec-WebSocket-Extensions: ${r}`),y._extensions=e}this.emit("headers",p,n),i.write(p.concat("\r\n").join("\r\n")),i.removeListener("error",g),y.setSocket(i,s,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(y),y.on("close",()=>{this.clients.delete(y),this._shouldEmitClose&&!this.clients.size&&process.nextTick(f,this)})),u(y,n)}}},97365,e=>{"use strict";let t,r,n,i,s;e.s(["handler",()=>lA,"patchFetch",()=>lC,"routeModule",()=>lE,"serverHooks",()=>lT,"workAsyncStorage",()=>lS,"workUnitAsyncStorage",()=>lw],97365);var o,a,l,u,c,d,h,p,f,g,m,y,v,_,b,E,S,w,T,C,A,O,x,I,k,R,P,N,D,M,j,U,L,F,B,q,G,H,$,V,K,z,J,W,Y,Z,X,Q,ee,et,er,en,ei,es,eo=e.i(47909),ea=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({}),el=function(e){return e.handleRequest="BaseServer.handleRequest",e.run="BaseServer.run",e.pipe="BaseServer.pipe",e.getStaticHTML="BaseServer.getStaticHTML",e.render="BaseServer.render",e.renderToResponseWithComponents="BaseServer.renderToResponseWithComponents",e.renderToResponse="BaseServer.renderToResponse",e.renderToHTML="BaseServer.renderToHTML",e.renderError="BaseServer.renderError",e.renderErrorToResponse="BaseServer.renderErrorToResponse",e.renderErrorToHTML="BaseServer.renderErrorToHTML",e.render404="BaseServer.render404",e}(el||{}),eu=function(e){return e.loadDefaultErrorComponents="LoadComponents.loadDefaultErrorComponents",e.loadComponents="LoadComponents.loadComponents",e}(eu||{}),ec=function(e){return e.getRequestHandler="NextServer.getRequestHandler",e.getServer="NextServer.getServer",e.getServerRequestHandler="NextServer.getServerRequestHandler",e.createServer="createServer.createServer",e}(ec||{}),ed=function(e){return e.compression="NextNodeServer.compression",e.getBuildId="NextNodeServer.getBuildId",e.createComponentTree="NextNodeServer.createComponentTree",e.clientComponentLoading="NextNodeServer.clientComponentLoading",e.getLayoutOrPageModule="NextNodeServer.getLayoutOrPageModule",e.generateStaticRoutes="NextNodeServer.generateStaticRoutes",e.generateFsStaticRoutes="NextNodeServer.generateFsStaticRoutes",e.generatePublicRoutes="NextNodeServer.generatePublicRoutes",e.generateImageRoutes="NextNodeServer.generateImageRoutes.route",e.sendRenderResult="NextNodeServer.sendRenderResult",e.proxyRequest="NextNodeServer.proxyRequest",e.runApi="NextNodeServer.runApi",e.render="NextNodeServer.render",e.renderHTML="NextNodeServer.renderHTML",e.imageOptimizer="NextNodeServer.imageOptimizer",e.getPagePath="NextNodeServer.getPagePath",e.getRoutesManifest="NextNodeServer.getRoutesManifest",e.findPageComponents="NextNodeServer.findPageComponents",e.getFontManifest="NextNodeServer.getFontManifest",e.getServerComponentManifest="NextNodeServer.getServerComponentManifest",e.getRequestHandler="NextNodeServer.getRequestHandler",e.renderToHTML="NextNodeServer.renderToHTML",e.renderError="NextNodeServer.renderError",e.renderErrorToHTML="NextNodeServer.renderErrorToHTML",e.render404="NextNodeServer.render404",e.startResponse="NextNodeServer.startResponse",e.route="route",e.onProxyReq="onProxyReq",e.apiResolver="apiResolver",e.internalFetch="internalFetch",e}(ed||{}),eh=function(e){return e.startServer="startServer.startServer",e}(eh||{}),ep=function(e){return e.getServerSideProps="Render.getServerSideProps",e.getStaticProps="Render.getStaticProps",e.renderToString="Render.renderToString",e.renderDocument="Render.renderDocument",e.createBodyResult="Render.createBodyResult",e}(ep||{}),ef=function(e){return e.renderToString="AppRender.renderToString",e.renderToReadableStream="AppRender.renderToReadableStream",e.getBodyResult="AppRender.getBodyResult",e.fetch="AppRender.fetch",e}(ef||{}),eg=function(e){return e.executeRoute="Router.executeRoute",e}(eg||{}),em=function(e){return e.runHandler="Node.runHandler",e}(em||{}),ey=function(e){return e.runHandler="AppRouteRouteHandlers.runHandler",e}(ey||{}),ev=function(e){return e.generateMetadata="ResolveMetadata.generateMetadata",e.generateViewport="ResolveMetadata.generateViewport",e}(ev||{}),e_=function(e){return e.execute="Middleware.execute",e}(e_||{});let eb=["Middleware.execute","BaseServer.handleRequest","Render.getServerSideProps","Render.getStaticProps","AppRender.fetch","AppRender.getBodyResult","Render.renderDocument","Node.runHandler","AppRouteRouteHandlers.runHandler","ResolveMetadata.generateMetadata","ResolveMetadata.generateViewport","NextNodeServer.createComponentTree","NextNodeServer.findPageComponents","NextNodeServer.getLayoutOrPageModule","NextNodeServer.startResponse","NextNodeServer.clientComponentLoading"],eE=["NextNodeServer.findPageComponents","NextNodeServer.createComponentTree","NextNodeServer.clientComponentLoading"];try{t=e.r(7896)}catch(r){t=e.r(17413)}let{context:eS,propagation:ew,trace:eT,SpanStatusCode:eC,SpanKind:eA,ROOT_CONTEXT:eO}=t;class ex extends Error{constructor(e,t){super(),this.bubble=e,this.result=t}}let eI=(e,t)=>{(function(e){return"object"==typeof e&&null!==e&&e instanceof ex})(t)&&t.bubble?e.setAttribute("next.bubble",!0):(t&&(e.recordException(t),e.setAttribute("error.type",t.name)),e.setStatus({code:eC.ERROR,message:null==t?void 0:t.message})),e.end()},ek=new Map,eR=t.createContextKey("next.rootSpanId"),eP=0,eN={set(e,t,r){e.push({key:t,value:r})}};class eD{getTracerInstance(){return eT.getTracer("next.js","0.0.1")}getContext(){return eS}getTracePropagationData(){let e=eS.active(),t=[];return ew.inject(e,t,eN),t}getActiveScopeSpan(){return eT.getSpan(null==eS?void 0:eS.active())}withPropagatedContext(e,t,r){let n=eS.active();if(eT.getSpanContext(n))return t();let i=ew.extract(n,e,r);return eS.with(i,t)}trace(...e){var t;let[r,n,i]=e,{fn:s,options:o}="function"==typeof n?{fn:n,options:{}}:{fn:i,options:{...n}},a=o.spanName??r;if(!eb.includes(r)&&"1"!==process.env.NEXT_OTEL_VERBOSE||o.hideSpan)return s();let l=this.getSpanContext((null==o?void 0:o.parentSpan)??this.getActiveScopeSpan()),u=!1;l?(null==(t=eT.getSpanContext(l))?void 0:t.isRemote)&&(u=!0):(l=(null==eS?void 0:eS.active())??eO,u=!0);let c=eP++;return o.attributes={"next.span_name":a,"next.span_type":r,...o.attributes},eS.with(l.setValue(eR,c),()=>this.getTracerInstance().startActiveSpan(a,o,e=>{let t="performance"in globalThis&&"measure"in performance?globalThis.performance.now():void 0,n=()=>{ek.delete(c),t&&process.env.NEXT_OTEL_PERFORMANCE_PREFIX&&eE.includes(r||"")&&performance.measure(`${process.env.NEXT_OTEL_PERFORMANCE_PREFIX}:next-${(r.split(".").pop()||"").replace(/[A-Z]/g,e=>"-"+e.toLowerCase())}`,{start:t,end:performance.now()})};u&&ek.set(c,new Map(Object.entries(o.attributes??{})));try{if(s.length>1)return s(e,t=>eI(e,t));let t=s(e);if(null!==t&&"object"==typeof t&&"then"in t&&"function"==typeof t.then)return t.then(t=>(e.end(),t)).catch(t=>{throw eI(e,t),t}).finally(n);return e.end(),n(),t}catch(t){throw eI(e,t),n(),t}}))}wrap(...e){let t=this,[r,n,i]=3===e.length?e:[e[0],{},e[1]];return eb.includes(r)||"1"===process.env.NEXT_OTEL_VERBOSE?function(){let e=n;"function"==typeof e&&"function"==typeof i&&(e=e.apply(this,arguments));let s=arguments.length-1,o=arguments[s];if("function"!=typeof o)return t.trace(r,e,()=>i.apply(this,arguments));{let n=t.getContext().bind(eS.active(),o);return t.trace(r,e,(e,t)=>(arguments[s]=function(e){return null==t||t(e),n.apply(this,arguments)},i.apply(this,arguments)))}}:i}startSpan(...e){let[t,r]=e,n=this.getSpanContext((null==r?void 0:r.parentSpan)??this.getActiveScopeSpan());return this.getTracerInstance().startSpan(t,r,n)}getSpanContext(e){return e?eT.setSpan(eS.active(),e):void 0}getRootSpanAttributes(){let e=eS.active().getValue(eR);return ek.get(e)}setRootSpanAttribute(e,t){let r=eS.active().getValue(eR),n=ek.get(r);n&&n.set(e,t)}}let eM=(()=>{let e=new eD;return()=>e})(),ej="x-next-cache-tags",eU={shared:"shared",reactServerComponents:"rsc",serverSideRendering:"ssr",actionBrowser:"action-browser",apiNode:"api-node",apiEdge:"api-edge",middleware:"middleware",instrument:"instrument",edgeAsset:"edge-asset",appPagesBrowser:"app-pages-browser",pagesDirBrowser:"pages-dir-browser",pagesDirEdge:"pages-dir-edge",pagesDirNode:"pages-dir-node"};({...eU,GROUP:{builtinReact:[eU.reactServerComponents,eU.actionBrowser],serverOnly:[eU.reactServerComponents,eU.actionBrowser,eU.instrument,eU.middleware],neutralTarget:[eU.apiNode,eU.apiEdge],clientOnly:[eU.serverSideRendering,eU.appPagesBrowser],bundled:[eU.reactServerComponents,eU.actionBrowser,eU.serverSideRendering,eU.appPagesBrowser,eU.shared,eU.instrument,eU.middleware],appPages:[eU.reactServerComponents,eU.serverSideRendering,eU.appPagesBrowser,eU.actionBrowser]}});var eL=e.i(47540);class eF extends Error{constructor(e){super("Dynamic server usage: "+e),this.description=e,this.digest="DYNAMIC_SERVER_USAGE"}}class eB extends Error{constructor(...e){super(...e),this.code="NEXT_STATIC_GEN_BAILOUT"}}var eq=e.i(32319);e.i(56704);class eG extends Error{constructor(e,t){super(`During prerendering, ${t} rejects when the prerender is complete. Typically these errors are handled by React but if you move ${t} to a different context by using \`setTimeout\`, \`after\`, or similar functions you may observe this error and you should handle it in that context. This occurred at route "${e}".`),this.route=e,this.expression=t,this.digest="HANGING_PROMISE_REJECTION"}}let eH=new WeakMap;function e$(e,t,r){if(e.aborted)return Promise.reject(new eG(t,r));{let n=new Promise((n,i)=>{let s=i.bind(null,new eG(t,r)),o=eH.get(e);if(o)o.push(s);else{let t=[s];eH.set(e,t),e.addEventListener("abort",()=>{for(let e=0;e<t.length;e++)t[e]()},{once:!0})}});return n.catch(eV),n}}function eV(){}class eK extends Error{constructor(e,t){super("Invariant: "+(e.endsWith(".")?e:e+".")+" This is a bug in Next.js.",t),this.name="InvariantError"}}let ez="function"==typeof eL.default.unstable_postpone;function eJ(e,t,r){if(t)switch(t.type){case"cache":case"unstable-cache":case"private-cache":return}if(!e.forceDynamic&&!e.forceStatic){if(e.dynamicShouldError)throw Object.defineProperty(new eB(`Route ${e.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${r}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E553",enumerable:!1,configurable:!0});if(t)switch(t.type){case"prerender-ppr":var n,i,s;return n=e.route,i=r,s=t.dynamicTracking,void(function(){if(!ez)throw Object.defineProperty(Error("Invariant: React.unstable_postpone is not defined. This suggests the wrong version of React was loaded. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E224",enumerable:!1,configurable:!0})}(),s&&s.dynamicAccesses.push({stack:s.isDebugDynamicAccesses?Error().stack:void 0,expression:i}),eL.default.unstable_postpone(eW(n,i)));case"prerender-legacy":t.revalidate=0;let o=Object.defineProperty(new eF(`Route ${e.route} couldn't be rendered statically because it used ${r}. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E550",enumerable:!1,configurable:!0});throw e.dynamicUsageDescription=r,e.dynamicUsageStack=o.stack,o}}}function eW(e,t){return`Route ${e} needs to bail out of prerendering at this point because it used ${t}. React throws this special object to indicate where. It should not be caught by your own try/catch. Learn more: https://nextjs.org/docs/messages/ppr-caught-error`}if(!1===function(e){return e.includes("needs to bail out of prerendering at this point because it used")&&e.includes("Learn more: https://nextjs.org/docs/messages/ppr-caught-error")}(eW("%%%","^^^")))throw Object.defineProperty(Error("Invariant: isDynamicPostpone misidentified a postpone reason. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E296",enumerable:!1,configurable:!0});RegExp(`\\n\\s+at Suspense \\(<anonymous>\\)(?:(?!\\n\\s+at (?:body|div|main|section|article|aside|header|footer|nav|form|p|span|h1|h2|h3|h4|h5|h6) \\(<anonymous>\\))[\\s\\S])*?\\n\\s+at __next_root_layout_boundary__ \\([^\\n]*\\)`),RegExp(`\\n\\s+at __next_metadata_boundary__[\\n\\s]`),RegExp(`\\n\\s+at __next_viewport_boundary__[\\n\\s]`),RegExp(`\\n\\s+at __next_outlet_boundary__[\\n\\s]`);let eY=()=>{};function eZ(e){if(!e.body)return[e,e];let[t,n]=e.body.tee(),i=new Response(t,{status:e.status,statusText:e.statusText,headers:e.headers});Object.defineProperty(i,"url",{value:e.url,configurable:!0,enumerable:!0,writable:!1}),r&&i.body&&r.register(i,new WeakRef(i.body));let s=new Response(n,{status:e.status,statusText:e.statusText,headers:e.headers});return Object.defineProperty(s,"url",{value:e.url,configurable:!0,enumerable:!0,writable:!1}),[i,s]}globalThis.FinalizationRegistry&&(r=new FinalizationRegistry(e=>{let t=e.deref();t&&!t.locked&&t.cancel("Response object has been garbage collected").then(eY)}));class eX{constructor(){let e,t;this.promise=new Promise((r,n)=>{e=r,t=n}),this.resolve=e,this.reject=t}}var eQ=function(e){return e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.PAGES="PAGES",e.FETCH="FETCH",e.REDIRECT="REDIRECT",e.IMAGE="IMAGE",e}({}),e0=function(e){return e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.PAGES="PAGES",e.FETCH="FETCH",e.IMAGE="IMAGE",e}({});function e1(){}new Uint8Array([60,104,116,109,108]),new Uint8Array([60,98,111,100,121]),new Uint8Array([60,47,104,101,97,100,62]),new Uint8Array([60,47,98,111,100,121,62]),new Uint8Array([60,47,104,116,109,108,62]),new Uint8Array([60,47,98,111,100,121,62,60,47,104,116,109,108,62]),new Uint8Array([60,109,101,116,97,32,110,97,109,101,61,34,194,171,110,120,116,45,105,99,111,110,194,187,34]);let e2=new TextEncoder;function e5(e){return new ReadableStream({start(t){t.enqueue(e2.encode(e)),t.close()}})}function e4(e){return new ReadableStream({start(t){t.enqueue(e),t.close()}})}async function e3(e,t){let r=new TextDecoder("utf-8",{fatal:!0}),n="";for await(let i of e){if(null==t?void 0:t.aborted)return n;n+=r.decode(i,{stream:!0})}return n+r.decode()}let e6=Symbol.for("NextInternalRequestMeta");function e9(e,t){let r=e[e6]||{};return"string"==typeof t?r[t]:r}function e8(e){let t=new Headers;for(let[r,n]of Object.entries(e))for(let e of Array.isArray(n)?n:[n])void 0!==e&&("number"==typeof e&&(e=e.toString()),t.append(r,e));return t}function e7(e){var t,r,n,i,s,o=[],a=0;function l(){for(;a<e.length&&/\s/.test(e.charAt(a));)a+=1;return a<e.length}for(;a<e.length;){for(t=a,s=!1;l();)if(","===(r=e.charAt(a))){for(n=a,a+=1,l(),i=a;a<e.length&&"="!==(r=e.charAt(a))&&";"!==r&&","!==r;)a+=1;a<e.length&&"="===e.charAt(a)?(s=!0,a=i,o.push(e.substring(t,n)),t=a):a=n+1}else a+=1;(!s||a>=e.length)&&o.push(e.substring(t,e.length))}return o}function te(e){let t={},r=[];if(e)for(let[n,i]of e.entries())"set-cookie"===n.toLowerCase()?(r.push(...e7(i)),t[n]=1===r.length?r[0]:r):t[n]=i;return t}function tt(e){return e.replace(/\/$/,"")||"/"}function tr(e){let t=e.indexOf("#"),r=e.indexOf("?"),n=r>-1&&(t<0||r<t);return n||t>-1?{pathname:e.substring(0,n?r:t),query:n?e.substring(r,t>-1?t:void 0):"",hash:t>-1?e.slice(t):""}:{pathname:e,query:"",hash:""}}function tn(e,t){if(!e.startsWith("/")||!t)return e;let{pathname:r,query:n,hash:i}=tr(e);return""+t+r+n+i}function ti(e,t){if(!e.startsWith("/")||!t)return e;let{pathname:r,query:n,hash:i}=tr(e);return""+r+t+n+i}function ts(e,t){if("string"!=typeof e)return!1;let{pathname:r}=tr(e);return r===t||r.startsWith(t+"/")}let to=new WeakMap;function ta(e,t){let r;if(!t)return{pathname:e};let n=to.get(t);n||(n=t.map(e=>e.toLowerCase()),to.set(t,n));let i=e.split("/",2);if(!i[1])return{pathname:e};let s=i[1].toLowerCase(),o=n.indexOf(s);return o<0?{pathname:e}:(r=t[o],{pathname:e=e.slice(r.length+1)||"/",detectedLocale:r})}let tl=/(?!^https?:\/\/)(127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|\[::1\]|localhost)/;function tu(e,t){return new URL(String(e).replace(tl,"localhost"),t&&String(t).replace(tl,"localhost"))}let tc=Symbol("NextURLInternal");class td{constructor(e,t,r){let n,i;"object"==typeof t&&"pathname"in t||"string"==typeof t?(n=t,i=r||{}):i=r||t||{},this[tc]={url:tu(e,n??i.base),options:i,basePath:""},this.analyze()}analyze(){var e,t,r,n,i;let s=function(e,t){var r,n;let{basePath:i,i18n:s,trailingSlash:o}=null!=(r=t.nextConfig)?r:{},a={pathname:e,trailingSlash:"/"!==e?e.endsWith("/"):o};i&&ts(a.pathname,i)&&(a.pathname=function(e,t){if(!ts(e,t))return e;let r=e.slice(t.length);return r.startsWith("/")?r:"/"+r}(a.pathname,i),a.basePath=i);let l=a.pathname;if(a.pathname.startsWith("/_next/data/")&&a.pathname.endsWith(".json")){let e=a.pathname.replace(/^\/_next\/data\//,"").replace(/\.json$/,"").split("/");a.buildId=e[0],l="index"!==e[1]?"/"+e.slice(1).join("/"):"/",!0===t.parseData&&(a.pathname=l)}if(s){let e=t.i18nProvider?t.i18nProvider.analyze(a.pathname):ta(a.pathname,s.locales);a.locale=e.detectedLocale,a.pathname=null!=(n=e.pathname)?n:a.pathname,!e.detectedLocale&&a.buildId&&(e=t.i18nProvider?t.i18nProvider.analyze(l):ta(l,s.locales)).detectedLocale&&(a.locale=e.detectedLocale)}return a}(this[tc].url.pathname,{nextConfig:this[tc].options.nextConfig,parseData:!0,i18nProvider:this[tc].options.i18nProvider}),o=function(e,t){let r;if((null==t?void 0:t.host)&&!Array.isArray(t.host))r=t.host.toString().split(":",1)[0];else{if(!e.hostname)return;r=e.hostname}return r.toLowerCase()}(this[tc].url,this[tc].options.headers);this[tc].domainLocale=this[tc].options.i18nProvider?this[tc].options.i18nProvider.detectDomainLocale(o):function(e,t,r){if(e)for(let s of(r&&(r=r.toLowerCase()),e)){var n,i;if(t===(null==(n=s.domain)?void 0:n.split(":",1)[0].toLowerCase())||r===s.defaultLocale.toLowerCase()||(null==(i=s.locales)?void 0:i.some(e=>e.toLowerCase()===r)))return s}}(null==(t=this[tc].options.nextConfig)||null==(e=t.i18n)?void 0:e.domains,o);let a=(null==(r=this[tc].domainLocale)?void 0:r.defaultLocale)||(null==(i=this[tc].options.nextConfig)||null==(n=i.i18n)?void 0:n.defaultLocale);this[tc].url.pathname=s.pathname,this[tc].defaultLocale=a,this[tc].basePath=s.basePath??"",this[tc].buildId=s.buildId,this[tc].locale=s.locale??a,this[tc].trailingSlash=s.trailingSlash}formatPathname(){var e;let t;return t=function(e,t,r,n){if(!t||t===r)return e;let i=e.toLowerCase();return!n&&(ts(i,"/api")||ts(i,"/"+t.toLowerCase()))?e:tn(e,"/"+t)}((e={basePath:this[tc].basePath,buildId:this[tc].buildId,defaultLocale:this[tc].options.forceLocale?void 0:this[tc].defaultLocale,locale:this[tc].locale,pathname:this[tc].url.pathname,trailingSlash:this[tc].trailingSlash}).pathname,e.locale,e.buildId?void 0:e.defaultLocale,e.ignorePrefix),(e.buildId||!e.trailingSlash)&&(t=tt(t)),e.buildId&&(t=ti(tn(t,"/_next/data/"+e.buildId),"/"===e.pathname?"index.json":".json")),t=tn(t,e.basePath),!e.buildId&&e.trailingSlash?t.endsWith("/")?t:ti(t,"/"):tt(t)}formatSearch(){return this[tc].url.search}get buildId(){return this[tc].buildId}set buildId(e){this[tc].buildId=e}get locale(){return this[tc].locale??""}set locale(e){var t,r;if(!this[tc].locale||!(null==(r=this[tc].options.nextConfig)||null==(t=r.i18n)?void 0:t.locales.includes(e)))throw Object.defineProperty(TypeError(`The NextURL configuration includes no locale "${e}"`),"__NEXT_ERROR_CODE",{value:"E597",enumerable:!1,configurable:!0});this[tc].locale=e}get defaultLocale(){return this[tc].defaultLocale}get domainLocale(){return this[tc].domainLocale}get searchParams(){return this[tc].url.searchParams}get host(){return this[tc].url.host}set host(e){this[tc].url.host=e}get hostname(){return this[tc].url.hostname}set hostname(e){this[tc].url.hostname=e}get port(){return this[tc].url.port}set port(e){this[tc].url.port=e}get protocol(){return this[tc].url.protocol}set protocol(e){this[tc].url.protocol=e}get href(){let e=this.formatPathname(),t=this.formatSearch();return`${this.protocol}//${this.host}${e}${t}${this.hash}`}set href(e){this[tc].url=tu(e),this.analyze()}get origin(){return this[tc].url.origin}get pathname(){return this[tc].url.pathname}set pathname(e){this[tc].url.pathname=e}get hash(){return this[tc].url.hash}set hash(e){this[tc].url.hash=e}get search(){return this[tc].url.search}set search(e){this[tc].url.search=e}get password(){return this[tc].url.password}set password(e){this[tc].url.password=e}get username(){return this[tc].url.username}set username(e){this[tc].url.username=e}get basePath(){return this[tc].basePath}set basePath(e){this[tc].basePath=e.startsWith("/")?e:`/${e}`}toString(){return this.href}toJSON(){return this.href}[Symbol.for("edge-runtime.inspect.custom")](){return{href:this.href,origin:this.origin,protocol:this.protocol,username:this.username,password:this.password,host:this.host,hostname:this.hostname,port:this.port,pathname:this.pathname,search:this.search,searchParams:this.searchParams,hash:this.hash}}clone(){return new td(String(this),this[tc].options)}}class th extends Error{constructor(){super(`The request.page has been deprecated in favour of \`URLPattern\`.
  Read more: https://nextjs.org/docs/messages/middleware-request-page
  `)}}class tp extends Error{constructor(){super(`The request.ua has been removed in favour of \`userAgent\` function.
  Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent
  `)}}var tf=e.i(19481);let tg=Symbol("internal request");class tm extends Request{constructor(e,t={}){let r="string"!=typeof e&&"url"in e?e.url:String(e);!function(e){try{String(new URL(String(e)))}catch(t){throw Object.defineProperty(Error(`URL is malformed "${String(e)}". Please use only absolute URLs - https://nextjs.org/docs/messages/middleware-relative-urls`,{cause:t}),"__NEXT_ERROR_CODE",{value:"E61",enumerable:!1,configurable:!0})}}(r),t.body&&"half"!==t.duplex&&(t.duplex="half"),e instanceof Request?super(e,t):super(r,t);let n=new td(r,{headers:te(this.headers),nextConfig:t.nextConfig});this[tg]={cookies:new tf.RequestCookies(this.headers),nextUrl:n,url:n.toString()}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,nextUrl:this.nextUrl,url:this.url,bodyUsed:this.bodyUsed,cache:this.cache,credentials:this.credentials,destination:this.destination,headers:Object.fromEntries(this.headers),integrity:this.integrity,keepalive:this.keepalive,method:this.method,mode:this.mode,redirect:this.redirect,referrer:this.referrer,referrerPolicy:this.referrerPolicy,signal:this.signal}}get cookies(){return this[tg].cookies}get nextUrl(){return this[tg].nextUrl}get page(){throw new th}get ua(){throw new tp}get url(){return this[tg].url}}let ty="ResponseAborted";class tv extends Error{constructor(...e){super(...e),this.name=ty}}function t_(e){let t=new AbortController;return e.once("close",()=>{e.writableFinished||t.abort(new tv)}),t}class tb{static fromBaseNextRequest(e,t){return tb.fromNodeNextRequest(e,t)}static fromNodeNextRequest(e,t){let r,n=null;if("GET"!==e.method&&"HEAD"!==e.method&&e.body&&(n=e.body),e.url.startsWith("http"))r=new URL(e.url);else{let t=e9(e,"initURL");r=t&&t.startsWith("http")?new URL(e.url,t):new URL(e.url,"http://n")}return new tm(r,{method:e.method,headers:e8(e.headers),duplex:"half",signal:t,...t.aborted?{}:{body:n}})}static fromWebNextRequest(e){let t=null;return"GET"!==e.method&&"HEAD"!==e.method&&(t=e.body),new tm(e.url,{method:e.method,headers:e8(e.headers),duplex:"half",signal:e.request.signal,...e.request.signal.aborted?{}:{body:t}})}}let tE=0,tS=0,tw=0;function tT(e){return(null==e?void 0:e.name)==="AbortError"||(null==e?void 0:e.name)===ty}async function tC(e,t,r){try{let{errored:n,destroyed:i}=t;if(n||i)return;let s=t_(t),o=function(e,t){let r=!1,n=new eX;function i(){n.resolve()}e.on("drain",i),e.once("close",()=>{e.off("drain",i),n.resolve()});let s=new eX;return e.once("finish",()=>{s.resolve()}),new WritableStream({write:async t=>{if(!r){if(r=!0,"performance"in globalThis&&process.env.NEXT_OTEL_PERFORMANCE_PREFIX){let e=function(e={}){let t=0===tE?void 0:{clientComponentLoadStart:tE,clientComponentLoadTimes:tS,clientComponentLoadCount:tw};return e.reset&&(tE=0,tS=0,tw=0),t}();e&&performance.measure(`${process.env.NEXT_OTEL_PERFORMANCE_PREFIX}:next-client-component-loading`,{start:e.clientComponentLoadStart,end:e.clientComponentLoadStart+e.clientComponentLoadTimes})}e.flushHeaders(),eM().trace(ed.startResponse,{spanName:"start response"},()=>void 0)}try{let r=e.write(t);"flush"in e&&"function"==typeof e.flush&&e.flush(),r||(await n.promise,n=new eX)}catch(t){throw e.end(),Object.defineProperty(Error("failed to write chunk to response",{cause:t}),"__NEXT_ERROR_CODE",{value:"E321",enumerable:!1,configurable:!0})}},abort:t=>{e.writableFinished||e.destroy(t)},close:async()=>{if(t&&await t,!e.writableFinished)return e.end(),s.promise}})}(t,r);await e.pipeTo(o,{signal:s.signal})}catch(e){if(tT(e))return;throw Object.defineProperty(Error("failed to pipe response",{cause:e}),"__NEXT_ERROR_CODE",{value:"E180",enumerable:!1,configurable:!0})}}class tA{static #e=this.EMPTY=new tA(null,{metadata:{},contentType:null});static fromStatic(e,t){return new tA(e,{metadata:{},contentType:t})}constructor(e,{contentType:t,waitUntil:r,metadata:n}){this.response=e,this.contentType=t,this.metadata=n,this.waitUntil=r}assignMetadata(e){Object.assign(this.metadata,e)}get isNull(){return null===this.response}get isDynamic(){return"string"!=typeof this.response}toUnchunkedString(e=!1){if(null===this.response)return"";if("string"!=typeof this.response){if(!e)throw Object.defineProperty(new eK("dynamic responses cannot be unchunked. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E732",enumerable:!1,configurable:!0});return e3(this.readable)}return this.response}get readable(){return null===this.response?new ReadableStream({start(e){e.close()}}):"string"==typeof this.response?e5(this.response):Buffer.isBuffer(this.response)?e4(this.response):Array.isArray(this.response)?function(...e){if(0===e.length)return new ReadableStream({start(e){e.close()}});if(1===e.length)return e[0];let{readable:t,writable:r}=new TransformStream,n=e[0].pipeTo(r,{preventClose:!0}),i=1;for(;i<e.length-1;i++){let t=e[i];n=n.then(()=>t.pipeTo(r,{preventClose:!0}))}let s=e[i];return(n=n.then(()=>s.pipeTo(r))).catch(e1),t}(...this.response):this.response}coerce(){return null===this.response?[]:"string"==typeof this.response?[e5(this.response)]:Array.isArray(this.response)?this.response:Buffer.isBuffer(this.response)?[e4(this.response)]:[this.response]}unshift(e){this.response=this.coerce(),this.response.unshift(e)}push(e){this.response=this.coerce(),this.response.push(e)}async pipeTo(e){try{await this.readable.pipeTo(e,{preventClose:!0}),this.waitUntil&&await this.waitUntil,await e.close()}catch(t){if(tT(t))return void await e.abort(t);throw t}}async pipeToNodeResponse(e){await tC(this.readable,e,this.waitUntil)}}let tO=Symbol.for("next-patch");function tx(e,t){e.shouldTrackFetchMetrics&&(e.fetchMetrics??=[],e.fetchMetrics.push({...t,end:performance.timeOrigin+performance.now(),idx:e.nextFetchId||0}))}async function tI(e,t,r,n,i,s){let o=await e.arrayBuffer(),a={headers:Object.fromEntries(e.headers.entries()),body:Buffer.from(o).toString("base64"),status:e.status,url:e.url};return r&&await n.set(t,{kind:eQ.FETCH,data:a,revalidate:i},r),await s(),new Response(o,{headers:e.headers,status:e.status,statusText:e.statusText})}async function tk(e,t,r,n,i,s,o,a,l){let[u,c]=eZ(t),d=u.arrayBuffer().then(async e=>{let t=Buffer.from(e),a={headers:Object.fromEntries(u.headers.entries()),body:t.toString("base64"),status:u.status,url:u.url};null==s||s.set(r,a),n&&await i.set(r,{kind:eQ.FETCH,data:a,revalidate:o},n)}).catch(e=>console.warn("Failed to set fetch cache",a,e)).finally(l),h=`cache-set-${r}`;return e.pendingRevalidates??={},h in e.pendingRevalidates&&await e.pendingRevalidates[h],e.pendingRevalidates[h]=d.finally(()=>{var t;(null==(t=e.pendingRevalidates)?void 0:t[h])&&delete e.pendingRevalidates[h]}),c}class tR{static get(e,t,r){let n=Reflect.get(e,t,r);return"function"==typeof n?n.bind(e):n}static set(e,t,r,n){return Reflect.set(e,t,r,n)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}class tP extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new tP}}class tN extends Headers{constructor(e){super(),this.headers=new Proxy(e,{get(t,r,n){if("symbol"==typeof r)return tR.get(t,r,n);let i=r.toLowerCase(),s=Object.keys(e).find(e=>e.toLowerCase()===i);if(void 0!==s)return tR.get(t,s,n)},set(t,r,n,i){if("symbol"==typeof r)return tR.set(t,r,n,i);let s=r.toLowerCase(),o=Object.keys(e).find(e=>e.toLowerCase()===s);return tR.set(t,o??r,n,i)},has(t,r){if("symbol"==typeof r)return tR.has(t,r);let n=r.toLowerCase(),i=Object.keys(e).find(e=>e.toLowerCase()===n);return void 0!==i&&tR.has(t,i)},deleteProperty(t,r){if("symbol"==typeof r)return tR.deleteProperty(t,r);let n=r.toLowerCase(),i=Object.keys(e).find(e=>e.toLowerCase()===n);return void 0===i||tR.deleteProperty(t,i)}})}static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"append":case"delete":case"set":return tP.callable;default:return tR.get(e,t,r)}}})}merge(e){return Array.isArray(e)?e.join(", "):e}static from(e){return e instanceof Headers?e:new tN(e)}append(e,t){let r=this.headers[e];"string"==typeof r?this.headers[e]=[r,t]:Array.isArray(r)?r.push(t):this.headers[e]=t}delete(e){delete this.headers[e]}get(e){let t=this.headers[e];return void 0!==t?this.merge(t):null}has(e){return void 0!==this.headers[e]}set(e,t){this.headers[e]=t}forEach(e,t){for(let[r,n]of this.entries())e.call(t,n,r,this)}*entries(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase(),r=this.get(t);yield[t,r]}}*keys(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase();yield t}}*values(){for(let e of Object.keys(this.headers)){let t=this.get(e);yield t}}[Symbol.iterator](){return this.entries()}}Symbol("__next_preview_data");let tD=Symbol("__prerender_bypass");var tM=function(e){return e[e.SeeOther=303]="SeeOther",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect",e}({});class tj{constructor(e,t,r){this.method=e,this.url=t,this.body=r}get cookies(){var t;return this._cookies?this._cookies:this._cookies=(t=this.headers,function(){let{cookie:r}=t;if(!r)return{};let{parse:n}=e.r(93118);return n(Array.isArray(r)?r.join("; "):r)})()}}class tU{constructor(e){this.destination=e}redirect(e,t){return this.setHeader("Location",e),this.statusCode=t,t===tM.PermanentRedirect&&this.setHeader("Refresh",`0;url=${e}`),this}}class tL extends tj{static #e=o=e6;constructor(e){var t;super(e.method.toUpperCase(),e.url,e),this._req=e,this.headers=this._req.headers,this.fetchMetrics=null==(t=this._req)?void 0:t.fetchMetrics,this[o]=this._req[e6]||{},this.streaming=!1}get originalRequest(){return this._req[e6]=this[e6],this._req.url=this.url,this._req.cookies=this.cookies,this._req}set originalRequest(e){this._req=e}stream(){if(this.streaming)throw Object.defineProperty(Error("Invariant: NodeNextRequest.stream() can only be called once"),"__NEXT_ERROR_CODE",{value:"E467",enumerable:!1,configurable:!0});return this.streaming=!0,new ReadableStream({start:e=>{this._req.on("data",t=>{e.enqueue(new Uint8Array(t))}),this._req.on("end",()=>{e.close()}),this._req.on("error",t=>{e.error(t)})}})}}class tF extends tU{get originalResponse(){return tD in this&&(this._res[tD]=this[tD]),this._res}constructor(e){super(e),this._res=e,this.textBody=void 0}get sent(){return this._res.finished||this._res.headersSent}get statusCode(){return this._res.statusCode}set statusCode(e){this._res.statusCode=e}get statusMessage(){return this._res.statusMessage}set statusMessage(e){this._res.statusMessage=e}setHeader(e,t){return this._res.setHeader(e,t),this}removeHeader(e){return this._res.removeHeader(e),this}getHeaderValues(e){let t=this._res.getHeader(e);if(void 0!==t)return(Array.isArray(t)?t:[t]).map(e=>e.toString())}hasHeader(e){return this._res.hasHeader(e)}getHeader(e){let t=this.getHeaderValues(e);return Array.isArray(t)?t.join(","):void 0}getHeaders(){return this._res.getHeaders()}appendHeader(e,t){let r=this.getHeaderValues(e)??[];return r.includes(t)||this._res.setHeader(e,[...r,t]),this}body(e){return this.textBody=e,this}send(){this._res.end(this.textBody)}onClose(e){this.originalResponse.on("close",e)}}function tB(e){return e.isOnDemandRevalidate?"on-demand":e.isRevalidate?"stale":void 0}async function tq(e,t,r,n){{var i;t.statusCode=r.status,t.statusMessage=r.statusText;let s=["set-cookie","www-authenticate","proxy-authenticate","vary"];null==(i=r.headers)||i.forEach((e,r)=>{if("x-middleware-set-cookie"!==r.toLowerCase())if("set-cookie"===r.toLowerCase())for(let n of e7(e))t.appendHeader(r,n);else{let n=void 0!==t.getHeader(r);(s.includes(r.toLowerCase())||!n)&&t.appendHeader(r,e)}});let{originalResponse:o}=t;r.body&&"HEAD"!==e.method?await tC(r.body,o,n):o.end()}}var tG=e.i(93695);e.s(["GET",()=>ly,"POST",()=>lv,"PUT",()=>l_],91762);var tH=(0,e.i(44376).createRequire)({get url(){return`file://${e.P("node_modules/inngest/_virtual/rolldown_runtime.js")}`}}.url),t$=e.i(29166);let tV=function(e){return e.DeployId="deployId",e.FnId="fnId",e.Probe="probe",e.StepId="stepId",e}({}),tK=function(e){return e.Trust="trust",e}({}),tz=function(e){return e.InngestSigningKey="INNGEST_SIGNING_KEY",e.InngestSigningKeyFallback="INNGEST_SIGNING_KEY_FALLBACK",e.InngestEventKey="INNGEST_EVENT_KEY",e.InngestDevServerUrl="INNGEST_DEVSERVER_URL",e.InngestEnvironment="INNGEST_ENV",e.InngestBaseUrl="INNGEST_BASE_URL",e.InngestEventApiBaseUrl="INNGEST_EVENT_API_BASE_URL",e.InngestApiBaseUrl="INNGEST_API_BASE_URL",e.InngestServeHost="INNGEST_SERVE_HOST",e.InngestServePath="INNGEST_SERVE_PATH",e.InngestLogLevel="INNGEST_LOG_LEVEL",e.InngestStreaming="INNGEST_STREAMING",e.InngestDevMode="INNGEST_DEV",e.InngestAllowInBandSync="INNGEST_ALLOW_IN_BAND_SYNC",e.BranchName="BRANCH_NAME",e.VercelBranch="VERCEL_GIT_COMMIT_REF",e.IsVercel="VERCEL",e.CloudflarePagesBranch="CF_PAGES_BRANCH",e.IsCloudflarePages="CF_PAGES",e.NetlifyBranch="BRANCH",e.IsNetlify="NETLIFY",e.RenderBranch="RENDER_GIT_BRANCH",e.IsRender="RENDER",e.RailwayBranch="RAILWAY_GIT_BRANCH",e.RailwayEnvironment="RAILWAY_ENVIRONMENT",e.VercelEnvKey="VERCEL_ENV",e.OpenAiApiKey="OPENAI_API_KEY",e.GeminiApiKey="GEMINI_API_KEY",e.AnthropicApiKey="ANTHROPIC_API_KEY",e}({}),tJ=function(e){return e.ContentLength="content-length",e.Signature="x-inngest-signature",e.SdkVersion="x-inngest-sdk",e.Environment="x-inngest-env",e.Platform="x-inngest-platform",e.Framework="x-inngest-framework",e.NoRetry="x-inngest-no-retry",e.RequestVersion="x-inngest-req-version",e.RetryAfter="retry-after",e.InngestServerKind="x-inngest-server-kind",e.InngestExpectedServerKind="x-inngest-expected-server-kind",e.InngestSyncKind="x-inngest-sync-kind",e.EventIdSeed="x-inngest-event-id-seed",e.TraceParent="traceparent",e.TraceState="tracestate",e}({}),tW="https://api.inngest.com/",tY="https://inn.gs/",tZ="http://localhost:8288/",tX=function(e){return e.FunctionFailed="inngest/function.failed",e.FunctionInvoked="inngest/function.invoked",e.FunctionFinished="inngest/function.finished",e.FunctionCancelled="inngest/function.cancelled",e.ScheduledTimer="inngest/scheduled.timer",e}({}),tQ=t$.default.magenta.bold("[Inngest]"),t0="inngest",t1="NO_EVENT_KEY_SET",t2=function(e){return e.InBand="in_band",e.OutOfBand="out_of_band",e}({}),t5=function(e){return e[e.V0=0]="V0",e[e.V1=1]="V1",e[e.V2=2]="V2",e}({}),t4="3.43.1";var t3=e.i(55598),t6=e.i(14359),t9=e.i(41528);let{sha256:t8}=t3.default,t7=e=>(0,t6.default)(e,(e,t)=>{if("bigint"!=typeof t)return t}),re=[["w",6048e5],["d",864e5],["h",36e5],["m",6e4],["s",1e3]],rt=e=>{if(e instanceof Date)return e.toISOString();let t="string"==typeof e?(0,t9.default)(e):e,[,r]=re.reduce(([e,t],[r,n])=>{let i=Math.floor(e/n);return i>0?[e%n,`${t}${i}${r}`]:[e,t]},[t,""]);return r},rr=e=>{if(!e)return"";let t=e.match(/^signkey-[\w]+-/)?.shift()||"",r=e.replace(/^signkey-[\w]+-/,"");return`${t}${t8().update(r,"hex").digest("hex")}`},rn=(e=ru())=>{let t=["REACT_APP_","NEXT_PUBLIC_"];return[tz.InngestBaseUrl,tz.InngestDevMode].flatMap(r=>t.map(t=>e[t+r])).find(e=>{if(e)try{return new URL(e),!0}catch{}})},ri={equals:(e,t)=>e===t,"starts with":(e,t)=>!!t&&(e?.startsWith(t)??!1),"is truthy":e=>!!e,"is truthy but not":(e,t)=>!!e&&e!==t},rs=[["CF_PAGES","equals","1"],["CONTEXT","starts with","prod"],["ENVIRONMENT","starts with","prod"],["NODE_ENV","starts with","prod"],["VERCEL_ENV","starts with","prod"],["DENO_DEPLOYMENT_ID","is truthy"],[tz.VercelEnvKey,"is truthy but not","development"],[tz.IsNetlify,"is truthy"],[tz.IsRender,"is truthy"],[tz.RailwayBranch,"is truthy"],[tz.IsCloudflarePages,"is truthy"]];var ro=class{type;isExplicit;explicitDevUrl;env;constructor({type:e,isExplicit:t,explicitDevUrl:r,env:n=ru()}){this.env=n,this.type=e,this.isExplicit=t||!!r,this.explicitDevUrl=r}get isDev(){return"dev"===this.type}get isCloud(){return"cloud"===this.type}get isInferred(){return!this.isExplicit}getExplicitUrl(e){if(this.isExplicit){if(this.explicitDevUrl)return this.explicitDevUrl.href;if(this.isCloud)return e;if(this.isDev)return tZ}}};let ra=({env:e=ru(),client:t,explicitMode:r}={})=>{if(r)return new ro({type:r,isExplicit:!0,env:e});if(t?.mode.isExplicit)return t.mode;if(tz.InngestDevMode in e){if("string"==typeof e[tz.InngestDevMode])try{let t=new URL(e[tz.InngestDevMode]);return new ro({type:"dev",isExplicit:!0,explicitDevUrl:t,env:e})}catch{}let t=rm(e[tz.InngestDevMode]);if("boolean"==typeof t)return new ro({type:t?"dev":"cloud",isExplicit:!0,env:e})}return new ro({type:rs.some(([t,r,n])=>ri[r]((e=>{if("boolean"==typeof e||"number"==typeof e||"string"==typeof e)return e.toString()})(e[t]),n))?"cloud":"dev",isExplicit:!1,env:e})},rl=e=>ru()[e],ru=()=>{try{return process.env}catch(e){}try{let e=Deno.env.toObject();if(e)return e}catch(e){}try{let e=Netlify.env.toObject();if(e)return e}catch(e){}return{}},rc=e=>{let t=`inngest-js:v${t4}`,r={"Content-Type":"application/json","User-Agent":t,[tJ.SdkVersion]:t};e?.framework&&(r[tJ.Framework]=e.framework),e?.expectedServerKind&&(r[tJ.InngestExpectedServerKind]=e.expectedServerKind);let n={...ru(),...e?.env},i=e?.inngestEnv||((e=ru())=>e[tz.InngestEnvironment]||e[tz.BranchName]||e[tz.VercelBranch]||e[tz.NetlifyBranch]||e[tz.CloudflarePagesBranch]||e[tz.RenderBranch]||e[tz.RailwayBranch])(n);i&&(r[tJ.Environment]=i);let s=rp(n);return s&&(r[tJ.Platform]=s),{...r,...e?.client?.headers,...e?.extras}},rd={vercel:e=>"1"===e[tz.IsVercel]||"string"==typeof EdgeRuntime,netlify:e=>"true"===e[tz.IsNetlify],"cloudflare-pages":e=>"1"===e[tz.IsCloudflarePages],render:e=>"true"===e[tz.IsRender],railway:e=>!!e[tz.RailwayEnvironment]},rh={vercel:(e,t)=>"string"==typeof EdgeRuntime,"cloudflare-pages":()=>!0},rp=e=>Object.keys(rd).find(t=>rd[t](e)),rf=Symbol("Custom fetch implementation"),rg=e=>{if(e){if(rf in e)return e;let t=async(...t)=>{try{return await e(...t)}catch(e){throw e instanceof Error&&e.message?.startsWith("fetch failed")||(console.warn("A request failed when using a custom fetch implementation; this may be a misconfiguration. Make sure that your fetch client is correctly bound to the global scope."),console.error(e)),e}};return Object.defineProperties(t,{[rf]:{},name:{value:e.name},length:{value:e.length}}),t}try{if("undefined"!=typeof globalThis&&"fetch"in globalThis)return fetch.bind(globalThis)}catch(e){}return"undefined"!=typeof fetch?fetch:tH("cross-fetch")},rm=e=>{if("boolean"==typeof e)return e;if("number"==typeof e)return!!e;if("string"==typeof e){let t=e.trim().toLowerCase();return"undefined"===t?void 0:!!["true","1"].includes(t)}},ry=async(e=tZ,t)=>{try{let r=rv(e,"/dev");return await (await t(r.toString())).json(),!0}catch(e){return!1}},rv=(e=r_(),t="")=>new URL(t,e.includes("://")?e:`http://${e}`),r_=()=>rn()||tZ;var rb=class extends Error{cause;constructor(e,t){super(e),this.cause=t?.cause,this.name="NonRetriableError"}};e.s([],54033),e.s(["getErrorMap",()=>rI,"setErrorMap",()=>rx],85676),e.s(["ZodError",()=>rC,"ZodIssueCode",()=>rw,"quotelessJson",()=>rT],15235),e.s(["ZodParsedType",()=>rE,"getParsedType",()=>rS,"objectUtil",()=>l,"util",()=>a],42944),function(e){e.assertEqual=e=>{},e.assertIs=function(e){},e.assertNever=function(e){throw Error()},e.arrayToEnum=e=>{let t={};for(let r of e)t[r]=r;return t},e.getValidEnumValues=t=>{let r=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),n={};for(let e of r)n[e]=t[e];return e.objectValues(n)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(let r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(a||(a={})),(l||(l={})).mergeShapes=(e,t)=>({...e,...t});let rE=a.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),rS=e=>{switch(typeof e){case"undefined":return rE.undefined;case"string":return rE.string;case"number":return Number.isNaN(e)?rE.nan:rE.number;case"boolean":return rE.boolean;case"function":return rE.function;case"bigint":return rE.bigint;case"symbol":return rE.symbol;case"object":if(Array.isArray(e))return rE.array;if(null===e)return rE.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return rE.promise;if("undefined"!=typeof Map&&e instanceof Map)return rE.map;if("undefined"!=typeof Set&&e instanceof Set)return rE.set;if("undefined"!=typeof Date&&e instanceof Date)return rE.date;return rE.object;default:return rE.unknown}},rw=a.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),rT=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class rC extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},r={_errors:[]},n=e=>{for(let i of e.issues)if("invalid_union"===i.code)i.unionErrors.map(n);else if("invalid_return_type"===i.code)n(i.returnTypeError);else if("invalid_arguments"===i.code)n(i.argumentsError);else if(0===i.path.length)r._errors.push(t(i));else{let e=r,n=0;for(;n<i.path.length;){let r=i.path[n];n===i.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(i))):e[r]=e[r]||{_errors:[]},e=e[r],n++}}};return n(this),r}static assert(e){if(!(e instanceof rC))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,a.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},r=[];for(let n of this.issues)if(n.path.length>0){let r=n.path[0];t[r]=t[r]||[],t[r].push(e(n))}else r.push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}rC.create=e=>new rC(e);let rA=(e,t)=>{let r;switch(e.code){case rw.invalid_type:r=e.received===rE.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case rw.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,a.jsonStringifyReplacer)}`;break;case rw.unrecognized_keys:r=`Unrecognized key(s) in object: ${a.joinValues(e.keys,", ")}`;break;case rw.invalid_union:r="Invalid input";break;case rw.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${a.joinValues(e.options)}`;break;case rw.invalid_enum_value:r=`Invalid enum value. Expected ${a.joinValues(e.options)}, received '${e.received}'`;break;case rw.invalid_arguments:r="Invalid function arguments";break;case rw.invalid_return_type:r="Invalid function return type";break;case rw.invalid_date:r="Invalid date";break;case rw.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:a.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case rw.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type||"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case rw.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case rw.custom:r="Invalid input";break;case rw.invalid_intersection_types:r="Intersection results could not be merged";break;case rw.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case rw.not_finite:r="Number must be finite";break;default:r=t.defaultError,a.assertNever(e)}return{message:r}},rO=rA;function rx(e){rO=e}function rI(){return rO}e.s(["DIRTY",()=>rM,"EMPTY_PATH",()=>rR,"INVALID",()=>rD,"OK",()=>rj,"ParseStatus",()=>rN,"addIssueToContext",()=>rP,"isAborted",()=>rU,"isAsync",()=>rB,"isDirty",()=>rL,"isValid",()=>rF,"makeIssue",()=>rk],84488);let rk=e=>{let{data:t,path:r,errorMaps:n,issueData:i}=e,s=[...r,...i.path||[]],o={...i,path:s};if(void 0!==i.message)return{...i,path:s,message:i.message};let a="";for(let e of n.filter(e=>!!e).slice().reverse())a=e(o,{data:t,defaultError:a}).message;return{...i,path:s,message:a}},rR=[];function rP(e,t){let r=rO,n=rk({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===rA?void 0:rA].filter(e=>!!e)});e.common.issues.push(n)}class rN{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let r=[];for(let n of t){if("aborted"===n.status)return rD;"dirty"===n.status&&e.dirty(),r.push(n.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){let r=[];for(let e of t){let t=await e.key,n=await e.value;r.push({key:t,value:n})}return rN.mergeObjectSync(e,r)}static mergeObjectSync(e,t){let r={};for(let n of t){let{key:t,value:i}=n;if("aborted"===t.status||"aborted"===i.status)return rD;"dirty"===t.status&&e.dirty(),"dirty"===i.status&&e.dirty(),"__proto__"!==t.value&&(void 0!==i.value||n.alwaysSet)&&(r[t.value]=i.value)}return{status:e.value,value:r}}}let rD=Object.freeze({status:"aborted"}),rM=e=>({status:"dirty",value:e}),rj=e=>({status:"valid",value:e}),rU=e=>"aborted"===e.status,rL=e=>"dirty"===e.status,rF=e=>"valid"===e.status,rB=e=>"undefined"!=typeof Promise&&e instanceof Promise;e.s([],91316),e.s(["BRAND",()=>nD,"NEVER",()=>iv,"Schema",()=>r$,"ZodAny",()=>na,"ZodArray",()=>nd,"ZodBigInt",()=>nt,"ZodBoolean",()=>nr,"ZodBranded",()=>nM,"ZodCatch",()=>nP,"ZodDate",()=>nn,"ZodDefault",()=>nR,"ZodDiscriminatedUnion",()=>ng,"ZodEffects",()=>nx,"ZodEnum",()=>nC,"ZodFirstPartyTypeKind",()=>c,"ZodFunction",()=>nE,"ZodIntersection",()=>nm,"ZodLazy",()=>nS,"ZodLiteral",()=>nw,"ZodMap",()=>n_,"ZodNaN",()=>nN,"ZodNativeEnum",()=>nA,"ZodNever",()=>nu,"ZodNull",()=>no,"ZodNullable",()=>nk,"ZodNumber",()=>ne,"ZodObject",()=>nh,"ZodOptional",()=>nI,"ZodPipeline",()=>nj,"ZodPromise",()=>nO,"ZodReadonly",()=>nU,"ZodRecord",()=>nv,"ZodSchema",()=>r$,"ZodSet",()=>nb,"ZodString",()=>r7,"ZodSymbol",()=>ni,"ZodTransformer",()=>nx,"ZodTuple",()=>ny,"ZodType",()=>r$,"ZodUndefined",()=>ns,"ZodUnion",()=>np,"ZodUnknown",()=>nl,"ZodVoid",()=>nc,"any",()=>nZ,"array",()=>n1,"bigint",()=>nV,"boolean",()=>nK,"coerce",()=>iy,"custom",()=>nF,"date",()=>nz,"datetimeRegex",()=>r8,"discriminatedUnion",()=>n3,"effect",()=>il,"enum",()=>is,"function",()=>it,"instanceof",()=>nq,"intersection",()=>n6,"late",()=>nB,"lazy",()=>ir,"literal",()=>ii,"map",()=>n7,"nan",()=>n$,"nativeEnum",()=>io,"never",()=>nQ,"null",()=>nY,"nullable",()=>ic,"number",()=>nH,"object",()=>n2,"oboolean",()=>im,"onumber",()=>ig,"optional",()=>iu,"ostring",()=>ip,"pipeline",()=>ih,"preprocess",()=>id,"promise",()=>ia,"record",()=>n8,"set",()=>ie,"strictObject",()=>n5,"string",()=>nG,"symbol",()=>nJ,"transformer",()=>il,"tuple",()=>n9,"undefined",()=>nW,"union",()=>n4,"unknown",()=>nX,"void",()=>n0],17958),function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:e?.message}(u||(u={}));class rq{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let rG=(e,t)=>{if(rF(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new rC(e.common.issues);return this._error=t,this._error}}};function rH(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:n,description:i}=e;if(t&&(r||n))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:i}:{errorMap:(t,i)=>{let{message:s}=e;return"invalid_enum_value"===t.code?{message:s??i.defaultError}:void 0===i.data?{message:s??n??i.defaultError}:"invalid_type"!==t.code?{message:i.defaultError}:{message:s??r??i.defaultError}},description:i}}class r${get description(){return this._def.description}_getType(e){return rS(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:rS(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new rN,ctx:{common:e.parent.common,data:e.data,parsedType:rS(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(rB(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){let r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:rS(e)},n=this._parseSync({data:e,path:r.path,parent:r});return rG(r,n)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:rS(e)};if(!this["~standard"].async)try{let r=this._parseSync({data:e,path:[],parent:t});return rF(r)?{value:r.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>rF(e)?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:rS(e)},n=this._parse({data:e,path:r.path,parent:r});return rG(r,await (rB(n)?n:Promise.resolve(n)))}refine(e,t){return this._refinement((r,n)=>{let i=e(r),s=()=>n.addIssue({code:rw.custom,..."string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(r):t});return"undefined"!=typeof Promise&&i instanceof Promise?i.then(e=>!!e||(s(),!1)):!!i||(s(),!1)})}refinement(e,t){return this._refinement((r,n)=>!!e(r)||(n.addIssue("function"==typeof t?t(r,n):t),!1))}_refinement(e){return new nx({schema:this,typeName:c.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return nI.create(this,this._def)}nullable(){return nk.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return nd.create(this)}promise(){return nO.create(this,this._def)}or(e){return np.create([this,e],this._def)}and(e){return nm.create(this,e,this._def)}transform(e){return new nx({...rH(this._def),schema:this,typeName:c.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new nR({...rH(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:c.ZodDefault})}brand(){return new nM({typeName:c.ZodBranded,type:this,...rH(this._def)})}catch(e){return new nP({...rH(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:c.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return nj.create(this,e)}readonly(){return nU.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let rV=/^c[^\s-]{8,}$/i,rK=/^[0-9a-z]+$/,rz=/^[0-9A-HJKMNP-TV-Z]{26}$/i,rJ=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,rW=/^[a-z0-9_-]{21}$/i,rY=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,rZ=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,rX=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,rQ=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,r0=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,r1=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,r2=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,r5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,r4=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,r3="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",r6=RegExp(`^${r3}$`);function r9(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);let r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function r8(e){let t=`${r3}T${r9(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,RegExp(`^${t}$`)}class r7 extends r${_parse(e){var t,r,i,s;let o;if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==rE.string){let t=this._getOrReturnCtx(e);return rP(t,{code:rw.invalid_type,expected:rE.string,received:t.parsedType}),rD}let l=new rN;for(let u of this._def.checks)if("min"===u.kind)e.data.length<u.value&&(rP(o=this._getOrReturnCtx(e,o),{code:rw.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),l.dirty());else if("max"===u.kind)e.data.length>u.value&&(rP(o=this._getOrReturnCtx(e,o),{code:rw.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),l.dirty());else if("length"===u.kind){let t=e.data.length>u.value,r=e.data.length<u.value;(t||r)&&(o=this._getOrReturnCtx(e,o),t?rP(o,{code:rw.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}):r&&rP(o,{code:rw.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}),l.dirty())}else if("email"===u.kind)rX.test(e.data)||(rP(o=this._getOrReturnCtx(e,o),{validation:"email",code:rw.invalid_string,message:u.message}),l.dirty());else if("emoji"===u.kind)n||(n=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),n.test(e.data)||(rP(o=this._getOrReturnCtx(e,o),{validation:"emoji",code:rw.invalid_string,message:u.message}),l.dirty());else if("uuid"===u.kind)rJ.test(e.data)||(rP(o=this._getOrReturnCtx(e,o),{validation:"uuid",code:rw.invalid_string,message:u.message}),l.dirty());else if("nanoid"===u.kind)rW.test(e.data)||(rP(o=this._getOrReturnCtx(e,o),{validation:"nanoid",code:rw.invalid_string,message:u.message}),l.dirty());else if("cuid"===u.kind)rV.test(e.data)||(rP(o=this._getOrReturnCtx(e,o),{validation:"cuid",code:rw.invalid_string,message:u.message}),l.dirty());else if("cuid2"===u.kind)rK.test(e.data)||(rP(o=this._getOrReturnCtx(e,o),{validation:"cuid2",code:rw.invalid_string,message:u.message}),l.dirty());else if("ulid"===u.kind)rz.test(e.data)||(rP(o=this._getOrReturnCtx(e,o),{validation:"ulid",code:rw.invalid_string,message:u.message}),l.dirty());else if("url"===u.kind)try{new URL(e.data)}catch{rP(o=this._getOrReturnCtx(e,o),{validation:"url",code:rw.invalid_string,message:u.message}),l.dirty()}else"regex"===u.kind?(u.regex.lastIndex=0,u.regex.test(e.data)||(rP(o=this._getOrReturnCtx(e,o),{validation:"regex",code:rw.invalid_string,message:u.message}),l.dirty())):"trim"===u.kind?e.data=e.data.trim():"includes"===u.kind?e.data.includes(u.value,u.position)||(rP(o=this._getOrReturnCtx(e,o),{code:rw.invalid_string,validation:{includes:u.value,position:u.position},message:u.message}),l.dirty()):"toLowerCase"===u.kind?e.data=e.data.toLowerCase():"toUpperCase"===u.kind?e.data=e.data.toUpperCase():"startsWith"===u.kind?e.data.startsWith(u.value)||(rP(o=this._getOrReturnCtx(e,o),{code:rw.invalid_string,validation:{startsWith:u.value},message:u.message}),l.dirty()):"endsWith"===u.kind?e.data.endsWith(u.value)||(rP(o=this._getOrReturnCtx(e,o),{code:rw.invalid_string,validation:{endsWith:u.value},message:u.message}),l.dirty()):"datetime"===u.kind?r8(u).test(e.data)||(rP(o=this._getOrReturnCtx(e,o),{code:rw.invalid_string,validation:"datetime",message:u.message}),l.dirty()):"date"===u.kind?r6.test(e.data)||(rP(o=this._getOrReturnCtx(e,o),{code:rw.invalid_string,validation:"date",message:u.message}),l.dirty()):"time"===u.kind?RegExp(`^${r9(u)}$`).test(e.data)||(rP(o=this._getOrReturnCtx(e,o),{code:rw.invalid_string,validation:"time",message:u.message}),l.dirty()):"duration"===u.kind?rZ.test(e.data)||(rP(o=this._getOrReturnCtx(e,o),{validation:"duration",code:rw.invalid_string,message:u.message}),l.dirty()):"ip"===u.kind?(t=e.data,!(("v4"===(r=u.version)||!r)&&rQ.test(t)||("v6"===r||!r)&&r1.test(t))&&1&&(rP(o=this._getOrReturnCtx(e,o),{validation:"ip",code:rw.invalid_string,message:u.message}),l.dirty())):"jwt"===u.kind?!function(e,t){if(!rY.test(e))return!1;try{let[r]=e.split(".");if(!r)return!1;let n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),i=JSON.parse(atob(n));if("object"!=typeof i||null===i||"typ"in i&&i?.typ!=="JWT"||!i.alg||t&&i.alg!==t)return!1;return!0}catch{return!1}}(e.data,u.alg)&&(rP(o=this._getOrReturnCtx(e,o),{validation:"jwt",code:rw.invalid_string,message:u.message}),l.dirty()):"cidr"===u.kind?(i=e.data,!(("v4"===(s=u.version)||!s)&&r0.test(i)||("v6"===s||!s)&&r2.test(i))&&1&&(rP(o=this._getOrReturnCtx(e,o),{validation:"cidr",code:rw.invalid_string,message:u.message}),l.dirty())):"base64"===u.kind?r5.test(e.data)||(rP(o=this._getOrReturnCtx(e,o),{validation:"base64",code:rw.invalid_string,message:u.message}),l.dirty()):"base64url"===u.kind?r4.test(e.data)||(rP(o=this._getOrReturnCtx(e,o),{validation:"base64url",code:rw.invalid_string,message:u.message}),l.dirty()):a.assertNever(u);return{status:l.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:rw.invalid_string,...u.errToObj(r)})}_addCheck(e){return new r7({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...u.errToObj(e)})}url(e){return this._addCheck({kind:"url",...u.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...u.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...u.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...u.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...u.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...u.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...u.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...u.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...u.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...u.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...u.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...u.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===e?.precision?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...u.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===e?.precision?null:e?.precision,...u.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...u.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...u.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...u.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...u.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...u.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...u.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...u.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...u.errToObj(t)})}nonempty(e){return this.min(1,u.errToObj(e))}trim(){return new r7({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new r7({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new r7({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}r7.create=e=>new r7({checks:[],typeName:c.ZodString,coerce:e?.coerce??!1,...rH(e)});class ne extends r${constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==rE.number){let t=this._getOrReturnCtx(e);return rP(t,{code:rw.invalid_type,expected:rE.number,received:t.parsedType}),rD}let r=new rN;for(let n of this._def.checks)"int"===n.kind?a.isInteger(e.data)||(rP(t=this._getOrReturnCtx(e,t),{code:rw.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty()):"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(rP(t=this._getOrReturnCtx(e,t),{code:rw.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(rP(t=this._getOrReturnCtx(e,t),{code:rw.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"multipleOf"===n.kind?0!==function(e,t){let r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,i=r>n?r:n;return Number.parseInt(e.toFixed(i).replace(".",""))%Number.parseInt(t.toFixed(i).replace(".",""))/10**i}(e.data,n.value)&&(rP(t=this._getOrReturnCtx(e,t),{code:rw.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(rP(t=this._getOrReturnCtx(e,t),{code:rw.not_finite,message:n.message}),r.dirty()):a.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,u.toString(t))}gt(e,t){return this.setLimit("min",e,!1,u.toString(t))}lte(e,t){return this.setLimit("max",e,!0,u.toString(t))}lt(e,t){return this.setLimit("max",e,!1,u.toString(t))}setLimit(e,t,r,n){return new ne({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:u.toString(n)}]})}_addCheck(e){return new ne({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:u.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:u.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:u.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:u.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:u.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:u.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:u.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:u.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:u.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&a.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks)if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;else"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value);return Number.isFinite(t)&&Number.isFinite(e)}}ne.create=e=>new ne({checks:[],typeName:c.ZodNumber,coerce:e?.coerce||!1,...rH(e)});class nt extends r${constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==rE.bigint)return this._getInvalidInput(e);let r=new rN;for(let n of this._def.checks)"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(rP(t=this._getOrReturnCtx(e,t),{code:rw.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(rP(t=this._getOrReturnCtx(e,t),{code:rw.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(rP(t=this._getOrReturnCtx(e,t),{code:rw.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):a.assertNever(n);return{status:r.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return rP(t,{code:rw.invalid_type,expected:rE.bigint,received:t.parsedType}),rD}gte(e,t){return this.setLimit("min",e,!0,u.toString(t))}gt(e,t){return this.setLimit("min",e,!1,u.toString(t))}lte(e,t){return this.setLimit("max",e,!0,u.toString(t))}lt(e,t){return this.setLimit("max",e,!1,u.toString(t))}setLimit(e,t,r,n){return new nt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:u.toString(n)}]})}_addCheck(e){return new nt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:u.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:u.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:u.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:u.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:u.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}nt.create=e=>new nt({checks:[],typeName:c.ZodBigInt,coerce:e?.coerce??!1,...rH(e)});class nr extends r${_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==rE.boolean){let t=this._getOrReturnCtx(e);return rP(t,{code:rw.invalid_type,expected:rE.boolean,received:t.parsedType}),rD}return rj(e.data)}}nr.create=e=>new nr({typeName:c.ZodBoolean,coerce:e?.coerce||!1,...rH(e)});class nn extends r${_parse(e){let t;if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==rE.date){let t=this._getOrReturnCtx(e);return rP(t,{code:rw.invalid_type,expected:rE.date,received:t.parsedType}),rD}if(Number.isNaN(e.data.getTime()))return rP(this._getOrReturnCtx(e),{code:rw.invalid_date}),rD;let r=new rN;for(let n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(rP(t=this._getOrReturnCtx(e,t),{code:rw.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),r.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(rP(t=this._getOrReturnCtx(e,t),{code:rw.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),r.dirty()):a.assertNever(n);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new nn({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:u.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:u.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}nn.create=e=>new nn({checks:[],coerce:e?.coerce||!1,typeName:c.ZodDate,...rH(e)});class ni extends r${_parse(e){if(this._getType(e)!==rE.symbol){let t=this._getOrReturnCtx(e);return rP(t,{code:rw.invalid_type,expected:rE.symbol,received:t.parsedType}),rD}return rj(e.data)}}ni.create=e=>new ni({typeName:c.ZodSymbol,...rH(e)});class ns extends r${_parse(e){if(this._getType(e)!==rE.undefined){let t=this._getOrReturnCtx(e);return rP(t,{code:rw.invalid_type,expected:rE.undefined,received:t.parsedType}),rD}return rj(e.data)}}ns.create=e=>new ns({typeName:c.ZodUndefined,...rH(e)});class no extends r${_parse(e){if(this._getType(e)!==rE.null){let t=this._getOrReturnCtx(e);return rP(t,{code:rw.invalid_type,expected:rE.null,received:t.parsedType}),rD}return rj(e.data)}}no.create=e=>new no({typeName:c.ZodNull,...rH(e)});class na extends r${constructor(){super(...arguments),this._any=!0}_parse(e){return rj(e.data)}}na.create=e=>new na({typeName:c.ZodAny,...rH(e)});class nl extends r${constructor(){super(...arguments),this._unknown=!0}_parse(e){return rj(e.data)}}nl.create=e=>new nl({typeName:c.ZodUnknown,...rH(e)});class nu extends r${_parse(e){let t=this._getOrReturnCtx(e);return rP(t,{code:rw.invalid_type,expected:rE.never,received:t.parsedType}),rD}}nu.create=e=>new nu({typeName:c.ZodNever,...rH(e)});class nc extends r${_parse(e){if(this._getType(e)!==rE.undefined){let t=this._getOrReturnCtx(e);return rP(t,{code:rw.invalid_type,expected:rE.void,received:t.parsedType}),rD}return rj(e.data)}}nc.create=e=>new nc({typeName:c.ZodVoid,...rH(e)});class nd extends r${_parse(e){let{ctx:t,status:r}=this._processInputParams(e),n=this._def;if(t.parsedType!==rE.array)return rP(t,{code:rw.invalid_type,expected:rE.array,received:t.parsedType}),rD;if(null!==n.exactLength){let e=t.data.length>n.exactLength.value,i=t.data.length<n.exactLength.value;(e||i)&&(rP(t,{code:e?rw.too_big:rw.too_small,minimum:i?n.exactLength.value:void 0,maximum:e?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(null!==n.minLength&&t.data.length<n.minLength.value&&(rP(t,{code:rw.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),null!==n.maxLength&&t.data.length>n.maxLength.value&&(rP(t,{code:rw.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>n.type._parseAsync(new rq(t,e,t.path,r)))).then(e=>rN.mergeArray(r,e));let i=[...t.data].map((e,r)=>n.type._parseSync(new rq(t,e,t.path,r)));return rN.mergeArray(r,i)}get element(){return this._def.type}min(e,t){return new nd({...this._def,minLength:{value:e,message:u.toString(t)}})}max(e,t){return new nd({...this._def,maxLength:{value:e,message:u.toString(t)}})}length(e,t){return new nd({...this._def,exactLength:{value:e,message:u.toString(t)}})}nonempty(e){return this.min(1,e)}}nd.create=(e,t)=>new nd({type:e,minLength:null,maxLength:null,exactLength:null,typeName:c.ZodArray,...rH(t)});class nh extends r${constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=a.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==rE.object){let t=this._getOrReturnCtx(e);return rP(t,{code:rw.invalid_type,expected:rE.object,received:t.parsedType}),rD}let{status:t,ctx:r}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),s=[];if(!(this._def.catchall instanceof nu&&"strip"===this._def.unknownKeys))for(let e in r.data)i.includes(e)||s.push(e);let o=[];for(let e of i){let t=n[e],i=r.data[e];o.push({key:{status:"valid",value:e},value:t._parse(new rq(r,i,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof nu){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of s)o.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)s.length>0&&(rP(r,{code:rw.unrecognized_keys,keys:s}),t.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of s){let n=r.data[t];o.push({key:{status:"valid",value:t},value:e._parse(new rq(r,n,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of o){let r=await t.key,n=await t.value;e.push({key:r,value:n,alwaysSet:t.alwaysSet})}return e}).then(e=>rN.mergeObjectSync(t,e)):rN.mergeObjectSync(t,o)}get shape(){return this._def.shape()}strict(e){return u.errToObj,new nh({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{let n=this._def.errorMap?.(t,r).message??r.defaultError;return"unrecognized_keys"===t.code?{message:u.errToObj(e).message??n}:{message:n}}}:{}})}strip(){return new nh({...this._def,unknownKeys:"strip"})}passthrough(){return new nh({...this._def,unknownKeys:"passthrough"})}extend(e){return new nh({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new nh({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:c.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new nh({...this._def,catchall:e})}pick(e){let t={};for(let r of a.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new nh({...this._def,shape:()=>t})}omit(e){let t={};for(let r of a.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new nh({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof nh){let r={};for(let n in t.shape){let i=t.shape[n];r[n]=nI.create(e(i))}return new nh({...t._def,shape:()=>r})}if(t instanceof nd)return new nd({...t._def,type:e(t.element)});if(t instanceof nI)return nI.create(e(t.unwrap()));if(t instanceof nk)return nk.create(e(t.unwrap()));if(t instanceof ny)return ny.create(t.items.map(t=>e(t)));else return t}(this)}partial(e){let t={};for(let r of a.objectKeys(this.shape)){let n=this.shape[r];e&&!e[r]?t[r]=n:t[r]=n.optional()}return new nh({...this._def,shape:()=>t})}required(e){let t={};for(let r of a.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof nI;)e=e._def.innerType;t[r]=e}return new nh({...this._def,shape:()=>t})}keyof(){return nT(a.objectKeys(this.shape))}}nh.create=(e,t)=>new nh({shape:()=>e,unknownKeys:"strip",catchall:nu.create(),typeName:c.ZodObject,...rH(t)}),nh.strictCreate=(e,t)=>new nh({shape:()=>e,unknownKeys:"strict",catchall:nu.create(),typeName:c.ZodObject,...rH(t)}),nh.lazycreate=(e,t)=>new nh({shape:e,unknownKeys:"strip",catchall:nu.create(),typeName:c.ZodObject,...rH(t)});class np extends r${_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{let r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;let r=e.map(e=>new rC(e.ctx.common.issues));return rP(t,{code:rw.invalid_union,unionErrors:r}),rD});{let e,n=[];for(let i of r){let r={...t,common:{...t.common,issues:[]},parent:null},s=i._parseSync({data:t.data,path:t.path,parent:r});if("valid"===s.status)return s;"dirty"!==s.status||e||(e={result:s,ctx:r}),r.common.issues.length&&n.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let i=n.map(e=>new rC(e));return rP(t,{code:rw.invalid_union,unionErrors:i}),rD}}get options(){return this._def.options}}np.create=(e,t)=>new np({options:e,typeName:c.ZodUnion,...rH(t)});let nf=e=>{if(e instanceof nS)return nf(e.schema);if(e instanceof nx)return nf(e.innerType());if(e instanceof nw)return[e.value];if(e instanceof nC)return e.options;if(e instanceof nA)return a.objectValues(e.enum);else if(e instanceof nR)return nf(e._def.innerType);else if(e instanceof ns)return[void 0];else if(e instanceof no)return[null];else if(e instanceof nI)return[void 0,...nf(e.unwrap())];else if(e instanceof nk)return[null,...nf(e.unwrap())];else if(e instanceof nM)return nf(e.unwrap());else if(e instanceof nU)return nf(e.unwrap());else if(e instanceof nP)return nf(e._def.innerType);else return[]};class ng extends r${_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==rE.object)return rP(t,{code:rw.invalid_type,expected:rE.object,received:t.parsedType}),rD;let r=this.discriminator,n=t.data[r],i=this.optionsMap.get(n);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(rP(t,{code:rw.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),rD)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let n=new Map;for(let r of t){let t=nf(r.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let i of t){if(n.has(i))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(i)}`);n.set(i,r)}}return new ng({typeName:c.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...rH(r)})}}class nm extends r${_parse(e){let{status:t,ctx:r}=this._processInputParams(e),n=(e,n)=>{if(rU(e)||rU(n))return rD;let i=function e(t,r){let n=rS(t),i=rS(r);if(t===r)return{valid:!0,data:t};if(n===rE.object&&i===rE.object){let n=a.objectKeys(r),i=a.objectKeys(t).filter(e=>-1!==n.indexOf(e)),s={...t,...r};for(let n of i){let i=e(t[n],r[n]);if(!i.valid)return{valid:!1};s[n]=i.data}return{valid:!0,data:s}}if(n===rE.array&&i===rE.array){if(t.length!==r.length)return{valid:!1};let n=[];for(let i=0;i<t.length;i++){let s=e(t[i],r[i]);if(!s.valid)return{valid:!1};n.push(s.data)}return{valid:!0,data:n}}if(n===rE.date&&i===rE.date&&+t==+r)return{valid:!0,data:t};return{valid:!1}}(e.value,n.value);return i.valid?((rL(e)||rL(n))&&t.dirty(),{status:t.value,value:i.data}):(rP(r,{code:rw.invalid_intersection_types}),rD)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>n(e,t)):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}nm.create=(e,t,r)=>new nm({left:e,right:t,typeName:c.ZodIntersection,...rH(r)});class ny extends r${_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==rE.array)return rP(r,{code:rw.invalid_type,expected:rE.array,received:r.parsedType}),rD;if(r.data.length<this._def.items.length)return rP(r,{code:rw.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),rD;!this._def.rest&&r.data.length>this._def.items.length&&(rP(r,{code:rw.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let n=[...r.data].map((e,t)=>{let n=this._def.items[t]||this._def.rest;return n?n._parse(new rq(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(n).then(e=>rN.mergeArray(t,e)):rN.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new ny({...this._def,rest:e})}}ny.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new ny({items:e,typeName:c.ZodTuple,rest:null,...rH(t)})};class nv extends r${get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==rE.object)return rP(r,{code:rw.invalid_type,expected:rE.object,received:r.parsedType}),rD;let n=[],i=this._def.keyType,s=this._def.valueType;for(let e in r.data)n.push({key:i._parse(new rq(r,e,r.path,e)),value:s._parse(new rq(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?rN.mergeObjectAsync(t,n):rN.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,r){return new nv(t instanceof r$?{keyType:e,valueType:t,typeName:c.ZodRecord,...rH(r)}:{keyType:r7.create(),valueType:e,typeName:c.ZodRecord,...rH(t)})}}class n_ extends r${get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==rE.map)return rP(r,{code:rw.invalid_type,expected:rE.map,received:r.parsedType}),rD;let n=this._def.keyType,i=this._def.valueType,s=[...r.data.entries()].map(([e,t],s)=>({key:n._parse(new rq(r,e,r.path,[s,"key"])),value:i._parse(new rq(r,t,r.path,[s,"value"]))}));if(r.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let r of s){let n=await r.key,i=await r.value;if("aborted"===n.status||"aborted"===i.status)return rD;("dirty"===n.status||"dirty"===i.status)&&t.dirty(),e.set(n.value,i.value)}return{status:t.value,value:e}})}{let e=new Map;for(let r of s){let n=r.key,i=r.value;if("aborted"===n.status||"aborted"===i.status)return rD;("dirty"===n.status||"dirty"===i.status)&&t.dirty(),e.set(n.value,i.value)}return{status:t.value,value:e}}}}n_.create=(e,t,r)=>new n_({valueType:t,keyType:e,typeName:c.ZodMap,...rH(r)});class nb extends r${_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==rE.set)return rP(r,{code:rw.invalid_type,expected:rE.set,received:r.parsedType}),rD;let n=this._def;null!==n.minSize&&r.data.size<n.minSize.value&&(rP(r,{code:rw.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),null!==n.maxSize&&r.data.size>n.maxSize.value&&(rP(r,{code:rw.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());let i=this._def.valueType;function s(e){let r=new Set;for(let n of e){if("aborted"===n.status)return rD;"dirty"===n.status&&t.dirty(),r.add(n.value)}return{status:t.value,value:r}}let o=[...r.data.values()].map((e,t)=>i._parse(new rq(r,e,r.path,t)));return r.common.async?Promise.all(o).then(e=>s(e)):s(o)}min(e,t){return new nb({...this._def,minSize:{value:e,message:u.toString(t)}})}max(e,t){return new nb({...this._def,maxSize:{value:e,message:u.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}nb.create=(e,t)=>new nb({valueType:e,minSize:null,maxSize:null,typeName:c.ZodSet,...rH(t)});class nE extends r${constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==rE.function)return rP(t,{code:rw.invalid_type,expected:rE.function,received:t.parsedType}),rD;function r(e,r){return rk({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,rO,rA].filter(e=>!!e),issueData:{code:rw.invalid_arguments,argumentsError:r}})}function n(e,r){return rk({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,rO,rA].filter(e=>!!e),issueData:{code:rw.invalid_return_type,returnTypeError:r}})}let i={errorMap:t.common.contextualErrorMap},s=t.data;if(this._def.returns instanceof nO){let e=this;return rj(async function(...t){let o=new rC([]),a=await e._def.args.parseAsync(t,i).catch(e=>{throw o.addIssue(r(t,e)),o}),l=await Reflect.apply(s,this,a);return await e._def.returns._def.type.parseAsync(l,i).catch(e=>{throw o.addIssue(n(l,e)),o})})}{let e=this;return rj(function(...t){let o=e._def.args.safeParse(t,i);if(!o.success)throw new rC([r(t,o.error)]);let a=Reflect.apply(s,this,o.data),l=e._def.returns.safeParse(a,i);if(!l.success)throw new rC([n(a,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new nE({...this._def,args:ny.create(e).rest(nl.create())})}returns(e){return new nE({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new nE({args:e||ny.create([]).rest(nl.create()),returns:t||nl.create(),typeName:c.ZodFunction,...rH(r)})}}class nS extends r${get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}nS.create=(e,t)=>new nS({getter:e,typeName:c.ZodLazy,...rH(t)});class nw extends r${_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return rP(t,{received:t.data,code:rw.invalid_literal,expected:this._def.value}),rD}return{status:"valid",value:e.data}}get value(){return this._def.value}}function nT(e,t){return new nC({values:e,typeName:c.ZodEnum,...rH(t)})}nw.create=(e,t)=>new nw({value:e,typeName:c.ZodLiteral,...rH(t)});class nC extends r${_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),r=this._def.values;return rP(t,{expected:a.joinValues(r),received:t.parsedType,code:rw.invalid_type}),rD}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return rP(t,{received:t.data,code:rw.invalid_enum_value,options:r}),rD}return rj(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return nC.create(e,{...this._def,...t})}exclude(e,t=this._def){return nC.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}nC.create=nT;class nA extends r${_parse(e){let t=a.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==rE.string&&r.parsedType!==rE.number){let e=a.objectValues(t);return rP(r,{expected:a.joinValues(e),received:r.parsedType,code:rw.invalid_type}),rD}if(this._cache||(this._cache=new Set(a.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let e=a.objectValues(t);return rP(r,{received:r.data,code:rw.invalid_enum_value,options:e}),rD}return rj(e.data)}get enum(){return this._def.values}}nA.create=(e,t)=>new nA({values:e,typeName:c.ZodNativeEnum,...rH(t)});class nO extends r${unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);return t.parsedType!==rE.promise&&!1===t.common.async?(rP(t,{code:rw.invalid_type,expected:rE.promise,received:t.parsedType}),rD):rj((t.parsedType===rE.promise?t.data:Promise.resolve(t.data)).then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}nO.create=(e,t)=>new nO({type:e,typeName:c.ZodPromise,...rH(t)});class nx extends r${innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===c.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:e=>{rP(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),"preprocess"===n.type){let e=n.transform(r.data,i);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return rD;let n=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===n.status?rD:"dirty"===n.status||"dirty"===t.value?rM(n.value):n});{if("aborted"===t.value)return rD;let n=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===n.status?rD:"dirty"===n.status||"dirty"===t.value?rM(n.value):n}}if("refinement"===n.type){let e=e=>{let t=n.refinement(e,i);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?rD:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))));{let n=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===n.status?rD:("dirty"===n.status&&t.dirty(),e(n.value),{status:t.value,value:n.value})}}if("transform"===n.type)if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>rF(e)?Promise.resolve(n.transform(e.value,i)).then(e=>({status:t.value,value:e})):rD);else{let e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!rF(e))return rD;let s=n.transform(e.value,i);if(s instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}a.assertNever(n)}}nx.create=(e,t,r)=>new nx({schema:e,typeName:c.ZodEffects,effect:t,...rH(r)}),nx.createWithPreprocess=(e,t,r)=>new nx({schema:t,effect:{type:"preprocess",transform:e},typeName:c.ZodEffects,...rH(r)});class nI extends r${_parse(e){return this._getType(e)===rE.undefined?rj(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}nI.create=(e,t)=>new nI({innerType:e,typeName:c.ZodOptional,...rH(t)});class nk extends r${_parse(e){return this._getType(e)===rE.null?rj(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}nk.create=(e,t)=>new nk({innerType:e,typeName:c.ZodNullable,...rH(t)});class nR extends r${_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===rE.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}nR.create=(e,t)=>new nR({innerType:e,typeName:c.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...rH(t)});class nP extends r${_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return rB(n)?n.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new rC(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new rC(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}nP.create=(e,t)=>new nP({innerType:e,typeName:c.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...rH(t)});class nN extends r${_parse(e){if(this._getType(e)!==rE.nan){let t=this._getOrReturnCtx(e);return rP(t,{code:rw.invalid_type,expected:rE.nan,received:t.parsedType}),rD}return{status:"valid",value:e.data}}}nN.create=e=>new nN({typeName:c.ZodNaN,...rH(e)});let nD=Symbol("zod_brand");class nM extends r${_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class nj extends r${_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?rD:"dirty"===e.status?(t.dirty(),rM(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{let e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?rD:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new nj({in:e,out:t,typeName:c.ZodPipeline})}}class nU extends r${_parse(e){let t=this._def.innerType._parse(e),r=e=>(rF(e)&&(e.value=Object.freeze(e.value)),e);return rB(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}}function nL(e,t){let r="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof r?{message:r}:r}function nF(e,t={},r){return e?na.create().superRefine((n,i)=>{let s=e(n);if(s instanceof Promise)return s.then(e=>{if(!e){let e=nL(t,n),s=e.fatal??r??!0;i.addIssue({code:"custom",...e,fatal:s})}});if(!s){let e=nL(t,n),s=e.fatal??r??!0;i.addIssue({code:"custom",...e,fatal:s})}}):na.create()}nU.create=(e,t)=>new nU({innerType:e,typeName:c.ZodReadonly,...rH(t)});let nB={object:nh.lazycreate};!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(c||(c={}));let nq=(e,t={message:`Input not instance of ${e.name}`})=>nF(t=>t instanceof e,t),nG=r7.create,nH=ne.create,n$=nN.create,nV=nt.create,nK=nr.create,nz=nn.create,nJ=ni.create,nW=ns.create,nY=no.create,nZ=na.create,nX=nl.create,nQ=nu.create,n0=nc.create,n1=nd.create,n2=nh.create,n5=nh.strictCreate,n4=np.create,n3=ng.create,n6=nm.create,n9=ny.create,n8=nv.create,n7=n_.create,ie=nb.create,it=nE.create,ir=nS.create,ii=nw.create,is=nC.create,io=nA.create,ia=nO.create,il=nx.create,iu=nI.create,ic=nk.create,id=nx.createWithPreprocess,ih=nj.create,ip=()=>nG().optional(),ig=()=>nH().optional(),im=()=>nK().optional(),iy={string:e=>r7.create({...e,coerce:!0}),number:e=>ne.create({...e,coerce:!0}),boolean:e=>nr.create({...e,coerce:!0}),bigint:e=>nt.create({...e,coerce:!0}),date:e=>nn.create({...e,coerce:!0})},iv=rD;e.s(["BRAND",()=>nD,"DIRTY",()=>rM,"EMPTY_PATH",()=>rR,"INVALID",()=>rD,"NEVER",()=>iv,"OK",()=>rj,"ParseStatus",()=>rN,"Schema",()=>r$,"ZodAny",()=>na,"ZodArray",()=>nd,"ZodBigInt",()=>nt,"ZodBoolean",()=>nr,"ZodBranded",()=>nM,"ZodCatch",()=>nP,"ZodDate",()=>nn,"ZodDefault",()=>nR,"ZodDiscriminatedUnion",()=>ng,"ZodEffects",()=>nx,"ZodEnum",()=>nC,"ZodError",()=>rC,"ZodFirstPartyTypeKind",()=>c,"ZodFunction",()=>nE,"ZodIntersection",()=>nm,"ZodIssueCode",()=>rw,"ZodLazy",()=>nS,"ZodLiteral",()=>nw,"ZodMap",()=>n_,"ZodNaN",()=>nN,"ZodNativeEnum",()=>nA,"ZodNever",()=>nu,"ZodNull",()=>no,"ZodNullable",()=>nk,"ZodNumber",()=>ne,"ZodObject",()=>nh,"ZodOptional",()=>nI,"ZodParsedType",()=>rE,"ZodPipeline",()=>nj,"ZodPromise",()=>nO,"ZodReadonly",()=>nU,"ZodRecord",()=>nv,"ZodSchema",()=>r$,"ZodSet",()=>nb,"ZodString",()=>r7,"ZodSymbol",()=>ni,"ZodTransformer",()=>nx,"ZodTuple",()=>ny,"ZodType",()=>r$,"ZodUndefined",()=>ns,"ZodUnion",()=>np,"ZodUnknown",()=>nl,"ZodVoid",()=>nc,"addIssueToContext",()=>rP,"any",()=>nZ,"array",()=>n1,"bigint",()=>nV,"boolean",()=>nK,"coerce",()=>iy,"custom",()=>nF,"date",()=>nz,"datetimeRegex",()=>r8,"defaultErrorMap",()=>rA,"discriminatedUnion",()=>n3,"effect",()=>il,"enum",()=>is,"function",()=>it,"getErrorMap",()=>rI,"getParsedType",()=>rS,"instanceof",()=>nq,"intersection",()=>n6,"isAborted",()=>rU,"isAsync",()=>rB,"isDirty",()=>rL,"isValid",()=>rF,"late",()=>nB,"lazy",()=>ir,"literal",()=>ii,"makeIssue",()=>rk,"map",()=>n7,"nan",()=>n$,"nativeEnum",()=>io,"never",()=>nQ,"null",()=>nY,"nullable",()=>ic,"number",()=>nH,"object",()=>n2,"objectUtil",()=>l,"oboolean",()=>im,"onumber",()=>ig,"optional",()=>iu,"ostring",()=>ip,"pipeline",()=>ih,"preprocess",()=>id,"promise",()=>ia,"quotelessJson",()=>rT,"record",()=>n8,"set",()=>ie,"setErrorMap",()=>rx,"strictObject",()=>n5,"string",()=>nG,"symbol",()=>nJ,"transformer",()=>il,"tuple",()=>n9,"undefined",()=>nW,"union",()=>n4,"unknown",()=>nX,"util",()=>a,"void",()=>n0],35907),e.i(54033),e.s(["defaultErrorMap",()=>rA,"getErrorMap",()=>rI,"setErrorMap",()=>rx],76733),e.i(85676),e.i(76733),e.i(84488),e.i(91316),e.i(42944),e.i(17958),e.i(15235);var i_=e.i(35907),ib=i_,iE=e.i(79482),iS=e.i(7);let iw="__serialized";iE.errorConstructors.set("NonRetriableError",rb);let iT=(e,t=!1)=>{try{let r=iC(e);if(r)return r;if("object"==typeof e&&null!==e){let r=(0,iE.serializeError)(e);if(!r.name&&t)return e;let n={...r,name:r.name||"Error",message:r.message||(0,t6.default)(e)||"Unknown error; error serialization could not find a message.",stack:r.stack||"",[iw]:!0},i=n;for(let e=0;e<5;e++){if("object"==typeof i&&null!==i&&"cause"in i&&i.cause){i=i.cause=iT(i.cause,!0);continue}break}return n}throw Error("Error is not an object; strange throw value.")}catch{if(t)return e;try{return{...iT(Error("string"==typeof e?e:(0,t6.default)(e)),!1),stack:"",[iw]:!0}}catch{return{name:"Could not serialize source error",message:"Serializing the source error failed.",stack:"",[iw]:!0}}}},iC=e=>{try{if("string"==typeof e){let t=ib.object({[iw]:ib.literal(!0),name:ib.enum([...Array.from(iE.errorConstructors.keys())]),message:ib.string(),stack:ib.string()}).passthrough().safeParse(JSON.parse(e));if(t.success)return t.data}if("object"==typeof e&&null!==e&&Object.hasOwn(e,iw)&&!0===e[iw])return e}catch{}},iA=(e,t=!1)=>{try{if(!["name","message"].every(t=>Object.hasOwn(e,t)))throw Error();let t=(0,iE.deserializeError)(e);return"cause"in t&&(t.cause=iA(t.cause,!0)),t}catch{if(t)return e;let r=Error("Unknown error; could not reserialize");return r.stack=void 0,r}},iO=function(e){return e.NESTING_STEPS="NESTING_STEPS",e.NON_DETERMINISTIC_FUNCTION="NON_DETERMINISTIC_FUNCTION",e.ASYNC_DETECTED_AFTER_MEMOIZATION="ASYNC_DETECTED_AFTER_MEMOIZATION",e.STEP_USED_AFTER_ASYNC="STEP_USED_AFTER_ASYNC",e.AUTOMATIC_PARALLEL_INDEXING="AUTOMATIC_PARALLEL_INDEXING",e}({}),ix="=================================================",iI=e=>{try{if(!ik(e)||!e.message.includes(ix))return e;let t=(0,iS.default)(e.message),r=t.split("  ")[1]?.split("\n")[0]?.trim()||e.message;if(e.message=[t.split("\n\nCode: ")[1]?.split("\n\n")[0]?.trim()||void 0,r].filter(Boolean).join(" - "),e.stack){let t=(0,iS.default)(e.stack).split(`${ix}
`).slice(2).join("\n");e.stack=`${e.name}: ${e.message}
${t}`}return e}catch(t){return e}},ik=e=>{try{if(e instanceof Error)return!0;if("object"!=typeof e||null===e)return!1;return Object.hasOwn(e,"name")&&Object.hasOwn(e,"message")}catch(e){return!1}},iR=(e,t)=>{let{message:r}=ib.object({message:ib.string().min(1)}).catch({message:t}).parse(e);return r},iP=({type:e="error",whatHappened:t,otherwise:r,reassurance:n,toFixNow:i,why:s,consequences:o,stack:a,code:l})=>{let{icon:u,colorFn:c}={error:{icon:"",colorFn:t$.default.red},warn:{icon:"",colorFn:t$.default.yellow}}[e],d=`${u}  ${t$.default.bold.underline(t.trim())}`;a&&(d+="\n"+[...Error().stack?.split("\n").slice(1).filter(Boolean)||[]].join("\n"));let h=(Array.isArray(i)?i.map(e=>e.trim()).filter(Boolean).map((e,t)=>`	${t+1}. ${e}`).join("\n"):i?.trim())??"";Array.isArray(i)&&h&&(h=`To fix this, you can take one of the following courses of action:

${h}`);let p=[n?.trim(),s?.trim(),o?.trim()].filter(Boolean).join(" ");p+=p?`

${h}`:h;let f=[r?.trim()].filter(Boolean).join(" "),g=[ix,d,p,f,l?`Code: ${l}`:"",ix].filter(Boolean).join("\n\n");return c(g)},iN=["Set the `INNGEST_EVENT_KEY` environment variable","Pass a key to the `new Inngest()` constructor using the `eventKey` option","Use `inngest.setEventKey()` at runtime"],iD=e=>t=>{try{t.message&&=`${e}; ${t.message}`}catch(e){}finally{throw t}},iM=e=>iP({whatHappened:"Your function was stopped from running",why:"We detected a mix of asynchronous logic, some using step tooling and some not.",consequences:"This can cause unexpected behaviour when a function is paused and resumed and is therefore strongly discouraged; we stopped your function to ensure nothing unexpected happened!",stack:!0,toFixNow:"Ensure that your function is either entirely step-based or entirely non-step-based, by either wrapping all asynchronous logic in `step.run()` calls or by removing all `step.*()` calls.",otherwise:"For more information on why step functions work in this manner, see https://www.inngest.com/docs/functions/multi-step#gotchas",code:e});var ib=i_;let ij=ib.object({name:ib.string().trim().optional(),error:ib.string().trim().optional(),message:ib.string().trim().optional(),stack:ib.string().trim().optional()}),iU=ib.lazy(()=>ib.object({name:ib.string().trim(),message:ib.string().trim(),stack:ib.string().trim().optional(),cause:ib.union([iU,ib.unknown()]).optional()})),iL=ij.extend({cause:ib.union([iU,ib.unknown()]).optional()}).passthrough().catch({}).transform(e=>({...e,name:e.name||"Error",message:e.message||e.error||"Unknown error",stack:e.stack})),iF=function(e){return e.WaitForSignal="WaitForSignal",e.WaitForEvent="WaitForEvent",e.Step="Step",e.StepRun="StepRun",e.StepError="StepError",e.StepPlanned="StepPlanned",e.Sleep="Sleep",e.StepNotFound="StepNotFound",e.InvokeFunction="InvokeFunction",e.AiGateway="AIGateway",e.Gateway="Gateway",e}({});ib.object({id:ib.string().min(1),data:ib.any().optional(),error:ib.any().optional(),input:ib.any().optional()});let iB=ib.object({ids:ib.array(ib.string()).default([]),status:ib.number().default(0),error:ib.string().optional()}),iq=["fatal","error","warn","info","debug","silent"],iG=ib.strictObject({limit:ib.number(),key:ib.string().optional(),scope:ib.enum(["fn","env","account"]).optional()}),iH=ib.strictObject({name:ib.string().optional(),id:ib.string(),triggers:ib.array(ib.union([ib.strictObject({event:ib.string(),expression:ib.string().optional()}),ib.strictObject({cron:ib.string()})])),steps:ib.record(ib.strictObject({id:ib.string(),name:ib.string(),runtime:ib.strictObject({type:ib.union([ib.literal("http"),ib.literal("ws")]),url:ib.string()}),retries:ib.strictObject({attempts:ib.number().optional()}).optional()})),idempotency:ib.string().optional(),batchEvents:ib.strictObject({maxSize:ib.number(),timeout:ib.string(),key:ib.string().optional(),if:ib.string().optional()}).optional(),rateLimit:ib.strictObject({key:ib.string().optional(),limit:ib.number(),period:ib.string().transform(e=>e)}).optional(),throttle:ib.strictObject({key:ib.string().optional(),limit:ib.number(),period:ib.string().transform(e=>e),burst:ib.number().optional()}).optional(),singleton:ib.strictObject({key:ib.string().optional(),mode:ib.enum(["skip","cancel"])}).optional(),cancel:ib.array(ib.strictObject({event:ib.string(),if:ib.string().optional(),timeout:ib.string().optional()})).optional(),debounce:ib.strictObject({key:ib.string().optional(),period:ib.string().transform(e=>e),timeout:ib.string().transform(e=>e).optional()}).optional(),timeouts:ib.strictObject({start:ib.string().transform(e=>e).optional(),finish:ib.string().transform(e=>e).optional()}).optional(),priority:ib.strictObject({run:ib.string().optional()}).optional(),concurrency:ib.union([ib.number(),iG.transform(e=>e),ib.array(iG.transform(e=>e)).min(1).max(2)]).optional()}),i$=e=>({ok:!0,value:e}),iV=e=>({ok:!1,error:e}),iK=ib.strictObject({url:ib.string()});var iz=e.i(17293);let iJ=t5.V1;var iW=class{debug;constructor(e){this.options=e,this.debug=(0,iz.default)(`${t0}:${this.options.runId}`)}},ib=i_;let iY=ib.object({error:ib.string(),status:ib.number()}),iZ=ib.record(ib.any().refine(e=>void 0!==e,{message:"Values in steps must be defined"})).optional().nullable(),iX=ib.record(ib.object({type:ib.literal("data").optional().default("data"),data:ib.any().refine(e=>void 0!==e,{message:"Data in steps must be defined"})}).strict().or(ib.object({type:ib.literal("error").optional().default("error"),error:iL}).strict()).or(ib.object({type:ib.literal("input").optional().default("input"),input:ib.any().refine(e=>void 0!==e,{message:"If input is present it must not be `undefined`"})}).strict()).or(ib.any().transform(e=>({type:"data",data:e})))).default({}),iQ={[t5.V0]:iZ,[t5.V1]:iX,[t5.V2]:iX},i0=ib.array(ib.record(ib.any()).transform(e=>e));var ib=i_;let i1=e=>{let t="value",r=new Map;return(...n)=>(r.has(t)||r.set(t,e(...n)),r.get(t))},i2=(e,t)=>(...r)=>e.reduce(async(e,r)=>{let n=await e,i=await r(n);return t?await t(n,i):void 0===i?n:i},Promise.resolve(r[0])),i5=e=>void 0===e?null:e,i4=ib.object({version:ib.literal(-1).or(ib.literal(0)).or(ib.literal(1)).or(ib.literal(2)).optional().transform(e=>void 0===e?(console.debug(`No request version specified by executor; defaulting to v${iJ}`),iJ):-1===e?iJ:e)}),i3=async({data:e,api:t,version:r})=>{let n={...e};try{if(n.version===t5.V0&&n.use_api||n.version===t5.V1&&n.ctx?.use_api){if(!n.ctx?.run_id)return iV(iP({whatHappened:"failed to attempt retrieving data from API",consequences:"function execution can't continue",why:"run_id is missing from context",stack:!0}));let[e,i]=await Promise.all([t.getRunBatch(n.ctx.run_id),t.getRunSteps(n.ctx.run_id,r)]);if(!e.ok)return iV(iP({whatHappened:"failed to retrieve list of events",consequences:"function execution can't continue",why:e.error?.error,stack:!0}));if(n.events=e.value,!i.ok)return iV(iP({whatHappened:"failed to retrieve steps for function run",consequences:"function execution can't continue",why:i.error?.error,stack:!0}));n.steps=i.value}return i$(n)}catch(e){return console.error(e),iV(i6(e))}},i6=e=>{let t;return e instanceof rC&&(t=e.toString()),iP({whatHappened:"Failed to parse data from executor.",consequences:"Function execution can't continue.",toFixNow:"Make sure that your API is set up to parse incoming request bodies as JSON, like body-parser for Express (https://expressjs.com/en/resources/middleware/body-parser.html).",stack:!0,why:t})};var i9=e.i(23065);let{hmac:i8,sha256:i7}=t3.default;async function se({authToken:e,authTokenFallback:t,fetch:r,options:n,url:i}){let s=await r(i,{...n,headers:{...n?.headers,Authorization:`Bearer ${e}`}});return[401,403].includes(s.status)&&t&&(s=await r(i,{...n,headers:{...n?.headers,Authorization:`Bearer ${t}`}})),s}function st(e,t,r){let n="string"==typeof e?e:(0,i9.default)(e);return i8(i7,t.replace(/signkey-\w+-/,"")).update(n).update(r).digest("hex")}let sr=(e=100)=>new Promise(t=>{let r=0,n=()=>{Promise.resolve().then(()=>{if(r++>e)return t();n()})};n()}),sn=()=>{let e,t;return{promise:new Promise((r,n)=>{e=e=>(r(e),sn()),t=e=>(n(e),sn())}),resolve:e,reject:t}},si=()=>{let e=[],t=()=>{},r=async function*(){for(;;){let r=e.shift();r?yield r:await new Promise(e=>{t=e})}}(),n=r=>{let i=r.resolve,s=r.reject;return r.resolve=s=>(e.push(r.promise),t(),n(i(s))),r.reject=i=>(e.push(r.promise),t(),n(s(i))),r};return{deferred:n(sn()),results:r}},ss=e=>{let t,r,{promise:n,resolve:i}=sn(),s=()=>(t||(t=setTimeout(()=>{i()},e)),r),o=()=>{clearTimeout(t),t=void 0};return r=Object.assign(n,{start:s,clear:o,reset:()=>(o(),s())})},so=e=>Promise.resolve().then(e),sa=async(e,t)=>{let r=t?.maxAttempts||5,n=t?.baseDelay??100;for(let t=1;t<=r;t++)try{return await e()}catch(s){if(t>=r)throw s;let e=Math.random()*n,i=n*Math.pow(2,t-1)+e;await new Promise(e=>setTimeout(e,i))}throw Error("Max retries reached; this should be unreachable.")};var sl=class{timings={};start(e,t){this.timings[e]||(this.timings[e]={description:t??"",timers:[]});let r=this.timings[e].timers.push({start:Date.now()})-1;return()=>{let t=this.timings[e];if(!t)return console.warn(`Timing "${e}" does not exist`);let n=t.timers[r];if(!n)return console.warn(`Timer ${r} for timing "${e}" does not exist`);n.end=Date.now()}}append(e,t){this.timings[e]={description:t,timers:[]}}async wrap(e,t,r){let n=this.start(e,r);try{return await so(t)}finally{n()}}getHeader(){return Object.entries(this.timings).reduce((e,[t,{description:r,timers:n}])=>{if(!n.some(e=>e.end))return e;let i=n.reduce((e,{start:t,end:r})=>t&&r?e+(r-t):e,0);return[...e,[t,r?`desc="${r}"`:"",i?`dur=${i}`:""].filter(Boolean).join(";")]},[]).join(", ")}},ib=i_;let su=ib.object({status:ib.number().default(200),skipped:ib.boolean().optional().default(!1),modified:ib.boolean().optional().default(!1),error:ib.string().default("Successfully registered")});var sc=class{id;handler;inngestRegisterUrl;frameworkName;signingKey;signingKeyFallback;_mode;fetch;_serveHost;_servePath;logLevel;streaming;rawFns;client;fns={};env=ru();allowExpiredSignatures;_options;skipSignatureValidation;constructor(e){if(this._options=e,Object.hasOwn(e,"eventKey"))throw Error(`${tQ} You've passed an Inngest client as the first argument to your serve handler. This is no longer supported in v3; please pass the Inngest client as the \`client\` property of an options object instead. See https://www.inngest.com/docs/sdk/migration`);this.frameworkName=e.frameworkName,this.client=e.client,e.id&&console.warn(`${tQ} The \`id\` serve option is deprecated and will be removed in v4`),this.id=e.id||this.client.id,this.handler=e.handler,this.allowExpiredSignatures=!!arguments[0]?.__testingAllowExpiredSignatures,this.rawFns=e.functions.filter(Boolean),this.rawFns.length!==e.functions.length&&console.warn("Some functions passed to serve() are undefined and misconfigured.  Please check your imports."),this.fns=this.rawFns.reduce((e,t)=>{let r=t.getConfig({baseUrl:new URL("https://example.com"),appPrefix:this.id}),n=r.reduce((e,{id:r},n)=>({...e,[r]:{fn:t,onFailure:!!n}}),{});return r.forEach(({id:t})=>{if(e[t])throw Error(`Duplicate function ID "${t}"; please change a function's name or provide an explicit ID to avoid conflicts.`)}),{...e,...n}},{}),this.inngestRegisterUrl=new URL("/fn/register",this.apiBaseUrl),this.signingKey=e.signingKey,this.signingKeyFallback=e.signingKeyFallback,this._serveHost=e.serveHost||this.env[tz.InngestServeHost],this._servePath=e.servePath||this.env[tz.InngestServePath],this.skipSignatureValidation=e.skipSignatureValidation||!1;let t="info";this.logLevel=ib.enum(iq).default(t).catch(e=>(this.log("warn",`Unknown log level passed: ${String(e.input)}; defaulting to ${t}`),t)).parse(e.logLevel||this.env[tz.InngestLogLevel]),"debug"===this.logLevel&&iz.default.enable&&"function"==typeof iz.default.enable&&iz.default.enable(`${t0}:*`),this.streaming=ib.union([ib.enum(["allow","force"]),ib.literal(!1)]).default(!1).catch(e=>(this.log("warn",`Unknown streaming option passed: ${String(e.input)}; defaulting to ${String(!1)}`),!1)).parse(e.streaming||this.env[tz.InngestStreaming]),this.fetch=e.fetch?rg(e.fetch):this.client.fetch}get apiBaseUrl(){return this._options.baseUrl||this.env[tz.InngestApiBaseUrl]||this.env[tz.InngestBaseUrl]||this.client.apiBaseUrl||tW}get eventApiBaseUrl(){return this._options.baseUrl||this.env[tz.InngestEventApiBaseUrl]||this.env[tz.InngestBaseUrl]||this.client.eventBaseUrl||tY}get serveHost(){return this._serveHost||this.env[tz.InngestServeHost]}get servePath(){return this._servePath||this.env[tz.InngestServePath]}get hashedEventKey(){if(this.client.eventKey&&this.client.eventKey!==t1){let e;return e=this.client.eventKey,t8().update(e).digest("hex")}}get hashedSigningKey(){if(this.signingKey)return rr(this.signingKey)}get hashedSigningKeyFallback(){if(this.signingKeyFallback)return rr(this.signingKeyFallback)}async shouldStream(e){return await e.queryStringWithDefaults("testing for probe",tV.Probe)===void 0&&!!e.transformStreamingResponse&&("force"===this.streaming||"allow"===this.streaming&&((e,t=ru())=>rh[rp(t)]?.(e,t)??!1)(this.frameworkName,this.env))}createHandler(){let e=async(...e)=>{let t=new sl,r=e[e.length-1],n="object"==typeof r&&null!==r&&"actionOverrides"in r&&"object"==typeof r.actionOverrides&&null!==r.actionOverrides?r.actionOverrides:{},i={...Object.entries({...await t.wrap("handler",()=>this.handler(...e)).catch(iD("Serve handler failed to run")),...n}).reduce((e,[t,r])=>"function"!=typeof r?e:{...e,[t]:(e,...n)=>{let i=[`Failed calling \`${t}\` from serve handler`,e].filter(Boolean).join(" when ");return so(()=>r(...n)).catch(iD(i)).catch(e=>{throw this.log("error",e),e})}},{}),queryStringWithDefaults:async(e,t)=>{let r=await i.url(e);return await i.queryString?.(e,t,r)||r.searchParams.get(t)||void 0},...n},[s,o]=await Promise.all([i.env?.("starting to handle request"),i.headers("checking expected server kind",tJ.InngestServerKind)]);this.env={...ru(),...s};let a=()=>rc({env:this.env,framework:this.frameworkName,client:this.client,expectedServerKind:o||void 0,extras:{"Server-Timing":t.getHeader()}}),l=ra({env:this.env,client:this.client});if(l.isExplicit)this._mode=l;else{let e=await i.isProduction?.("starting to handle request");"boolean"==typeof e?this._mode=new ro({type:e?"cloud":"dev",isExplicit:!1}):this._mode=l}this.upsertKeysFromEnv();let u=i.method("starting to handle request"),c=[tJ.TraceParent,tJ.TraceState].map(async e=>{let t=await i.headers(`fetching ${e} for forwarding`,e);return{header:e,value:t}}),d=await i.headers("checking signature for request",tJ.ContentLength).then(e=>{if(e)return Number.parseInt(e,10)}),[h,p,f]=await Promise.all([i.headers("checking signature for request",tJ.Signature).then(e=>e??void 0),u,u.then(e=>"POST"===e||"PUT"===e?d?i.body(`checking body for request signing as method is ${e}`):"":"")]),g=this.validateSignature(h,f),m=Promise.all(c).then(e=>e.reduce((e,{header:t,value:r})=>(r&&(e[t]=r),e),{})),y=t.wrap("action",()=>this.handleAction({actions:i,timer:t,getInngestHeaders:a,reqArgs:e,signatureValidation:g,body:f,method:p,headers:m})),v=async e=>{let t,r={...a(),...await m,...e.headers,...null===e.version?{}:{[tJ.RequestVersion]:(e.version??iJ).toString()}};try{t=await g.then(t=>{if(t.success&&t.keyUsed)return this.getResponseSignature(t.keyUsed,e.body)})}catch(t){return{...e,headers:r,body:t7(iT(t)),status:500}}return t&&(r[tJ.Signature]=t),{...e,headers:r}};if(await this.shouldStream(i)&&await i.method("starting streaming response")==="POST"){let{stream:e,finalize:r}=await (e=>{let t,r=new Promise(e=>{t=e}),n=e?.interval??3e3,i=e?.value??" ";return new Promise(async(e,s)=>{try{let s=new ReadableStream({start(e){let r=new TextEncoder,s=setInterval(()=>{e.enqueue(r.encode(i))},n);t(t=>{clearInterval(s),Promise.resolve(t).then(t=>{e.enqueue(r.encode(t7(t))),e.close()})})}});e({stream:s,finalize:await r})}catch(e){s(e)}})})();return y.then(e=>r(v(e))),t.wrap("res",()=>i.transformStreamingResponse?.("starting streaming response",{status:201,headers:a(),body:e,version:null}))}return t.wrap("res",async()=>y.then(v).then(e=>i.transformResponse("sending back response",e)))};return Object.defineProperties(e,{name:{value:"InngestHandler"},length:{value:this.handler.length}}),e}get mode(){return this._mode}set mode(e){this._mode=e,e&&(this.client.mode=e)}async handleAction({actions:e,timer:t,getInngestHeaders:r,reqArgs:n,signatureValidation:i,body:s,method:o,headers:a}){let l=void 0===s;try{let u=await e.url("starting to handle request");if("POST"===o){if(l)return this.log("error","Missing body when executing, possibly due to missing request body middleware"),{status:500,headers:{"Content-Type":"application/json"},body:t7(iT(Error("Missing request body when executing, possibly due to missing request body middleware"))),version:void 0};let r=await i;if(!r.success)return{status:401,headers:{"Content-Type":"application/json"},body:t7(iT(r.err)),version:void 0};let o=await e.queryStringWithDefaults("testing for probe",tV.Probe);if(o){let e=((e,t)=>{if(Object.values(e).includes(t))return t})(tK,o);if(!e)return{status:400,headers:{"Content-Type":"application/json"},body:t7(iT(Error(`Unknown probe "${o}"`))),version:void 0};return({[tK.Trust]:()=>({status:200,headers:{"Content-Type":"application/json"},body:"",version:void 0})})[e]()}let u=await e.queryStringWithDefaults("processing run request",tV.FnId);if(!u)throw Error("No function ID found in request");let c=await e.queryStringWithDefaults("processing run request",tV.StepId)||null,{version:d,result:h}=this.runStep({functionId:u,data:s,stepId:c,timer:t,reqArgs:n,headers:await a}),p=await h,f=e=>(e.data=i5(e.data),e),g={"function-rejected":e=>({status:e.retriable?500:400,headers:{"Content-Type":"application/json",[tJ.NoRetry]:e.retriable?"false":"true",..."string"==typeof e.retriable?{[tJ.RetryAfter]:e.retriable}:{}},body:t7(i5(e.error)),version:d}),"function-resolved":e=>({status:200,headers:{"Content-Type":"application/json"},body:t7(i5(e.data)),version:d}),"step-not-found":e=>({status:500,headers:{"Content-Type":"application/json",[tJ.NoRetry]:"false"},body:t7({error:`Could not find step "${e.step.displayName||e.step.id}" to run; timed out`}),version:d}),"step-ran":e=>{let t=f(e.step);return{status:206,headers:{"Content-Type":"application/json",...void 0!==e.retriable?{[tJ.NoRetry]:e.retriable?"false":"true",..."string"==typeof e.retriable?{[tJ.RetryAfter]:e.retriable}:{}}:{}},body:t7([t]),version:d}},"steps-found":e=>{let t=e.steps.map(f);return{status:206,headers:{"Content-Type":"application/json"},body:t7(t),version:d}}}[p.type];try{return await g(p)}catch(e){throw this.log("error","Error handling execution result",e),e}}let c=r()[tJ.Environment]??null;if("GET"===o)return{status:200,body:t7(await this.introspectionBody({actions:e,env:c,signatureValidation:i,url:u})),headers:{"Content-Type":"application/json"},version:void 0};if("PUT"===o){let[t,n]=await Promise.all([e.queryStringWithDefaults("processing deployment request",tV.DeployId).then(e=>"undefined"===e?void 0:e),Promise.resolve(rm(this.env[tz.InngestAllowInBandSync])).then(t=>void 0===t||t?e.headers("processing deployment request",tJ.InngestSyncKind):t2.OutOfBand).then(e=>e===t2.InBand)]);if(n){if(l)return this.log("error","Missing body when syncing, possibly due to missing request body middleware"),{status:500,headers:{"Content-Type":"application/json"},body:t7(iT(Error("Missing request body when syncing, possibly due to missing request body middleware"))),version:void 0};if(!(await i).success)return{status:401,body:t7({code:"sig_verification_failed"}),headers:{"Content-Type":"application/json"},version:void 0};let r=iK.safeParse(s);if(!r.success)return{status:400,body:t7({code:"invalid_request",message:r.error.message}),headers:{"Content-Type":"application/json"},version:void 0};u=this.reqUrl(new URL(r.data.url));let n=await this.inBandRegisterBody({actions:e,deployId:t,env:c,signatureValidation:i,url:u});return{status:200,body:t7(n),headers:{"Content-Type":"application/json",[tJ.InngestSyncKind]:t2.InBand},version:void 0}}let{status:o,message:a,modified:d}=await this.register(this.reqUrl(u),t,r);return{status:o,body:t7({message:a,modified:d}),headers:{"Content-Type":"application/json",[tJ.InngestSyncKind]:t2.OutOfBand},version:void 0}}}catch(e){return{status:500,body:t7({type:"internal",...iT(e)}),headers:{"Content-Type":"application/json"},version:void 0}}return{status:405,body:JSON.stringify({message:"No action found; request was likely not POST, PUT, or GET",mode:this._mode}),headers:{},version:void 0}}runStep({functionId:e,stepId:t,data:r,timer:n,reqArgs:i,headers:s}){let o=this.fns[e];if(!o)throw Error(`Could not find function with ID "${e}"`);let a=(e=>{let t;try{return{version:t}=i4.parse(e),({[t5.V0]:()=>({version:t5.V0,...ib.object({event:ib.record(ib.any()),events:ib.array(ib.record(ib.any())).default([]),steps:iQ[t5.V0],ctx:ib.object({run_id:ib.string(),attempt:ib.number().default(0),stack:ib.object({stack:ib.array(ib.string()).nullable().transform(e=>Array.isArray(e)?e:[]),current:ib.number()}).passthrough().optional().nullable()}).optional().nullable(),use_api:ib.boolean().default(!1)}).parse(e)}),[t5.V1]:()=>({version:t5.V1,...ib.object({event:ib.record(ib.any()),events:ib.array(ib.record(ib.any())).default([]),steps:iQ[t5.V1],ctx:ib.object({run_id:ib.string(),attempt:ib.number().default(0),disable_immediate_execution:ib.boolean().default(!1),use_api:ib.boolean().default(!1),stack:ib.object({stack:ib.array(ib.string()).nullable().transform(e=>Array.isArray(e)?e:[]),current:ib.number()}).passthrough().optional().nullable()}).optional().nullable()}).parse(e)}),[t5.V2]:()=>({version:t5.V2,...ib.object({event:ib.record(ib.any()),events:ib.array(ib.record(ib.any())).default([]),steps:iQ[t5.V2],ctx:ib.object({run_id:ib.string(),attempt:ib.number().default(0),disable_immediate_execution:ib.boolean().default(!1),use_api:ib.boolean().default(!1),stack:ib.object({stack:ib.array(ib.string()).nullable().transform(e=>Array.isArray(e)?e:[]),current:ib.number()}).passthrough().optional().nullable()}).optional().nullable()}).parse(e)})})[t]()}catch(e){throw Error(i6(e))}})(r),{version:l}=a;l===t5.V1&&o.fn.shouldOptimizeParallelism?.()&&(l=t5.V2);let u=so(async()=>{let e=await i3({data:a,api:this.client.inngestApi,version:l});if(!e.ok)throw Error(e.error);let r=await ({[t5.V0]:({event:e,events:r,steps:a,ctx:l,version:u})=>{let c=Object.entries(a??{}).reduce((e,[t,r])=>({...e,[t]:{id:t,data:r}}),{});return{version:u,partialOptions:{client:this.client,runId:l?.run_id||"",data:{event:e,events:r,runId:l?.run_id||"",attempt:l?.attempt??0},stepState:c,requestedRunStep:"step"===t?void 0:t||void 0,timer:n,isFailureHandler:o.onFailure,stepCompletionOrder:l?.stack?.stack??[],reqArgs:i,headers:s}}},[t5.V1]:({event:e,events:r,steps:a,ctx:l,version:u})=>{let c=Object.entries(a??{}).reduce((e,[t,r])=>({...e,[t]:"data"===r.type?{id:t,data:r.data}:"input"===r.type?{id:t,input:r.input}:{id:t,error:r.error}}),{});return{version:u,partialOptions:{client:this.client,runId:l?.run_id||"",data:{event:e,events:r,runId:l?.run_id||"",attempt:l?.attempt??0},stepState:c,requestedRunStep:"step"===t?void 0:t||void 0,timer:n,isFailureHandler:o.onFailure,disableImmediateExecution:l?.disable_immediate_execution,stepCompletionOrder:l?.stack?.stack??[],reqArgs:i,headers:s}}},[t5.V2]:({event:e,events:r,steps:a,ctx:l,version:u})=>{let c=Object.entries(a??{}).reduce((e,[t,r])=>({...e,[t]:"data"===r.type?{id:t,data:r.data}:"input"===r.type?{id:t,input:r.input}:{id:t,error:r.error}}),{});return{version:u,partialOptions:{client:this.client,runId:l?.run_id||"",data:{event:e,events:r,runId:l?.run_id||"",attempt:l?.attempt??0},stepState:c,requestedRunStep:"step"===t?void 0:t||void 0,timer:n,isFailureHandler:o.onFailure,disableImmediateExecution:l?.disable_immediate_execution,stepCompletionOrder:l?.stack?.stack??[],reqArgs:i,headers:s}}}})[l](e.value);return o.fn.createExecution(r).start()});return{version:l,result:u}}configs(e){let t=Object.values(this.rawFns).reduce((t,r)=>[...t,...r.getConfig({baseUrl:e,appPrefix:this.id})],[]);for(let e of t){let t=iH.safeParse(e);if(!t.success){let r=t.error.errors.map(e=>e.message).join("; ");this.log("warn",`Config invalid for function "${e.id}" : ${r}`)}}return t}reqUrl(e){let t=new URL(e),r=this.serveHost||this.env[tz.InngestServeHost],n=this.servePath||this.env[tz.InngestServePath];return n&&(t.pathname=n),r&&(t=new URL(t.pathname+t.search,r)),t}registerBody({url:e,deployId:t}){return{url:e.href,deployType:"ping",framework:this.frameworkName,appName:this.id,functions:this.configs(e),sdk:`js:v${t4}`,v:"0.1",deployId:t||void 0,capabilities:{trust_probe:"v1",connect:"v1"},appVersion:this.client.appVersion}}async inBandRegisterBody({actions:e,deployId:t,env:r,signatureValidation:n,url:i}){let s=this.registerBody({deployId:t,url:i}),o=await this.introspectionBody({actions:e,env:r,signatureValidation:n,url:i}),a={app_id:this.id,appVersion:this.client.appVersion,capabilities:s.capabilities,env:r,framework:s.framework,functions:s.functions,inspection:o,platform:rp({...ru(),...this.env}),sdk_author:"inngest",sdk_language:"",sdk_version:"",sdk:s.sdk,url:s.url};return o.authentication_succeeded&&(a.sdk_language=o.sdk_language,a.sdk_version=o.sdk_version),a}async introspectionBody({actions:e,env:t,signatureValidation:r,url:n}){let i=this.registerBody({url:this.reqUrl(n),deployId:null});if(!this._mode)throw Error("No mode set; cannot introspect without mode");let s={authentication_succeeded:null,extra:{is_mode_explicit:this._mode.isExplicit},has_event_key:this.client.eventKeySet(),has_signing_key:!!this.signingKey,function_count:i.functions.length,mode:this._mode.type,schema_version:"2024-05-24"};if("cloud"===this._mode.type)try{if(!(await r).success)throw Error("Signature validation failed");s={...s,authentication_succeeded:!0,api_origin:this.apiBaseUrl,app_id:this.id,capabilities:{trust_probe:"v1",connect:"v1"},env:t,event_api_origin:this.eventApiBaseUrl,event_key_hash:this.hashedEventKey??null,extra:{...s.extra,is_streaming:await this.shouldStream(e)},framework:this.frameworkName,sdk_language:"js",sdk_version:t4,serve_origin:this.serveHost??null,serve_path:this.servePath??null,signing_key_fallback_hash:this.hashedSigningKeyFallback??null,signing_key_hash:this.hashedSigningKey??null}}catch{s={...s,authentication_succeeded:!1}}return s}async register(e,t,r){let n,i,s,o,a,l=this.registerBody({url:e,deployId:t}),u=new URL(this.inngestRegisterUrl.href);if(this._mode&&this._mode.isInferred&&this._mode.isDev){let e=rn(this.env);await ry(e,this.fetch)&&(u=rv(e,"/fn/register"))}else this._mode?.explicitDevUrl&&(u=rv(this._mode.explicitDevUrl.href,"/fn/register"));t&&u.searchParams.set(tV.DeployId,t);try{n=await se({authToken:this.hashedSigningKey,authTokenFallback:this.hashedSigningKeyFallback,fetch:this.fetch,url:u.href,options:{method:"POST",body:t7(l),headers:{...r(),[tJ.InngestSyncKind]:t2.OutOfBand},redirect:"follow"}})}catch(e){return this.log("error",e),{status:500,message:`Failed to register${e instanceof Error?`; ${e.message}`:""}`,modified:!1}}let c=await n.text(),d={};try{d=JSON.parse(c)}catch(t){this.log("warn","Couldn't unpack register response:",t);let e="Failed to register";return t instanceof Error&&(e+=`; ${t.message}`),{status:500,message:e+=`; status code: ${n.status}`,modified:!1}}try{({status:i,error:s,skipped:o,modified:a}=su.parse(d))}catch(t){this.log("warn","Invalid register response schema:",t);let e="Failed to register";return t instanceof Error&&(e+=`; ${t.message}`),{status:500,message:e+=`; status code: ${n.status}`,modified:!1}}return o||this.log("debug","registered inngest functions:",n.status,n.statusText,d),{status:i,message:s,modified:a}}upsertKeysFromEnv(){this.env[tz.InngestSigningKey]&&(this.signingKey||(this.signingKey=String(this.env[tz.InngestSigningKey])),this.client.inngestApi.setSigningKey(this.signingKey)),this.env[tz.InngestSigningKeyFallback]&&(this.signingKeyFallback||(this.signingKeyFallback=String(this.env[tz.InngestSigningKeyFallback])),this.client.inngestApi.setSigningKeyFallback(this.signingKeyFallback)),!this.client.eventKeySet()&&this.env[tz.InngestEventKey]&&this.client.setEventKey(String(this.env[tz.InngestEventKey])),this.env[tz.InngestDevServerUrl]&&this.log("warn",`Use of ${tz.InngestDevServerUrl} has been deprecated in v3; please use ${tz.InngestBaseUrl} instead. See https://www.inngest.com/docs/sdk/migration`)}async validateSignature(e,t){try{if(this.skipSignatureValidation||this._mode&&!this._mode.isCloud)return{success:!0,keyUsed:""};if(!this.signingKey)throw Error(`No signing key found in client options or ${tz.InngestSigningKey} env var. Find your keys at https://app.inngest.com/secrets`);if(!e)throw Error(`No ${tJ.Signature} provided`);return{success:!0,keyUsed:new sd(e).verifySignature({body:t,allowExpiredSignatures:this.allowExpiredSignatures,signingKey:this.signingKey,signingKeyFallback:this.signingKeyFallback})}}catch(e){return{success:!1,err:e}}}getResponseSignature(e,t){let r=Date.now(),n=st(t,e,r.toString());return`t=${r}&s=${n}`}log(e,...t){let r=["debug","info","warn","error","fatal","silent"],n=r.indexOf(this.logLevel);if(r.indexOf(e)>=n){let r=console.log;Object.hasOwn(console,e)&&(r=console[e]),r(`${tQ} ${e} -`,...t)}}},sd=class{timestamp;signature;constructor(e){let t=new URLSearchParams(e);if(this.timestamp=t.get("t")||"",this.signature=t.get("s")||"",!this.timestamp||!this.signature)throw Error(`Invalid ${tJ.Signature} provided`)}hasExpired(e){return!e&&Date.now()-new Date(1e3*Number.parseInt(this.timestamp)).valueOf()>3e5}#t({body:e,signingKey:t,allowExpiredSignatures:r}){if(this.hasExpired(r))throw Error("Signature has expired");if(st(e,t,this.timestamp)!==this.signature)throw Error("Invalid signature")}verifySignature({body:e,signingKey:t,signingKeyFallback:r,allowExpiredSignatures:n}){try{return this.#t({body:e,signingKey:t,allowExpiredSignatures:n}),t}catch(t){if(!r)throw t;return this.#t({body:e,signingKey:r,allowExpiredSignatures:n}),r}}},sh=class e{get[Symbol.toStringTag](){return e.Tag}name;init;constructor({name:e,init:t}){this.name=e,this.init=t}};(sh||(sh={})).Tag="Inngest.Middleware";let sp=async(e,t,r,n)=>{let i=sf[t];if(!i)throw Error(`No hook directions found for key "${String(t)}". This is likely a bug in the Inngest SDK.`);let s=await (await e).reduce((e,r)=>{let n=r[t];return n?[...e,n]:e},[]).reduce(async(e,t)=>[...await e,await t(r)],Promise.resolve([])),o={};for(let e of s)for(let t of Object.keys(e)){let r=[e[t]],s=o[t];s&&(r="forward"===i[t]?[s,e[t]]:[e[t],s]);let a=n[t];o[t]=i2(r,a)}for(let e of Object.keys(o))o[e]=i1(o[e]);return o},sf={onFunctionRun:{transformInput:"forward",beforeMemoization:"forward",afterMemoization:"backward",beforeExecution:"forward",afterExecution:"backward",transformOutput:"backward",beforeResponse:"forward",finished:"forward"},onSendEvent:{transformInput:"forward",transformOutput:"backward"}};var sg=class extends Error{cause;retryAfter;constructor(e,t,r){if(super(e),t instanceof Date)this.retryAfter=t.toISOString();else{let e=`${Math.ceil(("string"==typeof t?(0,t9.default)(t):t)/1e3)}`;if(!isFinite(Number(e)))throw Error("retryAfter must be a number of milliseconds, a ms-compatible string, or a Date");this.retryAfter=e}this.cause=r?.cause}},sm=class{constructor(e){this.opts=e}};let sy=Symbol.for("inngest:als"),sv=async()=>s_().then(e=>e.getStore()),s_=async()=>(globalThis[sy]??=new Promise(async t=>{try{let{AsyncLocalStorage:r}=await e.A(5389);t(new r)}catch(e){console.warn("node:async_hooks is not supported in this runtime. Experimental async context is disabled."),t({getStore:()=>void 0,run:(e,t)=>t()})}}),globalThis[sy]),sb=globalThis.fetch,sE=(0,iz.default)("inngest:fetch"),sS=(()=>{let e,t={fallback:sb};return e=Object.assign(async(t,r)=>{let n=await sv();if(!n){if(!e.fallback)throw Error("step.fetch() called outside of a function and had no fallback set");return sE("step.fetch() called outside of a function; falling back to global fetch"),e.fallback(t,r)}if(n.executingStep){if(!e.fallback)throw Error(`step.fetch() called inside step "${n.executingStep.id}" and had no fallback set`);return sE(`step.fetch() called inside step "${n.executingStep.id}"; falling back to global fetch`),e.fallback(t,r)}let i=new URL(t instanceof Request?t.url:t.toString());sE("step.fetch() shimming request to",i.hostname);let s=await n.ctx.step[sA](`step.fetch: ${i.hostname}`,t,r);return new Response(s.body,{headers:s.headers,status:s.status})},{config:r=>(Object.assign(t,r),Object.assign(e,t),e),...t})})();var ib=i_,sw=e.i(90930);let sT=e=>"string"==typeof e?{id:e}:e,sC=(e,t,r)=>{let n=(e,t)=>async(...n)=>r({args:n,matchOp:e,opts:t}),i=e=>n(({id:t,name:r},n,...i)=>{let s={...i.length?{input:i}:{},...e?{type:e}:{}};return{id:t,op:iF.StepPlanned,name:t,displayName:r??t,...Object.keys(s).length?{opts:s}:{}}},{fn:(e,t,...r)=>t(...r)}),s={sendEvent:n(({id:e,name:t})=>({id:e,op:iF.StepPlanned,name:"sendEvent",displayName:t??e,opts:{type:"step.sendEvent"}}),{fn:(r,n)=>e._send({payload:n,headers:t.options.headers})}),waitForSignal:n(({id:e,name:t},r)=>({id:e,op:iF.WaitForSignal,name:r.signal,displayName:t??e,opts:{signal:r.signal,timeout:rt(r.timeout),conflict:r.onConflict}})),sendSignal:n(({id:e,name:t},r)=>({id:e,op:iF.StepPlanned,name:"sendSignal",displayName:t??e,opts:{type:"step.sendSignal",signal:r.signal}}),{fn:(r,n)=>e._sendSignal({signal:n.signal,data:n.data,headers:t.options.headers})}),waitForEvent:n(({id:e,name:t},r)=>{let n={timeout:rt("string"==typeof r?r:r.timeout)};return"string"!=typeof r&&(r?.match?n.if=`event.${r.match} == async.${r.match}`:r?.if&&(n.if=r.if)),{id:e,op:iF.WaitForEvent,name:r.event,opts:n,displayName:t??e}}),run:i(),ai:{infer:n(({id:e,name:t},r)=>{let{model:n,body:i,...s}=r,o={...n};return r.model.onCall?.(o,r.body),{id:e,op:iF.AiGateway,displayName:t??e,opts:{type:"step.ai.infer",url:o.url,headers:o.headers,auth_key:o.authKey,format:o.format,body:i,...s}}}),wrap:i("step.ai.wrap"),models:{...sw.models}},sleep:n(({id:e,name:t},r)=>{let n=rt((e=>{try{return"Temporal.Duration"===e[Symbol.toStringTag]}catch{return!1}})(r)?r.total({unit:"milliseconds"}):r);return{id:e,op:iF.Sleep,name:n,displayName:t??e}}),sleepUntil:n(({id:e,name:t},r)=>{try{let n=(e=>{if("string"==typeof e)return new Date(e).toISOString();if(e instanceof Date)return e.toISOString();if((e=>{try{return"Temporal.ZonedDateTime"===e[Symbol.toStringTag]}catch{return!1}})(e))return e.toInstant().toString();if((e=>{try{return"Temporal.Instant"===e[Symbol.toStringTag]}catch{return!1}})(e))return e.toString();throw TypeError("Invalid date input")})(r);return{id:e,op:iF.Sleep,name:n,displayName:t??e}}catch(e){throw console.warn("Invalid `Date`, date string, `Temporal.Instant`, or `Temporal.ZonedDateTime` passed to sleepUntil;",e),Error(`Invalid \`Date\`, date string, \`Temporal.Instant\`, or \`Temporal.ZonedDateTime\` passed to sleepUntil: ${r}`)}}),invoke:n(({id:t,name:r},n)=>{let i=sO.extend({timeout:ib.union([ib.number(),ib.string(),ib.date()]).optional()}),s=i.extend({_type:ib.literal("fullId").optional().default("fullId"),function:ib.string().min(1)}).or(i.extend({_type:ib.literal("fnInstance").optional().default("fnInstance"),function:ib.instanceof(sH)})).or(i.extend({_type:ib.literal("refInstance").optional().default("refInstance"),function:ib.instanceof(sm)})).safeParse(n);if(!s.success)throw Error("Invalid invocation options passed to invoke; must include either a function or functionId.");let{_type:o,function:a,data:l,user:u,v:c,timeout:d}=s.data,h={payload:{data:l,user:u,v:c},function_id:"",timeout:void 0===d?void 0:rt(d)};switch(o){case"fnInstance":h.function_id=a.id(a.client.id);break;case"fullId":console.warn(`${tQ} Invoking function with \`function: string\` is deprecated and will be removed in v4.0.0; use an imported function or \`referenceFunction()\` instead. See https://innge.st/ts-referencing-functions`),h.function_id=a;break;case"refInstance":h.function_id=[a.opts.appId||e.id,a.opts.functionId].filter(Boolean).join("-")}return{id:t,op:iF.InvokeFunction,displayName:r??t,opts:h}}),fetch:sS};return s[sA]=n(({id:e,name:t},r,n)=>{let i=r instanceof Request?r.url:r.toString(),s={};return r instanceof Request?r.headers.forEach((e,t)=>{s[t]=e}):n?.headers&&new Headers(n.headers).forEach((e,t)=>{s[t]=e}),{id:e,op:iF.Gateway,displayName:t??e,opts:{url:i,method:n?.method??"GET",headers:s,body:n?.body}}}),s},sA=Symbol.for("inngest.step.gateway"),sO=ib.object({data:ib.record(ib.any()).optional(),user:ib.record(ib.any()).optional(),v:ib.string().optional()});var ib=i_;let{sha1:sx}=t3.default;var sI=class extends iW{state;execution;userFnToRun;fnArg;constructor(e){super(e),this.userFnToRun=this.getUserFnToRun(),this.state=this.createExecutionState(),this.fnArg=this.createFnArg()}start(){return this.debug("starting V0 execution"),this.execution??=this._start().then(e=>(this.debug("result:",e),e))}async _start(){this.state.hooks=await this.initializeMiddleware();try{await this.transformInput(),await this.state.hooks.beforeMemoization?.(),0!==this.state.opStack.length||this.options.requestedRunStep||(await this.state.hooks.afterMemoization?.(),await this.state.hooks.beforeExecution?.());let e=so(()=>this.userFnToRun(this.fnArg)),t=-1;do{if(t>=0){this.options.requestedRunStep||t!==this.state.opStack.length-1||(await this.state.hooks.afterMemoization?.(),await this.state.hooks.beforeExecution?.()),this.state.tickOps={};let e=this.state.opStack[t];if(this.state.currentOp=this.state.allFoundOps[e.id],!this.state.currentOp)throw new rb(iP({whatHappened:" Your function was stopped from running",why:"We couldn't resume your function's state because it may have changed since the run started or there are async actions in-between steps that we haven't noticed in previous executions.",consequences:"Continuing to run the function may result in unexpected behaviour, so we've stopped your function to ensure nothing unexpected happened!",toFixNow:"Ensure that your function is either entirely step-based or entirely non-step-based, by either wrapping all asynchronous logic in `step.run()` calls or by removing all `step.*()` calls.",otherwise:"For more information on why step functions work in this manner, see https://www.inngest.com/docs/functions/multi-step#gotchas",stack:!0,code:iO.NON_DETERMINISTIC_FUNCTION}));this.state.currentOp.fulfilled=!0,void 0!==e.data?this.state.currentOp.resolve(e.data):this.state.currentOp.reject(e.error)}await sr(),this.state.reset(),t++}while(t<this.state.opStack.length)await this.state.hooks.afterMemoization?.();let r=Object.values(this.state.tickOps).map(sk),n=this.options.requestedRunStep||this.getEarlyExecRunStep(r);if(n){let e=this.state.allFoundOps[n],t=e?.fn;if(!t)throw Error(`Bad stack; executor requesting to run unknown step "${n}"`);let r={...sk(e),op:iF.Step};await this.state.hooks.beforeExecution?.(),this.state.executingStep=!0;let{type:i,...s}=await so(t).finally(()=>{this.state.executingStep=!1}).catch(async e=>await this.transformOutput({error:e},r)).then(async e=>(await this.state.hooks?.afterExecution?.(),await this.transformOutput({data:e},r)));return{type:"step-ran",ctx:this.fnArg,ops:this.ops,step:{...r,...s}}}if(!r.length){let t=await Promise.race([e.then(e=>({type:"complete",data:e})),new Promise(e=>setTimeout(e)).then(()=>({type:"incomplete"}))]);if("complete"===t.type){if(await this.state.hooks.afterExecution?.(),Object.values(this.state.allFoundOps).every(e=>e.fulfilled))return await this.transformOutput({data:t.data})}else if(this.state.hasUsedTools){if(!Object.values(this.state.allFoundOps).some(e=>!1===e.fulfilled))throw new rb(iM(iO.ASYNC_DETECTED_AFTER_MEMOIZATION))}else{this.state.nonStepFnDetected=!0;let t=await e;return await this.state.hooks.afterExecution?.(),await this.transformOutput({data:t})}}return await this.state.hooks.afterExecution?.(),{type:"steps-found",ctx:this.fnArg,ops:this.ops,steps:r}}catch(e){return await this.transformOutput({error:e})}finally{await this.state.hooks.beforeResponse?.()}}async initializeMiddleware(){let e=this.options.data;return await sp(this.options.fn.middleware,"onFunctionRun",{ctx:e,fn:this.options.fn,steps:Object.values(this.options.stepState),reqArgs:this.options.reqArgs},{transformInput:(e,t)=>({ctx:{...e.ctx,...t?.ctx},fn:this.options.fn,steps:e.steps.map((e,r)=>({...e,...t?.steps?.[r]})),reqArgs:e.reqArgs}),transformOutput:(e,t)=>({result:{...e.result,...t?.result},step:e.step})})}createExecutionState(){let e={allFoundOps:{},tickOps:{},tickOpHashes:{},currentOp:void 0,hasUsedTools:!1,reset:()=>{e.tickOpHashes={},e.allFoundOps={...e.allFoundOps,...e.tickOps}},nonStepFnDetected:!1,executingStep:!1,opStack:this.options.stepCompletionOrder.reduce((e,t)=>{let r=this.options.stepState[t];return r?[...e,r]:e},[])};return e}get ops(){return Object.fromEntries(Object.entries(this.state.allFoundOps).map(([e,t])=>[e,{id:t.id,rawArgs:t.rawArgs,data:t.data,error:t.error,fulfilled:t.fulfilled,seen:!0}]))}getUserFnToRun(){if(!this.options.isFailureHandler)return this.options.fn.fn;if(!this.options.fn.onFailureFn)throw Error("Cannot find function `onFailure` handler");return this.options.fn.onFailureFn}createFnArg(){this.state.tickOps=this.state.allFoundOps;let e=e=>{let t={parent:this.state.currentOp?.id??null,op:e.op,name:e.name,opts:e.op===iF.StepPlanned?null:e.opts??null},r=sR.hashData(t),n=this.state.tickOpHashes[r]=(this.state.tickOpHashes[r]??-1)+1;return{...e,id:sR.hashData({pos:n,...t})}},t=({args:t,matchOp:r,opts:n})=>{if(this.state.nonStepFnDetected)throw new rb(iM(iO.STEP_USED_AFTER_ASYNC));if(this.state.executingStep)throw new rb(iP({whatHappened:"Your function was stopped from running",why:"We detected that you have nested `step.*` tooling.",consequences:"Nesting `step.*` tooling is not supported.",stack:!0,toFixNow:"Make sure you're not using `step.*` tooling inside of other `step.*` tooling. If you need to compose steps together, you can create a new async function and call it from within your step function, or use promise chaining.",otherwise:"For more information on step functions with Inngest, see https://www.inngest.com/docs/functions/multi-step",code:iO.NESTING_STEPS}));this.state.hasUsedTools=!0;let i=e(r(sT(t[0]),...t.slice(1)));return new Promise((e,r)=>{this.state.tickOps[i.id]={...i,...n?.fn?{fn:()=>n.fn?.(...t)}:{},rawArgs:t,resolve:e,reject:r,fulfilled:!1}})},r=sC(this.options.client,this,t),n={...this.options.data,step:r};if(this.options.isFailureHandler){let e=ib.object({error:iL}).parse(n.event?.data);n={...n,error:iA(e.error)}}return this.options.transformCtx?.(n)??n}async transformInput(){let e=await this.state.hooks?.transformInput?.({ctx:{...this.fnArg},steps:Object.values(this.options.stepState),fn:this.options.fn,reqArgs:this.options.reqArgs});e?.ctx&&(this.fnArg=e.ctx),e?.steps&&(this.state.opStack=[...e.steps])}getEarlyExecRunStep(e){if(1!==e.length)return;let t=e[0];if(t&&t.op===iF.StepPlanned)return t.id}async transformOutput(e,t){let r={...e};void 0!==r.error&&(r.data=iT(r.error));let n=await this.state.hooks?.transformOutput?.({result:{...r},step:t}),{data:i,error:s}={...r,...n?.result};if(t||await this.state.hooks?.finished?.({result:{...void 0!==s?{error:s}:{data:i}}}),void 0!==s){let e=!(s instanceof rb);e&&s instanceof sg&&(e=s.retryAfter);let t=iT(s);return{type:"function-rejected",ctx:this.fnArg,ops:this.ops,error:t,retriable:e}}return{type:"function-resolved",ctx:this.fnArg,ops:this.ops,data:i5(i)}}};let sk=e=>({op:e.op,id:e.id,name:e.name,opts:e.opts}),sR={hashData:e=>sx().update((0,i9.default)(e)).digest("hex")},sP=new WeakMap;var sN=class extends Error{cause;constructor(e,t){let r=iL.parse(t);super(r.message),this.stepId=e,this.name=r.name,this.stepId=e,this.stack=r.stack??void 0,this.cause=r.cause?iA(r.cause,!0):void 0}},ib=i_,sD=e.i(84886);let{sha1:sM}=t3.default;var sj=class extends iW{state;fnArg;checkpointHandlers;timeoutDuration=1e4;execution;userFnToRun;timeout;constructor(e){super(e),this.userFnToRun=this.getUserFnToRun(),this.state=this.createExecutionState(),this.fnArg=this.createFnArg(),this.checkpointHandlers=this.createCheckpointHandlers(),this.initializeTimer(this.state),this.debug("created new V1 execution for run;",this.options.requestedRunStep?`wanting to run step "${this.options.requestedRunStep}"`:"discovering steps"),this.debug("existing state keys:",Object.keys(this.state.stepState))}start(){if(!this.execution){this.debug("starting V1 execution");let e=sD.trace.getTracer("inngest",t4);this.execution=s_().then(t=>t.run({app:this.options.client,ctx:this.fnArg},async()=>e.startActiveSpan("inngest.execution",e=>(sP.get(this.options.client)?.declareStartingSpan({span:e,runId:this.options.runId,traceparent:this.options.headers[tJ.TraceParent],tracestate:this.options.headers[tJ.TraceState]}),this._start().then(e=>(this.debug("result:",e),e)).finally(()=>{e.end()})))))}return this.execution}async _start(){try{let e=this.getCheckpointHandler("");for await(let t of(this.state.hooks=await this.initializeMiddleware(),await this.startExecution(),this.state.loop)){await e(t);let r=await this.getCheckpointHandler(t.type)(t);if(r)return r}}catch(e){return await this.transformOutput({error:e})}finally{this.state.loop.return(),await this.state.hooks?.beforeResponse?.()}throw Error("Core loop finished without returning a value")}createCheckpointHandlers(){return{"":e=>{this.debug("checkpoint:",e)},"function-resolved":async e=>await this.transformOutput({data:e.data}),"function-rejected":async e=>await this.transformOutput({error:e.error}),"steps-found":async({steps:e})=>{let t=await this.tryExecuteStep(e);if(t){let e=await this.transformOutput(t);return"function-resolved"===e.type?{type:"step-ran",ctx:e.ctx,ops:e.ops,step:sL.hashOp({...t,data:e.data})}:"function-rejected"===e.type?{type:"step-ran",ctx:e.ctx,ops:e.ops,step:sL.hashOp({...t,error:e.error}),retriable:e.retriable}:e}let r=await this.filterNewSteps(Array.from(this.state.steps.values()));if(r)return{type:"steps-found",ctx:this.fnArg,ops:this.ops,steps:r}},"step-not-found":({step:e})=>({type:"step-not-found",ctx:this.fnArg,ops:this.ops,step:e})}}getCheckpointHandler(e){return this.checkpointHandlers[e]}async tryExecuteStep(e){let t=this.options.requestedRunStep||this.getEarlyExecRunStep(e);if(!t)return;let r=e.find(e=>e.hashedId===t&&e.fn);if(r)return await this.executeStep(r);this.timeout?.reset()}getEarlyExecRunStep(e){if(this.options.disableImmediateExecution)return;let t=e.filter(e=>!e.fulfilled);if(1!==t.length)return;let r=t[0];if(r&&r.op===iF.StepPlanned)return r.hashedId}async filterNewSteps(e){if(this.options.requestedRunStep)return;let t=e.filter(e=>!e.fulfilled);if(!t.length)return;let r=0;for(let t of e)t.fulfilled&&r++;this.state.stepsToFulfill!==r&&console.warn(iP({type:"warn",whatHappened:"Function may be indeterminate",why:"We found new steps before seeing all previous steps, which may indicate that the function is non-deterministic.",consequences:"This may cause unexpected behaviour as Inngest executes your function.",reassurance:"This is expected if a function is updated in the middle of a run, but may indicate a bug if not."})),await this.state.hooks?.afterMemoization?.(),await this.state.hooks?.beforeExecution?.(),await this.state.hooks?.afterExecution?.();let n=t.map(e=>({displayName:e.displayName,op:e.op,id:e.hashedId,name:e.name,opts:e.opts}));return await this.transformNewSteps(n)}async transformNewSteps(e){return Promise.all(e.map(async e=>{if(e.op!==iF.InvokeFunction)return e;let t=await (await sp(this.options.fn.middleware,"onSendEvent",void 0,{transformInput:(e,t)=>({...e,...t}),transformOutput:(e,t)=>({result:{...e.result,...t?.result}})})).transformInput?.({payloads:[{...e.opts?.payload??{},name:tX.FunctionInvoked}]}),r=sO.parse(t?.payloads?.[0]??{});return{...e,opts:{...e.opts,payload:{...e.opts?.payload??{},...r}}}}))}async executeStep({id:e,name:t,opts:r,fn:n,displayName:i}){this.timeout?.clear(),await this.state.hooks?.afterMemoization?.(),await this.state.hooks?.beforeExecution?.();let s={id:e,op:iF.StepRun,name:t,opts:r,displayName:i};this.state.executingStep=s;let o=await sv();return o&&(o.executingStep={id:e,name:i}),this.debug(`executing step "${e}"`),so(n).finally(async()=>{o&&delete o.executingStep,await this.state.hooks?.afterExecution?.()}).then(e=>({...s,data:e})).catch(e=>({...s,op:iF.StepError,error:e}))}async startExecution(){await this.transformInput(),this.timeout?.start(),await this.state.hooks?.beforeMemoization?.(),this.state.allStateUsed()&&(await this.state.hooks?.afterMemoization?.(),await this.state.hooks?.beforeExecution?.()),so(()=>this.userFnToRun(this.fnArg)).finally(async()=>{await this.state.hooks?.afterMemoization?.(),await this.state.hooks?.beforeExecution?.(),await this.state.hooks?.afterExecution?.()}).then(e=>{this.state.setCheckpoint({type:"function-resolved",data:e})}).catch(e=>{this.state.setCheckpoint({type:"function-rejected",error:e})})}async transformInput(){let e=await this.state.hooks?.transformInput?.({ctx:{...this.fnArg},steps:Object.values(this.state.stepState),fn:this.options.fn,reqArgs:this.options.reqArgs});e?.ctx&&(this.fnArg=e.ctx),e?.steps&&(this.state.stepState=Object.fromEntries(e.steps.map(e=>[e.id,e])))}async transformOutput(e){let t={...e};void 0!==t.error&&(t.data=iT(t.error));let r=!!this.state.executingStep,n=await this.state.hooks?.transformOutput?.({result:{...t},step:this.state.executingStep}),{data:i,error:s}={...t,...n?.result};if(r||await this.state.hooks?.finished?.({result:{...void 0!==s?{error:s}:{data:i}}}),void 0!==s){let e=!(s instanceof rb||s instanceof sN);e&&s instanceof sg&&(e=s.retryAfter);let t=iI(iT(s));return{type:"function-rejected",ctx:this.fnArg,ops:this.ops,error:t,retriable:e}}return{type:"function-resolved",ctx:this.fnArg,ops:this.ops,data:i5(i)}}createExecutionState(){let e=si(),t=e.deferred.resolve,r=e.results,n=async function*(e){try{for(;;){let e=(await r.next()).value;e&&(yield e)}}finally{e?.()}}(()=>{this.timeout?.clear(),r.return()}),i=Object.keys(this.options.stepState).length;return{stepState:this.options.stepState,stepsToFulfill:i,steps:new Map,loop:n,hasSteps:!!i,stepCompletionOrder:[...this.options.stepCompletionOrder],remainingStepsToBeSeen:new Set(this.options.stepCompletionOrder),setCheckpoint:e=>{({resolve:t}=t(e))},allStateUsed:()=>0===this.state.remainingStepsToBeSeen.size}}get ops(){return Object.fromEntries(this.state.steps)}createFnArg(){let e=this.createStepTools(),t={...this.options.data,step:e};if(this.options.isFailureHandler){let e=ib.object({error:iL}).parse(t.event?.data);t={...t,error:iA(e.error)}}return this.options.transformCtx?.(t)??t}createStepTools(){let e,t,r=new Map,n=new Map,i=new Map,s=this.state.stepCompletionOrder.slice(),o=!1,a=0,l=e=>{o||this.state.steps.has(e)&&!r.has(e)&&(o=!0,console.warn(iP({type:"warn",whatHappened:"We detected that you have multiple steps with the same ID.",code:iO.AUTOMATIC_PARALLEL_INDEXING,why:`This can happen if you're using the same ID for multiple steps across different chains of parallel work. We found the issue with step "${e}".`,reassurance:"Your function is still running, though it may exhibit unexpected behaviour.",consequences:"Using the same IDs across parallel chains of work can cause unexpected behaviour.",toFixNow:"We recommend using a unique ID for each step, especially those happening in parallel."})))},u=()=>{let i;e||(++a>=10?(a=0,i=new Promise(e=>setTimeout(e))):i=sr(),e=i.then(()=>t).then(()=>{e=void 0;for(let e=0;e<s.length;e++){let t=s[e];if(t&&n.get(t)?.handle()){s.splice(e,1),n.delete(t),u();return}}let t=[...r.values()];r.clear(),n.clear(),this.state.setCheckpoint({type:"steps-found",steps:t})}))},c=async({args:e,matchOp:s,opts:o})=>{let a;await t;let c=s(sT(e[0]),...e.slice(1));if(this.state.executingStep&&console.warn(iP({whatHappened:`We detected that you have nested \`step.*\` tooling in \`${c.displayName??c.id}\``,consequences:"Nesting `step.*` tooling is not supported.",type:"warn",reassurance:"It's possible to see this warning if steps are separated by regular asynchronous calls, which is fine.",stack:!0,toFixNow:"Make sure you're not using `step.*` tooling inside of other `step.*` tooling. If you need to compose steps together, you can create a new async function and call it from within your step function, or use promise chaining.",code:iO.NESTING_STEPS})),this.state.steps.has(c.id)){let e=c.id;l(e);let t=i.get(e)??1;for(let r=t;;r++){let t=e+":"+r;if(!this.state.steps.has(t)){i.set(e,r+1),c.id=t;break}}}let{promise:d,resolve:h,reject:p}=sn(),f=sL.hashId(c.id),g=this.state.stepState[f],m=!1;g&&(g.seen=!0,this.state.remainingStepsToBeSeen.delete(f),void 0===g.input&&(m=!0));let y=[...e];if(void 0!==g?.input&&Array.isArray(g.input))switch(c.op){case iF.StepPlanned:y=[...e.slice(0,2),...g.input],a={input:[...g.input]};break;case iF.AiGateway:a={body:{..."object"==typeof c.opts?.body?{...c.opts.body}:{},...g.input[0]}}}let v={...c,opts:{...c.opts,...a},rawArgs:y,hashedId:f,input:g?.input,fn:o?.fn?()=>o.fn?.(...y):void 0,promise:d,fulfilled:m,hasStepState:!!g,displayName:c.displayName??c.id,handled:!1,handle:()=>!v.handled&&(v.handled=!0,m&&g&&(g.fulfilled=!0,Promise.all([g.data,g.error,g.input]).then(()=>{void 0!==g.data?h(g.data):(this.state.recentlyRejectedStepError=new sN(c.id,g.error),p(this.state.recentlyRejectedStepError))})),!0)};return this.state.steps.set(c.id,v),this.state.hasSteps=!0,r.set(v.id,v),n.set(v.hashedId,v),u(),!t&&this.state.allStateUsed()&&await (t=(async()=>{await this.state.hooks?.afterMemoization?.(),await this.state.hooks?.beforeExecution?.()})()),d};return sC(this.options.client,this,c)}getUserFnToRun(){if(!this.options.isFailureHandler)return this.options.fn.fn;if(!this.options.fn.onFailureFn)throw Error("Cannot find function `onFailure` handler");return this.options.fn.onFailureFn}initializeTimer(e){this.options.requestedRunStep&&(this.timeout=ss(this.timeoutDuration),this.timeout.then(async()=>{await this.state.hooks?.afterMemoization?.(),await this.state.hooks?.beforeExecution?.(),await this.state.hooks?.afterExecution?.(),e.setCheckpoint({type:"step-not-found",step:{id:this.options.requestedRunStep,op:iF.StepNotFound}})}))}async initializeMiddleware(){let e=this.options.data;return await sp(this.options.fn.middleware,"onFunctionRun",{ctx:e,fn:this.options.fn,steps:Object.values(this.options.stepState),reqArgs:this.options.reqArgs},{transformInput:(e,t)=>({ctx:{...e.ctx,...t?.ctx},fn:this.options.fn,steps:e.steps.map((e,r)=>({...e,...t?.steps?.[r]})),reqArgs:e.reqArgs}),transformOutput:(e,t)=>({result:{...e.result,...t?.result},step:e.step})})}};let sU=e=>sM().update(e).digest("hex"),sL={hashOp:e=>({...e,id:sU(e.id)}),hashId:sU};var ib=i_;let{sha1:sF}=t3.default;var sB=class extends iW{state;fnArg;checkpointHandlers;timeoutDuration=1e4;execution;userFnToRun;timeout;constructor(e){super(e),this.userFnToRun=this.getUserFnToRun(),this.state=this.createExecutionState(),this.fnArg=this.createFnArg(),this.checkpointHandlers=this.createCheckpointHandlers(),this.initializeTimer(this.state),this.debug("created new V2 execution for run;",this.options.requestedRunStep?`wanting to run step "${this.options.requestedRunStep}"`:"discovering steps"),this.debug("existing state keys:",Object.keys(this.state.stepState))}start(){if(!this.execution){this.debug("starting V2 execution");let e=sD.trace.getTracer("inngest",t4);this.execution=s_().then(t=>t.run({app:this.options.client,ctx:this.fnArg},async()=>e.startActiveSpan("inngest.execution",e=>(sP.get(this.options.client)?.declareStartingSpan({span:e,runId:this.options.runId,traceparent:this.options.headers[tJ.TraceParent],tracestate:this.options.headers[tJ.TraceState]}),this._start().then(e=>(this.debug("result:",e),e)).finally(()=>{e.end()})))))}return this.execution}async _start(){try{let e=this.getCheckpointHandler("");for await(let t of(this.state.hooks=await this.initializeMiddleware(),await this.startExecution(),this.state.loop)){await e(t);let r=await this.getCheckpointHandler(t.type)(t);if(r)return r}}catch(e){return await this.transformOutput({error:e})}finally{this.state.loop.return(),await this.state.hooks?.beforeResponse?.()}throw Error("Core loop finished without returning a value")}createCheckpointHandlers(){return{"":e=>{this.debug("checkpoint:",e)},"function-resolved":async e=>await this.transformOutput({data:e.data}),"function-rejected":async e=>await this.transformOutput({error:e.error}),"steps-found":async({steps:e})=>{let t=await this.tryExecuteStep(e);if(t){let e=await this.transformOutput(t);return"function-resolved"===e.type?{type:"step-ran",ctx:e.ctx,ops:e.ops,step:sG.hashOp({...t,data:e.data})}:"function-rejected"===e.type?{type:"step-ran",ctx:e.ctx,ops:e.ops,step:sG.hashOp({...t,error:e.error}),retriable:e.retriable}:e}let r=await this.filterNewSteps(Array.from(this.state.steps.values()));if(r)return{type:"steps-found",ctx:this.fnArg,ops:this.ops,steps:r}},"step-not-found":({step:e})=>({type:"step-not-found",ctx:this.fnArg,ops:this.ops,step:e})}}getCheckpointHandler(e){return this.checkpointHandlers[e]}async tryExecuteStep(e){let t=this.options.requestedRunStep||this.getEarlyExecRunStep(e);if(!t)return;let r=e.find(e=>e.hashedId===t&&e.fn);if(r)return await this.executeStep(r);this.timeout?.reset()}getEarlyExecRunStep(e){if(this.options.disableImmediateExecution)return;let t=e.filter(e=>!e.fulfilled);if(1!==t.length)return;let r=t[0];if(r&&r.op===iF.StepPlanned)return r.hashedId}async filterNewSteps(e){if(this.options.requestedRunStep)return;let t=e.filter(e=>!e.fulfilled);if(!t.length)return;let r=0;for(let t of e)t.fulfilled&&r++;this.state.stepsToFulfill!==r&&console.warn(iP({type:"warn",whatHappened:"Function may be indeterminate",why:"We found new steps before seeing all previous steps, which may indicate that the function is non-deterministic.",consequences:"This may cause unexpected behaviour as Inngest executes your function.",reassurance:"This is expected if a function is updated in the middle of a run, but may indicate a bug if not."})),await this.state.hooks?.afterMemoization?.(),await this.state.hooks?.beforeExecution?.(),await this.state.hooks?.afterExecution?.();let n=t.map(e=>({displayName:e.displayName,op:e.op,id:e.hashedId,name:e.name,opts:e.opts}));return await this.transformNewSteps(n)}async transformNewSteps(e){return Promise.all(e.map(async e=>{if(e.op!==iF.InvokeFunction)return e;let t=await (await sp(this.options.fn.middleware,"onSendEvent",void 0,{transformInput:(e,t)=>({...e,...t}),transformOutput:(e,t)=>({result:{...e.result,...t?.result}})})).transformInput?.({payloads:[{...e.opts?.payload??{},name:tX.FunctionInvoked}]}),r=sO.parse(t?.payloads?.[0]??{});return{...e,opts:{...e.opts,payload:{...e.opts?.payload??{},...r}}}}))}async executeStep({id:e,name:t,opts:r,fn:n,displayName:i}){this.timeout?.clear(),await this.state.hooks?.afterMemoization?.(),await this.state.hooks?.beforeExecution?.();let s={id:e,op:iF.StepRun,name:t,opts:r,displayName:i};this.state.executingStep=s;let o=await sv();return o&&(o.executingStep={id:e,name:i}),this.debug(`executing step "${e}"`),so(n).finally(async()=>{o&&delete o.executingStep,await this.state.hooks?.afterExecution?.()}).then(e=>({...s,data:e})).catch(e=>({...s,op:iF.StepError,error:e}))}async startExecution(){await this.transformInput(),this.timeout?.start(),await this.state.hooks?.beforeMemoization?.(),this.state.allStateUsed()&&(await this.state.hooks?.afterMemoization?.(),await this.state.hooks?.beforeExecution?.()),so(()=>this.userFnToRun(this.fnArg)).finally(async()=>{await this.state.hooks?.afterMemoization?.(),await this.state.hooks?.beforeExecution?.(),await this.state.hooks?.afterExecution?.()}).then(e=>{this.state.setCheckpoint({type:"function-resolved",data:e})}).catch(e=>{this.state.setCheckpoint({type:"function-rejected",error:e})})}async transformInput(){let e=await this.state.hooks?.transformInput?.({ctx:{...this.fnArg},steps:Object.values(this.state.stepState),fn:this.options.fn,reqArgs:this.options.reqArgs});e?.ctx&&(this.fnArg=e.ctx),e?.steps&&(this.state.stepState=Object.fromEntries(e.steps.map(e=>[e.id,e])))}async transformOutput(e){let t={...e};void 0!==t.error&&(t.data=iT(t.error));let r=!!this.state.executingStep,n=await this.state.hooks?.transformOutput?.({result:{...t},step:this.state.executingStep}),{data:i,error:s}={...t,...n?.result};if(r||await this.state.hooks?.finished?.({result:{...void 0!==s?{error:s}:{data:i}}}),void 0!==s){let e=!(s instanceof rb||s instanceof sN);e&&s instanceof sg&&(e=s.retryAfter);let t=iI(iT(s));return{type:"function-rejected",ctx:this.fnArg,ops:this.ops,error:t,retriable:e}}return{type:"function-resolved",ctx:this.fnArg,ops:this.ops,data:i5(i)}}createExecutionState(){let e=si(),t=e.deferred.resolve,r=e.results,n=async function*(e){try{for(;;){let e=(await r.next()).value;e&&(yield e)}}finally{e?.()}}(()=>{this.timeout?.clear(),r.return()}),i=Object.keys(this.options.stepState).length;return{stepState:this.options.stepState,stepsToFulfill:i,steps:new Map,loop:n,hasSteps:!!i,stepCompletionOrder:[...this.options.stepCompletionOrder],remainingStepsToBeSeen:new Set(this.options.stepCompletionOrder),setCheckpoint:e=>{({resolve:t}=t(e))},allStateUsed:()=>0===this.state.remainingStepsToBeSeen.size}}get ops(){return Object.fromEntries(this.state.steps)}createFnArg(){let e=this.createStepTools(),t={...this.options.data,step:e};if(this.options.isFailureHandler){let e=ib.object({error:iL}).parse(t.event?.data);t={...t,error:iA(e.error)}}return this.options.transformCtx?.(t)??t}createStepTools(){let e,t,r=new Map,n=new Map,i=new Map,s=()=>{e||(e=new Promise(e=>setImmediate(e)).then(()=>t).then(()=>{for(let[t,i]of(e=void 0,n))i.handle()&&(n.delete(t),i.fulfilled&&r.delete(i.id));if(r.size){let e=[...r.values()];r.clear(),this.state.setCheckpoint({type:"steps-found",steps:e});return}}))},o=async({args:e,matchOp:o,opts:a})=>{let l;await t;let u=o(sT(e[0]),...e.slice(1));if(this.state.executingStep&&console.warn(iP({whatHappened:`We detected that you have nested \`step.*\` tooling in \`${u.displayName??u.id}\``,consequences:"Nesting `step.*` tooling is not supported.",type:"warn",reassurance:"It's possible to see this warning if steps are separated by regular asynchronous calls, which is fine.",stack:!0,toFixNow:"Make sure you're not using `step.*` tooling inside of other `step.*` tooling. If you need to compose steps together, you can create a new async function and call it from within your step function, or use promise chaining.",code:iO.NESTING_STEPS})),this.state.steps.has(u.id)){let e=u.id,t=i.get(e)??1;for(let r=t;;r++){let t=e+":"+r;if(!this.state.steps.has(t)){i.set(e,r+1),u.id=t;break}}}let{promise:c,resolve:d,reject:h}=sn(),p=sG.hashId(u.id),f=this.state.stepState[p],g=!1;f&&(f.seen=!0,this.state.remainingStepsToBeSeen.delete(p),void 0===f.input&&(g=!0));let m=[...e];if(void 0!==f?.input&&Array.isArray(f.input))switch(u.op){case iF.StepPlanned:m=[...e.slice(0,2),...f.input],l={input:[...f.input]};break;case iF.AiGateway:l={body:{..."object"==typeof u.opts?.body?{...u.opts.body}:{},...f.input[0]}}}let y={...u,opts:{...u.opts,...l},rawArgs:m,hashedId:p,input:f?.input,fn:a?.fn?()=>a.fn?.(...m):void 0,promise:c,fulfilled:g,hasStepState:!!f,displayName:u.displayName??u.id,handled:!1,handle:()=>!y.handled&&(y.handled=!0,g&&f&&(f.fulfilled=!0,Promise.all([f.data,f.error,f.input]).then(()=>{void 0!==f.data?d(f.data):(this.state.recentlyRejectedStepError=new sN(u.id,f.error),h(this.state.recentlyRejectedStepError))})),!0)};return this.state.steps.set(u.id,y),this.state.hasSteps=!0,r.set(y.id,y),n.set(y.hashedId,y),s(),!t&&this.state.allStateUsed()&&await (t=(async()=>{await this.state.hooks?.afterMemoization?.(),await this.state.hooks?.beforeExecution?.()})()),c};return sC(this.options.client,this,o)}getUserFnToRun(){if(!this.options.isFailureHandler)return this.options.fn.fn;if(!this.options.fn.onFailureFn)throw Error("Cannot find function `onFailure` handler");return this.options.fn.onFailureFn}initializeTimer(e){this.options.requestedRunStep&&(this.timeout=ss(this.timeoutDuration),this.timeout.then(async()=>{await this.state.hooks?.afterMemoization?.(),await this.state.hooks?.beforeExecution?.(),await this.state.hooks?.afterExecution?.(),e.setCheckpoint({type:"step-not-found",step:{id:this.options.requestedRunStep,op:iF.StepNotFound}})}))}async initializeMiddleware(){let e=this.options.data;return await sp(this.options.fn.middleware,"onFunctionRun",{ctx:e,fn:this.options.fn,steps:Object.values(this.options.stepState),reqArgs:this.options.reqArgs},{transformInput:(e,t)=>({ctx:{...e.ctx,...t?.ctx},fn:this.options.fn,steps:e.steps.map((e,r)=>({...e,...t?.steps?.[r]})),reqArgs:e.reqArgs}),transformOutput:(e,t)=>({result:{...e.result,...t?.result},step:e.step})})}};let sq=e=>sF().update(e).digest("hex"),sG={hashOp:e=>({...e,id:sq(e.id)}),hashId:sq};var sH=class e{static stepId="step";static failureSuffix="-failure";get[Symbol.toStringTag](){return e.Tag}opts;fn;onFailureFn;client;middleware;constructor(e,t,r){this.client=e,this.opts=t,this.fn=r,this.onFailureFn=this.opts.onFailure,this.middleware=this.client.initializeMiddleware(this.opts.middleware,{registerInput:{fn:this},prefixStack:this.client.middleware})}id(e){return[e,this.opts.id].filter(Boolean).join("-")}get absoluteId(){return this.id(this.client.id)}get name(){return this.opts.name||this.id()}get description(){return this.opts.description}getConfig({baseUrl:t,appPrefix:r,isConnect:n}){let i=this.id(r),s=new URL(t.href);s.searchParams.set(tV.FnId,i),s.searchParams.set(tV.StepId,e.stepId);let{retries:o,cancelOn:a,idempotency:l,batchEvents:u,rateLimit:c,throttle:d,concurrency:h,debounce:p,timeouts:f,priority:g,singleton:m}=this.opts,y={id:i,name:this.name,triggers:(this.opts.triggers??[]).map(e=>"event"in e?{event:e.event,expression:e.if}:{cron:e.cron}),steps:{[e.stepId]:{id:e.stepId,name:e.stepId,runtime:{type:n?"ws":"http",url:s.href},retries:void 0===o?void 0:{attempts:o}}},idempotency:l,batchEvents:u,rateLimit:c,throttle:d,concurrency:h,debounce:p,priority:g,timeouts:f,singleton:m};a&&(y.cancel=a.map(({event:e,timeout:t,if:r,match:n})=>{let i={event:e};return t&&(i.timeout=rt(t)),n?i.if=`event.${n} == async.${n}`:r&&(i.if=r),i},[]));let v=[y];if(this.onFailureFn){let t=`${y.id}${e.failureSuffix}`,r=`${y.name??y.id} (failure)`,n=new URL(s.href);n.searchParams.set(tV.FnId,t),v.push({id:t,name:r,triggers:[{event:tX.FunctionFailed,expression:`event.data.function_id == '${i}'`}],steps:{[e.stepId]:{id:e.stepId,name:e.stepId,runtime:{type:"http",url:n.href},retries:{attempts:1}}}})}return v}createExecution(e){let t={fn:this,...e.partialOptions};return({[t5.V2]:()=>new sB(t),[t5.V1]:()=>new sj(t),[t5.V0]:()=>new sI(t)})[e.version]()}shouldOptimizeParallelism(){return this.opts.optimizeParallelism??this.client.options.optimizeParallelism??!1}};(sH||(sH={})).Tag="Inngest.Function";var ib=i_;let s$=ib.object({jwt:ib.string()}),sV=ib.object({data:ib.object({run_id:ib.string().min(1)})});var sK=class{apiBaseUrl;signingKey;signingKeyFallback;fetch;mode;constructor({baseUrl:e,signingKey:t,signingKeyFallback:r,fetch:n,mode:i}){this.apiBaseUrl=e,this.signingKey=t,this.signingKeyFallback=r,this.fetch=n,this.mode=i}get hashedKey(){return rr(this.signingKey)}get hashedFallbackKey(){if(this.signingKeyFallback)return rr(this.signingKeyFallback)}setSigningKey(e){"string"==typeof e&&""===this.signingKey&&(this.signingKey=e)}setSigningKeyFallback(e){"string"!=typeof e||this.signingKeyFallback||(this.signingKeyFallback=e)}async getTargetUrl(e){if(this.apiBaseUrl)return new URL(e,this.apiBaseUrl);let t=new URL(e,tW);return this.mode.isDev&&this.mode.isInferred&&!this.apiBaseUrl&&await ry(tZ,this.fetch)&&(t=new URL(e,tZ)),t}async getRunSteps(e,t){return se({authToken:this.hashedKey,authTokenFallback:this.hashedFallbackKey,fetch:this.fetch,url:await this.getTargetUrl(`/v0/runs/${e}/actions`)}).then(async e=>{let r=await e.json();return e.ok?i$(iQ[t].parse(r)):iV(iY.parse(r))}).catch(e=>iV({error:iR(e,"Unknown error retrieving step data"),status:500}))}async getRunBatch(e){return se({authToken:this.hashedKey,authTokenFallback:this.hashedFallbackKey,fetch:this.fetch,url:await this.getTargetUrl(`/v0/runs/${e}/batch`)}).then(async e=>{let t=await e.json();return e.ok?i$(i0.parse(t)):iV(iY.parse(t))}).catch(e=>iV({error:iR(e,"Unknown error retrieving event batch"),status:500}))}async publish(e,t){let r=t instanceof ReadableStream,n=await this.getTargetUrl("/v1/realtime/publish");return n.searchParams.set("channel",e.channel||""),e.runId&&n.searchParams.set("run_id",e.runId),e.topics.forEach(e=>{n.searchParams.append("topic",e)}),se({authToken:this.hashedKey,authTokenFallback:this.hashedFallbackKey,fetch:this.fetch,url:n,options:{method:"POST",body:r||"string"==typeof t?t:JSON.stringify(t),headers:{"Content-Type":r?"text/stream":"application/json"},...r?{duplex:"half"}:{}}}).then(e=>{if(!e.ok)throw Error(`Failed to publish event: ${e.status} ${e.statusText}`);return i$(void 0)}).catch(e=>iV({error:iR(e,"Unknown error publishing event"),status:500}))}async sendSignal(e,t){let r=await this.getTargetUrl("/v1/signals"),n={signal:e.signal,data:e.data};return se({authToken:this.hashedKey,authTokenFallback:this.hashedFallbackKey,fetch:this.fetch,url:r,options:{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json",...t?.headers}}}).then(async e=>{let t;if(404===e.status)return i$({runId:void 0});let r=e.clone();try{t=await e.json()}catch{return iV({error:`Failed to send signal: ${e.status} ${e.statusText} - ${await r.text()}`,status:e.status})}if(!e.ok)try{return iV(iY.parse(t))}catch{return iV({error:`Failed to send signal: ${e.status} ${e.statusText} - ${await e.text()}`,status:e.status})}let n=sV.safeParse(t);return n.success?i$({runId:n.data.data.run_id}):iV({error:`Successfully sent signal, but response parsing failed: ${e.status} ${e.statusText} - ${await r.text()}`,status:e.status})}).catch(e=>iV({error:iR(e,"Unknown error sending signal"),status:500}))}async getSubscriptionToken(e,t){let r=await this.getTargetUrl("/v1/realtime/token"),n=t.map(t=>({channel:e,name:t,kind:"run"}));return se({authToken:this.hashedKey,authTokenFallback:this.hashedFallbackKey,fetch:this.fetch,url:r,options:{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}}).then(async e=>{if(!e.ok)throw Error(`Failed to get subscription token: ${e.status} ${e.statusText} - ${await e.text()}`);return s$.parse(await e.json()).jwt}).catch(e=>{throw Error(iR(e,"Unknown error getting subscription token"))})}},sz=class{info(...e){console.info(...e)}warn(...e){console.warn(...e)}error(...e){console.error(...e)}debug(...e){console.debug(...e)}},sJ=class{logger;enabled=!1;constructor(e){return this.logger=e,new Proxy(this,{get:(e,t,r)=>t in e?Reflect.get(e,t,r):Reflect.get(e.logger,t,r)})}info(...e){this.enabled&&this.logger.info(...e)}warn(...e){this.enabled&&this.logger.warn(...e)}error(...e){this.enabled&&this.logger.error(...e)}debug(...e){this.enabled&&"function"==typeof this.logger.debug&&this.logger.debug(...e)}enable(){this.enabled=!0}disable(){this.enabled=!1}async flush(){this.logger.constructor.name!==sz.name&&await new Promise(e=>{setTimeout(()=>e(null),1e3)})}},sW=class e{get[Symbol.toStringTag](){return e.Tag}id;options;eventKey="";_apiBaseUrl;_eventBaseUrl;inngestApi;sendEventUrl=new URL(`e/${this.eventKey}`,tY);headers;fetch;logger;localFns=[];middleware;_mode;schemas;_appVersion;get apiBaseUrl(){return this._apiBaseUrl}get eventBaseUrl(){return this._eventBaseUrl}get env(){return this.headers[tJ.Environment]??null}get appVersion(){return this._appVersion}constructor(e){this.options=e;let{id:t,fetch:r,logger:n=new sz,middleware:i,isDev:s,schemas:o,appVersion:a}=this.options;if(!t)throw Error("An `id` must be passed to create an Inngest instance.");this.id=t,this._mode=ra({explicitMode:"boolean"==typeof s?s?"dev":"cloud":void 0}),this.fetch=rg(r),this.inngestApi=new sK({baseUrl:this.apiBaseUrl,signingKey:rl(tz.InngestSigningKey)||"",signingKeyFallback:rl(tz.InngestSigningKeyFallback),fetch:this.fetch,mode:this.mode}),this.schemas=o,this.loadModeEnvVars(),this.logger=n,this.middleware=this.initializeMiddleware([...sY,...i||[]]),this._appVersion=a}get ready(){return this.middleware.then(()=>{})}setEnvVars(e=ru()){return this.mode=ra({env:e,client:this}),this}loadModeEnvVars(){this._apiBaseUrl=this.options.baseUrl||this.mode.env[tz.InngestApiBaseUrl]||this.mode.env[tz.InngestBaseUrl]||this.mode.getExplicitUrl(tW),this._eventBaseUrl=this.options.baseUrl||this.mode.env[tz.InngestEventApiBaseUrl]||this.mode.env[tz.InngestBaseUrl]||this.mode.getExplicitUrl(tY),this.setEventKey(this.options.eventKey||this.mode.env[tz.InngestEventKey]||""),this.headers=rc({inngestEnv:this.options.env,env:this.mode.env}),this.inngestApi.mode=this.mode,this.inngestApi.apiBaseUrl=this._apiBaseUrl}async initializeMiddleware(e=[],t){let r=await (t?.prefixStack??[]),n=e.reduce(async(e,r)=>[...await e,await r.init({client:this,...t?.registerInput})],Promise.resolve([]));return[...r,...await n]}get mode(){return this._mode}set mode(e){this._mode=e,this.loadModeEnvVars()}async getResponseError(e,t,r="Unknown error"){let n=r;if("Unknown error"===n)switch(e.status){case 401:n="Event key Not Found";break;case 400:n="Cannot process event payload";break;case 403:n="Forbidden";break;case 404:n="Event key not found";break;case 406:n=`${JSON.stringify(await t)}`;break;case 409:case 412:n="Event transformation failed";break;case 413:n="Event payload too large";break;case 500:n="Internal server error";break;default:try{n=await e.text()}catch(e){n=`${JSON.stringify(await t)}`}}return Error(`Inngest API Error: ${e.status} ${n}`)}setEventKey(e){this.eventKey=e||t1,this.sendEventUrl=new URL(`e/${this.eventKey}`,this.eventBaseUrl||tY)}eventKeySet(){return!!this.eventKey&&this.eventKey!==t1}async sendSignal({signal:e,data:t,env:r}){let n={...r?{[tJ.Environment]:r}:{}};return this._sendSignal({signal:e,data:t,headers:n})}async _sendSignal({signal:e,data:t,headers:r}){let n=await this.inngestApi.sendSignal({signal:e,data:t},{...this.headers,...r});if(n.ok)return n.value;throw Error(`Failed to send signal: ${n.error?.error||"Unknown error"}`)}async send(e,t){let r={...t?.env?{[tJ.Environment]:t.env}:{}};return this._send({payload:e,headers:r})}async _send({payload:e,headers:t}){let r=new Date().getTime(),n=5;try{let e=function(e){let t=new Uint8Array(10),{crypto:r}=globalThis;if(!r)throw Error("missing crypto module");if(!r.getRandomValues)throw Error("missing crypto.getRandomValues");return r.getRandomValues(t),t}(0),n=Buffer.from(e).toString("base64");t={...t,[tJ.EventIdSeed]:`${r},${n}`}}catch(t){let e="Event-sending retries disabled";t instanceof Error&&(e+=`: ${t.message}`),console.debug(e),n=1}let i=await sp(this.middleware,"onSendEvent",void 0,{transformInput:(e,t)=>({...e,...t}),transformOutput:(e,t)=>({result:{...e.result,...t?.result}})}),s=Array.isArray(e)?e:e?[e]:[],o=await i.transformInput?.({payloads:[...s]});o?.payloads&&(s=[...o.payloads]);let a=async e=>{let t=await i.transformOutput?.(e);return{...e.result,...t?.result}};if(!(s=s.map(e=>({...e,id:e.id,ts:e.ts||r,data:e.data||{}}))).length)return console.warn(iP({type:"warn",whatHappened:"`inngest.send()` called with no events",reassurance:"This is not an error, but you may not have intended to do this.",consequences:"The returned promise will resolve, but no events have been sent to Inngest.",stack:!0})),await a({result:{ids:[]}});let l=this.sendEventUrl.href;if(this.mode.isCloud&&!this.eventKeySet())throw Error(iP({whatHappened:"Failed to send event",consequences:"Your event or events were not sent to Inngest.",why:"We couldn't find an event key to use to send events to Inngest.",toFixNow:iN}));this.mode.isDev&&this.mode.isInferred&&!this.eventBaseUrl&&await ry(tZ,this.fetch)&&(l=rv(tZ,`e/${this.eventKey}`).href);let u=await sa(async()=>{let e,r,n=await this.fetch(l,{method:"POST",body:t7(s),headers:{...this.headers,...t}});try{e=await n.json(),r=await iB.parseAsync(e)}catch(t){throw await this.getResponseError(n,e)}if(200!==r.status||r.error)throw await this.getResponseError(n,e,r.error);return r},{maxAttempts:n,baseDelay:100});return await a({result:{ids:u.ids}})}createFunction=(e,t,r)=>{let n=this._createFunction(e,t,r);return this.localFns.push(n),n};get funcs(){return this.localFns}_createFunction=(e,t,r)=>{let n=this.sanitizeOptions(e),i=this.sanitizeTriggers(t);return new sH(this,{...n,triggers:i},r)};sanitizeOptions(e){return(Object.hasOwn(e,"fns")&&console.warn(`${tQ} InngestFunction: \`fns\` option has been deprecated in v3; use \`middleware\` instead. See https://www.inngest.com/docs/sdk/migration`),"string"==typeof e)?(console.warn(`${tQ} InngestFunction: Creating a function with a string as the first argument has been deprecated in v3; pass an object instead. See https://www.inngest.com/docs/sdk/migration`),{id:e}):e}sanitizeTriggers(e){return"string"==typeof e?(console.warn(`${tQ} InngestFunction: Creating a function with a string as the second argument has been deprecated in v3; pass an object instead. See https://www.inngest.com/docs/sdk/migration`),[{event:e}]):Array.isArray(e)?e:[e]}};let sY=[new sh({name:"Inngest: Logger",init:({client:e})=>({onFunctionRun(t){let{ctx:r}=t,n={runID:r.runId,eventName:r.event.name,functionName:t.fn.name},i=e.logger;try{"child"in i&&(i=i.child(n))}catch(e){console.error('failed to create "childLogger" with error: ',e)}let s=new sJ(i);return{transformInput:()=>({ctx:{logger:s}}),beforeExecution(){s.enable()},transformOutput({result:{error:e}}){e&&s.error(e)},async beforeResponse(){await s.flush()}}}})})];(sW||(sW={})).Tag="Inngest.App";let sZ=new sW({id:"my-app",name:"SkillForge",credentials:{gemini:{apiKey:process.env.GEMINI_API_KEY}}});var sX=e.i(29173);let sQ=globalThis.prisma||new sX.PrismaClient;var s0=e.i(47334),s1=e.i(22734),s2=e.i(81111);e.i(21365),e.i(29485),e.i(16735);var s5=e.i(35065);e.i(17198),s5.default;var s4=e.i(24868);class s3{}function s6(e,t){return e.replace(/\{([^}]+)\}/g,(e,r)=>{if(Object.prototype.hasOwnProperty.call(t,r)){let e=t[r];return null!=e?String(e):""}throw Error(`Key '${r}' not found in valueMap.`)})}function s9(e,t,r){for(let n=0;n<t.length-1;n++){let i=t[n];if(i.endsWith("[]")){let s=i.slice(0,-2);if(!(s in e))if(Array.isArray(r))e[s]=Array.from({length:r.length},()=>({}));else throw Error(`Value must be a list given an array path ${i}`);if(Array.isArray(e[s])){let i=e[s];if(Array.isArray(r))for(let e=0;e<i.length;e++)s9(i[e],t.slice(n+1),r[e]);else for(let e of i)s9(e,t.slice(n+1),r)}return}if(i.endsWith("[0]")){let s=i.slice(0,-3);s in e||(e[s]=[{}]),s9(e[s][0],t.slice(n+1),r);return}e[i]&&"object"==typeof e[i]||(e[i]={}),e=e[i]}let n=t[t.length-1],i=e[n];if(void 0!==i){if(!r||"object"==typeof r&&0===Object.keys(r).length||r===i)return;if("object"==typeof i&&"object"==typeof r&&null!==i&&null!==r)Object.assign(i,r);else throw Error(`Cannot set value for an existing key. Key: ${n}`)}else"_self"!==n||"object"!=typeof r||null===r||Array.isArray(r)?e[n]=r:Object.assign(e,r)}function s8(e,t){try{if(1===t.length&&"_self"===t[0])return e;for(let r=0;r<t.length;r++){if("object"!=typeof e||null===e)return;let n=t[r];if(n.endsWith("[]")){let i=n.slice(0,-2);if(!(i in e))return;{let n=e[i];if(!Array.isArray(n))return;return n.map(e=>s8(e,t.slice(r+1)))}}e=e[n]}return e}catch(e){if(e instanceof TypeError)return;throw e}}function s7(e){if("string"!=typeof e)throw Error("fromImageBytes must be a string");return e}!function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"}(d||(d={})),function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"}(h||(h={})),function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"}(p||(p={})),function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"}(f||(f={})),function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"}(g||(g={})),function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"}(m||(m={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"}(y||(y={})),function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"}(v||(v={})),function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"}(_||(_={})),function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"}(b||(b={})),function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"}(E||(E={})),function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"}(S||(S={})),function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"}(w||(w={})),function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY"}(T||(T={})),function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"}(C||(C={})),function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"}(A||(A={})),function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"}(O||(O={})),function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"}(x||(x={})),function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"}(I||(I={})),function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"}(k||(k={})),function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"}(R||(R={})),function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"}(P||(P={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"}(N||(N={})),function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"}(D||(D={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"}(M||(M={})),function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"}(j||(j={})),function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"}(U||(U={})),function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"}(L||(L={})),function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"}(F||(F={})),function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"}(B||(B={})),function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"}(q||(q={})),function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"}(G||(G={})),function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"}(H||(H={})),function(e){e.ASSET="ASSET",e.STYLE="STYLE"}($||($={})),function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"}(V||(V={})),function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"}(K||(K={})),function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"}(z||(z={})),function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"}(J||(J={})),function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"}(W||(W={})),function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"}(Y||(Y={})),function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"}(Z||(Z={})),function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"}(X||(X={})),function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"}(Q||(Q={})),function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"}(ee||(ee={})),function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"}(et||(et={})),function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"}(er||(er={})),function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"}(en||(en={})),function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"}(ei||(ei={}));class oe{constructor(e){let t={};for(let r of e.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class ot{get text(){var e,t,r,n,i,s,o,a;if((null==(n=null==(r=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:r.parts)?void 0:n.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let l="",u=!1,c=[];for(let e of null!=(a=null==(o=null==(s=null==(i=this.candidates)?void 0:i[0])?void 0:s.content)?void 0:o.parts)?a:[]){for(let[t,r]of Object.entries(e))"text"!==t&&"thought"!==t&&(null!==r||void 0!==r)&&c.push(t);if("string"==typeof e.text){if("boolean"==typeof e.thought&&e.thought)continue;u=!0,l+=e.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?l:void 0}get data(){var e,t,r,n,i,s,o,a;if((null==(n=null==(r=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:r.parts)?void 0:n.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let l="",u=[];for(let e of null!=(a=null==(o=null==(s=null==(i=this.candidates)?void 0:i[0])?void 0:s.content)?void 0:o.parts)?a:[]){for(let[t,r]of Object.entries(e))"inlineData"!==t&&(null!==r||void 0!==r)&&u.push(t);e.inlineData&&"string"==typeof e.inlineData.data&&(l+=atob(e.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),l.length>0?btoa(l):void 0}get functionCalls(){var e,t,r,n,i,s,o,a;if((null==(n=null==(r=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:r.parts)?void 0:n.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let l=null==(a=null==(o=null==(s=null==(i=this.candidates)?void 0:i[0])?void 0:s.content)?void 0:o.parts)?void 0:a.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);if((null==l?void 0:l.length)!==0)return l}get executableCode(){var e,t,r,n,i,s,o,a,l;if((null==(n=null==(r=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:r.parts)?void 0:n.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let u=null==(a=null==(o=null==(s=null==(i=this.candidates)?void 0:i[0])?void 0:s.content)?void 0:o.parts)?void 0:a.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null==(l=null==u?void 0:u[0])?void 0:l.code}get codeExecutionResult(){var e,t,r,n,i,s,o,a,l;if((null==(n=null==(r=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:r.parts)?void 0:n.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let u=null==(a=null==(o=null==(s=null==(i=this.candidates)?void 0:i[0])?void 0:s.content)?void 0:o.parts)?void 0:a.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null==(l=null==u?void 0:u[0])?void 0:l.output}}class or{}class on{}class oi{}class os{}class oo{}class oa{}class ol{}class ou{}class oc{}class od{}class oh{_fromAPIResponse({apiResponse:e,isVertexAI:t}){let r=new oh;return Object.assign(r,t?function(e){let t={},r=s8(e,["name"]);null!=r&&s9(t,["name"],r);let n=s8(e,["metadata"]);null!=n&&s9(t,["metadata"],n);let i=s8(e,["done"]);null!=i&&s9(t,["done"],i);let s=s8(e,["error"]);null!=s&&s9(t,["error"],s);let o=s8(e,["response"]);return null!=o&&s9(t,["response"],function(e){let t={},r=s8(e,["videos"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["_self"]);return null!=r&&s9(t,["video"],function(e){let t={},r=s8(e,["gcsUri"]);null!=r&&s9(t,["uri"],r);let n=s8(e,["bytesBase64Encoded"]);null!=n&&s9(t,["videoBytes"],s7(n));let i=s8(e,["mimeType"]);return null!=i&&s9(t,["mimeType"],i),t}(r)),t})(e))),s9(t,["generatedVideos"],e)}let n=s8(e,["raiMediaFilteredCount"]);null!=n&&s9(t,["raiMediaFilteredCount"],n);let i=s8(e,["raiMediaFilteredReasons"]);return null!=i&&s9(t,["raiMediaFilteredReasons"],i),t}(o)),t}(e):function(e){let t={},r=s8(e,["name"]);null!=r&&s9(t,["name"],r);let n=s8(e,["metadata"]);null!=n&&s9(t,["metadata"],n);let i=s8(e,["done"]);null!=i&&s9(t,["done"],i);let s=s8(e,["error"]);null!=s&&s9(t,["error"],s);let o=s8(e,["response","generateVideoResponse"]);return null!=o&&s9(t,["response"],function(e){let t={},r=s8(e,["generatedSamples"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["_self"]);return null!=r&&s9(t,["video"],function(e){let t={},r=s8(e,["video","uri"]);null!=r&&s9(t,["uri"],r);let n=s8(e,["video","encodedVideo"]);null!=n&&s9(t,["videoBytes"],s7(n));let i=s8(e,["encoding"]);return null!=i&&s9(t,["mimeType"],i),t}(r)),t})(e))),s9(t,["generatedVideos"],e)}let n=s8(e,["raiMediaFilteredCount"]);null!=n&&s9(t,["raiMediaFilteredCount"],n);let i=s8(e,["raiMediaFilteredReasons"]);return null!=i&&s9(t,["raiMediaFilteredReasons"],i),t}(o)),t}(e)),r}}class op{}class of{}class og{}class om{}class oy{}class ov{}class o_{}class ob{get text(){var e,t,r;let n="",i=!1,s=[];for(let o of null!=(r=null==(t=null==(e=this.serverContent)?void 0:e.modelTurn)?void 0:t.parts)?r:[]){for(let[e,t]of Object.entries(o))"text"!==e&&"thought"!==e&&null!==t&&s.push(e);if("string"==typeof o.text){if("boolean"==typeof o.thought&&o.thought)continue;i=!0,n+=o.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?n:void 0}get data(){var e,t,r;let n="",i=[];for(let s of null!=(r=null==(t=null==(e=this.serverContent)?void 0:e.modelTurn)?void 0:t.parts)?r:[]){for(let[e,t]of Object.entries(s))"inlineData"!==e&&null!==t&&i.push(e);s.inlineData&&"string"==typeof s.inlineData.data&&(n+=atob(s.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),n.length>0?btoa(n):void 0}}class oE{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}function oS(e,t){if(!t||"string"!=typeof t)throw Error("model is required and must be a string");if(e.isVertexAI())if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;else{if(!(t.indexOf("/")>=0))return`publishers/google/models/${t}`;let e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function ow(e,t){let r=oS(e,t);return r?r.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${r}`:r.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${r}`:r:""}function oT(e){return Array.isArray(e)?e.map(e=>oC(e)):[oC(e)]}function oC(e){if("object"==typeof e&&null!==e)return e;throw Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function oA(e){let t=oC(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw Error(`Unsupported mime type: ${t.mimeType}`)}function oO(e){let t=oC(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw Error(`Unsupported mime type: ${t.mimeType}`)}function ox(e){if(null==e)throw Error("PartUnion is required");if("object"==typeof e)return e;if("string"==typeof e)return{text:e};throw Error(`Unsupported part type: ${typeof e}`)}function oI(e){if(null==e||Array.isArray(e)&&0===e.length)throw Error("PartListUnion is required");return Array.isArray(e)?e.map(e=>ox(e)):[ox(e)]}function ok(e){return null!=e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts)}function oR(e){return null!=e&&"object"==typeof e&&"functionCall"in e}function oP(e){return null!=e&&"object"==typeof e&&"functionResponse"in e}function oN(e){if(null==e)throw Error("ContentUnion is required");return ok(e)?e:{role:"user",parts:oI(e)}}function oD(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{let t=oN(e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]});if(e.isVertexAI()){let e=oN(t);return e.parts&&e.parts.length>0&&void 0!==e.parts[0].text?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>oN(e)):[oN(t)]}function oM(e){if(null==e||Array.isArray(e)&&0===e.length)throw Error("contents are required");if(!Array.isArray(e)){if(oR(e)||oP(e))throw Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[oN(e)]}let t=[],r=[],n=ok(e[0]);for(let i of e){let e=ok(i);if(e!=n)throw Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(e)t.push(i);else if(oR(i)||oP(i))throw Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");else r.push(i)}return n||t.push({role:"user",parts:oI(r)}),t}function oj(e){let t={},r=["items"],n=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw Error("type and anyOf cannot be both populated.");let s=e.anyOf;for(let[o,a]of(null!=s&&2==s.length&&("null"===s[0].type?(t.nullable=!0,e=s[1]):"null"===s[1].type&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&function(e,t){e.includes("null")&&(t.nullable=!0);let r=e.filter(e=>"null"!==e);if(1===r.length)t.type=Object.values(p).includes(r[0].toUpperCase())?r[0].toUpperCase():p.TYPE_UNSPECIFIED;else for(let e of(t.anyOf=[],r))t.anyOf.push({type:Object.values(p).includes(e.toUpperCase())?e.toUpperCase():p.TYPE_UNSPECIFIED})}(e.type,t),Object.entries(e)))if(null!=a)if("type"==o){if("null"===a)throw Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;t.type=Object.values(p).includes(a.toUpperCase())?a.toUpperCase():p.TYPE_UNSPECIFIED}else if(r.includes(o))t[o]=oj(a);else if(n.includes(o)){let e=[];for(let r of a){if("null"==r.type){t.nullable=!0;continue}e.push(oj(r))}t[o]=e}else if(i.includes(o)){let e={};for(let[t,r]of Object.entries(a))e[t]=oj(r);t[o]=e}else{if("additionalProperties"===o)continue;t[o]=a}return t}function oU(e){if("object"==typeof e)return e;if("string"==typeof e)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw Error(`Unsupported speechConfig type: ${typeof e}`)}function oL(e){if("multiSpeakerVoiceConfig"in e)throw Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function oF(e){if(e.functionDeclarations)for(let t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=oj(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=oj(t.response));return e}function oB(e){if(null==e)throw Error("tools is required");if(!Array.isArray(e))throw Error("tools is required and must be an array of Tools");let t=[];for(let r of e)t.push(r);return t}function oq(e,t){if("string"!=typeof t)throw Error("name must be a string");return function(e,t,r,n=1){let i=!t.startsWith(`${r}/`)&&t.split("/").length===n;if(e.isVertexAI())if(t.startsWith("projects/"))return t;else if(t.startsWith("locations/"))return`projects/${e.getProject()}/${t}`;else if(t.startsWith(`${r}/`))return`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`;else if(i)return`projects/${e.getProject()}/locations/${e.getLocation()}/${r}/${t}`;else return t;return i?`${r}/${t}`:t}(e,t,"cachedContents")}function oG(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function oH(e){return null!=e&&"object"==typeof e&&"video"in e}function o$(e){return null!=e&&"object"==typeof e&&"uri"in e}function oV(e){var t;let r;if(null!=e&&"object"==typeof e&&"name"in e&&(r=e.name),!o$(e)||void 0!==(r=e.uri)){if(!oH(e)||void 0!==(r=null==(t=e.video)?void 0:t.uri)){if("string"==typeof e&&(r=e),void 0===r)throw Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){let e=r.split("files/")[1].match(/[a-z0-9]+/);if(null===e)throw Error(`Could not extract file name from URI ${r}`);r=e[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}}function oK(e,t){return e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels"}function oz(e){for(let n of["models","tunedModels","publisherModels"]){var t,r;if(t=e,r=n,null!==t&&"object"==typeof t&&r in t)return e[n]}return[]}function oJ(e,t){let r;if("string"==typeof t)if(e.isVertexAI())if(t.startsWith("gs://"))r={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))r={format:"bigquery",bigqueryUri:t};else throw Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))r={fileName:t};else throw Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw Error("InlinedRequest[] is not supported in Vertex AI.");r={inlinedRequests:t}}else r=t;let n=[r.gcsUri,r.bigqueryUri].filter(Boolean).length,i=[r.inlinedRequests,r.fileName].filter(Boolean).length;if(e.isVertexAI()){if(i>0||1!==n)throw Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(n>0||1!==i)throw Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return r}function oW(e){if("object"!=typeof e||null===e)return{};let t=e.inlinedResponses;if("object"!=typeof t||null===t)return e;let r=t.inlinedResponses;if(!Array.isArray(r)||0===r.length)return e;let n=!1;for(let e of r){if("object"!=typeof e||null===e)continue;let t=e.response;if("object"==typeof t&&null!==t&&void 0!==t.embedding){n=!0;break}}return n&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),e}function oY(e,t){if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw Error(`Invalid batch job name: ${t}.`)}function oZ(e){if("BATCH_STATE_UNSPECIFIED"===e)return"JOB_STATE_UNSPECIFIED";if("BATCH_STATE_PENDING"===e)return"JOB_STATE_PENDING";if("BATCH_STATE_RUNNING"===e)return"JOB_STATE_RUNNING";if("BATCH_STATE_SUCCEEDED"===e)return"JOB_STATE_SUCCEEDED";if("BATCH_STATE_FAILED"===e)return"JOB_STATE_FAILED";else if("BATCH_STATE_CANCELLED"===e)return"JOB_STATE_CANCELLED";else if("BATCH_STATE_EXPIRED"===e)return"JOB_STATE_EXPIRED";else return e}function oX(e){let t={},r=s8(e,["name"]);null!=r&&s9(t,["name"],r);let n=s8(e,["metadata","displayName"]);null!=n&&s9(t,["displayName"],n);let i=s8(e,["metadata","state"]);null!=i&&s9(t,["state"],oZ(i));let s=s8(e,["metadata","createTime"]);null!=s&&s9(t,["createTime"],s);let o=s8(e,["metadata","endTime"]);null!=o&&s9(t,["endTime"],o);let a=s8(e,["metadata","updateTime"]);null!=a&&s9(t,["updateTime"],a);let l=s8(e,["metadata","model"]);null!=l&&s9(t,["model"],l);let u=s8(e,["metadata","output"]);return null!=u&&s9(t,["dest"],function(e){let t={},r=s8(e,["responsesFile"]);null!=r&&s9(t,["fileName"],r);let n=s8(e,["inlinedResponses","inlinedResponses"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["response"]);null!=r&&s9(t,["response"],function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["candidates"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["content"]);null!=r&&s9(t,["content"],function(e){let t={},r=s8(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["videoMetadata"]);null!=r&&s9(t,["videoMetadata"],function(e){let t={},r=s8(e,["fps"]);null!=r&&s9(t,["fps"],r);let n=s8(e,["endOffset"]);null!=n&&s9(t,["endOffset"],n);let i=s8(e,["startOffset"]);return null!=i&&s9(t,["startOffset"],i),t}(r));let n=s8(e,["thought"]);null!=n&&s9(t,["thought"],n);let i=s8(e,["inlineData"]);null!=i&&s9(t,["inlineData"],function(e){let t={},r=s8(e,["data"]);null!=r&&s9(t,["data"],r);let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(i));let s=s8(e,["fileData"]);null!=s&&s9(t,["fileData"],function(e){let t={},r=s8(e,["fileUri"]);null!=r&&s9(t,["fileUri"],r);let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(s));let o=s8(e,["thoughtSignature"]);null!=o&&s9(t,["thoughtSignature"],o);let a=s8(e,["functionCall"]);null!=a&&s9(t,["functionCall"],function(e){let t={},r=s8(e,["id"]);null!=r&&s9(t,["id"],r);let n=s8(e,["args"]);null!=n&&s9(t,["args"],n);let i=s8(e,["name"]);return null!=i&&s9(t,["name"],i),t}(a));let l=s8(e,["codeExecutionResult"]);null!=l&&s9(t,["codeExecutionResult"],l);let u=s8(e,["executableCode"]);null!=u&&s9(t,["executableCode"],u);let c=s8(e,["functionResponse"]);null!=c&&s9(t,["functionResponse"],c);let d=s8(e,["text"]);return null!=d&&s9(t,["text"],d),t})(e))),s9(t,["parts"],e)}let n=s8(e,["role"]);return null!=n&&s9(t,["role"],n),t}(r));let n=s8(e,["citationMetadata"]);null!=n&&s9(t,["citationMetadata"],function(e){let t={},r=s8(e,["citationSources"]);return null!=r&&s9(t,["citations"],r),t}(n));let i=s8(e,["tokenCount"]);null!=i&&s9(t,["tokenCount"],i);let s=s8(e,["finishReason"]);null!=s&&s9(t,["finishReason"],s);let o=s8(e,["urlContextMetadata"]);null!=o&&s9(t,["urlContextMetadata"],function(e){let t={},r=s8(e,["urlMetadata"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["retrievedUrl"]);null!=r&&s9(t,["retrievedUrl"],r);let n=s8(e,["urlRetrievalStatus"]);return null!=n&&s9(t,["urlRetrievalStatus"],n),t})(e))),s9(t,["urlMetadata"],e)}return t}(o));let a=s8(e,["avgLogprobs"]);null!=a&&s9(t,["avgLogprobs"],a);let l=s8(e,["groundingMetadata"]);null!=l&&s9(t,["groundingMetadata"],l);let u=s8(e,["index"]);null!=u&&s9(t,["index"],u);let c=s8(e,["logprobsResult"]);null!=c&&s9(t,["logprobsResult"],c);let d=s8(e,["safetyRatings"]);return null!=d&&s9(t,["safetyRatings"],d),t})(e))),s9(t,["candidates"],e)}let i=s8(e,["modelVersion"]);null!=i&&s9(t,["modelVersion"],i);let s=s8(e,["promptFeedback"]);null!=s&&s9(t,["promptFeedback"],s);let o=s8(e,["responseId"]);null!=o&&s9(t,["responseId"],o);let a=s8(e,["usageMetadata"]);return null!=a&&s9(t,["usageMetadata"],a),t}(r));let n=s8(e,["error"]);return null!=n&&s9(t,["error"],o5(n)),t})(e))),s9(t,["inlinedResponses"],e)}let i=s8(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["response"]);null!=r&&s9(t,["response"],function(e){let t={},r=s8(e,["embedding"]);null!=r&&s9(t,["embedding"],function(e){let t={},r=s8(e,["values"]);return null!=r&&s9(t,["values"],r),t}(r));let n=s8(e,["tokenCount"]);return null!=n&&s9(t,["tokenCount"],n),t}(r));let n=s8(e,["error"]);return null!=n&&s9(t,["error"],o5(n)),t})(e))),s9(t,["inlinedEmbedContentResponses"],e)}return t}(oW(u))),t}function oQ(e){let t={},r=s8(e,["name"]);null!=r&&s9(t,["name"],r);let n=s8(e,["displayName"]);null!=n&&s9(t,["displayName"],n);let i=s8(e,["state"]);null!=i&&s9(t,["state"],oZ(i));let s=s8(e,["error"]);null!=s&&s9(t,["error"],o4(s));let o=s8(e,["createTime"]);null!=o&&s9(t,["createTime"],o);let a=s8(e,["startTime"]);null!=a&&s9(t,["startTime"],a);let l=s8(e,["endTime"]);null!=l&&s9(t,["endTime"],l);let u=s8(e,["updateTime"]);null!=u&&s9(t,["updateTime"],u);let c=s8(e,["model"]);null!=c&&s9(t,["model"],c);let d=s8(e,["inputConfig"]);null!=d&&s9(t,["src"],function(e){let t={},r=s8(e,["instancesFormat"]);null!=r&&s9(t,["format"],r);let n=s8(e,["gcsSource","uris"]);null!=n&&s9(t,["gcsUri"],n);let i=s8(e,["bigquerySource","inputUri"]);return null!=i&&s9(t,["bigqueryUri"],i),t}(d));let h=s8(e,["outputConfig"]);return null!=h&&s9(t,["dest"],function(e){let t={},r=s8(e,["predictionsFormat"]);null!=r&&s9(t,["format"],r);let n=s8(e,["gcsDestination","outputUriPrefix"]);null!=n&&s9(t,["gcsUri"],n);let i=s8(e,["bigqueryDestination","outputUri"]);return null!=i&&s9(t,["bigqueryUri"],i),t}(oW(h))),t}function o0(e){let t={},r=s8(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["videoMetadata"]);null!=r&&s9(t,["videoMetadata"],function(e){let t={},r=s8(e,["fps"]);null!=r&&s9(t,["fps"],r);let n=s8(e,["endOffset"]);null!=n&&s9(t,["endOffset"],n);let i=s8(e,["startOffset"]);return null!=i&&s9(t,["startOffset"],i),t}(r));let n=s8(e,["thought"]);null!=n&&s9(t,["thought"],n);let i=s8(e,["inlineData"]);null!=i&&s9(t,["inlineData"],function(e){let t={};if(void 0!==s8(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=s8(e,["data"]);null!=r&&s9(t,["data"],r);let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(i));let s=s8(e,["fileData"]);null!=s&&s9(t,["fileData"],function(e){let t={};if(void 0!==s8(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=s8(e,["fileUri"]);null!=r&&s9(t,["fileUri"],r);let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(s));let o=s8(e,["thoughtSignature"]);null!=o&&s9(t,["thoughtSignature"],o);let a=s8(e,["functionCall"]);null!=a&&s9(t,["functionCall"],function(e){let t={},r=s8(e,["id"]);null!=r&&s9(t,["id"],r);let n=s8(e,["args"]);null!=n&&s9(t,["args"],n);let i=s8(e,["name"]);return null!=i&&s9(t,["name"],i),t}(a));let l=s8(e,["codeExecutionResult"]);null!=l&&s9(t,["codeExecutionResult"],l);let u=s8(e,["executableCode"]);null!=u&&s9(t,["executableCode"],u);let c=s8(e,["functionResponse"]);null!=c&&s9(t,["functionResponse"],c);let d=s8(e,["text"]);return null!=d&&s9(t,["text"],d),t})(e))),s9(t,["parts"],e)}let n=s8(e,["role"]);return null!=n&&s9(t,["role"],n),t}function o1(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["src"]);null!=i&&s9(r,["batch","inputConfig"],function(e,t){let r={};if(void 0!==s8(t,["format"]))throw Error("format parameter is not supported in Gemini API.");if(void 0!==s8(t,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==s8(t,["bigqueryUri"]))throw Error("bigqueryUri parameter is not supported in Gemini API.");let n=s8(t,["fileName"]);null!=n&&s9(r,["fileName"],n);let i=s8(t,["inlinedRequests"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["request","model"],oS(e,n));let i=s8(t,["contents"]);if(null!=i){let e=oM(i);Array.isArray(e)&&(e=e.map(e=>o0(e))),s9(r,["request","contents"],e)}let s=s8(t,["config"]);return null!=s&&s9(r,["request","generationConfig"],function(e,t,r){let n={},i=s8(t,["systemInstruction"]);void 0!==r&&null!=i&&s9(r,["systemInstruction"],o0(oN(i)));let s=s8(t,["temperature"]);null!=s&&s9(n,["temperature"],s);let o=s8(t,["topP"]);null!=o&&s9(n,["topP"],o);let a=s8(t,["topK"]);null!=a&&s9(n,["topK"],a);let l=s8(t,["candidateCount"]);null!=l&&s9(n,["candidateCount"],l);let u=s8(t,["maxOutputTokens"]);null!=u&&s9(n,["maxOutputTokens"],u);let c=s8(t,["stopSequences"]);null!=c&&s9(n,["stopSequences"],c);let d=s8(t,["responseLogprobs"]);null!=d&&s9(n,["responseLogprobs"],d);let h=s8(t,["logprobs"]);null!=h&&s9(n,["logprobs"],h);let p=s8(t,["presencePenalty"]);null!=p&&s9(n,["presencePenalty"],p);let f=s8(t,["frequencyPenalty"]);null!=f&&s9(n,["frequencyPenalty"],f);let g=s8(t,["seed"]);null!=g&&s9(n,["seed"],g);let m=s8(t,["responseMimeType"]);null!=m&&s9(n,["responseMimeType"],m);let y=s8(t,["responseSchema"]);null!=y&&s9(n,["responseSchema"],function(e){let t={},r=s8(e,["anyOf"]);null!=r&&s9(t,["anyOf"],r);let n=s8(e,["default"]);null!=n&&s9(t,["default"],n);let i=s8(e,["description"]);null!=i&&s9(t,["description"],i);let s=s8(e,["enum"]);null!=s&&s9(t,["enum"],s);let o=s8(e,["example"]);null!=o&&s9(t,["example"],o);let a=s8(e,["format"]);null!=a&&s9(t,["format"],a);let l=s8(e,["items"]);null!=l&&s9(t,["items"],l);let u=s8(e,["maxItems"]);null!=u&&s9(t,["maxItems"],u);let c=s8(e,["maxLength"]);null!=c&&s9(t,["maxLength"],c);let d=s8(e,["maxProperties"]);null!=d&&s9(t,["maxProperties"],d);let h=s8(e,["maximum"]);null!=h&&s9(t,["maximum"],h);let p=s8(e,["minItems"]);null!=p&&s9(t,["minItems"],p);let f=s8(e,["minLength"]);null!=f&&s9(t,["minLength"],f);let g=s8(e,["minProperties"]);null!=g&&s9(t,["minProperties"],g);let m=s8(e,["minimum"]);null!=m&&s9(t,["minimum"],m);let y=s8(e,["nullable"]);null!=y&&s9(t,["nullable"],y);let v=s8(e,["pattern"]);null!=v&&s9(t,["pattern"],v);let _=s8(e,["properties"]);null!=_&&s9(t,["properties"],_);let b=s8(e,["propertyOrdering"]);null!=b&&s9(t,["propertyOrdering"],b);let E=s8(e,["required"]);null!=E&&s9(t,["required"],E);let S=s8(e,["title"]);null!=S&&s9(t,["title"],S);let w=s8(e,["type"]);return null!=w&&s9(t,["type"],w),t}(oj(y)));let v=s8(t,["responseJsonSchema"]);if(null!=v&&s9(n,["responseJsonSchema"],v),void 0!==s8(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==s8(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let _=s8(t,["safetySettings"]);if(void 0!==r&&null!=_){let e=_;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==s8(e,["method"]))throw Error("method parameter is not supported in Gemini API.");let r=s8(e,["category"]);null!=r&&s9(t,["category"],r);let n=s8(e,["threshold"]);return null!=n&&s9(t,["threshold"],n),t})(e))),s9(r,["safetySettings"],e)}let b=s8(t,["tools"]);if(void 0!==r&&null!=b){let e=oB(b);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["behavior"]);null!=r&&s9(t,["behavior"],r);let n=s8(e,["description"]);null!=n&&s9(t,["description"],n);let i=s8(e,["name"]);null!=i&&s9(t,["name"],i);let s=s8(e,["parameters"]);null!=s&&s9(t,["parameters"],s);let o=s8(e,["parametersJsonSchema"]);null!=o&&s9(t,["parametersJsonSchema"],o);let a=s8(e,["response"]);null!=a&&s9(t,["response"],a);let l=s8(e,["responseJsonSchema"]);return null!=l&&s9(t,["responseJsonSchema"],l),t})(e))),s9(t,["functionDeclarations"],e)}if(void 0!==s8(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let n=s8(e,["googleSearch"]);null!=n&&s9(t,["googleSearch"],function(e){let t={},r=s8(e,["timeRangeFilter"]);if(null!=r&&s9(t,["timeRangeFilter"],function(e){let t={},r=s8(e,["startTime"]);null!=r&&s9(t,["startTime"],r);let n=s8(e,["endTime"]);return null!=n&&s9(t,["endTime"],n),t}(r)),void 0!==s8(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return t}(n));let i=s8(e,["googleSearchRetrieval"]);if(null!=i&&s9(t,["googleSearchRetrieval"],function(e){let t={},r=s8(e,["dynamicRetrievalConfig"]);return null!=r&&s9(t,["dynamicRetrievalConfig"],function(e){let t={},r=s8(e,["mode"]);null!=r&&s9(t,["mode"],r);let n=s8(e,["dynamicThreshold"]);return null!=n&&s9(t,["dynamicThreshold"],n),t}(r)),t}(i)),void 0!==s8(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==s8(e,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");null!=s8(e,["urlContext"])&&s9(t,["urlContext"],{});let s=s8(e,["computerUse"]);null!=s&&s9(t,["computerUse"],function(e){let t={},r=s8(e,["environment"]);null!=r&&s9(t,["environment"],r);let n=s8(e,["excludedPredefinedFunctions"]);return null!=n&&s9(t,["excludedPredefinedFunctions"],n),t}(s));let o=s8(e,["codeExecution"]);return null!=o&&s9(t,["codeExecution"],o),t})(oF(e)))),s9(r,["tools"],e)}let E=s8(t,["toolConfig"]);if(void 0!==r&&null!=E&&s9(r,["toolConfig"],function(e){let t={},r=s8(e,["functionCallingConfig"]);null!=r&&s9(t,["functionCallingConfig"],function(e){let t={},r=s8(e,["mode"]);null!=r&&s9(t,["mode"],r);let n=s8(e,["allowedFunctionNames"]);return null!=n&&s9(t,["allowedFunctionNames"],n),t}(r));let n=s8(e,["retrievalConfig"]);return null!=n&&s9(t,["retrievalConfig"],function(e){let t={},r=s8(e,["latLng"]);null!=r&&s9(t,["latLng"],function(e){let t={},r=s8(e,["latitude"]);null!=r&&s9(t,["latitude"],r);let n=s8(e,["longitude"]);return null!=n&&s9(t,["longitude"],n),t}(r));let n=s8(e,["languageCode"]);return null!=n&&s9(t,["languageCode"],n),t}(n)),t}(E)),void 0!==s8(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let S=s8(t,["cachedContent"]);void 0!==r&&null!=S&&s9(r,["cachedContent"],oq(e,S));let w=s8(t,["responseModalities"]);null!=w&&s9(n,["responseModalities"],w);let T=s8(t,["mediaResolution"]);null!=T&&s9(n,["mediaResolution"],T);let C=s8(t,["speechConfig"]);if(null!=C&&s9(n,["speechConfig"],function(e){let t={},r=s8(e,["voiceConfig"]);null!=r&&s9(t,["voiceConfig"],o3(r));let n=s8(e,["multiSpeakerVoiceConfig"]);null!=n&&s9(t,["multiSpeakerVoiceConfig"],function(e){let t={},r=s8(e,["speakerVoiceConfigs"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["speaker"]);null!=r&&s9(t,["speaker"],r);let n=s8(e,["voiceConfig"]);return null!=n&&s9(t,["voiceConfig"],o3(n)),t})(e))),s9(t,["speakerVoiceConfigs"],e)}return t}(n));let i=s8(e,["languageCode"]);return null!=i&&s9(t,["languageCode"],i),t}(oU(C))),void 0!==s8(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let A=s8(t,["thinkingConfig"]);return null!=A&&s9(n,["thinkingConfig"],function(e){let t={},r=s8(e,["includeThoughts"]);null!=r&&s9(t,["includeThoughts"],r);let n=s8(e,["thinkingBudget"]);return null!=n&&s9(t,["thinkingBudget"],n),t}(A)),n}(e,s,r)),r})(e,t))),s9(r,["requests","requests"],t)}return r}(e,oJ(e,i)));let s=s8(t,["config"]);return null!=s&&function(e,t){let r=s8(e,["displayName"]);if(void 0!==t&&null!=r&&s9(t,["batch","displayName"],r),void 0!==s8(e,["dest"]))throw Error("dest parameter is not supported in Gemini API.")}(s,r),r}function o2(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["src"]);null!=i&&s9(r,["batch","inputConfig"],function(e,t){let r={},n=s8(t,["fileName"]);null!=n&&s9(r,["file_name"],n);let i=s8(t,["inlinedRequests"]);return null!=i&&s9(r,["requests"],function(e,t){let r={},n=s8(t,["contents"]);null!=n&&s9(r,["requests[]","request","content"],oD(e,n));let i=s8(t,["config"]);return null!=i&&s9(r,["config"],function(e,t){let r=s8(e,["taskType"]);void 0!==t&&null!=r&&s9(t,["requests[]","taskType"],r);let n=s8(e,["title"]);void 0!==t&&null!=n&&s9(t,["requests[]","title"],n);let i=s8(e,["outputDimensionality"]);if(void 0!==t&&null!=i&&s9(t,["requests[]","outputDimensionality"],i),void 0!==s8(e,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==s8(e,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.");return{}}(i,r)),r}(e,i)),r}(e,i));let s=s8(t,["config"]);return null!=s&&function(e,t){let r=s8(e,["displayName"]);void 0!==t&&null!=r&&s9(t,["batch","displayName"],r)}(s,r),r}function o5(e){let t={},r=s8(e,["details"]);null!=r&&s9(t,["details"],r);let n=s8(e,["code"]);null!=n&&s9(t,["code"],n);let i=s8(e,["message"]);return null!=i&&s9(t,["message"],i),t}function o4(e){let t={},r=s8(e,["details"]);null!=r&&s9(t,["details"],r);let n=s8(e,["code"]);null!=n&&s9(t,["code"],n);let i=s8(e,["message"]);return null!=i&&s9(t,["message"],i),t}function o3(e){let t={},r=s8(e,["prebuiltVoiceConfig"]);return null!=r&&s9(t,["prebuiltVoiceConfig"],function(e){let t={},r=s8(e,["voiceName"]);return null!=r&&s9(t,["voiceName"],r),t}(r)),t}!function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"}(es||(es={}));class o6{constructor(e,t,r,n){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,r,n)}init(e,t,r){var n,i;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=null==t?void 0:t.sdkHttpResponse,this.idxInternal=0;let s={config:{}};(s=r&&0!==Object.keys(r).length?"object"==typeof r?Object.assign({},r):r:{config:{}}).config&&(s.config.pageToken=t.nextPageToken),this.paramsInternal=s,this.pageInternalSize=null!=(i=null==(n=s.config)?void 0:n.pageSize)?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(!this.hasNextPage())return{value:void 0,done:!0};else await this.nextPage();let e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw Error("No more pages to fetch.");let e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return(null==(e=this.params.config)?void 0:e.pageToken)!==void 0}}class o9 extends s3{constructor(e){super(),this.apiClient=e,this.create=async e=>{var t,r;if(this.apiClient.isVertexAI())return e.config=this.formatDestination(e.src,e.config),this.createInternal(e);let n=e.src;if(!(Array.isArray(e.src)||void 0!==n.inlinedRequests))return this.createInternal(e);let i=this.createInlinedGenerateContentRequest(e),s=i.path,o=i.body,a=o1(this.apiClient,e)._query||{};return this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>oX(e))},this.createEmbeddings=async e=>{var t,r;if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw Error("Vertex AI does not support batches.createEmbeddings.");if(void 0===e.src.inlinedRequests)return this.createEmbeddingsInternal(e);let n=this.createInlinedEmbedContentRequest(e),i=n.path,s=n.body,o=o2(this.apiClient,e)._query||{};return this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>oX(e))},this.list=async(e={})=>new o6(es.PAGED_ITEM_BATCH_JOBS,e=>this.listInternal(e),await this.listInternal(e),e)}createInlinedGenerateContentRequest(e){let t=o1(this.apiClient,e),r=s6("{model}:batchGenerateContent",t._url),n=t.batch.inputConfig.requests,i=n.requests,s=[];for(let e of i){let t=Object.assign({},e);if(t.systemInstruction){let e=t.systemInstruction;delete t.systemInstruction;let r=t.request;r.systemInstruction=e,t.request=r}s.push(t)}return n.requests=s,delete t.config,delete t._url,delete t._query,{path:r,body:t}}createInlinedEmbedContentRequest(e){let t=o2(this.apiClient,e),r=s6("{model}:asyncBatchEmbedContent",t._url),n=t.batch.inputConfig.requests,i=n.requests,s=[];for(let e of(delete n.config,i)){let t=Object.assign({},e),r=t.request;for(let e in t)"request"!==e&&(r[e]=t[e],delete t[e]);s.push(t)}return n.requests=s,delete t.config,delete t._url,delete t._query,{path:r,body:t}}getGcsUri(e){return"string"==typeof e?e.startsWith("gs://")?e:void 0:!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0?e.gcsUri[0]:void 0}getBigqueryUri(e){return"string"==typeof e?e.startsWith("bq://")?e:void 0:Array.isArray(e)?void 0:e.bigqueryUri}formatDestination(e,t){let r=t?Object.assign({},t):{},n=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${n}`),void 0===r.dest){let t=this.getGcsUri(e),i=this.getBigqueryUri(e);if(t)t.endsWith(".jsonl")?r.dest=`${t.slice(0,-6)}/dest`:r.dest=`${t}_dest_${n}`;else if(i)r.dest=`${i}_dest_${n}`;else throw Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["model"],oS(e,n));let i=s8(t,["src"]);null!=i&&s9(r,["inputConfig"],function(e){let t={},r=s8(e,["format"]);null!=r&&s9(t,["instancesFormat"],r);let n=s8(e,["gcsUri"]);null!=n&&s9(t,["gcsSource","uris"],n);let i=s8(e,["bigqueryUri"]);if(null!=i&&s9(t,["bigquerySource","inputUri"],i),void 0!==s8(e,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==s8(e,["inlinedRequests"]))throw Error("inlinedRequests parameter is not supported in Vertex AI.");return t}(oJ(e,i)));let s=s8(t,["config"]);return null!=s&&function(e,t){let r=s8(e,["displayName"]);void 0!==t&&null!=r&&s9(t,["displayName"],r);let n=s8(e,["dest"]);void 0!==t&&null!=n&&s9(t,["outputConfig"],function(e){let t={},r=s8(e,["format"]);null!=r&&s9(t,["predictionsFormat"],r);let n=s8(e,["gcsUri"]);null!=n&&s9(t,["gcsDestination","outputUriPrefix"],n);let i=s8(e,["bigqueryUri"]);if(null!=i&&s9(t,["bigqueryDestination","outputUri"],i),void 0!==s8(e,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==s8(e,["inlinedResponses"]))throw Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==s8(e,["inlinedEmbedContentResponses"]))throw Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}(function(e){if("string"!=typeof e)return e;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw Error(`Unsupported destination: ${e}`)}(n)))}(s,r),r}(this.apiClient,e);return s=s6("batchPredictionJobs",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>oQ(e))}{let t=o1(this.apiClient,e);return s=s6("{model}:batchGenerateContent",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json()).then(e=>oX(e))}}async createEmbeddingsInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=o2(this.apiClient,e);return n=s6("{model}:asyncBatchEmbedContent",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>oX(e))}}async get(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=s8(t,["name"]);return null!=n&&s9(r,["_url","name"],oY(e,n)),r}(this.apiClient,e);return s=s6("batchPredictionJobs/{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>oQ(e))}{let t=function(e,t){let r={},n=s8(t,["name"]);return null!=n&&s9(r,["_url","name"],oY(e,n)),r}(this.apiClient,e);return s=s6("batches/{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json()).then(e=>oX(e))}}async cancel(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=s8(t,["name"]);return null!=n&&s9(r,["_url","name"],oY(e,n)),r}(this.apiClient,e);s=s6("batchPredictionJobs/{name}:cancel",n._url),o=n._query,delete n._url,delete n._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal})}else{let t=function(e,t){let r={},n=s8(t,["name"]);return null!=n&&s9(r,["_url","name"],oY(e,n)),r}(this.apiClient,e);s=s6("batches/{name}:cancel",t._url),o=t._query,delete t._url,delete t._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal})}}async listInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e){let t={},r=s8(e,["config"]);return null!=r&&function(e,t){let r=s8(e,["pageSize"]);void 0!==t&&null!=r&&s9(t,["_query","pageSize"],r);let n=s8(e,["pageToken"]);void 0!==t&&null!=n&&s9(t,["_query","pageToken"],n);let i=s8(e,["filter"]);void 0!==t&&null!=i&&s9(t,["_query","filter"],i)}(r,t),t}(e);return s=s6("batchPredictionJobs",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["nextPageToken"]);null!=n&&s9(t,["nextPageToken"],n);let i=s8(e,["batchPredictionJobs"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>oQ(e))),s9(t,["batchJobs"],e)}return t}(e),r=new o_;return Object.assign(r,t),r})}{let t=function(e){let t={},r=s8(e,["config"]);return null!=r&&function(e,t){let r=s8(e,["pageSize"]);void 0!==t&&null!=r&&s9(t,["_query","pageSize"],r);let n=s8(e,["pageToken"]);if(void 0!==t&&null!=n&&s9(t,["_query","pageToken"],n),void 0!==s8(e,["filter"]))throw Error("filter parameter is not supported in Gemini API.")}(r,t),t}(e);return s=s6("batches",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["nextPageToken"]);null!=n&&s9(t,["nextPageToken"],n);let i=s8(e,["operations"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>oX(e))),s9(t,["batchJobs"],e)}return t}(e),r=new o_;return Object.assign(r,t),r})}}async delete(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=s8(t,["name"]);return null!=n&&s9(r,["_url","name"],oY(e,n)),r}(this.apiClient,e);return s=s6("batchPredictionJobs/{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>(function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["name"]);null!=n&&s9(t,["name"],n);let i=s8(e,["done"]);null!=i&&s9(t,["done"],i);let s=s8(e,["error"]);return null!=s&&s9(t,["error"],o4(s)),t})(e))}{let t=function(e,t){let r={},n=s8(t,["name"]);return null!=n&&s9(r,["_url","name"],oY(e,n)),r}(this.apiClient,e);return s=s6("batches/{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>(function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["name"]);null!=n&&s9(t,["name"],n);let i=s8(e,["done"]);null!=i&&s9(t,["done"],i);let s=s8(e,["error"]);return null!=s&&s9(t,["error"],o5(s)),t})(e))}}}function o8(e){let t={},r=s8(e,["name"]);null!=r&&s9(t,["name"],r);let n=s8(e,["displayName"]);null!=n&&s9(t,["displayName"],n);let i=s8(e,["model"]);null!=i&&s9(t,["model"],i);let s=s8(e,["createTime"]);null!=s&&s9(t,["createTime"],s);let o=s8(e,["updateTime"]);null!=o&&s9(t,["updateTime"],o);let a=s8(e,["expireTime"]);null!=a&&s9(t,["expireTime"],a);let l=s8(e,["usageMetadata"]);return null!=l&&s9(t,["usageMetadata"],l),t}function o7(e){let t={},r=s8(e,["name"]);null!=r&&s9(t,["name"],r);let n=s8(e,["displayName"]);null!=n&&s9(t,["displayName"],n);let i=s8(e,["model"]);null!=i&&s9(t,["model"],i);let s=s8(e,["createTime"]);null!=s&&s9(t,["createTime"],s);let o=s8(e,["updateTime"]);null!=o&&s9(t,["updateTime"],o);let a=s8(e,["expireTime"]);null!=a&&s9(t,["expireTime"],a);let l=s8(e,["usageMetadata"]);return null!=l&&s9(t,["usageMetadata"],l),t}function ae(e){let t={},r=s8(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["videoMetadata"]);null!=r&&s9(t,["videoMetadata"],function(e){let t={},r=s8(e,["fps"]);null!=r&&s9(t,["fps"],r);let n=s8(e,["endOffset"]);null!=n&&s9(t,["endOffset"],n);let i=s8(e,["startOffset"]);return null!=i&&s9(t,["startOffset"],i),t}(r));let n=s8(e,["thought"]);null!=n&&s9(t,["thought"],n);let i=s8(e,["inlineData"]);null!=i&&s9(t,["inlineData"],function(e){let t={};if(void 0!==s8(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=s8(e,["data"]);null!=r&&s9(t,["data"],r);let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(i));let s=s8(e,["fileData"]);null!=s&&s9(t,["fileData"],function(e){let t={};if(void 0!==s8(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=s8(e,["fileUri"]);null!=r&&s9(t,["fileUri"],r);let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(s));let o=s8(e,["thoughtSignature"]);null!=o&&s9(t,["thoughtSignature"],o);let a=s8(e,["functionCall"]);null!=a&&s9(t,["functionCall"],function(e){let t={},r=s8(e,["id"]);null!=r&&s9(t,["id"],r);let n=s8(e,["args"]);null!=n&&s9(t,["args"],n);let i=s8(e,["name"]);return null!=i&&s9(t,["name"],i),t}(a));let l=s8(e,["codeExecutionResult"]);null!=l&&s9(t,["codeExecutionResult"],l);let u=s8(e,["executableCode"]);null!=u&&s9(t,["executableCode"],u);let c=s8(e,["functionResponse"]);null!=c&&s9(t,["functionResponse"],c);let d=s8(e,["text"]);return null!=d&&s9(t,["text"],d),t})(e))),s9(t,["parts"],e)}let n=s8(e,["role"]);return null!=n&&s9(t,["role"],n),t}function at(e){let t={},r=s8(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["videoMetadata"]);null!=r&&s9(t,["videoMetadata"],function(e){let t={},r=s8(e,["fps"]);null!=r&&s9(t,["fps"],r);let n=s8(e,["endOffset"]);null!=n&&s9(t,["endOffset"],n);let i=s8(e,["startOffset"]);return null!=i&&s9(t,["startOffset"],i),t}(r));let n=s8(e,["thought"]);null!=n&&s9(t,["thought"],n);let i=s8(e,["inlineData"]);null!=i&&s9(t,["inlineData"],function(e){let t={},r=s8(e,["displayName"]);null!=r&&s9(t,["displayName"],r);let n=s8(e,["data"]);null!=n&&s9(t,["data"],n);let i=s8(e,["mimeType"]);return null!=i&&s9(t,["mimeType"],i),t}(i));let s=s8(e,["fileData"]);null!=s&&s9(t,["fileData"],function(e){let t={},r=s8(e,["displayName"]);null!=r&&s9(t,["displayName"],r);let n=s8(e,["fileUri"]);null!=n&&s9(t,["fileUri"],n);let i=s8(e,["mimeType"]);return null!=i&&s9(t,["mimeType"],i),t}(s));let o=s8(e,["thoughtSignature"]);null!=o&&s9(t,["thoughtSignature"],o);let a=s8(e,["functionCall"]);null!=a&&s9(t,["functionCall"],function(e){let t={},r=s8(e,["id"]);null!=r&&s9(t,["id"],r);let n=s8(e,["args"]);null!=n&&s9(t,["args"],n);let i=s8(e,["name"]);return null!=i&&s9(t,["name"],i),t}(a));let l=s8(e,["codeExecutionResult"]);null!=l&&s9(t,["codeExecutionResult"],l);let u=s8(e,["executableCode"]);null!=u&&s9(t,["executableCode"],u);let c=s8(e,["functionResponse"]);null!=c&&s9(t,["functionResponse"],c);let d=s8(e,["text"]);return null!=d&&s9(t,["text"],d),t})(e))),s9(t,["parts"],e)}let n=s8(e,["role"]);return null!=n&&s9(t,["role"],n),t}class ar extends s3{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new o6(es.PAGED_ITEM_CACHED_CONTENTS,e=>this.listInternal(e),await this.listInternal(e),e)}async create(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["model"],ow(e,n));let i=s8(t,["config"]);return null!=i&&function(e,t){let r=s8(e,["ttl"]);void 0!==t&&null!=r&&s9(t,["ttl"],r);let n=s8(e,["expireTime"]);void 0!==t&&null!=n&&s9(t,["expireTime"],n);let i=s8(e,["displayName"]);void 0!==t&&null!=i&&s9(t,["displayName"],i);let s=s8(e,["contents"]);if(void 0!==t&&null!=s){let e=oM(s);Array.isArray(e)&&(e=e.map(e=>at(e))),s9(t,["contents"],e)}let o=s8(e,["systemInstruction"]);void 0!==t&&null!=o&&s9(t,["systemInstruction"],at(oN(o)));let a=s8(e,["tools"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==s8(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let r=s8(e,["description"]);null!=r&&s9(t,["description"],r);let n=s8(e,["name"]);null!=n&&s9(t,["name"],n);let i=s8(e,["parameters"]);null!=i&&s9(t,["parameters"],i);let s=s8(e,["parametersJsonSchema"]);null!=s&&s9(t,["parametersJsonSchema"],s);let o=s8(e,["response"]);null!=o&&s9(t,["response"],o);let a=s8(e,["responseJsonSchema"]);return null!=a&&s9(t,["responseJsonSchema"],a),t})(e))),s9(t,["functionDeclarations"],e)}let n=s8(e,["retrieval"]);null!=n&&s9(t,["retrieval"],n);let i=s8(e,["googleSearch"]);null!=i&&s9(t,["googleSearch"],function(e){let t={},r=s8(e,["timeRangeFilter"]);null!=r&&s9(t,["timeRangeFilter"],function(e){let t={},r=s8(e,["startTime"]);null!=r&&s9(t,["startTime"],r);let n=s8(e,["endTime"]);return null!=n&&s9(t,["endTime"],n),t}(r));let n=s8(e,["excludeDomains"]);return null!=n&&s9(t,["excludeDomains"],n),t}(i));let s=s8(e,["googleSearchRetrieval"]);null!=s&&s9(t,["googleSearchRetrieval"],function(e){let t={},r=s8(e,["dynamicRetrievalConfig"]);return null!=r&&s9(t,["dynamicRetrievalConfig"],function(e){let t={},r=s8(e,["mode"]);null!=r&&s9(t,["mode"],r);let n=s8(e,["dynamicThreshold"]);return null!=n&&s9(t,["dynamicThreshold"],n),t}(r)),t}(s));let o=s8(e,["enterpriseWebSearch"]);null!=o&&s9(t,["enterpriseWebSearch"],function(e){let t={},r=s8(e,["excludeDomains"]);return null!=r&&s9(t,["excludeDomains"],r),t}(o));let a=s8(e,["googleMaps"]);null!=a&&s9(t,["googleMaps"],function(e){let t={},r=s8(e,["authConfig"]);return null!=r&&s9(t,["authConfig"],function(e){let t={},r=s8(e,["apiKeyConfig"]);null!=r&&s9(t,["apiKeyConfig"],function(e){let t={},r=s8(e,["apiKeyString"]);return null!=r&&s9(t,["apiKeyString"],r),t}(r));let n=s8(e,["authType"]);null!=n&&s9(t,["authType"],n);let i=s8(e,["googleServiceAccountConfig"]);null!=i&&s9(t,["googleServiceAccountConfig"],i);let s=s8(e,["httpBasicAuthConfig"]);null!=s&&s9(t,["httpBasicAuthConfig"],s);let o=s8(e,["oauthConfig"]);null!=o&&s9(t,["oauthConfig"],o);let a=s8(e,["oidcConfig"]);return null!=a&&s9(t,["oidcConfig"],a),t}(r)),t}(a)),null!=s8(e,["urlContext"])&&s9(t,["urlContext"],{});let l=s8(e,["computerUse"]);null!=l&&s9(t,["computerUse"],function(e){let t={},r=s8(e,["environment"]);null!=r&&s9(t,["environment"],r);let n=s8(e,["excludedPredefinedFunctions"]);return null!=n&&s9(t,["excludedPredefinedFunctions"],n),t}(l));let u=s8(e,["codeExecution"]);return null!=u&&s9(t,["codeExecution"],u),t})(e))),s9(t,["tools"],e)}let l=s8(e,["toolConfig"]);void 0!==t&&null!=l&&s9(t,["toolConfig"],function(e){let t={},r=s8(e,["functionCallingConfig"]);null!=r&&s9(t,["functionCallingConfig"],function(e){let t={},r=s8(e,["mode"]);null!=r&&s9(t,["mode"],r);let n=s8(e,["allowedFunctionNames"]);return null!=n&&s9(t,["allowedFunctionNames"],n),t}(r));let n=s8(e,["retrievalConfig"]);return null!=n&&s9(t,["retrievalConfig"],function(e){let t={},r=s8(e,["latLng"]);null!=r&&s9(t,["latLng"],function(e){let t={},r=s8(e,["latitude"]);null!=r&&s9(t,["latitude"],r);let n=s8(e,["longitude"]);return null!=n&&s9(t,["longitude"],n),t}(r));let n=s8(e,["languageCode"]);return null!=n&&s9(t,["languageCode"],n),t}(n)),t}(l));let u=s8(e,["kmsKeyName"]);void 0!==t&&null!=u&&s9(t,["encryption_spec","kmsKeyName"],u)}(i,r),r}(this.apiClient,e);return s=s6("cachedContents",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>o7(e))}{let t=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["model"],ow(e,n));let i=s8(t,["config"]);return null!=i&&function(e,t){let r=s8(e,["ttl"]);void 0!==t&&null!=r&&s9(t,["ttl"],r);let n=s8(e,["expireTime"]);void 0!==t&&null!=n&&s9(t,["expireTime"],n);let i=s8(e,["displayName"]);void 0!==t&&null!=i&&s9(t,["displayName"],i);let s=s8(e,["contents"]);if(void 0!==t&&null!=s){let e=oM(s);Array.isArray(e)&&(e=e.map(e=>ae(e))),s9(t,["contents"],e)}let o=s8(e,["systemInstruction"]);void 0!==t&&null!=o&&s9(t,["systemInstruction"],ae(oN(o)));let a=s8(e,["tools"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["behavior"]);null!=r&&s9(t,["behavior"],r);let n=s8(e,["description"]);null!=n&&s9(t,["description"],n);let i=s8(e,["name"]);null!=i&&s9(t,["name"],i);let s=s8(e,["parameters"]);null!=s&&s9(t,["parameters"],s);let o=s8(e,["parametersJsonSchema"]);null!=o&&s9(t,["parametersJsonSchema"],o);let a=s8(e,["response"]);null!=a&&s9(t,["response"],a);let l=s8(e,["responseJsonSchema"]);return null!=l&&s9(t,["responseJsonSchema"],l),t})(e))),s9(t,["functionDeclarations"],e)}if(void 0!==s8(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let n=s8(e,["googleSearch"]);null!=n&&s9(t,["googleSearch"],function(e){let t={},r=s8(e,["timeRangeFilter"]);if(null!=r&&s9(t,["timeRangeFilter"],function(e){let t={},r=s8(e,["startTime"]);null!=r&&s9(t,["startTime"],r);let n=s8(e,["endTime"]);return null!=n&&s9(t,["endTime"],n),t}(r)),void 0!==s8(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return t}(n));let i=s8(e,["googleSearchRetrieval"]);if(null!=i&&s9(t,["googleSearchRetrieval"],function(e){let t={},r=s8(e,["dynamicRetrievalConfig"]);return null!=r&&s9(t,["dynamicRetrievalConfig"],function(e){let t={},r=s8(e,["mode"]);null!=r&&s9(t,["mode"],r);let n=s8(e,["dynamicThreshold"]);return null!=n&&s9(t,["dynamicThreshold"],n),t}(r)),t}(i)),void 0!==s8(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==s8(e,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");null!=s8(e,["urlContext"])&&s9(t,["urlContext"],{});let s=s8(e,["computerUse"]);null!=s&&s9(t,["computerUse"],function(e){let t={},r=s8(e,["environment"]);null!=r&&s9(t,["environment"],r);let n=s8(e,["excludedPredefinedFunctions"]);return null!=n&&s9(t,["excludedPredefinedFunctions"],n),t}(s));let o=s8(e,["codeExecution"]);return null!=o&&s9(t,["codeExecution"],o),t})(e))),s9(t,["tools"],e)}let l=s8(e,["toolConfig"]);if(void 0!==t&&null!=l&&s9(t,["toolConfig"],function(e){let t={},r=s8(e,["functionCallingConfig"]);null!=r&&s9(t,["functionCallingConfig"],function(e){let t={},r=s8(e,["mode"]);null!=r&&s9(t,["mode"],r);let n=s8(e,["allowedFunctionNames"]);return null!=n&&s9(t,["allowedFunctionNames"],n),t}(r));let n=s8(e,["retrievalConfig"]);return null!=n&&s9(t,["retrievalConfig"],function(e){let t={},r=s8(e,["latLng"]);null!=r&&s9(t,["latLng"],function(e){let t={},r=s8(e,["latitude"]);null!=r&&s9(t,["latitude"],r);let n=s8(e,["longitude"]);return null!=n&&s9(t,["longitude"],n),t}(r));let n=s8(e,["languageCode"]);return null!=n&&s9(t,["languageCode"],n),t}(n)),t}(l)),void 0!==s8(e,["kmsKeyName"]))throw Error("kmsKeyName parameter is not supported in Gemini API.")}(i,r),r}(this.apiClient,e);return s=s6("cachedContents",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json()).then(e=>o8(e))}}async get(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=s8(t,["name"]);return null!=n&&s9(r,["_url","name"],oq(e,n)),r}(this.apiClient,e);return s=s6("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>o7(e))}{let t=function(e,t){let r={},n=s8(t,["name"]);return null!=n&&s9(r,["_url","name"],oq(e,n)),r}(this.apiClient,e);return s=s6("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json()).then(e=>o8(e))}}async delete(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=s8(t,["name"]);return null!=n&&s9(r,["_url","name"],oq(e,n)),r}(this.apiClient,e);return s=s6("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);return null!=r&&s9(t,["sdkHttpResponse"],r),t}(e),r=new of;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=s8(t,["name"]);return null!=n&&s9(r,["_url","name"],oq(e,n)),r}(this.apiClient,e);return s=s6("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);return null!=r&&s9(t,["sdkHttpResponse"],r),t}(e),r=new of;return Object.assign(r,t),r})}}async update(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=s8(t,["name"]);null!=n&&s9(r,["_url","name"],oq(e,n));let i=s8(t,["config"]);return null!=i&&function(e,t){let r=s8(e,["ttl"]);void 0!==t&&null!=r&&s9(t,["ttl"],r);let n=s8(e,["expireTime"]);void 0!==t&&null!=n&&s9(t,["expireTime"],n)}(i,r),r}(this.apiClient,e);return s=s6("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"PATCH",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>o7(e))}{let t=function(e,t){let r={},n=s8(t,["name"]);null!=n&&s9(r,["_url","name"],oq(e,n));let i=s8(t,["config"]);return null!=i&&function(e,t){let r=s8(e,["ttl"]);void 0!==t&&null!=r&&s9(t,["ttl"],r);let n=s8(e,["expireTime"]);void 0!==t&&null!=n&&s9(t,["expireTime"],n)}(i,r),r}(this.apiClient,e);return s=s6("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json()).then(e=>o8(e))}}async listInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e){let t={},r=s8(e,["config"]);return null!=r&&function(e,t){let r=s8(e,["pageSize"]);void 0!==t&&null!=r&&s9(t,["_query","pageSize"],r);let n=s8(e,["pageToken"]);void 0!==t&&null!=n&&s9(t,["_query","pageToken"],n)}(r,t),t}(e);return s=s6("cachedContents",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["nextPageToken"]);null!=n&&s9(t,["nextPageToken"],n);let i=s8(e,["cachedContents"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>o7(e))),s9(t,["cachedContents"],e)}return t}(e),r=new og;return Object.assign(r,t),r})}{let t=function(e){let t={},r=s8(e,["config"]);return null!=r&&function(e,t){let r=s8(e,["pageSize"]);void 0!==t&&null!=r&&s9(t,["_query","pageSize"],r);let n=s8(e,["pageToken"]);void 0!==t&&null!=n&&s9(t,["_query","pageToken"],n)}(r,t),t}(e);return s=s6("cachedContents",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["nextPageToken"]);null!=n&&s9(t,["nextPageToken"],n);let i=s8(e,["cachedContents"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>o8(e))),s9(t,["cachedContents"],e)}return t}(e),r=new og;return Object.assign(r,t),r})}}}function an(e){return this instanceof an?(this.v=e,this):new an(e)}function ai(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),s=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),n[Symbol.asyncIterator]=function(){return this},n;function o(e,t){i[e]&&(n[e]=function(t){return new Promise(function(r,n){s.push([e,t,r,n])>1||a(e,t)})},t&&(n[e]=t(n[e])))}function a(e,t){try{var r;(r=i[e](t)).value instanceof an?Promise.resolve(r.value.v).then(l,u):c(s[0][2],r)}catch(e){c(s[0][3],e)}}function l(e){a("next",e)}function u(e){a("throw",e)}function c(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function as(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){var s,o,a;s=n,o=i,a=(t=e[r](t)).done,Promise.resolve(t.value).then(function(e){s({value:e,done:a})},o)})}}}function ao(e){if(void 0===e.parts||0===e.parts.length)return!1;for(let t of e.parts)if(void 0===t||0===Object.keys(t).length)return!1;return!0}function aa(e){if(void 0===e||0===e.length)return[];let t=[],r=e.length,n=0;for(;n<r;)if("user"===e[n].role)t.push(e[n]),n++;else{let i=[],s=!0;for(;n<r&&"model"===e[n].role;)i.push(e[n]),s&&!ao(e[n])&&(s=!1),n++;s?t.push(...i):t.pop()}return t}"function"==typeof SuppressedError&&SuppressedError;class al{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new au(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class au{constructor(e,t,r,n={},i=[]){this.apiClient=e,this.modelsModule=t,this.model=r,this.config=n,this.history=i,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length){for(let t of e)if("user"!==t.role&&"model"!==t.role)throw Error(`Role must be user or model, but got ${t.role}.`)}}(i)}async sendMessage(e){var t;await this.sendPromise;let r=oN(e.message),n=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:null!=(t=e.config)?t:this.config});return this.sendPromise=(async()=>{var e,t,i;let s=await n,o=null==(t=null==(e=s.candidates)?void 0:e[0])?void 0:t.content,a=s.automaticFunctionCallingHistory,l=this.getHistory(!0).length,u=[];null!=a&&(u=null!=(i=a.slice(l))?i:[]),this.recordHistory(r,o?[o]:[],u)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),n}async sendMessageStream(e){var t;await this.sendPromise;let r=oN(e.message),n=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:null!=(t=e.config)?t:this.config});this.sendPromise=n.then(()=>void 0).catch(()=>void 0);let i=await n;return this.processStreamResponse(i,r)}getHistory(e=!1){return structuredClone(e?aa(this.history):this.history)}processStreamResponse(e,t){var r,n;return ai(this,arguments,function*(){var i,s,o,a;let l=[];try{for(var u,c=!0,d=as(e);!(i=(u=yield an(d.next())).done);c=!0){if(a=u.value,c=!1,function(e){var t;if(void 0==e.candidates||0===e.candidates.length)return!1;let r=null==(t=e.candidates[0])?void 0:t.content;return void 0!==r&&ao(r)}(a)){let e=null==(n=null==(r=a.candidates)?void 0:r[0])?void 0:n.content;void 0!==e&&l.push(e)}yield yield an(a)}}catch(e){s={error:e}}finally{try{!c&&!i&&(o=d.return)&&(yield an(o.call(d)))}finally{if(s)throw s.error}}this.recordHistory(t,l)})}recordHistory(e,t,r){let n=[];t.length>0&&t.every(e=>void 0!==e.role)?n=t:n.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...aa(r)):this.history.push(e),this.history.push(...n)}}class ac extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,ac.prototype)}}function ad(e){let t={},r=s8(e,["name"]);null!=r&&s9(t,["name"],r);let n=s8(e,["displayName"]);null!=n&&s9(t,["displayName"],n);let i=s8(e,["mimeType"]);null!=i&&s9(t,["mimeType"],i);let s=s8(e,["sizeBytes"]);null!=s&&s9(t,["sizeBytes"],s);let o=s8(e,["createTime"]);null!=o&&s9(t,["createTime"],o);let a=s8(e,["expirationTime"]);null!=a&&s9(t,["expirationTime"],a);let l=s8(e,["updateTime"]);null!=l&&s9(t,["updateTime"],l);let u=s8(e,["sha256Hash"]);null!=u&&s9(t,["sha256Hash"],u);let c=s8(e,["uri"]);null!=c&&s9(t,["uri"],c);let d=s8(e,["downloadUri"]);null!=d&&s9(t,["downloadUri"],d);let h=s8(e,["state"]);null!=h&&s9(t,["state"],h);let p=s8(e,["source"]);null!=p&&s9(t,["source"],p);let f=s8(e,["videoMetadata"]);null!=f&&s9(t,["videoMetadata"],f);let g=s8(e,["error"]);return null!=g&&s9(t,["error"],function(e){let t={},r=s8(e,["details"]);null!=r&&s9(t,["details"],r);let n=s8(e,["message"]);null!=n&&s9(t,["message"],n);let i=s8(e,["code"]);return null!=i&&s9(t,["code"],i),t}(g)),t}class ah extends s3{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new o6(es.PAGED_ITEM_FILES,e=>this.listInternal(e),await this.listInternal(e),e)}async upload(e){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(e=>ad(e))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=s8(e,["config"]);return null!=r&&function(e,t){let r=s8(e,["pageSize"]);void 0!==t&&null!=r&&s9(t,["_query","pageSize"],r);let n=s8(e,["pageToken"]);void 0!==t&&null!=n&&s9(t,["_query","pageToken"],n)}(r,t),t}(e);return n=s6("files",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["nextPageToken"]);null!=n&&s9(t,["nextPageToken"],n);let i=s8(e,["files"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>ad(e))),s9(t,["files"],e)}return t}(e),r=new om;return Object.assign(r,t),r})}}async createInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=s8(e,["file"]);return null!=r&&s9(t,["file"],function(e){let t={},r=s8(e,["name"]);null!=r&&s9(t,["name"],r);let n=s8(e,["displayName"]);null!=n&&s9(t,["displayName"],n);let i=s8(e,["mimeType"]);null!=i&&s9(t,["mimeType"],i);let s=s8(e,["sizeBytes"]);null!=s&&s9(t,["sizeBytes"],s);let o=s8(e,["createTime"]);null!=o&&s9(t,["createTime"],o);let a=s8(e,["expirationTime"]);null!=a&&s9(t,["expirationTime"],a);let l=s8(e,["updateTime"]);null!=l&&s9(t,["updateTime"],l);let u=s8(e,["sha256Hash"]);null!=u&&s9(t,["sha256Hash"],u);let c=s8(e,["uri"]);null!=c&&s9(t,["uri"],c);let d=s8(e,["downloadUri"]);null!=d&&s9(t,["downloadUri"],d);let h=s8(e,["state"]);null!=h&&s9(t,["state"],h);let p=s8(e,["source"]);null!=p&&s9(t,["source"],p);let f=s8(e,["videoMetadata"]);null!=f&&s9(t,["videoMetadata"],f);let g=s8(e,["error"]);return null!=g&&s9(t,["error"],function(e){let t={},r=s8(e,["details"]);null!=r&&s9(t,["details"],r);let n=s8(e,["message"]);null!=n&&s9(t,["message"],n);let i=s8(e,["code"]);return null!=i&&s9(t,["code"],i),t}(g)),t}(r)),t}(e);return n=s6("upload/v1beta/files",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);return null!=r&&s9(t,["sdkHttpResponse"],r),t}(e),r=new oy;return Object.assign(r,t),r})}}async get(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=s8(e,["name"]);return null!=r&&s9(t,["_url","file"],oV(r)),t}(e);return n=s6("files/{file}",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>ad(e))}}async delete(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=s8(e,["name"]);return null!=r&&s9(t,["_url","file"],oV(r)),t}(e);return n=s6("files/{file}",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);return null!=r&&s9(t,["sdkHttpResponse"],r),t}(e),r=new ov;return Object.assign(r,t),r})}}}function ap(e){let t={},r=s8(e,["id"]);null!=r&&s9(t,["id"],r);let n=s8(e,["args"]);null!=n&&s9(t,["args"],n);let i=s8(e,["name"]);return null!=i&&s9(t,["name"],i),t}function af(e){let t={},r=s8(e,["id"]);null!=r&&s9(t,["id"],r);let n=s8(e,["args"]);null!=n&&s9(t,["args"],n);let i=s8(e,["name"]);return null!=i&&s9(t,["name"],i),t}function ag(e){let t={},r=s8(e,["weightedPrompts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>aT(e))),s9(t,["weightedPrompts"],e)}return t}function am(e){let t={},r=s8(e,["setup"]);null!=r&&s9(t,["setup"],ay(r));let n=s8(e,["clientContent"]);null!=n&&s9(t,["clientContent"],ag(n));let i=s8(e,["musicGenerationConfig"]);null!=i&&s9(t,["musicGenerationConfig"],av(i));let s=s8(e,["playbackControl"]);return null!=s&&s9(t,["playbackControl"],s),t}function ay(e){let t={},r=s8(e,["model"]);return null!=r&&s9(t,["model"],r),t}function av(e){let t={},r=s8(e,["temperature"]);null!=r&&s9(t,["temperature"],r);let n=s8(e,["topK"]);null!=n&&s9(t,["topK"],n);let i=s8(e,["seed"]);null!=i&&s9(t,["seed"],i);let s=s8(e,["guidance"]);null!=s&&s9(t,["guidance"],s);let o=s8(e,["bpm"]);null!=o&&s9(t,["bpm"],o);let a=s8(e,["density"]);null!=a&&s9(t,["density"],a);let l=s8(e,["brightness"]);null!=l&&s9(t,["brightness"],l);let u=s8(e,["scale"]);null!=u&&s9(t,["scale"],u);let c=s8(e,["muteBass"]);null!=c&&s9(t,["muteBass"],c);let d=s8(e,["muteDrums"]);null!=d&&s9(t,["muteDrums"],d);let h=s8(e,["onlyBassAndDrums"]);null!=h&&s9(t,["onlyBassAndDrums"],h);let p=s8(e,["musicGenerationMode"]);return null!=p&&s9(t,["musicGenerationMode"],p),t}function a_(e){let t={},r=s8(e,["modality"]);null!=r&&s9(t,["modality"],r);let n=s8(e,["tokenCount"]);return null!=n&&s9(t,["tokenCount"],n),t}function ab(e){let t={},r=s8(e,["modality"]);null!=r&&s9(t,["modality"],r);let n=s8(e,["tokenCount"]);return null!=n&&s9(t,["tokenCount"],n),t}function aE(e){let t={},r=s8(e,["text"]);null!=r&&s9(t,["text"],r);let n=s8(e,["finished"]);return null!=n&&s9(t,["finished"],n),t}function aS(e){let t={},r=s8(e,["text"]);null!=r&&s9(t,["text"],r);let n=s8(e,["finished"]);return null!=n&&s9(t,["finished"],n),t}function aw(e){let t={},r=s8(e,["prebuiltVoiceConfig"]);return null!=r&&s9(t,["prebuiltVoiceConfig"],function(e){let t={},r=s8(e,["voiceName"]);return null!=r&&s9(t,["voiceName"],r),t}(r)),t}function aT(e){let t={},r=s8(e,["text"]);null!=r&&s9(t,["text"],r);let n=s8(e,["weight"]);return null!=n&&s9(t,["weight"],n),t}function aC(e){let t={},r=s8(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["videoMetadata"]);null!=r&&s9(t,["videoMetadata"],function(e){let t={},r=s8(e,["fps"]);null!=r&&s9(t,["fps"],r);let n=s8(e,["endOffset"]);null!=n&&s9(t,["endOffset"],n);let i=s8(e,["startOffset"]);return null!=i&&s9(t,["startOffset"],i),t}(r));let n=s8(e,["thought"]);null!=n&&s9(t,["thought"],n);let i=s8(e,["inlineData"]);null!=i&&s9(t,["inlineData"],function(e){let t={};if(void 0!==s8(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=s8(e,["data"]);null!=r&&s9(t,["data"],r);let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(i));let s=s8(e,["fileData"]);null!=s&&s9(t,["fileData"],function(e){let t={};if(void 0!==s8(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=s8(e,["fileUri"]);null!=r&&s9(t,["fileUri"],r);let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(s));let o=s8(e,["thoughtSignature"]);null!=o&&s9(t,["thoughtSignature"],o);let a=s8(e,["functionCall"]);null!=a&&s9(t,["functionCall"],function(e){let t={},r=s8(e,["id"]);null!=r&&s9(t,["id"],r);let n=s8(e,["args"]);null!=n&&s9(t,["args"],n);let i=s8(e,["name"]);return null!=i&&s9(t,["name"],i),t}(a));let l=s8(e,["codeExecutionResult"]);null!=l&&s9(t,["codeExecutionResult"],l);let u=s8(e,["executableCode"]);null!=u&&s9(t,["executableCode"],u);let c=s8(e,["functionResponse"]);null!=c&&s9(t,["functionResponse"],c);let d=s8(e,["text"]);return null!=d&&s9(t,["text"],d),t})(e))),s9(t,["parts"],e)}let n=s8(e,["role"]);return null!=n&&s9(t,["role"],n),t}function aA(e){let t={},r=s8(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["videoMetadata"]);null!=r&&s9(t,["videoMetadata"],function(e){let t={},r=s8(e,["fps"]);null!=r&&s9(t,["fps"],r);let n=s8(e,["endOffset"]);null!=n&&s9(t,["endOffset"],n);let i=s8(e,["startOffset"]);return null!=i&&s9(t,["startOffset"],i),t}(r));let n=s8(e,["thought"]);null!=n&&s9(t,["thought"],n);let i=s8(e,["inlineData"]);null!=i&&s9(t,["inlineData"],function(e){let t={},r=s8(e,["displayName"]);null!=r&&s9(t,["displayName"],r);let n=s8(e,["data"]);null!=n&&s9(t,["data"],n);let i=s8(e,["mimeType"]);return null!=i&&s9(t,["mimeType"],i),t}(i));let s=s8(e,["fileData"]);null!=s&&s9(t,["fileData"],function(e){let t={},r=s8(e,["displayName"]);null!=r&&s9(t,["displayName"],r);let n=s8(e,["fileUri"]);null!=n&&s9(t,["fileUri"],n);let i=s8(e,["mimeType"]);return null!=i&&s9(t,["mimeType"],i),t}(s));let o=s8(e,["thoughtSignature"]);null!=o&&s9(t,["thoughtSignature"],o);let a=s8(e,["functionCall"]);null!=a&&s9(t,["functionCall"],function(e){let t={},r=s8(e,["id"]);null!=r&&s9(t,["id"],r);let n=s8(e,["args"]);null!=n&&s9(t,["args"],n);let i=s8(e,["name"]);return null!=i&&s9(t,["name"],i),t}(a));let l=s8(e,["codeExecutionResult"]);null!=l&&s9(t,["codeExecutionResult"],l);let u=s8(e,["executableCode"]);null!=u&&s9(t,["executableCode"],u);let c=s8(e,["functionResponse"]);null!=c&&s9(t,["functionResponse"],c);let d=s8(e,["text"]);return null!=d&&s9(t,["text"],d),t})(e))),s9(t,["parts"],e)}let n=s8(e,["role"]);return null!=n&&s9(t,["role"],n),t}function aO(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["contents"]);if(null!=i){let e=oM(i);Array.isArray(e)&&(e=e.map(e=>aC(e))),s9(r,["contents"],e)}let s=s8(t,["config"]);return null!=s&&s9(r,["generationConfig"],function(e,t,r){let n={},i=s8(t,["systemInstruction"]);void 0!==r&&null!=i&&s9(r,["systemInstruction"],aC(oN(i)));let s=s8(t,["temperature"]);null!=s&&s9(n,["temperature"],s);let o=s8(t,["topP"]);null!=o&&s9(n,["topP"],o);let a=s8(t,["topK"]);null!=a&&s9(n,["topK"],a);let l=s8(t,["candidateCount"]);null!=l&&s9(n,["candidateCount"],l);let u=s8(t,["maxOutputTokens"]);null!=u&&s9(n,["maxOutputTokens"],u);let c=s8(t,["stopSequences"]);null!=c&&s9(n,["stopSequences"],c);let d=s8(t,["responseLogprobs"]);null!=d&&s9(n,["responseLogprobs"],d);let h=s8(t,["logprobs"]);null!=h&&s9(n,["logprobs"],h);let p=s8(t,["presencePenalty"]);null!=p&&s9(n,["presencePenalty"],p);let f=s8(t,["frequencyPenalty"]);null!=f&&s9(n,["frequencyPenalty"],f);let g=s8(t,["seed"]);null!=g&&s9(n,["seed"],g);let m=s8(t,["responseMimeType"]);null!=m&&s9(n,["responseMimeType"],m);let y=s8(t,["responseSchema"]);null!=y&&s9(n,["responseSchema"],function(e){let t={},r=s8(e,["anyOf"]);null!=r&&s9(t,["anyOf"],r);let n=s8(e,["default"]);null!=n&&s9(t,["default"],n);let i=s8(e,["description"]);null!=i&&s9(t,["description"],i);let s=s8(e,["enum"]);null!=s&&s9(t,["enum"],s);let o=s8(e,["example"]);null!=o&&s9(t,["example"],o);let a=s8(e,["format"]);null!=a&&s9(t,["format"],a);let l=s8(e,["items"]);null!=l&&s9(t,["items"],l);let u=s8(e,["maxItems"]);null!=u&&s9(t,["maxItems"],u);let c=s8(e,["maxLength"]);null!=c&&s9(t,["maxLength"],c);let d=s8(e,["maxProperties"]);null!=d&&s9(t,["maxProperties"],d);let h=s8(e,["maximum"]);null!=h&&s9(t,["maximum"],h);let p=s8(e,["minItems"]);null!=p&&s9(t,["minItems"],p);let f=s8(e,["minLength"]);null!=f&&s9(t,["minLength"],f);let g=s8(e,["minProperties"]);null!=g&&s9(t,["minProperties"],g);let m=s8(e,["minimum"]);null!=m&&s9(t,["minimum"],m);let y=s8(e,["nullable"]);null!=y&&s9(t,["nullable"],y);let v=s8(e,["pattern"]);null!=v&&s9(t,["pattern"],v);let _=s8(e,["properties"]);null!=_&&s9(t,["properties"],_);let b=s8(e,["propertyOrdering"]);null!=b&&s9(t,["propertyOrdering"],b);let E=s8(e,["required"]);null!=E&&s9(t,["required"],E);let S=s8(e,["title"]);null!=S&&s9(t,["title"],S);let w=s8(e,["type"]);return null!=w&&s9(t,["type"],w),t}(oj(y)));let v=s8(t,["responseJsonSchema"]);if(null!=v&&s9(n,["responseJsonSchema"],v),void 0!==s8(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==s8(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let _=s8(t,["safetySettings"]);if(void 0!==r&&null!=_){let e=_;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==s8(e,["method"]))throw Error("method parameter is not supported in Gemini API.");let r=s8(e,["category"]);null!=r&&s9(t,["category"],r);let n=s8(e,["threshold"]);return null!=n&&s9(t,["threshold"],n),t})(e))),s9(r,["safetySettings"],e)}let b=s8(t,["tools"]);if(void 0!==r&&null!=b){let e=oB(b);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["behavior"]);null!=r&&s9(t,["behavior"],r);let n=s8(e,["description"]);null!=n&&s9(t,["description"],n);let i=s8(e,["name"]);null!=i&&s9(t,["name"],i);let s=s8(e,["parameters"]);null!=s&&s9(t,["parameters"],s);let o=s8(e,["parametersJsonSchema"]);null!=o&&s9(t,["parametersJsonSchema"],o);let a=s8(e,["response"]);null!=a&&s9(t,["response"],a);let l=s8(e,["responseJsonSchema"]);return null!=l&&s9(t,["responseJsonSchema"],l),t})(e))),s9(t,["functionDeclarations"],e)}if(void 0!==s8(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let n=s8(e,["googleSearch"]);null!=n&&s9(t,["googleSearch"],function(e){let t={},r=s8(e,["timeRangeFilter"]);if(null!=r&&s9(t,["timeRangeFilter"],function(e){let t={},r=s8(e,["startTime"]);null!=r&&s9(t,["startTime"],r);let n=s8(e,["endTime"]);return null!=n&&s9(t,["endTime"],n),t}(r)),void 0!==s8(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return t}(n));let i=s8(e,["googleSearchRetrieval"]);if(null!=i&&s9(t,["googleSearchRetrieval"],function(e){let t={},r=s8(e,["dynamicRetrievalConfig"]);return null!=r&&s9(t,["dynamicRetrievalConfig"],function(e){let t={},r=s8(e,["mode"]);null!=r&&s9(t,["mode"],r);let n=s8(e,["dynamicThreshold"]);return null!=n&&s9(t,["dynamicThreshold"],n),t}(r)),t}(i)),void 0!==s8(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==s8(e,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");null!=s8(e,["urlContext"])&&s9(t,["urlContext"],{});let s=s8(e,["computerUse"]);null!=s&&s9(t,["computerUse"],function(e){let t={},r=s8(e,["environment"]);null!=r&&s9(t,["environment"],r);let n=s8(e,["excludedPredefinedFunctions"]);return null!=n&&s9(t,["excludedPredefinedFunctions"],n),t}(s));let o=s8(e,["codeExecution"]);return null!=o&&s9(t,["codeExecution"],o),t})(oF(e)))),s9(r,["tools"],e)}let E=s8(t,["toolConfig"]);if(void 0!==r&&null!=E&&s9(r,["toolConfig"],function(e){let t={},r=s8(e,["functionCallingConfig"]);null!=r&&s9(t,["functionCallingConfig"],function(e){let t={},r=s8(e,["mode"]);null!=r&&s9(t,["mode"],r);let n=s8(e,["allowedFunctionNames"]);return null!=n&&s9(t,["allowedFunctionNames"],n),t}(r));let n=s8(e,["retrievalConfig"]);return null!=n&&s9(t,["retrievalConfig"],function(e){let t={},r=s8(e,["latLng"]);null!=r&&s9(t,["latLng"],function(e){let t={},r=s8(e,["latitude"]);null!=r&&s9(t,["latitude"],r);let n=s8(e,["longitude"]);return null!=n&&s9(t,["longitude"],n),t}(r));let n=s8(e,["languageCode"]);return null!=n&&s9(t,["languageCode"],n),t}(n)),t}(E)),void 0!==s8(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let S=s8(t,["cachedContent"]);void 0!==r&&null!=S&&s9(r,["cachedContent"],oq(e,S));let w=s8(t,["responseModalities"]);null!=w&&s9(n,["responseModalities"],w);let T=s8(t,["mediaResolution"]);null!=T&&s9(n,["mediaResolution"],T);let C=s8(t,["speechConfig"]);if(null!=C&&s9(n,["speechConfig"],function(e){let t={},r=s8(e,["voiceConfig"]);null!=r&&s9(t,["voiceConfig"],aq(r));let n=s8(e,["multiSpeakerVoiceConfig"]);null!=n&&s9(t,["multiSpeakerVoiceConfig"],function(e){let t={},r=s8(e,["speakerVoiceConfigs"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["speaker"]);null!=r&&s9(t,["speaker"],r);let n=s8(e,["voiceConfig"]);return null!=n&&s9(t,["voiceConfig"],aq(n)),t})(e))),s9(t,["speakerVoiceConfigs"],e)}return t}(n));let i=s8(e,["languageCode"]);return null!=i&&s9(t,["languageCode"],i),t}(oU(C))),void 0!==s8(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let A=s8(t,["thinkingConfig"]);return null!=A&&s9(n,["thinkingConfig"],function(e){let t={},r=s8(e,["includeThoughts"]);null!=r&&s9(t,["includeThoughts"],r);let n=s8(e,["thinkingBudget"]);return null!=n&&s9(t,["thinkingBudget"],n),t}(A)),n}(e,s,r)),r}function ax(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["contents"]);if(null!=i){let e=oM(i);Array.isArray(e)&&(e=e.map(e=>aA(e))),s9(r,["contents"],e)}let s=s8(t,["config"]);return null!=s&&s9(r,["generationConfig"],function(e,t,r){let n={},i=s8(t,["systemInstruction"]);void 0!==r&&null!=i&&s9(r,["systemInstruction"],aA(oN(i)));let s=s8(t,["temperature"]);null!=s&&s9(n,["temperature"],s);let o=s8(t,["topP"]);null!=o&&s9(n,["topP"],o);let a=s8(t,["topK"]);null!=a&&s9(n,["topK"],a);let l=s8(t,["candidateCount"]);null!=l&&s9(n,["candidateCount"],l);let u=s8(t,["maxOutputTokens"]);null!=u&&s9(n,["maxOutputTokens"],u);let c=s8(t,["stopSequences"]);null!=c&&s9(n,["stopSequences"],c);let d=s8(t,["responseLogprobs"]);null!=d&&s9(n,["responseLogprobs"],d);let h=s8(t,["logprobs"]);null!=h&&s9(n,["logprobs"],h);let p=s8(t,["presencePenalty"]);null!=p&&s9(n,["presencePenalty"],p);let f=s8(t,["frequencyPenalty"]);null!=f&&s9(n,["frequencyPenalty"],f);let g=s8(t,["seed"]);null!=g&&s9(n,["seed"],g);let m=s8(t,["responseMimeType"]);null!=m&&s9(n,["responseMimeType"],m);let y=s8(t,["responseSchema"]);null!=y&&s9(n,["responseSchema"],function(e){let t={},r=s8(e,["anyOf"]);null!=r&&s9(t,["anyOf"],r);let n=s8(e,["default"]);null!=n&&s9(t,["default"],n);let i=s8(e,["description"]);null!=i&&s9(t,["description"],i);let s=s8(e,["enum"]);null!=s&&s9(t,["enum"],s);let o=s8(e,["example"]);null!=o&&s9(t,["example"],o);let a=s8(e,["format"]);null!=a&&s9(t,["format"],a);let l=s8(e,["items"]);null!=l&&s9(t,["items"],l);let u=s8(e,["maxItems"]);null!=u&&s9(t,["maxItems"],u);let c=s8(e,["maxLength"]);null!=c&&s9(t,["maxLength"],c);let d=s8(e,["maxProperties"]);null!=d&&s9(t,["maxProperties"],d);let h=s8(e,["maximum"]);null!=h&&s9(t,["maximum"],h);let p=s8(e,["minItems"]);null!=p&&s9(t,["minItems"],p);let f=s8(e,["minLength"]);null!=f&&s9(t,["minLength"],f);let g=s8(e,["minProperties"]);null!=g&&s9(t,["minProperties"],g);let m=s8(e,["minimum"]);null!=m&&s9(t,["minimum"],m);let y=s8(e,["nullable"]);null!=y&&s9(t,["nullable"],y);let v=s8(e,["pattern"]);null!=v&&s9(t,["pattern"],v);let _=s8(e,["properties"]);null!=_&&s9(t,["properties"],_);let b=s8(e,["propertyOrdering"]);null!=b&&s9(t,["propertyOrdering"],b);let E=s8(e,["required"]);null!=E&&s9(t,["required"],E);let S=s8(e,["title"]);null!=S&&s9(t,["title"],S);let w=s8(e,["type"]);return null!=w&&s9(t,["type"],w),t}(oj(y)));let v=s8(t,["responseJsonSchema"]);null!=v&&s9(n,["responseJsonSchema"],v);let _=s8(t,["routingConfig"]);null!=_&&s9(n,["routingConfig"],_);let b=s8(t,["modelSelectionConfig"]);null!=b&&s9(n,["modelConfig"],function(e){let t={},r=s8(e,["featureSelectionPreference"]);return null!=r&&s9(t,["featureSelectionPreference"],r),t}(b));let E=s8(t,["safetySettings"]);if(void 0!==r&&null!=E){let e=E;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["method"]);null!=r&&s9(t,["method"],r);let n=s8(e,["category"]);null!=n&&s9(t,["category"],n);let i=s8(e,["threshold"]);return null!=i&&s9(t,["threshold"],i),t})(e))),s9(r,["safetySettings"],e)}let S=s8(t,["tools"]);if(void 0!==r&&null!=S){let e=oB(S);Array.isArray(e)&&(e=e.map(e=>aF(oF(e)))),s9(r,["tools"],e)}let w=s8(t,["toolConfig"]);void 0!==r&&null!=w&&s9(r,["toolConfig"],function(e){let t={},r=s8(e,["functionCallingConfig"]);null!=r&&s9(t,["functionCallingConfig"],function(e){let t={},r=s8(e,["mode"]);null!=r&&s9(t,["mode"],r);let n=s8(e,["allowedFunctionNames"]);return null!=n&&s9(t,["allowedFunctionNames"],n),t}(r));let n=s8(e,["retrievalConfig"]);return null!=n&&s9(t,["retrievalConfig"],function(e){let t={},r=s8(e,["latLng"]);null!=r&&s9(t,["latLng"],function(e){let t={},r=s8(e,["latitude"]);null!=r&&s9(t,["latitude"],r);let n=s8(e,["longitude"]);return null!=n&&s9(t,["longitude"],n),t}(r));let n=s8(e,["languageCode"]);return null!=n&&s9(t,["languageCode"],n),t}(n)),t}(w));let T=s8(t,["labels"]);void 0!==r&&null!=T&&s9(r,["labels"],T);let C=s8(t,["cachedContent"]);void 0!==r&&null!=C&&s9(r,["cachedContent"],oq(e,C));let A=s8(t,["responseModalities"]);null!=A&&s9(n,["responseModalities"],A);let O=s8(t,["mediaResolution"]);null!=O&&s9(n,["mediaResolution"],O);let x=s8(t,["speechConfig"]);null!=x&&s9(n,["speechConfig"],function(e){let t={},r=s8(e,["voiceConfig"]);if(null!=r&&s9(t,["voiceConfig"],function(e){let t={},r=s8(e,["prebuiltVoiceConfig"]);return null!=r&&s9(t,["prebuiltVoiceConfig"],function(e){let t={},r=s8(e,["voiceName"]);return null!=r&&s9(t,["voiceName"],r),t}(r)),t}(r)),void 0!==s8(e,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");let n=s8(e,["languageCode"]);return null!=n&&s9(t,["languageCode"],n),t}(oU(x)));let I=s8(t,["audioTimestamp"]);null!=I&&s9(n,["audioTimestamp"],I);let k=s8(t,["thinkingConfig"]);return null!=k&&s9(n,["thinkingConfig"],function(e){let t={},r=s8(e,["includeThoughts"]);null!=r&&s9(t,["includeThoughts"],r);let n=s8(e,["thinkingBudget"]);return null!=n&&s9(t,["thinkingBudget"],n),t}(k)),n}(e,s,r)),r}function aI(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["candidates"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["content"]);null!=r&&s9(t,["content"],function(e){let t={},r=s8(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["videoMetadata"]);null!=r&&s9(t,["videoMetadata"],function(e){let t={},r=s8(e,["fps"]);null!=r&&s9(t,["fps"],r);let n=s8(e,["endOffset"]);null!=n&&s9(t,["endOffset"],n);let i=s8(e,["startOffset"]);return null!=i&&s9(t,["startOffset"],i),t}(r));let n=s8(e,["thought"]);null!=n&&s9(t,["thought"],n);let i=s8(e,["inlineData"]);null!=i&&s9(t,["inlineData"],function(e){let t={},r=s8(e,["data"]);null!=r&&s9(t,["data"],r);let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(i));let s=s8(e,["fileData"]);null!=s&&s9(t,["fileData"],function(e){let t={},r=s8(e,["fileUri"]);null!=r&&s9(t,["fileUri"],r);let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(s));let o=s8(e,["thoughtSignature"]);null!=o&&s9(t,["thoughtSignature"],o);let a=s8(e,["functionCall"]);null!=a&&s9(t,["functionCall"],function(e){let t={},r=s8(e,["id"]);null!=r&&s9(t,["id"],r);let n=s8(e,["args"]);null!=n&&s9(t,["args"],n);let i=s8(e,["name"]);return null!=i&&s9(t,["name"],i),t}(a));let l=s8(e,["codeExecutionResult"]);null!=l&&s9(t,["codeExecutionResult"],l);let u=s8(e,["executableCode"]);null!=u&&s9(t,["executableCode"],u);let c=s8(e,["functionResponse"]);null!=c&&s9(t,["functionResponse"],c);let d=s8(e,["text"]);return null!=d&&s9(t,["text"],d),t})(e))),s9(t,["parts"],e)}let n=s8(e,["role"]);return null!=n&&s9(t,["role"],n),t}(r));let n=s8(e,["citationMetadata"]);null!=n&&s9(t,["citationMetadata"],function(e){let t={},r=s8(e,["citationSources"]);return null!=r&&s9(t,["citations"],r),t}(n));let i=s8(e,["tokenCount"]);null!=i&&s9(t,["tokenCount"],i);let s=s8(e,["finishReason"]);null!=s&&s9(t,["finishReason"],s);let o=s8(e,["urlContextMetadata"]);null!=o&&s9(t,["urlContextMetadata"],function(e){let t={},r=s8(e,["urlMetadata"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["retrievedUrl"]);null!=r&&s9(t,["retrievedUrl"],r);let n=s8(e,["urlRetrievalStatus"]);return null!=n&&s9(t,["urlRetrievalStatus"],n),t})(e))),s9(t,["urlMetadata"],e)}return t}(o));let a=s8(e,["avgLogprobs"]);null!=a&&s9(t,["avgLogprobs"],a);let l=s8(e,["groundingMetadata"]);null!=l&&s9(t,["groundingMetadata"],l);let u=s8(e,["index"]);null!=u&&s9(t,["index"],u);let c=s8(e,["logprobsResult"]);null!=c&&s9(t,["logprobsResult"],c);let d=s8(e,["safetyRatings"]);return null!=d&&s9(t,["safetyRatings"],d),t})(e))),s9(t,["candidates"],e)}let i=s8(e,["modelVersion"]);null!=i&&s9(t,["modelVersion"],i);let s=s8(e,["promptFeedback"]);null!=s&&s9(t,["promptFeedback"],s);let o=s8(e,["responseId"]);null!=o&&s9(t,["responseId"],o);let a=s8(e,["usageMetadata"]);return null!=a&&s9(t,["usageMetadata"],a),t}function ak(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["candidates"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["content"]);null!=r&&s9(t,["content"],function(e){let t={},r=s8(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["videoMetadata"]);null!=r&&s9(t,["videoMetadata"],function(e){let t={},r=s8(e,["fps"]);null!=r&&s9(t,["fps"],r);let n=s8(e,["endOffset"]);null!=n&&s9(t,["endOffset"],n);let i=s8(e,["startOffset"]);return null!=i&&s9(t,["startOffset"],i),t}(r));let n=s8(e,["thought"]);null!=n&&s9(t,["thought"],n);let i=s8(e,["inlineData"]);null!=i&&s9(t,["inlineData"],function(e){let t={},r=s8(e,["displayName"]);null!=r&&s9(t,["displayName"],r);let n=s8(e,["data"]);null!=n&&s9(t,["data"],n);let i=s8(e,["mimeType"]);return null!=i&&s9(t,["mimeType"],i),t}(i));let s=s8(e,["fileData"]);null!=s&&s9(t,["fileData"],function(e){let t={},r=s8(e,["displayName"]);null!=r&&s9(t,["displayName"],r);let n=s8(e,["fileUri"]);null!=n&&s9(t,["fileUri"],n);let i=s8(e,["mimeType"]);return null!=i&&s9(t,["mimeType"],i),t}(s));let o=s8(e,["thoughtSignature"]);null!=o&&s9(t,["thoughtSignature"],o);let a=s8(e,["functionCall"]);null!=a&&s9(t,["functionCall"],function(e){let t={},r=s8(e,["id"]);null!=r&&s9(t,["id"],r);let n=s8(e,["args"]);null!=n&&s9(t,["args"],n);let i=s8(e,["name"]);return null!=i&&s9(t,["name"],i),t}(a));let l=s8(e,["codeExecutionResult"]);null!=l&&s9(t,["codeExecutionResult"],l);let u=s8(e,["executableCode"]);null!=u&&s9(t,["executableCode"],u);let c=s8(e,["functionResponse"]);null!=c&&s9(t,["functionResponse"],c);let d=s8(e,["text"]);return null!=d&&s9(t,["text"],d),t})(e))),s9(t,["parts"],e)}let n=s8(e,["role"]);return null!=n&&s9(t,["role"],n),t}(r));let n=s8(e,["citationMetadata"]);null!=n&&s9(t,["citationMetadata"],function(e){let t={},r=s8(e,["citations"]);return null!=r&&s9(t,["citations"],r),t}(n));let i=s8(e,["finishMessage"]);null!=i&&s9(t,["finishMessage"],i);let s=s8(e,["finishReason"]);null!=s&&s9(t,["finishReason"],s);let o=s8(e,["urlContextMetadata"]);null!=o&&s9(t,["urlContextMetadata"],function(e){let t={},r=s8(e,["urlMetadata"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["retrievedUrl"]);null!=r&&s9(t,["retrievedUrl"],r);let n=s8(e,["urlRetrievalStatus"]);return null!=n&&s9(t,["urlRetrievalStatus"],n),t})(e))),s9(t,["urlMetadata"],e)}return t}(o));let a=s8(e,["avgLogprobs"]);null!=a&&s9(t,["avgLogprobs"],a);let l=s8(e,["groundingMetadata"]);null!=l&&s9(t,["groundingMetadata"],l);let u=s8(e,["index"]);null!=u&&s9(t,["index"],u);let c=s8(e,["logprobsResult"]);null!=c&&s9(t,["logprobsResult"],c);let d=s8(e,["safetyRatings"]);return null!=d&&s9(t,["safetyRatings"],d),t})(e))),s9(t,["candidates"],e)}let i=s8(e,["createTime"]);null!=i&&s9(t,["createTime"],i);let s=s8(e,["modelVersion"]);null!=s&&s9(t,["modelVersion"],s);let o=s8(e,["promptFeedback"]);null!=o&&s9(t,["promptFeedback"],o);let a=s8(e,["responseId"]);null!=a&&s9(t,["responseId"],a);let l=s8(e,["usageMetadata"]);return null!=l&&s9(t,["usageMetadata"],l),t}function aR(e){let t={},r=s8(e,["_self"]);null!=r&&s9(t,["image"],aP(r));let n=s8(e,["raiFilteredReason"]);null!=n&&s9(t,["raiFilteredReason"],n);let i=s8(e,["_self"]);null!=i&&s9(t,["safetyAttributes"],aL(i));let s=s8(e,["prompt"]);return null!=s&&s9(t,["enhancedPrompt"],s),t}function aP(e){let t={},r=s8(e,["gcsUri"]);null!=r&&s9(t,["gcsUri"],r);let n=s8(e,["bytesBase64Encoded"]);null!=n&&s9(t,["imageBytes"],s7(n));let i=s8(e,["mimeType"]);return null!=i&&s9(t,["mimeType"],i),t}function aN(e){let t={};if(void 0!==s8(e,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");let r=s8(e,["imageBytes"]);null!=r&&s9(t,["bytesBase64Encoded"],s7(r));let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}function aD(e){let t={},r=s8(e,["gcsUri"]);null!=r&&s9(t,["gcsUri"],r);let n=s8(e,["imageBytes"]);null!=n&&s9(t,["bytesBase64Encoded"],s7(n));let i=s8(e,["mimeType"]);return null!=i&&s9(t,["mimeType"],i),t}function aM(e){let t={},r=s8(e,["name"]);null!=r&&s9(t,["name"],r);let n=s8(e,["displayName"]);null!=n&&s9(t,["displayName"],n);let i=s8(e,["description"]);null!=i&&s9(t,["description"],i);let s=s8(e,["version"]);null!=s&&s9(t,["version"],s);let o=s8(e,["_self"]);null!=o&&s9(t,["tunedModelInfo"],function(e){let t={},r=s8(e,["baseModel"]);null!=r&&s9(t,["baseModel"],r);let n=s8(e,["createTime"]);null!=n&&s9(t,["createTime"],n);let i=s8(e,["updateTime"]);return null!=i&&s9(t,["updateTime"],i),t}(o));let a=s8(e,["inputTokenLimit"]);null!=a&&s9(t,["inputTokenLimit"],a);let l=s8(e,["outputTokenLimit"]);null!=l&&s9(t,["outputTokenLimit"],l);let u=s8(e,["supportedGenerationMethods"]);return null!=u&&s9(t,["supportedActions"],u),t}function aj(e){let t={},r=s8(e,["name"]);null!=r&&s9(t,["name"],r);let n=s8(e,["displayName"]);null!=n&&s9(t,["displayName"],n);let i=s8(e,["description"]);null!=i&&s9(t,["description"],i);let s=s8(e,["versionId"]);null!=s&&s9(t,["version"],s);let o=s8(e,["deployedModels"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["endpoint"]);null!=r&&s9(t,["name"],r);let n=s8(e,["deployedModelId"]);return null!=n&&s9(t,["deployedModelId"],n),t})(e))),s9(t,["endpoints"],e)}let a=s8(e,["labels"]);null!=a&&s9(t,["labels"],a);let l=s8(e,["_self"]);null!=l&&s9(t,["tunedModelInfo"],function(e){let t={},r=s8(e,["labels","google-vertex-llm-tuning-base-model-id"]);null!=r&&s9(t,["baseModel"],r);let n=s8(e,["createTime"]);null!=n&&s9(t,["createTime"],n);let i=s8(e,["updateTime"]);return null!=i&&s9(t,["updateTime"],i),t}(l));let u=s8(e,["defaultCheckpointId"]);null!=u&&s9(t,["defaultCheckpointId"],u);let c=s8(e,["checkpoints"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["checkpointId"]);null!=r&&s9(t,["checkpointId"],r);let n=s8(e,["epoch"]);null!=n&&s9(t,["epoch"],n);let i=s8(e,["step"]);return null!=i&&s9(t,["step"],i),t})(e))),s9(t,["checkpoints"],e)}return t}function aU(e){let t={},r=s8(e,["safetyAttributes","categories"]);null!=r&&s9(t,["categories"],r);let n=s8(e,["safetyAttributes","scores"]);null!=n&&s9(t,["scores"],n);let i=s8(e,["contentType"]);return null!=i&&s9(t,["contentType"],i),t}function aL(e){let t={},r=s8(e,["safetyAttributes","categories"]);null!=r&&s9(t,["categories"],r);let n=s8(e,["safetyAttributes","scores"]);null!=n&&s9(t,["scores"],n);let i=s8(e,["contentType"]);return null!=i&&s9(t,["contentType"],i),t}function aF(e){let t={},r=s8(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==s8(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let r=s8(e,["description"]);null!=r&&s9(t,["description"],r);let n=s8(e,["name"]);null!=n&&s9(t,["name"],n);let i=s8(e,["parameters"]);null!=i&&s9(t,["parameters"],i);let s=s8(e,["parametersJsonSchema"]);null!=s&&s9(t,["parametersJsonSchema"],s);let o=s8(e,["response"]);null!=o&&s9(t,["response"],o);let a=s8(e,["responseJsonSchema"]);return null!=a&&s9(t,["responseJsonSchema"],a),t})(e))),s9(t,["functionDeclarations"],e)}let n=s8(e,["retrieval"]);null!=n&&s9(t,["retrieval"],n);let i=s8(e,["googleSearch"]);null!=i&&s9(t,["googleSearch"],function(e){let t={},r=s8(e,["timeRangeFilter"]);null!=r&&s9(t,["timeRangeFilter"],function(e){let t={},r=s8(e,["startTime"]);null!=r&&s9(t,["startTime"],r);let n=s8(e,["endTime"]);return null!=n&&s9(t,["endTime"],n),t}(r));let n=s8(e,["excludeDomains"]);return null!=n&&s9(t,["excludeDomains"],n),t}(i));let s=s8(e,["googleSearchRetrieval"]);null!=s&&s9(t,["googleSearchRetrieval"],function(e){let t={},r=s8(e,["dynamicRetrievalConfig"]);return null!=r&&s9(t,["dynamicRetrievalConfig"],function(e){let t={},r=s8(e,["mode"]);null!=r&&s9(t,["mode"],r);let n=s8(e,["dynamicThreshold"]);return null!=n&&s9(t,["dynamicThreshold"],n),t}(r)),t}(s));let o=s8(e,["enterpriseWebSearch"]);null!=o&&s9(t,["enterpriseWebSearch"],function(e){let t={},r=s8(e,["excludeDomains"]);return null!=r&&s9(t,["excludeDomains"],r),t}(o));let a=s8(e,["googleMaps"]);null!=a&&s9(t,["googleMaps"],function(e){let t={},r=s8(e,["authConfig"]);return null!=r&&s9(t,["authConfig"],function(e){let t={},r=s8(e,["apiKeyConfig"]);null!=r&&s9(t,["apiKeyConfig"],function(e){let t={},r=s8(e,["apiKeyString"]);return null!=r&&s9(t,["apiKeyString"],r),t}(r));let n=s8(e,["authType"]);null!=n&&s9(t,["authType"],n);let i=s8(e,["googleServiceAccountConfig"]);null!=i&&s9(t,["googleServiceAccountConfig"],i);let s=s8(e,["httpBasicAuthConfig"]);null!=s&&s9(t,["httpBasicAuthConfig"],s);let o=s8(e,["oauthConfig"]);null!=o&&s9(t,["oauthConfig"],o);let a=s8(e,["oidcConfig"]);return null!=a&&s9(t,["oidcConfig"],a),t}(r)),t}(a)),null!=s8(e,["urlContext"])&&s9(t,["urlContext"],{});let l=s8(e,["computerUse"]);null!=l&&s9(t,["computerUse"],function(e){let t={},r=s8(e,["environment"]);null!=r&&s9(t,["environment"],r);let n=s8(e,["excludedPredefinedFunctions"]);return null!=n&&s9(t,["excludedPredefinedFunctions"],n),t}(l));let u=s8(e,["codeExecution"]);return null!=u&&s9(t,["codeExecution"],u),t}function aB(e){let t={},r=s8(e,["uri"]);null!=r&&s9(t,["gcsUri"],r);let n=s8(e,["videoBytes"]);null!=n&&s9(t,["bytesBase64Encoded"],s7(n));let i=s8(e,["mimeType"]);return null!=i&&s9(t,["mimeType"],i),t}function aq(e){let t={},r=s8(e,["prebuiltVoiceConfig"]);return null!=r&&s9(t,["prebuiltVoiceConfig"],function(e){let t={},r=s8(e,["voiceName"]);return null!=r&&s9(t,["voiceName"],r),t}(r)),t}let aG="x-goog-api-client",aH=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class a${constructor(e){var t,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});let n={};this.clientOptions.vertexai?(n.apiVersion=null!=(t=this.clientOptions.apiVersion)?t:"v1beta1",n.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(n.apiVersion=null!=(r=this.clientOptions.apiVersion)?r:"v1beta",n.baseUrl="https://generativelanguage.googleapis.com/"),n.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=n,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(n,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return null!=(e=this.clientOptions.vertexai)&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw Error("HTTP options are not correctly set.");let t=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&t.push(e.apiVersion),t.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let e=new URL(this.getBaseUrl());return e.protocol="http:"==e.protocol?"ws":"wss",e.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw Error("HTTP options are not correctly set.")}constructUrl(e,t,r){let n=[this.getRequestUrlInternal(t)];return r&&n.push(this.getBaseResourcePath()),""!==e&&n.push(e),new URL(`${n.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||"GET"===e.httpMethod&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let r=this.shouldPrependVertexProjectPath(e),n=this.constructUrl(e.path,t,r);if(e.queryParams)for(let[t,r]of Object.entries(e.queryParams))n.searchParams.append(t,String(r));let i={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,t,e.abortSignal),this.unaryApiCall(n,i,e.httpMethod)}patchHttpOptions(e,t){let r=JSON.parse(JSON.stringify(e));for(let[e,n]of Object.entries(t))"object"==typeof n?r[e]=Object.assign(Object.assign({},r[e]),n):void 0!==n&&(r[e]=n);return r}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let r=this.shouldPrependVertexProjectPath(e),n=this.constructUrl(e.path,t,r);n.searchParams.has("alt")&&"sse"===n.searchParams.get("alt")||n.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,t,e.abortSignal),this.streamApiCall(n,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,r){if(t&&t.timeout||r){let n=new AbortController,i=n.signal;if(t.timeout&&(null==t?void 0:t.timeout)>0){let e=setTimeout(()=>n.abort(),t.timeout);e&&"function"==typeof e.unref&&e.unref()}r&&r.addEventListener("abort",()=>{n.abort()}),e.signal=i}return t&&null!==t.extraBody&&function(e,t){if(!t||0===Object.keys(t).length)return;if(e.body instanceof Blob)return console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");let r={};if("string"==typeof e.body&&e.body.length>0)try{let t=JSON.parse(e.body);if("object"!=typeof t||null===t||Array.isArray(t))return void console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");r=t}catch(e){console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}e.body=JSON.stringify(function e(t,r){let n=Object.assign({},t);for(let t in r)if(Object.prototype.hasOwnProperty.call(r,t)){let i=r[t],s=n[t];i&&"object"==typeof i&&!Array.isArray(i)&&s&&"object"==typeof s&&!Array.isArray(s)?n[t]=e(s,i):(s&&i&&typeof s!=typeof i&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${t}". Original type: ${typeof s}, New type: ${typeof i}. Overwriting.`),n[t]=i)}return n}(r,t))}(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async e=>(await aV(e),new oe(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}async streamApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async e=>(await aV(e),this.processStreamResponse(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}processStreamResponse(e){var t;return ai(this,arguments,function*(){let r=null==(t=null==e?void 0:e.body)?void 0:t.getReader(),n=new TextDecoder("utf-8");if(!r)throw Error("Response body is empty");try{let t="";for(;;){let{done:i,value:s}=yield an(r.read());if(i){if(t.trim().length>0)throw Error("Incomplete JSON segment at the end");break}let o=n.decode(s,{stream:!0});try{let e=JSON.parse(o);if("error"in e){let t=JSON.parse(JSON.stringify(e.error)),r=t.status,n=t.code,i=`got status: ${r}. ${JSON.stringify(e)}`;if(n>=400&&n<600)throw new ac({message:i,status:n})}}catch(e){if("ApiError"===e.name)throw e}let a=(t+=o).match(aH);for(;a;){let r=a[1];try{let n=new Response(r,{headers:null==e?void 0:e.headers,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText});yield yield an(new oe(n)),a=(t=t.slice(a[0].length)).match(aH)}catch(e){throw Error(`exception parsing stream chunk ${r}. ${e}`)}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(e=>{throw Error(`exception ${e} sending request`)})}getDefaultHeaders(){let e={},t="google-genai-sdk/1.21.0 "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[aG]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e){let t=new Headers;if(e&&e.headers){for(let[r,n]of Object.entries(e.headers))t.append(r,n);e.timeout&&e.timeout>0&&t.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var r;let n={};null!=t&&(n.mimeType=t.mimeType,n.name=t.name,n.displayName=t.displayName),n.name&&!n.name.startsWith("files/")&&(n.name=`files/${n.name}`);let i=this.clientOptions.uploader,s=await i.stat(e);n.sizeBytes=String(s.size);let o=null!=(r=null==t?void 0:t.mimeType)?r:s.type;if(void 0===o||""===o)throw Error("Can not determine mimeType. Please provide mimeType in the config.");n.mimeType=o;let a=await this.fetchUploadUrl(n,t);return i.upload(e,a,this)}async downloadFile(e){let t=this.clientOptions.downloader;await t.download(e,this)}async fetchUploadUrl(e,t){var r;let n={};n=(null==t?void 0:t.httpOptions)?t.httpOptions:{apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};let i={file:e},s=await this.request({path:s6("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:n});if(!s||!(null==s?void 0:s.headers))throw Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let o=null==(r=null==s?void 0:s.headers)?void 0:r["x-goog-upload-url"];if(void 0===o)throw Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return o}}async function aV(e){var t;if(void 0===e)throw Error("response is undefined");if(!e.ok){let r=e.status,n=JSON.stringify((null==(t=e.headers.get("content-type"))?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}});if(r>=400&&r<600)throw new ac({message:n,status:r});throw Error(n)}}function aK(e){for(let r of e){var t;if(null!==(t=r)&&"object"==typeof t&&t instanceof aJ||"object"==typeof r&&"inputSchema"in r)return!0}return!1}function az(e){var t;let r=null!=(t=e[aG])?t:"";e[aG]=(r+" mcp_used/unknown").trimStart()}class aJ{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new aJ(e,t)}async initialize(){var e,t,r,n;if(this.mcpTools.length>0)return;let i={},s=[];for(let u of this.mcpClients)try{for(var o,a=!0,l=(t=void 0,as(function(e,t=100){return ai(this,arguments,function*(){let r,n=0;for(;n<t;){let t=yield an(e.listTools({cursor:r}));for(let e of t.tools)yield yield an(e),n++;if(!t.nextCursor)break;r=t.nextCursor}})}(u)));!(e=(o=await l.next()).done);a=!0){n=o.value,a=!1,s.push(n);let e=n.name;if(i[e])throw Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);i[e]=u}}catch(e){t={error:e}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(t)throw t.error}}this.mcpTools=s,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),function(e,t={}){let r=[],n=new Set;for(let i of e){let e=i.name;if(n.has(e))throw Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);n.add(e);let s=function(e,t={}){let r={name:e.name,description:e.description,parametersJsonSchema:e.inputSchema};return e.outputSchema&&(r.responseJsonSchema=e.outputSchema),t.behavior&&(r.behavior=t.behavior),{functionDeclarations:[r]}}(i,t);s.functionDeclarations&&r.push(...s.functionDeclarations)}return{functionDeclarations:r}}(this.mcpTools,this.config)}async callTool(e){await this.initialize();let t=[];for(let r of e)if(r.name in this.functionNameToMcpClient){let e,n=this.functionNameToMcpClient[r.name];this.config.timeout&&(e={timeout:this.config.timeout});let i=await n.callTool({name:r.name,arguments:r.args},void 0,e);t.push({functionResponse:{name:r.name,response:i.isError?{error:i}:i}})}return t}}async function aW(e,t,r){let n=new oE;Object.assign(n,function(e){let t={};null!=s8(e,["setupComplete"])&&s9(t,["setupComplete"],{});let r=s8(e,["serverContent"]);null!=r&&s9(t,["serverContent"],function(e){let t={},r=s8(e,["audioChunks"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["data"]);null!=r&&s9(t,["data"],r);let n=s8(e,["mimeType"]);null!=n&&s9(t,["mimeType"],n);let i=s8(e,["sourceMetadata"]);return null!=i&&s9(t,["sourceMetadata"],function(e){let t={},r=s8(e,["clientContent"]);null!=r&&s9(t,["clientContent"],function(e){let t={},r=s8(e,["weightedPrompts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["text"]);null!=r&&s9(t,["text"],r);let n=s8(e,["weight"]);return null!=n&&s9(t,["weight"],n),t})(e))),s9(t,["weightedPrompts"],e)}return t}(r));let n=s8(e,["musicGenerationConfig"]);return null!=n&&s9(t,["musicGenerationConfig"],function(e){let t={},r=s8(e,["temperature"]);null!=r&&s9(t,["temperature"],r);let n=s8(e,["topK"]);null!=n&&s9(t,["topK"],n);let i=s8(e,["seed"]);null!=i&&s9(t,["seed"],i);let s=s8(e,["guidance"]);null!=s&&s9(t,["guidance"],s);let o=s8(e,["bpm"]);null!=o&&s9(t,["bpm"],o);let a=s8(e,["density"]);null!=a&&s9(t,["density"],a);let l=s8(e,["brightness"]);null!=l&&s9(t,["brightness"],l);let u=s8(e,["scale"]);null!=u&&s9(t,["scale"],u);let c=s8(e,["muteBass"]);null!=c&&s9(t,["muteBass"],c);let d=s8(e,["muteDrums"]);null!=d&&s9(t,["muteDrums"],d);let h=s8(e,["onlyBassAndDrums"]);null!=h&&s9(t,["onlyBassAndDrums"],h);let p=s8(e,["musicGenerationMode"]);return null!=p&&s9(t,["musicGenerationMode"],p),t}(n)),t}(i)),t})(e))),s9(t,["audioChunks"],e)}return t}(r));let n=s8(e,["filteredPrompt"]);return null!=n&&s9(t,["filteredPrompt"],function(e){let t={},r=s8(e,["text"]);null!=r&&s9(t,["text"],r);let n=s8(e,["filteredReason"]);return null!=n&&s9(t,["filteredReason"],n),t}(n)),t}(r.data instanceof Blob?JSON.parse(await r.data.text()):JSON.parse(r.data))),t(n)}class aY{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r}async connect(e){var t,r;if(this.apiClient.isVertexAI())throw Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let n=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),s=function(e){let t=new Headers;for(let[r,n]of Object.entries(e))t.append(r,n);return t}(this.apiClient.getDefaultHeaders()),o=this.apiClient.getApiKey(),a=`${n}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateMusic?key=${o}`,l=()=>{},u=new Promise(e=>{l=e}),c=e.callbacks,d=this.apiClient,h={onopen:function(){l({})},onmessage:e=>{aW(d,c.onmessage,e)},onerror:null!=(t=null==c?void 0:c.onerror)?t:function(e){},onclose:null!=(r=null==c?void 0:c.onclose)?r:function(e){}},p=this.webSocketFactory.create(a,function(e){let t={};return e.forEach((e,r)=>{t[r]=e}),t}(s),h);p.connect(),await u;let f=am({setup:ay({model:oS(this.apiClient,e.model)})});return p.send(JSON.stringify(f)),new aZ(p,this.apiClient)}}class aZ{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw Error("Weighted prompts must be set and contain at least one entry.");let t=ag(function(e){let t={},r=s8(e,["weightedPrompts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>aT(e))),s9(t,["weightedPrompts"],e)}return t}(e));this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});let t=am(function(e){let t={},r=s8(e,["musicGenerationConfig"]);return null!=r&&s9(t,["musicGenerationConfig"],av(r)),t}(e));this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){let t=am({playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(ei.PLAY)}pause(){this.sendPlaybackControl(ei.PAUSE)}stop(){this.sendPlaybackControl(ei.STOP)}resetContext(){this.sendPlaybackControl(ei.RESET_CONTEXT)}close(){this.conn.close()}}async function aX(e,t,r){let n=new ob,i=JSON.parse(r.data instanceof Blob?await r.data.text():r.data instanceof ArrayBuffer?new TextDecoder().decode(r.data):r.data);e.isVertexAI()?Object.assign(n,function(e){let t={},r=s8(e,["setupComplete"]);null!=r&&s9(t,["setupComplete"],function(e){let t={},r=s8(e,["sessionId"]);return null!=r&&s9(t,["sessionId"],r),t}(r));let n=s8(e,["serverContent"]);null!=n&&s9(t,["serverContent"],function(e){let t={},r=s8(e,["modelTurn"]);null!=r&&s9(t,["modelTurn"],function(e){let t={},r=s8(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["videoMetadata"]);null!=r&&s9(t,["videoMetadata"],function(e){let t={},r=s8(e,["fps"]);null!=r&&s9(t,["fps"],r);let n=s8(e,["endOffset"]);null!=n&&s9(t,["endOffset"],n);let i=s8(e,["startOffset"]);return null!=i&&s9(t,["startOffset"],i),t}(r));let n=s8(e,["thought"]);null!=n&&s9(t,["thought"],n);let i=s8(e,["inlineData"]);null!=i&&s9(t,["inlineData"],function(e){let t={},r=s8(e,["displayName"]);null!=r&&s9(t,["displayName"],r);let n=s8(e,["data"]);null!=n&&s9(t,["data"],n);let i=s8(e,["mimeType"]);return null!=i&&s9(t,["mimeType"],i),t}(i));let s=s8(e,["fileData"]);null!=s&&s9(t,["fileData"],function(e){let t={},r=s8(e,["displayName"]);null!=r&&s9(t,["displayName"],r);let n=s8(e,["fileUri"]);null!=n&&s9(t,["fileUri"],n);let i=s8(e,["mimeType"]);return null!=i&&s9(t,["mimeType"],i),t}(s));let o=s8(e,["thoughtSignature"]);null!=o&&s9(t,["thoughtSignature"],o);let a=s8(e,["functionCall"]);null!=a&&s9(t,["functionCall"],af(a));let l=s8(e,["codeExecutionResult"]);null!=l&&s9(t,["codeExecutionResult"],l);let u=s8(e,["executableCode"]);null!=u&&s9(t,["executableCode"],u);let c=s8(e,["functionResponse"]);null!=c&&s9(t,["functionResponse"],c);let d=s8(e,["text"]);return null!=d&&s9(t,["text"],d),t})(e))),s9(t,["parts"],e)}let n=s8(e,["role"]);return null!=n&&s9(t,["role"],n),t}(r));let n=s8(e,["turnComplete"]);null!=n&&s9(t,["turnComplete"],n);let i=s8(e,["interrupted"]);null!=i&&s9(t,["interrupted"],i);let s=s8(e,["groundingMetadata"]);null!=s&&s9(t,["groundingMetadata"],s);let o=s8(e,["generationComplete"]);null!=o&&s9(t,["generationComplete"],o);let a=s8(e,["inputTranscription"]);null!=a&&s9(t,["inputTranscription"],aS(a));let l=s8(e,["outputTranscription"]);null!=l&&s9(t,["outputTranscription"],aS(l));let u=s8(e,["turnCompleteReason"]);null!=u&&s9(t,["turnCompleteReason"],u);let c=s8(e,["waitingForInput"]);return null!=c&&s9(t,["waitingForInput"],c),t}(n));let i=s8(e,["toolCall"]);null!=i&&s9(t,["toolCall"],function(e){let t={},r=s8(e,["functionCalls"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>af(e))),s9(t,["functionCalls"],e)}return t}(i));let s=s8(e,["toolCallCancellation"]);null!=s&&s9(t,["toolCallCancellation"],function(e){let t={},r=s8(e,["ids"]);return null!=r&&s9(t,["ids"],r),t}(s));let o=s8(e,["usageMetadata"]);null!=o&&s9(t,["usageMetadata"],function(e){let t={},r=s8(e,["promptTokenCount"]);null!=r&&s9(t,["promptTokenCount"],r);let n=s8(e,["cachedContentTokenCount"]);null!=n&&s9(t,["cachedContentTokenCount"],n);let i=s8(e,["candidatesTokenCount"]);null!=i&&s9(t,["responseTokenCount"],i);let s=s8(e,["toolUsePromptTokenCount"]);null!=s&&s9(t,["toolUsePromptTokenCount"],s);let o=s8(e,["thoughtsTokenCount"]);null!=o&&s9(t,["thoughtsTokenCount"],o);let a=s8(e,["totalTokenCount"]);null!=a&&s9(t,["totalTokenCount"],a);let l=s8(e,["promptTokensDetails"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>ab(e))),s9(t,["promptTokensDetails"],e)}let u=s8(e,["cacheTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>ab(e))),s9(t,["cacheTokensDetails"],e)}let c=s8(e,["candidatesTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>ab(e))),s9(t,["responseTokensDetails"],e)}let d=s8(e,["toolUsePromptTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>ab(e))),s9(t,["toolUsePromptTokensDetails"],e)}let h=s8(e,["trafficType"]);return null!=h&&s9(t,["trafficType"],h),t}(o));let a=s8(e,["goAway"]);null!=a&&s9(t,["goAway"],function(e){let t={},r=s8(e,["timeLeft"]);return null!=r&&s9(t,["timeLeft"],r),t}(a));let l=s8(e,["sessionResumptionUpdate"]);return null!=l&&s9(t,["sessionResumptionUpdate"],function(e){let t={},r=s8(e,["newHandle"]);null!=r&&s9(t,["newHandle"],r);let n=s8(e,["resumable"]);null!=n&&s9(t,["resumable"],n);let i=s8(e,["lastConsumedClientMessageIndex"]);return null!=i&&s9(t,["lastConsumedClientMessageIndex"],i),t}(l)),t}(i)):Object.assign(n,function(e){let t={};null!=s8(e,["setupComplete"])&&s9(t,["setupComplete"],{});let r=s8(e,["serverContent"]);null!=r&&s9(t,["serverContent"],function(e){let t={},r=s8(e,["modelTurn"]);null!=r&&s9(t,["modelTurn"],function(e){let t={},r=s8(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["videoMetadata"]);null!=r&&s9(t,["videoMetadata"],function(e){let t={},r=s8(e,["fps"]);null!=r&&s9(t,["fps"],r);let n=s8(e,["endOffset"]);null!=n&&s9(t,["endOffset"],n);let i=s8(e,["startOffset"]);return null!=i&&s9(t,["startOffset"],i),t}(r));let n=s8(e,["thought"]);null!=n&&s9(t,["thought"],n);let i=s8(e,["inlineData"]);null!=i&&s9(t,["inlineData"],function(e){let t={},r=s8(e,["data"]);null!=r&&s9(t,["data"],r);let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(i));let s=s8(e,["fileData"]);null!=s&&s9(t,["fileData"],function(e){let t={},r=s8(e,["fileUri"]);null!=r&&s9(t,["fileUri"],r);let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(s));let o=s8(e,["thoughtSignature"]);null!=o&&s9(t,["thoughtSignature"],o);let a=s8(e,["functionCall"]);null!=a&&s9(t,["functionCall"],ap(a));let l=s8(e,["codeExecutionResult"]);null!=l&&s9(t,["codeExecutionResult"],l);let u=s8(e,["executableCode"]);null!=u&&s9(t,["executableCode"],u);let c=s8(e,["functionResponse"]);null!=c&&s9(t,["functionResponse"],c);let d=s8(e,["text"]);return null!=d&&s9(t,["text"],d),t})(e))),s9(t,["parts"],e)}let n=s8(e,["role"]);return null!=n&&s9(t,["role"],n),t}(r));let n=s8(e,["turnComplete"]);null!=n&&s9(t,["turnComplete"],n);let i=s8(e,["interrupted"]);null!=i&&s9(t,["interrupted"],i);let s=s8(e,["groundingMetadata"]);null!=s&&s9(t,["groundingMetadata"],s);let o=s8(e,["generationComplete"]);null!=o&&s9(t,["generationComplete"],o);let a=s8(e,["inputTranscription"]);null!=a&&s9(t,["inputTranscription"],aE(a));let l=s8(e,["outputTranscription"]);null!=l&&s9(t,["outputTranscription"],aE(l));let u=s8(e,["urlContextMetadata"]);null!=u&&s9(t,["urlContextMetadata"],function(e){let t={},r=s8(e,["urlMetadata"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["retrievedUrl"]);null!=r&&s9(t,["retrievedUrl"],r);let n=s8(e,["urlRetrievalStatus"]);return null!=n&&s9(t,["urlRetrievalStatus"],n),t})(e))),s9(t,["urlMetadata"],e)}return t}(u));let c=s8(e,["turnCompleteReason"]);null!=c&&s9(t,["turnCompleteReason"],c);let d=s8(e,["waitingForInput"]);return null!=d&&s9(t,["waitingForInput"],d),t}(r));let n=s8(e,["toolCall"]);null!=n&&s9(t,["toolCall"],function(e){let t={},r=s8(e,["functionCalls"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>ap(e))),s9(t,["functionCalls"],e)}return t}(n));let i=s8(e,["toolCallCancellation"]);null!=i&&s9(t,["toolCallCancellation"],function(e){let t={},r=s8(e,["ids"]);return null!=r&&s9(t,["ids"],r),t}(i));let s=s8(e,["usageMetadata"]);null!=s&&s9(t,["usageMetadata"],function(e){let t={},r=s8(e,["promptTokenCount"]);null!=r&&s9(t,["promptTokenCount"],r);let n=s8(e,["cachedContentTokenCount"]);null!=n&&s9(t,["cachedContentTokenCount"],n);let i=s8(e,["responseTokenCount"]);null!=i&&s9(t,["responseTokenCount"],i);let s=s8(e,["toolUsePromptTokenCount"]);null!=s&&s9(t,["toolUsePromptTokenCount"],s);let o=s8(e,["thoughtsTokenCount"]);null!=o&&s9(t,["thoughtsTokenCount"],o);let a=s8(e,["totalTokenCount"]);null!=a&&s9(t,["totalTokenCount"],a);let l=s8(e,["promptTokensDetails"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>a_(e))),s9(t,["promptTokensDetails"],e)}let u=s8(e,["cacheTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>a_(e))),s9(t,["cacheTokensDetails"],e)}let c=s8(e,["responseTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>a_(e))),s9(t,["responseTokensDetails"],e)}let d=s8(e,["toolUsePromptTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>a_(e))),s9(t,["toolUsePromptTokensDetails"],e)}return t}(s));let o=s8(e,["goAway"]);null!=o&&s9(t,["goAway"],function(e){let t={},r=s8(e,["timeLeft"]);return null!=r&&s9(t,["timeLeft"],r),t}(o));let a=s8(e,["sessionResumptionUpdate"]);return null!=a&&s9(t,["sessionResumptionUpdate"],function(e){let t={},r=s8(e,["newHandle"]);null!=r&&s9(t,["newHandle"],r);let n=s8(e,["resumable"]);null!=n&&s9(t,["resumable"],n);let i=s8(e,["lastConsumedClientMessageIndex"]);return null!=i&&s9(t,["lastConsumedClientMessageIndex"],i),t}(a)),t}(i)),t(n)}class aQ{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r,this.music=new aY(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,r,n,i,s,o;let a;if(e.config&&e.config.httpOptions)throw Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");let l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion(),c=this.apiClient.getHeaders();e.config&&e.config.tools&&aK(e.config.tools)&&az(c);let d=function(e){let t=new Headers;for(let[r,n]of Object.entries(e))t.append(r,n);return t}(c);if(this.apiClient.isVertexAI())a=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(d);else{let e=this.apiClient.getApiKey(),t="BidiGenerateContent",r="key";(null==e?void 0:e.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==u&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),t="BidiGenerateContentConstrained",r="access_token"),a=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${t}?${r}=${e}`}let h=()=>{},p=new Promise(e=>{h=e}),f=e.callbacks,g=this.apiClient,m={onopen:function(){var e;null==(e=null==f?void 0:f.onopen)||e.call(f),h({})},onmessage:e=>{aX(g,f.onmessage,e)},onerror:null!=(t=null==f?void 0:f.onerror)?t:function(e){},onclose:null!=(r=null==f?void 0:f.onclose)?r:function(e){}},y=this.webSocketFactory.create(a,function(e){let t={};return e.forEach((e,r)=>{t[r]=e}),t}(d),m);y.connect(),await p;let v=oS(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&v.startsWith("publishers/")){let e=this.apiClient.getProject(),t=this.apiClient.getLocation();v=`projects/${e}/locations/${t}/`+v}let _={};this.apiClient.isVertexAI()&&(null==(n=e.config)?void 0:n.responseModalities)===void 0&&(void 0===e.config?e.config={responseModalities:[A.AUDIO]}:e.config.responseModalities=[A.AUDIO]),(null==(i=e.config)?void 0:i.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let b=null!=(o=null==(s=e.config)?void 0:s.tools)?o:[],E=[];for(let e of b)this.isCallableTool(e)?E.push(await e.tool()):E.push(e);E.length>0&&(e.config.tools=E);let S={model:v,config:e.config,callbacks:e.callbacks};return _=this.apiClient.isVertexAI()?function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["setup","model"],oS(e,n));let i=s8(t,["config"]);return null!=i&&s9(r,["config"],function(e,t){let r=s8(e,["generationConfig"]);void 0!==t&&null!=r&&s9(t,["setup","generationConfig"],r);let n=s8(e,["responseModalities"]);void 0!==t&&null!=n&&s9(t,["setup","generationConfig","responseModalities"],n);let i=s8(e,["temperature"]);void 0!==t&&null!=i&&s9(t,["setup","generationConfig","temperature"],i);let s=s8(e,["topP"]);void 0!==t&&null!=s&&s9(t,["setup","generationConfig","topP"],s);let o=s8(e,["topK"]);void 0!==t&&null!=o&&s9(t,["setup","generationConfig","topK"],o);let a=s8(e,["maxOutputTokens"]);void 0!==t&&null!=a&&s9(t,["setup","generationConfig","maxOutputTokens"],a);let l=s8(e,["mediaResolution"]);void 0!==t&&null!=l&&s9(t,["setup","generationConfig","mediaResolution"],l);let u=s8(e,["seed"]);void 0!==t&&null!=u&&s9(t,["setup","generationConfig","seed"],u);let c=s8(e,["speechConfig"]);void 0!==t&&null!=c&&s9(t,["setup","generationConfig","speechConfig"],function(e){let t={},r=s8(e,["voiceConfig"]);if(null!=r&&s9(t,["voiceConfig"],function(e){let t={},r=s8(e,["prebuiltVoiceConfig"]);return null!=r&&s9(t,["prebuiltVoiceConfig"],function(e){let t={},r=s8(e,["voiceName"]);return null!=r&&s9(t,["voiceName"],r),t}(r)),t}(r)),void 0!==s8(e,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");let n=s8(e,["languageCode"]);return null!=n&&s9(t,["languageCode"],n),t}(oL(c)));let d=s8(e,["enableAffectiveDialog"]);void 0!==t&&null!=d&&s9(t,["setup","generationConfig","enableAffectiveDialog"],d);let h=s8(e,["systemInstruction"]);void 0!==t&&null!=h&&s9(t,["setup","systemInstruction"],function(e){let t={},r=s8(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["videoMetadata"]);null!=r&&s9(t,["videoMetadata"],function(e){let t={},r=s8(e,["fps"]);null!=r&&s9(t,["fps"],r);let n=s8(e,["endOffset"]);null!=n&&s9(t,["endOffset"],n);let i=s8(e,["startOffset"]);return null!=i&&s9(t,["startOffset"],i),t}(r));let n=s8(e,["thought"]);null!=n&&s9(t,["thought"],n);let i=s8(e,["inlineData"]);null!=i&&s9(t,["inlineData"],function(e){let t={},r=s8(e,["displayName"]);null!=r&&s9(t,["displayName"],r);let n=s8(e,["data"]);null!=n&&s9(t,["data"],n);let i=s8(e,["mimeType"]);return null!=i&&s9(t,["mimeType"],i),t}(i));let s=s8(e,["fileData"]);null!=s&&s9(t,["fileData"],function(e){let t={},r=s8(e,["displayName"]);null!=r&&s9(t,["displayName"],r);let n=s8(e,["fileUri"]);null!=n&&s9(t,["fileUri"],n);let i=s8(e,["mimeType"]);return null!=i&&s9(t,["mimeType"],i),t}(s));let o=s8(e,["thoughtSignature"]);null!=o&&s9(t,["thoughtSignature"],o);let a=s8(e,["functionCall"]);null!=a&&s9(t,["functionCall"],function(e){let t={},r=s8(e,["id"]);null!=r&&s9(t,["id"],r);let n=s8(e,["args"]);null!=n&&s9(t,["args"],n);let i=s8(e,["name"]);return null!=i&&s9(t,["name"],i),t}(a));let l=s8(e,["codeExecutionResult"]);null!=l&&s9(t,["codeExecutionResult"],l);let u=s8(e,["executableCode"]);null!=u&&s9(t,["executableCode"],u);let c=s8(e,["functionResponse"]);null!=c&&s9(t,["functionResponse"],c);let d=s8(e,["text"]);return null!=d&&s9(t,["text"],d),t})(e))),s9(t,["parts"],e)}let n=s8(e,["role"]);return null!=n&&s9(t,["role"],n),t}(oN(h)));let p=s8(e,["tools"]);if(void 0!==t&&null!=p){let e=oB(p);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==s8(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let r=s8(e,["description"]);null!=r&&s9(t,["description"],r);let n=s8(e,["name"]);null!=n&&s9(t,["name"],n);let i=s8(e,["parameters"]);null!=i&&s9(t,["parameters"],i);let s=s8(e,["parametersJsonSchema"]);null!=s&&s9(t,["parametersJsonSchema"],s);let o=s8(e,["response"]);null!=o&&s9(t,["response"],o);let a=s8(e,["responseJsonSchema"]);return null!=a&&s9(t,["responseJsonSchema"],a),t})(e))),s9(t,["functionDeclarations"],e)}let n=s8(e,["retrieval"]);null!=n&&s9(t,["retrieval"],n);let i=s8(e,["googleSearch"]);null!=i&&s9(t,["googleSearch"],function(e){let t={},r=s8(e,["timeRangeFilter"]);null!=r&&s9(t,["timeRangeFilter"],function(e){let t={},r=s8(e,["startTime"]);null!=r&&s9(t,["startTime"],r);let n=s8(e,["endTime"]);return null!=n&&s9(t,["endTime"],n),t}(r));let n=s8(e,["excludeDomains"]);return null!=n&&s9(t,["excludeDomains"],n),t}(i));let s=s8(e,["googleSearchRetrieval"]);null!=s&&s9(t,["googleSearchRetrieval"],function(e){let t={},r=s8(e,["dynamicRetrievalConfig"]);return null!=r&&s9(t,["dynamicRetrievalConfig"],function(e){let t={},r=s8(e,["mode"]);null!=r&&s9(t,["mode"],r);let n=s8(e,["dynamicThreshold"]);return null!=n&&s9(t,["dynamicThreshold"],n),t}(r)),t}(s));let o=s8(e,["enterpriseWebSearch"]);null!=o&&s9(t,["enterpriseWebSearch"],function(e){let t={},r=s8(e,["excludeDomains"]);return null!=r&&s9(t,["excludeDomains"],r),t}(o));let a=s8(e,["googleMaps"]);null!=a&&s9(t,["googleMaps"],function(e){let t={},r=s8(e,["authConfig"]);return null!=r&&s9(t,["authConfig"],function(e){let t={},r=s8(e,["apiKeyConfig"]);null!=r&&s9(t,["apiKeyConfig"],function(e){let t={},r=s8(e,["apiKeyString"]);return null!=r&&s9(t,["apiKeyString"],r),t}(r));let n=s8(e,["authType"]);null!=n&&s9(t,["authType"],n);let i=s8(e,["googleServiceAccountConfig"]);null!=i&&s9(t,["googleServiceAccountConfig"],i);let s=s8(e,["httpBasicAuthConfig"]);null!=s&&s9(t,["httpBasicAuthConfig"],s);let o=s8(e,["oauthConfig"]);null!=o&&s9(t,["oauthConfig"],o);let a=s8(e,["oidcConfig"]);return null!=a&&s9(t,["oidcConfig"],a),t}(r)),t}(a)),null!=s8(e,["urlContext"])&&s9(t,["urlContext"],{});let l=s8(e,["computerUse"]);null!=l&&s9(t,["computerUse"],function(e){let t={},r=s8(e,["environment"]);null!=r&&s9(t,["environment"],r);let n=s8(e,["excludedPredefinedFunctions"]);return null!=n&&s9(t,["excludedPredefinedFunctions"],n),t}(l));let u=s8(e,["codeExecution"]);return null!=u&&s9(t,["codeExecution"],u),t})(oF(e)))),s9(t,["setup","tools"],e)}let f=s8(e,["sessionResumption"]);void 0!==t&&null!=f&&s9(t,["setup","sessionResumption"],function(e){let t={},r=s8(e,["handle"]);null!=r&&s9(t,["handle"],r);let n=s8(e,["transparent"]);return null!=n&&s9(t,["transparent"],n),t}(f));let g=s8(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&s9(t,["setup","inputAudioTranscription"],{});let m=s8(e,["outputAudioTranscription"]);void 0!==t&&null!=m&&s9(t,["setup","outputAudioTranscription"],{});let y=s8(e,["realtimeInputConfig"]);void 0!==t&&null!=y&&s9(t,["setup","realtimeInputConfig"],function(e){let t={},r=s8(e,["automaticActivityDetection"]);null!=r&&s9(t,["automaticActivityDetection"],function(e){let t={},r=s8(e,["disabled"]);null!=r&&s9(t,["disabled"],r);let n=s8(e,["startOfSpeechSensitivity"]);null!=n&&s9(t,["startOfSpeechSensitivity"],n);let i=s8(e,["endOfSpeechSensitivity"]);null!=i&&s9(t,["endOfSpeechSensitivity"],i);let s=s8(e,["prefixPaddingMs"]);null!=s&&s9(t,["prefixPaddingMs"],s);let o=s8(e,["silenceDurationMs"]);return null!=o&&s9(t,["silenceDurationMs"],o),t}(r));let n=s8(e,["activityHandling"]);null!=n&&s9(t,["activityHandling"],n);let i=s8(e,["turnCoverage"]);return null!=i&&s9(t,["turnCoverage"],i),t}(y));let v=s8(e,["contextWindowCompression"]);void 0!==t&&null!=v&&s9(t,["setup","contextWindowCompression"],function(e){let t={},r=s8(e,["triggerTokens"]);null!=r&&s9(t,["triggerTokens"],r);let n=s8(e,["slidingWindow"]);return null!=n&&s9(t,["slidingWindow"],function(e){let t={},r=s8(e,["targetTokens"]);return null!=r&&s9(t,["targetTokens"],r),t}(n)),t}(v));let _=s8(e,["proactivity"]);return void 0!==t&&null!=_&&s9(t,["setup","proactivity"],function(e){let t={},r=s8(e,["proactiveAudio"]);return null!=r&&s9(t,["proactiveAudio"],r),t}(_)),{}}(i,r)),r}(this.apiClient,S):function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["setup","model"],oS(e,n));let i=s8(t,["config"]);return null!=i&&s9(r,["config"],function(e,t){let r=s8(e,["generationConfig"]);void 0!==t&&null!=r&&s9(t,["setup","generationConfig"],r);let n=s8(e,["responseModalities"]);void 0!==t&&null!=n&&s9(t,["setup","generationConfig","responseModalities"],n);let i=s8(e,["temperature"]);void 0!==t&&null!=i&&s9(t,["setup","generationConfig","temperature"],i);let s=s8(e,["topP"]);void 0!==t&&null!=s&&s9(t,["setup","generationConfig","topP"],s);let o=s8(e,["topK"]);void 0!==t&&null!=o&&s9(t,["setup","generationConfig","topK"],o);let a=s8(e,["maxOutputTokens"]);void 0!==t&&null!=a&&s9(t,["setup","generationConfig","maxOutputTokens"],a);let l=s8(e,["mediaResolution"]);void 0!==t&&null!=l&&s9(t,["setup","generationConfig","mediaResolution"],l);let u=s8(e,["seed"]);void 0!==t&&null!=u&&s9(t,["setup","generationConfig","seed"],u);let c=s8(e,["speechConfig"]);void 0!==t&&null!=c&&s9(t,["setup","generationConfig","speechConfig"],function(e){let t={},r=s8(e,["voiceConfig"]);null!=r&&s9(t,["voiceConfig"],aw(r));let n=s8(e,["multiSpeakerVoiceConfig"]);null!=n&&s9(t,["multiSpeakerVoiceConfig"],function(e){let t={},r=s8(e,["speakerVoiceConfigs"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["speaker"]);null!=r&&s9(t,["speaker"],r);let n=s8(e,["voiceConfig"]);return null!=n&&s9(t,["voiceConfig"],aw(n)),t})(e))),s9(t,["speakerVoiceConfigs"],e)}return t}(n));let i=s8(e,["languageCode"]);return null!=i&&s9(t,["languageCode"],i),t}(oL(c)));let d=s8(e,["enableAffectiveDialog"]);void 0!==t&&null!=d&&s9(t,["setup","generationConfig","enableAffectiveDialog"],d);let h=s8(e,["systemInstruction"]);void 0!==t&&null!=h&&s9(t,["setup","systemInstruction"],function(e){let t={},r=s8(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["videoMetadata"]);null!=r&&s9(t,["videoMetadata"],function(e){let t={},r=s8(e,["fps"]);null!=r&&s9(t,["fps"],r);let n=s8(e,["endOffset"]);null!=n&&s9(t,["endOffset"],n);let i=s8(e,["startOffset"]);return null!=i&&s9(t,["startOffset"],i),t}(r));let n=s8(e,["thought"]);null!=n&&s9(t,["thought"],n);let i=s8(e,["inlineData"]);null!=i&&s9(t,["inlineData"],function(e){let t={};if(void 0!==s8(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=s8(e,["data"]);null!=r&&s9(t,["data"],r);let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(i));let s=s8(e,["fileData"]);null!=s&&s9(t,["fileData"],function(e){let t={};if(void 0!==s8(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=s8(e,["fileUri"]);null!=r&&s9(t,["fileUri"],r);let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(s));let o=s8(e,["thoughtSignature"]);null!=o&&s9(t,["thoughtSignature"],o);let a=s8(e,["functionCall"]);null!=a&&s9(t,["functionCall"],function(e){let t={},r=s8(e,["id"]);null!=r&&s9(t,["id"],r);let n=s8(e,["args"]);null!=n&&s9(t,["args"],n);let i=s8(e,["name"]);return null!=i&&s9(t,["name"],i),t}(a));let l=s8(e,["codeExecutionResult"]);null!=l&&s9(t,["codeExecutionResult"],l);let u=s8(e,["executableCode"]);null!=u&&s9(t,["executableCode"],u);let c=s8(e,["functionResponse"]);null!=c&&s9(t,["functionResponse"],c);let d=s8(e,["text"]);return null!=d&&s9(t,["text"],d),t})(e))),s9(t,["parts"],e)}let n=s8(e,["role"]);return null!=n&&s9(t,["role"],n),t}(oN(h)));let p=s8(e,["tools"]);if(void 0!==t&&null!=p){let e=oB(p);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["behavior"]);null!=r&&s9(t,["behavior"],r);let n=s8(e,["description"]);null!=n&&s9(t,["description"],n);let i=s8(e,["name"]);null!=i&&s9(t,["name"],i);let s=s8(e,["parameters"]);null!=s&&s9(t,["parameters"],s);let o=s8(e,["parametersJsonSchema"]);null!=o&&s9(t,["parametersJsonSchema"],o);let a=s8(e,["response"]);null!=a&&s9(t,["response"],a);let l=s8(e,["responseJsonSchema"]);return null!=l&&s9(t,["responseJsonSchema"],l),t})(e))),s9(t,["functionDeclarations"],e)}if(void 0!==s8(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let n=s8(e,["googleSearch"]);null!=n&&s9(t,["googleSearch"],function(e){let t={},r=s8(e,["timeRangeFilter"]);if(null!=r&&s9(t,["timeRangeFilter"],function(e){let t={},r=s8(e,["startTime"]);null!=r&&s9(t,["startTime"],r);let n=s8(e,["endTime"]);return null!=n&&s9(t,["endTime"],n),t}(r)),void 0!==s8(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return t}(n));let i=s8(e,["googleSearchRetrieval"]);if(null!=i&&s9(t,["googleSearchRetrieval"],function(e){let t={},r=s8(e,["dynamicRetrievalConfig"]);return null!=r&&s9(t,["dynamicRetrievalConfig"],function(e){let t={},r=s8(e,["mode"]);null!=r&&s9(t,["mode"],r);let n=s8(e,["dynamicThreshold"]);return null!=n&&s9(t,["dynamicThreshold"],n),t}(r)),t}(i)),void 0!==s8(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==s8(e,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");null!=s8(e,["urlContext"])&&s9(t,["urlContext"],{});let s=s8(e,["computerUse"]);null!=s&&s9(t,["computerUse"],function(e){let t={},r=s8(e,["environment"]);null!=r&&s9(t,["environment"],r);let n=s8(e,["excludedPredefinedFunctions"]);return null!=n&&s9(t,["excludedPredefinedFunctions"],n),t}(s));let o=s8(e,["codeExecution"]);return null!=o&&s9(t,["codeExecution"],o),t})(oF(e)))),s9(t,["setup","tools"],e)}let f=s8(e,["sessionResumption"]);void 0!==t&&null!=f&&s9(t,["setup","sessionResumption"],function(e){let t={},r=s8(e,["handle"]);if(null!=r&&s9(t,["handle"],r),void 0!==s8(e,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return t}(f));let g=s8(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&s9(t,["setup","inputAudioTranscription"],{});let m=s8(e,["outputAudioTranscription"]);void 0!==t&&null!=m&&s9(t,["setup","outputAudioTranscription"],{});let y=s8(e,["realtimeInputConfig"]);void 0!==t&&null!=y&&s9(t,["setup","realtimeInputConfig"],function(e){let t={},r=s8(e,["automaticActivityDetection"]);null!=r&&s9(t,["automaticActivityDetection"],function(e){let t={},r=s8(e,["disabled"]);null!=r&&s9(t,["disabled"],r);let n=s8(e,["startOfSpeechSensitivity"]);null!=n&&s9(t,["startOfSpeechSensitivity"],n);let i=s8(e,["endOfSpeechSensitivity"]);null!=i&&s9(t,["endOfSpeechSensitivity"],i);let s=s8(e,["prefixPaddingMs"]);null!=s&&s9(t,["prefixPaddingMs"],s);let o=s8(e,["silenceDurationMs"]);return null!=o&&s9(t,["silenceDurationMs"],o),t}(r));let n=s8(e,["activityHandling"]);null!=n&&s9(t,["activityHandling"],n);let i=s8(e,["turnCoverage"]);return null!=i&&s9(t,["turnCoverage"],i),t}(y));let v=s8(e,["contextWindowCompression"]);void 0!==t&&null!=v&&s9(t,["setup","contextWindowCompression"],function(e){let t={},r=s8(e,["triggerTokens"]);null!=r&&s9(t,["triggerTokens"],r);let n=s8(e,["slidingWindow"]);return null!=n&&s9(t,["slidingWindow"],function(e){let t={},r=s8(e,["targetTokens"]);return null!=r&&s9(t,["targetTokens"],r),t}(n)),t}(v));let _=s8(e,["proactivity"]);return void 0!==t&&null!=_&&s9(t,["setup","proactivity"],function(e){let t={},r=s8(e,["proactiveAudio"]);return null!=r&&s9(t,["proactiveAudio"],r),t}(_)),{}}(i,r)),r}(this.apiClient,S),delete _.config,y.send(JSON.stringify(_)),new a1(y,this.apiClient)}isCallableTool(e){return"callTool"in e&&"function"==typeof e.callTool}}let a0={turnComplete:!0};class a1{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let r=[];try{r=oM(t.turns),r=e.isVertexAI()?r.map(e=>aA(e)):r.map(e=>aC(e))}catch(e){throw Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let r=[];if(null==t.functionResponses||0===(r=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses]).length)throw Error("functionResponses is required.");for(let t of r){if("object"!=typeof t||null===t||!("name"in t)||!("response"in t))throw Error(`Could not parse function response, type '${typeof t}'.`);if(!e.isVertexAI()&&!("id"in t))throw Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},a0),e);let t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:function(e){let t={},r=s8(e,["media"]);if(null!=r){let e=oT(r);Array.isArray(e)&&(e=e.map(e=>e)),s9(t,["mediaChunks"],e)}let n=s8(e,["audio"]);null!=n&&s9(t,["audio"],oO(n));let i=s8(e,["audioStreamEnd"]);null!=i&&s9(t,["audioStreamEnd"],i);let s=s8(e,["video"]);null!=s&&s9(t,["video"],oA(s));let o=s8(e,["text"]);return null!=o&&s9(t,["text"],o),null!=s8(e,["activityStart"])&&s9(t,["activityStart"],{}),null!=s8(e,["activityEnd"])&&s9(t,["activityEnd"],{}),t}(e)}:{realtimeInput:function(e){let t={},r=s8(e,["media"]);if(null!=r){let e=oT(r);Array.isArray(e)&&(e=e.map(e=>e)),s9(t,["mediaChunks"],e)}let n=s8(e,["audio"]);null!=n&&s9(t,["audio"],oO(n));let i=s8(e,["audioStreamEnd"]);null!=i&&s9(t,["audioStreamEnd"],i);let s=s8(e,["video"]);null!=s&&s9(t,["video"],oA(s));let o=s8(e,["text"]);return null!=o&&s9(t,["text"],o),null!=s8(e,["activityStart"])&&s9(t,["activityStart"],{}),null!=s8(e,["activityEnd"])&&s9(t,["activityEnd"],{}),t}(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw Error("Tool response parameters are required.");let t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function a2(e){var t,r,n;if(null==(t=null==e?void 0:e.automaticFunctionCalling)?void 0:t.disable)return!0;let i=!1;for(let t of null!=(r=null==e?void 0:e.tools)?r:[])if(a5(t)){i=!0;break}if(!i)return!0;let s=null==(n=null==e?void 0:e.automaticFunctionCalling)?void 0:n.maximumRemoteCalls;return(!(!s||!(s<0)&&Number.isInteger(s))||0==s)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0)}function a5(e){return"callTool"in e&&"function"==typeof e.callTool}function a4(e){var t;return!(null==(t=null==e?void 0:e.automaticFunctionCalling)?void 0:t.ignoreCallHistory)}class a3 extends s3{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>{var t,r,n,i,s;let o,a,l=await this.processParamsMaybeAddMcpUsage(e);if(this.maybeMoveToResponseJsonSchem(e),!function(e){var t,r,n;return null!=(n=null==(r=null==(t=e.config)?void 0:t.tools)?void 0:r.some(e=>a5(e)))&&n}(e)||a2(e.config))return await this.generateContentInternal(l);if(function(e){var t,r,n;return null!=(n=null==(r=null==(t=e.config)?void 0:t.tools)?void 0:r.some(e=>!a5(e)))&&n}(e))throw Error("Automatic function calling with CallableTools and Tools is not yet supported.");let u=oM(l.contents),c=null!=(n=null==(r=null==(t=l.config)?void 0:t.automaticFunctionCalling)?void 0:r.maximumRemoteCalls)?n:10,d=0;for(;d<c&&(o=await this.generateContentInternal(l)).functionCalls&&0!==o.functionCalls.length;){let t=o.candidates[0].content,r=[];for(let t of null!=(s=null==(i=e.config)?void 0:i.tools)?s:[])if(a5(t)){let e=await t.callTool(o.functionCalls);r.push(...e)}d++,a={role:"user",parts:r},l.contents=oM(l.contents),l.contents.push(t),l.contents.push(a),a4(l.config)&&(u.push(t),u.push(a))}return a4(l.config)&&(o.automaticFunctionCallingHistory=u),o},this.generateContentStream=async e=>{if(this.maybeMoveToResponseJsonSchem(e),!a2(e.config))return await this.processAfcStream(e);{let t=await this.processParamsMaybeAddMcpUsage(e);return await this.generateContentStreamInternal(t)}},this.generateImages=async e=>await this.generateImagesInternal(e).then(e=>{var t;let r,n=[];if(null==e?void 0:e.generatedImages)for(let i of e.generatedImages)i&&(null==i?void 0:i.safetyAttributes)&&(null==(t=null==i?void 0:i.safetyAttributes)?void 0:t.contentType)==="Positive Prompt"?r=null==i?void 0:i.safetyAttributes:n.push(i);return r?{generatedImages:n,positivePromptSafetyAttributes:r,sdkHttpResponse:e.sdkHttpResponse}:{generatedImages:n,sdkHttpResponse:e.sdkHttpResponse}}),this.list=async e=>{var t;let r={config:Object.assign(Object.assign({},{queryBase:!0}),null==e?void 0:e.config)};if(this.apiClient.isVertexAI()&&!r.config.queryBase)if(null==(t=r.config)?void 0:t.filter)throw Error("Filtering tuned models list for Vertex AI is not currently supported");else r.config.filter="labels.tune-type:*";return new o6(es.PAGED_ITEM_MODELS,e=>this.listInternal(e),await this.listInternal(r),r)},this.editImage=async e=>{let t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(e=>e.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));let r={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(r)},this.generateVideos=async e=>{if((e.prompt||e.image||e.video)&&e.source)throw Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return await this.generateVideosInternal(e)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&!e.config.responseJsonSchema&&Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema)}async processParamsMaybeAddMcpUsage(e){var t,r,n;let i=null==(t=e.config)?void 0:t.tools;if(!i)return e;let s=await Promise.all(i.map(async e=>a5(e)?await e.tool():e)),o={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};if(o.config.tools=s,e.config&&e.config.tools&&aK(e.config.tools)){let t=Object.assign({},null!=(n=null==(r=e.config.httpOptions)?void 0:r.headers)?n:{});0===Object.keys(t).length&&(t=this.apiClient.getDefaultHeaders()),az(t),o.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:t})}return o}async initAfcToolsMap(e){var t,r,n;let i=new Map;for(let s of null!=(r=null==(t=e.config)?void 0:t.tools)?r:[])if(a5(s))for(let e of null!=(n=(await s.tool()).functionDeclarations)?n:[]){if(!e.name)throw Error("Function declaration name is required.");if(i.has(e.name))throw Error(`Duplicate tool declaration name: ${e.name}`);i.set(e.name,s)}return i}async processAfcStream(e){var t,r,n;let i=null!=(n=null==(r=null==(t=e.config)?void 0:t.automaticFunctionCalling)?void 0:r.maximumRemoteCalls)?n:10,s=!1,o=0;return function(e,t,r){var n,a;return ai(this,arguments,function*(){for(var l,u,c,d;o<i;){s&&(o++,s=!1);let g=yield an(e.processParamsMaybeAddMcpUsage(r)),m=yield an(e.generateContentStreamInternal(g)),y=[],v=[];try{for(var h,p=!0,f=(u=void 0,as(m));!(l=(h=yield an(f.next())).done);p=!0)if(d=h.value,p=!1,yield yield an(d),d.candidates&&(null==(n=d.candidates[0])?void 0:n.content)){for(let e of(v.push(d.candidates[0].content),null!=(a=d.candidates[0].content.parts)?a:[]))if(o<i&&e.functionCall){if(!e.functionCall.name)throw Error("Function call name was not returned by the model.");if(t.has(e.functionCall.name)){let r=yield an(t.get(e.functionCall.name).callTool([e.functionCall]));y.push(...r)}else throw Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${t.keys()}, mising tool: ${e.functionCall.name}`)}}}catch(e){u={error:e}}finally{try{!p&&!l&&(c=f.return)&&(yield an(c.call(f)))}finally{if(u)throw u.error}}if(y.length>0){s=!0;let e=new ot;e.candidates=[{content:{role:"user",parts:y}}],yield yield an(e);let t=[];t.push(...v),t.push({role:"user",parts:y});let n=oM(r.contents).concat(t);r.contents=n}else break}})}(this,await this.initAfcToolsMap(e),e)}async generateContentInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=ax(this.apiClient,e);return s=s6("{model}:generateContent",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=ak(e),r=new ot;return Object.assign(r,t),r})}{let t=aO(this.apiClient,e);return s=s6("{model}:generateContent",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=aI(e),r=new ot;return Object.assign(r,t),r})}}async generateContentStreamInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=ax(this.apiClient,e);return s=s6("{model}:streamGenerateContent?alt=sse",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.requestStream({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(function(e){return ai(this,arguments,function*(){var t,r,n,i;try{for(var s,o=!0,a=as(e);!(t=(s=yield an(a.next())).done);o=!0){i=s.value,o=!1;let e=ak((yield an(i.json())));e.sdkHttpResponse={headers:i.headers};let t=new ot;Object.assign(t,e),yield yield an(t)}}catch(e){r={error:e}}finally{try{!o&&!t&&(n=a.return)&&(yield an(n.call(a)))}finally{if(r)throw r.error}}})})}{let t=aO(this.apiClient,e);return s=s6("{model}:streamGenerateContent?alt=sse",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.requestStream({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(function(e){return ai(this,arguments,function*(){var t,r,n,i;try{for(var s,o=!0,a=as(e);!(t=(s=yield an(a.next())).done);o=!0){i=s.value,o=!1;let e=aI((yield an(i.json())));e.sdkHttpResponse={headers:i.headers};let t=new ot;Object.assign(t,e),yield yield an(t)}}catch(e){r={error:e}}finally{try{!o&&!t&&(n=a.return)&&(yield an(n.call(a)))}finally{if(r)throw r.error}}})})}}async embedContent(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["contents"]);null!=i&&s9(r,["instances[]","content"],oD(e,i));let s=s8(t,["config"]);return null!=s&&function(e,t){let r=s8(e,["taskType"]);void 0!==t&&null!=r&&s9(t,["instances[]","task_type"],r);let n=s8(e,["title"]);void 0!==t&&null!=n&&s9(t,["instances[]","title"],n);let i=s8(e,["outputDimensionality"]);void 0!==t&&null!=i&&s9(t,["parameters","outputDimensionality"],i);let s=s8(e,["mimeType"]);void 0!==t&&null!=s&&s9(t,["instances[]","mimeType"],s);let o=s8(e,["autoTruncate"]);void 0!==t&&null!=o&&s9(t,["parameters","autoTruncate"],o)}(s,r),r}(this.apiClient,e);return s=s6("{model}:predict",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["predictions[]","embeddings"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["values"]);null!=r&&s9(t,["values"],r);let n=s8(e,["statistics"]);return null!=n&&s9(t,["statistics"],function(e){let t={},r=s8(e,["truncated"]);null!=r&&s9(t,["truncated"],r);let n=s8(e,["token_count"]);return null!=n&&s9(t,["tokenCount"],n),t}(n)),t})(e))),s9(t,["embeddings"],e)}let i=s8(e,["metadata"]);return null!=i&&s9(t,["metadata"],function(e){let t={},r=s8(e,["billableCharacterCount"]);return null!=r&&s9(t,["billableCharacterCount"],r),t}(i)),t}(e),r=new or;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["contents"]);null!=i&&s9(r,["requests[]","content"],oD(e,i));let s=s8(t,["config"]);null!=s&&function(e,t){let r=s8(e,["taskType"]);void 0!==t&&null!=r&&s9(t,["requests[]","taskType"],r);let n=s8(e,["title"]);void 0!==t&&null!=n&&s9(t,["requests[]","title"],n);let i=s8(e,["outputDimensionality"]);if(void 0!==t&&null!=i&&s9(t,["requests[]","outputDimensionality"],i),void 0!==s8(e,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==s8(e,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.")}(s,r);let o=s8(t,["model"]);return void 0!==o&&s9(r,["requests[]","model"],oS(e,o)),r}(this.apiClient,e);return s=s6("{model}:batchEmbedContents",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["embeddings"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["values"]);return null!=r&&s9(t,["values"],r),t})(e))),s9(t,["embeddings"],e)}return null!=s8(e,["metadata"])&&s9(t,["metadata"],{}),t}(e),r=new or;return Object.assign(r,t),r})}}async generateImagesInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["prompt"]);null!=i&&s9(r,["instances[0]","prompt"],i);let s=s8(t,["config"]);return null!=s&&function(e,t){let r=s8(e,["outputGcsUri"]);void 0!==t&&null!=r&&s9(t,["parameters","storageUri"],r);let n=s8(e,["negativePrompt"]);void 0!==t&&null!=n&&s9(t,["parameters","negativePrompt"],n);let i=s8(e,["numberOfImages"]);void 0!==t&&null!=i&&s9(t,["parameters","sampleCount"],i);let s=s8(e,["aspectRatio"]);void 0!==t&&null!=s&&s9(t,["parameters","aspectRatio"],s);let o=s8(e,["guidanceScale"]);void 0!==t&&null!=o&&s9(t,["parameters","guidanceScale"],o);let a=s8(e,["seed"]);void 0!==t&&null!=a&&s9(t,["parameters","seed"],a);let l=s8(e,["safetyFilterLevel"]);void 0!==t&&null!=l&&s9(t,["parameters","safetySetting"],l);let u=s8(e,["personGeneration"]);void 0!==t&&null!=u&&s9(t,["parameters","personGeneration"],u);let c=s8(e,["includeSafetyAttributes"]);void 0!==t&&null!=c&&s9(t,["parameters","includeSafetyAttributes"],c);let d=s8(e,["includeRaiReason"]);void 0!==t&&null!=d&&s9(t,["parameters","includeRaiReason"],d);let h=s8(e,["language"]);void 0!==t&&null!=h&&s9(t,["parameters","language"],h);let p=s8(e,["outputMimeType"]);void 0!==t&&null!=p&&s9(t,["parameters","outputOptions","mimeType"],p);let f=s8(e,["outputCompressionQuality"]);void 0!==t&&null!=f&&s9(t,["parameters","outputOptions","compressionQuality"],f);let g=s8(e,["addWatermark"]);void 0!==t&&null!=g&&s9(t,["parameters","addWatermark"],g);let m=s8(e,["imageSize"]);void 0!==t&&null!=m&&s9(t,["parameters","sampleImageSize"],m);let y=s8(e,["enhancePrompt"]);void 0!==t&&null!=y&&s9(t,["parameters","enhancePrompt"],y)}(s,r),r}(this.apiClient,e);return s=s6("{model}:predict",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>aR(e))),s9(t,["generatedImages"],e)}let i=s8(e,["positivePromptSafetyAttributes"]);return null!=i&&s9(t,["positivePromptSafetyAttributes"],aL(i)),t}(e),r=new on;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["prompt"]);null!=i&&s9(r,["instances[0]","prompt"],i);let s=s8(t,["config"]);return null!=s&&function(e,t){if(void 0!==s8(e,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==s8(e,["negativePrompt"]))throw Error("negativePrompt parameter is not supported in Gemini API.");let r=s8(e,["numberOfImages"]);void 0!==t&&null!=r&&s9(t,["parameters","sampleCount"],r);let n=s8(e,["aspectRatio"]);void 0!==t&&null!=n&&s9(t,["parameters","aspectRatio"],n);let i=s8(e,["guidanceScale"]);if(void 0!==t&&null!=i&&s9(t,["parameters","guidanceScale"],i),void 0!==s8(e,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let s=s8(e,["safetyFilterLevel"]);void 0!==t&&null!=s&&s9(t,["parameters","safetySetting"],s);let o=s8(e,["personGeneration"]);void 0!==t&&null!=o&&s9(t,["parameters","personGeneration"],o);let a=s8(e,["includeSafetyAttributes"]);void 0!==t&&null!=a&&s9(t,["parameters","includeSafetyAttributes"],a);let l=s8(e,["includeRaiReason"]);void 0!==t&&null!=l&&s9(t,["parameters","includeRaiReason"],l);let u=s8(e,["language"]);void 0!==t&&null!=u&&s9(t,["parameters","language"],u);let c=s8(e,["outputMimeType"]);void 0!==t&&null!=c&&s9(t,["parameters","outputOptions","mimeType"],c);let d=s8(e,["outputCompressionQuality"]);if(void 0!==t&&null!=d&&s9(t,["parameters","outputOptions","compressionQuality"],d),void 0!==s8(e,["addWatermark"]))throw Error("addWatermark parameter is not supported in Gemini API.");let h=s8(e,["imageSize"]);if(void 0!==t&&null!=h&&s9(t,["parameters","sampleImageSize"],h),void 0!==s8(e,["enhancePrompt"]))throw Error("enhancePrompt parameter is not supported in Gemini API.")}(s,r),r}(this.apiClient,e);return s=s6("{model}:predict",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["_self"]);null!=r&&s9(t,["image"],function(e){let t={},r=s8(e,["bytesBase64Encoded"]);null!=r&&s9(t,["imageBytes"],s7(r));let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(r));let n=s8(e,["raiFilteredReason"]);null!=n&&s9(t,["raiFilteredReason"],n);let i=s8(e,["_self"]);return null!=i&&s9(t,["safetyAttributes"],aU(i)),t})(e))),s9(t,["generatedImages"],e)}let i=s8(e,["positivePromptSafetyAttributes"]);return null!=i&&s9(t,["positivePromptSafetyAttributes"],aU(i)),t}(e),r=new on;return Object.assign(r,t),r})}}async editImageInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["prompt"]);null!=i&&s9(r,["instances[0]","prompt"],i);let s=s8(t,["referenceImages"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["referenceImage"]);null!=r&&s9(t,["referenceImage"],aD(r));let n=s8(e,["referenceId"]);null!=n&&s9(t,["referenceId"],n);let i=s8(e,["referenceType"]);null!=i&&s9(t,["referenceType"],i);let s=s8(e,["maskImageConfig"]);null!=s&&s9(t,["maskImageConfig"],function(e){let t={},r=s8(e,["maskMode"]);null!=r&&s9(t,["maskMode"],r);let n=s8(e,["segmentationClasses"]);null!=n&&s9(t,["maskClasses"],n);let i=s8(e,["maskDilation"]);return null!=i&&s9(t,["dilation"],i),t}(s));let o=s8(e,["controlImageConfig"]);null!=o&&s9(t,["controlImageConfig"],function(e){let t={},r=s8(e,["controlType"]);null!=r&&s9(t,["controlType"],r);let n=s8(e,["enableControlImageComputation"]);return null!=n&&s9(t,["computeControl"],n),t}(o));let a=s8(e,["styleImageConfig"]);null!=a&&s9(t,["styleImageConfig"],function(e){let t={},r=s8(e,["styleDescription"]);return null!=r&&s9(t,["styleDescription"],r),t}(a));let l=s8(e,["subjectImageConfig"]);return null!=l&&s9(t,["subjectImageConfig"],function(e){let t={},r=s8(e,["subjectType"]);null!=r&&s9(t,["subjectType"],r);let n=s8(e,["subjectDescription"]);return null!=n&&s9(t,["subjectDescription"],n),t}(l)),t})(e))),s9(r,["instances[0]","referenceImages"],e)}let o=s8(t,["config"]);return null!=o&&function(e,t){let r=s8(e,["outputGcsUri"]);void 0!==t&&null!=r&&s9(t,["parameters","storageUri"],r);let n=s8(e,["negativePrompt"]);void 0!==t&&null!=n&&s9(t,["parameters","negativePrompt"],n);let i=s8(e,["numberOfImages"]);void 0!==t&&null!=i&&s9(t,["parameters","sampleCount"],i);let s=s8(e,["aspectRatio"]);void 0!==t&&null!=s&&s9(t,["parameters","aspectRatio"],s);let o=s8(e,["guidanceScale"]);void 0!==t&&null!=o&&s9(t,["parameters","guidanceScale"],o);let a=s8(e,["seed"]);void 0!==t&&null!=a&&s9(t,["parameters","seed"],a);let l=s8(e,["safetyFilterLevel"]);void 0!==t&&null!=l&&s9(t,["parameters","safetySetting"],l);let u=s8(e,["personGeneration"]);void 0!==t&&null!=u&&s9(t,["parameters","personGeneration"],u);let c=s8(e,["includeSafetyAttributes"]);void 0!==t&&null!=c&&s9(t,["parameters","includeSafetyAttributes"],c);let d=s8(e,["includeRaiReason"]);void 0!==t&&null!=d&&s9(t,["parameters","includeRaiReason"],d);let h=s8(e,["language"]);void 0!==t&&null!=h&&s9(t,["parameters","language"],h);let p=s8(e,["outputMimeType"]);void 0!==t&&null!=p&&s9(t,["parameters","outputOptions","mimeType"],p);let f=s8(e,["outputCompressionQuality"]);void 0!==t&&null!=f&&s9(t,["parameters","outputOptions","compressionQuality"],f);let g=s8(e,["addWatermark"]);void 0!==t&&null!=g&&s9(t,["parameters","addWatermark"],g);let m=s8(e,["editMode"]);void 0!==t&&null!=m&&s9(t,["parameters","editMode"],m);let y=s8(e,["baseSteps"]);void 0!==t&&null!=y&&s9(t,["parameters","editConfig","baseSteps"],y)}(o,r),r}(this.apiClient,e);return n=s6("{model}:predict",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>aR(e))),s9(t,["generatedImages"],e)}return t}(e),r=new oi;return Object.assign(r,t),r})}throw Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["image"]);null!=i&&s9(r,["instances[0]","image"],aD(i));let s=s8(t,["upscaleFactor"]);null!=s&&s9(r,["parameters","upscaleConfig","upscaleFactor"],s);let o=s8(t,["config"]);return null!=o&&function(e,t){let r=s8(e,["outputGcsUri"]);void 0!==t&&null!=r&&s9(t,["parameters","storageUri"],r);let n=s8(e,["includeRaiReason"]);void 0!==t&&null!=n&&s9(t,["parameters","includeRaiReason"],n);let i=s8(e,["outputMimeType"]);void 0!==t&&null!=i&&s9(t,["parameters","outputOptions","mimeType"],i);let s=s8(e,["outputCompressionQuality"]);void 0!==t&&null!=s&&s9(t,["parameters","outputOptions","compressionQuality"],s);let o=s8(e,["enhanceInputImage"]);void 0!==t&&null!=o&&s9(t,["parameters","upscaleConfig","enhanceInputImage"],o);let a=s8(e,["imagePreservationFactor"]);void 0!==t&&null!=a&&s9(t,["parameters","upscaleConfig","imagePreservationFactor"],a);let l=s8(e,["numberOfImages"]);void 0!==t&&null!=l&&s9(t,["parameters","sampleCount"],l);let u=s8(e,["mode"]);void 0!==t&&null!=u&&s9(t,["parameters","mode"],u)}(o,r),r}(this.apiClient,e);return n=s6("{model}:predict",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>aR(e))),s9(t,["generatedImages"],e)}return t}(e),r=new os;return Object.assign(r,t),r})}throw Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["source"]);null!=i&&function(e,t){let r=s8(e,["prompt"]);void 0!==t&&null!=r&&s9(t,["instances[0]","prompt"],r);let n=s8(e,["personImage"]);void 0!==t&&null!=n&&s9(t,["instances[0]","personImage","image"],aD(n));let i=s8(e,["productImages"]);if(void 0!==t&&null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["productImage"]);return null!=r&&s9(t,["image"],aD(r)),t})(e))),s9(t,["instances[0]","productImages"],e)}}(i,r);let s=s8(t,["config"]);return null!=s&&function(e,t){let r=s8(e,["numberOfImages"]);void 0!==t&&null!=r&&s9(t,["parameters","sampleCount"],r);let n=s8(e,["baseSteps"]);void 0!==t&&null!=n&&s9(t,["parameters","editConfig","baseSteps"],n);let i=s8(e,["outputGcsUri"]);void 0!==t&&null!=i&&s9(t,["parameters","storageUri"],i);let s=s8(e,["seed"]);void 0!==t&&null!=s&&s9(t,["parameters","seed"],s);let o=s8(e,["safetyFilterLevel"]);void 0!==t&&null!=o&&s9(t,["parameters","safetySetting"],o);let a=s8(e,["personGeneration"]);void 0!==t&&null!=a&&s9(t,["parameters","personGeneration"],a);let l=s8(e,["addWatermark"]);void 0!==t&&null!=l&&s9(t,["parameters","addWatermark"],l);let u=s8(e,["outputMimeType"]);void 0!==t&&null!=u&&s9(t,["parameters","outputOptions","mimeType"],u);let c=s8(e,["outputCompressionQuality"]);void 0!==t&&null!=c&&s9(t,["parameters","outputOptions","compressionQuality"],c);let d=s8(e,["enhancePrompt"]);void 0!==t&&null!=d&&s9(t,["parameters","enhancePrompt"],d)}(s,r),r}(this.apiClient,e);return n=s6("{model}:predict",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=s8(e,["predictions"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>aR(e))),s9(t,["generatedImages"],e)}return t}(e),r=new oo;return Object.assign(r,t),r})}throw Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["source"]);null!=i&&function(e,t){let r=s8(e,["prompt"]);void 0!==t&&null!=r&&s9(t,["instances[0]","prompt"],r);let n=s8(e,["image"]);void 0!==t&&null!=n&&s9(t,["instances[0]","image"],aD(n));let i=s8(e,["scribbleImage"]);void 0!==t&&null!=i&&s9(t,["instances[0]","scribble"],function(e){let t={},r=s8(e,["image"]);return null!=r&&s9(t,["image"],aD(r)),t}(i))}(i,r);let s=s8(t,["config"]);return null!=s&&function(e,t){let r=s8(e,["mode"]);void 0!==t&&null!=r&&s9(t,["parameters","mode"],r);let n=s8(e,["maxPredictions"]);void 0!==t&&null!=n&&s9(t,["parameters","maxPredictions"],n);let i=s8(e,["confidenceThreshold"]);void 0!==t&&null!=i&&s9(t,["parameters","confidenceThreshold"],i);let s=s8(e,["maskDilation"]);void 0!==t&&null!=s&&s9(t,["parameters","maskDilation"],s);let o=s8(e,["binaryColorThreshold"]);void 0!==t&&null!=o&&s9(t,["parameters","binaryColorThreshold"],o)}(s,r),r}(this.apiClient,e);return n=s6("{model}:predict",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=s8(e,["predictions"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["_self"]);null!=r&&s9(t,["mask"],aP(r));let n=s8(e,["labels"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["label"]);null!=r&&s9(t,["label"],r);let n=s8(e,["score"]);return null!=n&&s9(t,["score"],n),t})(e))),s9(t,["labels"],e)}return t})(e))),s9(t,["generatedMasks"],e)}return t}(e),r=new oa;return Object.assign(r,t),r})}throw Error("This method is only supported by the Vertex AI.")}async get(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=s8(t,["model"]);return null!=n&&s9(r,["_url","name"],oS(e,n)),r}(this.apiClient,e);return s=s6("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>aj(e))}{let t=function(e,t){let r={},n=s8(t,["model"]);return null!=n&&s9(r,["_url","name"],oS(e,n)),r}(this.apiClient,e);return s=s6("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json()).then(e=>aM(e))}}async listInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=s8(t,["config"]);return null!=n&&function(e,t,r){let n=s8(t,["pageSize"]);void 0!==r&&null!=n&&s9(r,["_query","pageSize"],n);let i=s8(t,["pageToken"]);void 0!==r&&null!=i&&s9(r,["_query","pageToken"],i);let s=s8(t,["filter"]);void 0!==r&&null!=s&&s9(r,["_query","filter"],s);let o=s8(t,["queryBase"]);void 0!==r&&null!=o&&s9(r,["_url","models_url"],oK(e,o))}(e,n,r),r}(this.apiClient,e);return s=s6("{models_url}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["nextPageToken"]);null!=n&&s9(t,["nextPageToken"],n);let i=s8(e,["_self"]);if(null!=i){let e=oz(i);Array.isArray(e)&&(e=e.map(e=>aj(e))),s9(t,["models"],e)}return t}(e),r=new ol;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=s8(t,["config"]);return null!=n&&function(e,t,r){let n=s8(t,["pageSize"]);void 0!==r&&null!=n&&s9(r,["_query","pageSize"],n);let i=s8(t,["pageToken"]);void 0!==r&&null!=i&&s9(r,["_query","pageToken"],i);let s=s8(t,["filter"]);void 0!==r&&null!=s&&s9(r,["_query","filter"],s);let o=s8(t,["queryBase"]);void 0!==r&&null!=o&&s9(r,["_url","models_url"],oK(e,o))}(e,n,r),r}(this.apiClient,e);return s=s6("{models_url}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["nextPageToken"]);null!=n&&s9(t,["nextPageToken"],n);let i=s8(e,["_self"]);if(null!=i){let e=oz(i);Array.isArray(e)&&(e=e.map(e=>aM(e))),s9(t,["models"],e)}return t}(e),r=new ol;return Object.assign(r,t),r})}}async update(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["config"]);return null!=i&&function(e,t){let r=s8(e,["displayName"]);void 0!==t&&null!=r&&s9(t,["displayName"],r);let n=s8(e,["description"]);void 0!==t&&null!=n&&s9(t,["description"],n);let i=s8(e,["defaultCheckpointId"]);void 0!==t&&null!=i&&s9(t,["defaultCheckpointId"],i)}(i,r),r}(this.apiClient,e);return s=s6("{model}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"PATCH",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>aj(e))}{let t=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","name"],oS(e,n));let i=s8(t,["config"]);return null!=i&&function(e,t){let r=s8(e,["displayName"]);void 0!==t&&null!=r&&s9(t,["displayName"],r);let n=s8(e,["description"]);void 0!==t&&null!=n&&s9(t,["description"],n);let i=s8(e,["defaultCheckpointId"]);void 0!==t&&null!=i&&s9(t,["defaultCheckpointId"],i)}(i,r),r}(this.apiClient,e);return s=s6("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json()).then(e=>aM(e))}}async delete(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=s8(t,["model"]);return null!=n&&s9(r,["_url","name"],oS(e,n)),r}(this.apiClient,e);return s=s6("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);return null!=r&&s9(t,["sdkHttpResponse"],r),t}(e),r=new ou;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=s8(t,["model"]);return null!=n&&s9(r,["_url","name"],oS(e,n)),r}(this.apiClient,e);return s=s6("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);return null!=r&&s9(t,["sdkHttpResponse"],r),t}(e),r=new ou;return Object.assign(r,t),r})}}async countTokens(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["contents"]);if(null!=i){let e=oM(i);Array.isArray(e)&&(e=e.map(e=>aA(e))),s9(r,["contents"],e)}let s=s8(t,["config"]);return null!=s&&function(e,t){let r=s8(e,["systemInstruction"]);void 0!==t&&null!=r&&s9(t,["systemInstruction"],aA(oN(r)));let n=s8(e,["tools"]);if(void 0!==t&&null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>aF(e))),s9(t,["tools"],e)}let i=s8(e,["generationConfig"]);void 0!==t&&null!=i&&s9(t,["generationConfig"],i)}(s,r),r}(this.apiClient,e);return s=s6("{model}:countTokens",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["totalTokens"]);return null!=n&&s9(t,["totalTokens"],n),t}(e),r=new oc;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["contents"]);if(null!=i){let e=oM(i);Array.isArray(e)&&(e=e.map(e=>aC(e))),s9(r,["contents"],e)}let s=s8(t,["config"]);return null!=s&&function(e){if(void 0!==s8(e,["systemInstruction"]))throw Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==s8(e,["tools"]))throw Error("tools parameter is not supported in Gemini API.");if(void 0!==s8(e,["generationConfig"]))throw Error("generationConfig parameter is not supported in Gemini API.")}(s),r}(this.apiClient,e);return s=s6("{model}:countTokens",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["totalTokens"]);null!=n&&s9(t,["totalTokens"],n);let i=s8(e,["cachedContentTokenCount"]);return null!=i&&s9(t,["cachedContentTokenCount"],i),t}(e),r=new oc;return Object.assign(r,t),r})}}async computeTokens(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["contents"]);if(null!=i){let e=oM(i);Array.isArray(e)&&(e=e.map(e=>aA(e))),s9(r,["contents"],e)}return r}(this.apiClient,e);return n=s6("{model}:computeTokens",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["tokensInfo"]);return null!=n&&s9(t,["tokensInfo"],n),t}(e),r=new od;return Object.assign(r,t),r})}throw Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["prompt"]);null!=i&&s9(r,["instances[0]","prompt"],i);let s=s8(t,["image"]);null!=s&&s9(r,["instances[0]","image"],aD(s));let o=s8(t,["video"]);null!=o&&s9(r,["instances[0]","video"],aB(o));let a=s8(t,["source"]);null!=a&&function(e,t){let r=s8(e,["prompt"]);void 0!==t&&null!=r&&s9(t,["instances[0]","prompt"],r);let n=s8(e,["image"]);void 0!==t&&null!=n&&s9(t,["instances[0]","image"],aD(n));let i=s8(e,["video"]);void 0!==t&&null!=i&&s9(t,["instances[0]","video"],aB(i))}(a,r);let l=s8(t,["config"]);return null!=l&&function(e,t){let r=s8(e,["numberOfVideos"]);void 0!==t&&null!=r&&s9(t,["parameters","sampleCount"],r);let n=s8(e,["outputGcsUri"]);void 0!==t&&null!=n&&s9(t,["parameters","storageUri"],n);let i=s8(e,["fps"]);void 0!==t&&null!=i&&s9(t,["parameters","fps"],i);let s=s8(e,["durationSeconds"]);void 0!==t&&null!=s&&s9(t,["parameters","durationSeconds"],s);let o=s8(e,["seed"]);void 0!==t&&null!=o&&s9(t,["parameters","seed"],o);let a=s8(e,["aspectRatio"]);void 0!==t&&null!=a&&s9(t,["parameters","aspectRatio"],a);let l=s8(e,["resolution"]);void 0!==t&&null!=l&&s9(t,["parameters","resolution"],l);let u=s8(e,["personGeneration"]);void 0!==t&&null!=u&&s9(t,["parameters","personGeneration"],u);let c=s8(e,["pubsubTopic"]);void 0!==t&&null!=c&&s9(t,["parameters","pubsubTopic"],c);let d=s8(e,["negativePrompt"]);void 0!==t&&null!=d&&s9(t,["parameters","negativePrompt"],d);let h=s8(e,["enhancePrompt"]);void 0!==t&&null!=h&&s9(t,["parameters","enhancePrompt"],h);let p=s8(e,["generateAudio"]);void 0!==t&&null!=p&&s9(t,["parameters","generateAudio"],p);let f=s8(e,["lastFrame"]);void 0!==t&&null!=f&&s9(t,["instances[0]","lastFrame"],aD(f));let g=s8(e,["referenceImages"]);if(void 0!==t&&null!=g){let e=g;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["image"]);null!=r&&s9(t,["image"],aD(r));let n=s8(e,["referenceType"]);return null!=n&&s9(t,["referenceType"],n),t})(e))),s9(t,["instances[0]","referenceImages"],e)}let m=s8(e,["mask"]);void 0!==t&&null!=m&&s9(t,["instances[0]","mask"],function(e){let t={},r=s8(e,["image"]);null!=r&&s9(t,["_self"],aD(r));let n=s8(e,["maskMode"]);return null!=n&&s9(t,["maskMode"],n),t}(m));let y=s8(e,["compressionQuality"]);void 0!==t&&null!=y&&s9(t,["parameters","compressionQuality"],y)}(l,r),r}(this.apiClient,e);return s=s6("{model}:predictLongRunning",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=s8(e,["name"]);null!=r&&s9(t,["name"],r);let n=s8(e,["metadata"]);null!=n&&s9(t,["metadata"],n);let i=s8(e,["done"]);null!=i&&s9(t,["done"],i);let s=s8(e,["error"]);null!=s&&s9(t,["error"],s);let o=s8(e,["response"]);return null!=o&&s9(t,["response"],function(e){let t={},r=s8(e,["videos"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["_self"]);return null!=r&&s9(t,["video"],function(e){let t={},r=s8(e,["gcsUri"]);null!=r&&s9(t,["uri"],r);let n=s8(e,["bytesBase64Encoded"]);null!=n&&s9(t,["videoBytes"],s7(n));let i=s8(e,["mimeType"]);return null!=i&&s9(t,["mimeType"],i),t}(r)),t})(e))),s9(t,["generatedVideos"],e)}let n=s8(e,["raiMediaFilteredCount"]);null!=n&&s9(t,["raiMediaFilteredCount"],n);let i=s8(e,["raiMediaFilteredReasons"]);return null!=i&&s9(t,["raiMediaFilteredReasons"],i),t}(o)),t}(e),r=new oh;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["_url","model"],oS(e,n));let i=s8(t,["prompt"]);null!=i&&s9(r,["instances[0]","prompt"],i);let s=s8(t,["image"]);if(null!=s&&s9(r,["instances[0]","image"],aN(s)),void 0!==s8(t,["video"]))throw Error("video parameter is not supported in Gemini API.");let o=s8(t,["source"]);null!=o&&function(e,t){let r=s8(e,["prompt"]);void 0!==t&&null!=r&&s9(t,["instances[0]","prompt"],r);let n=s8(e,["image"]);if(void 0!==t&&null!=n&&s9(t,["instances[0]","image"],aN(n)),void 0!==s8(e,["video"]))throw Error("video parameter is not supported in Gemini API.")}(o,r);let a=s8(t,["config"]);return null!=a&&function(e,t){let r=s8(e,["numberOfVideos"]);if(void 0!==t&&null!=r&&s9(t,["parameters","sampleCount"],r),void 0!==s8(e,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==s8(e,["fps"]))throw Error("fps parameter is not supported in Gemini API.");let n=s8(e,["durationSeconds"]);if(void 0!==t&&null!=n&&s9(t,["parameters","durationSeconds"],n),void 0!==s8(e,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let i=s8(e,["aspectRatio"]);void 0!==t&&null!=i&&s9(t,["parameters","aspectRatio"],i);let s=s8(e,["resolution"]);void 0!==t&&null!=s&&s9(t,["parameters","resolution"],s);let o=s8(e,["personGeneration"]);if(void 0!==t&&null!=o&&s9(t,["parameters","personGeneration"],o),void 0!==s8(e,["pubsubTopic"]))throw Error("pubsubTopic parameter is not supported in Gemini API.");let a=s8(e,["negativePrompt"]);void 0!==t&&null!=a&&s9(t,["parameters","negativePrompt"],a);let l=s8(e,["enhancePrompt"]);if(void 0!==t&&null!=l&&s9(t,["parameters","enhancePrompt"],l),void 0!==s8(e,["generateAudio"]))throw Error("generateAudio parameter is not supported in Gemini API.");if(void 0!==s8(e,["lastFrame"]))throw Error("lastFrame parameter is not supported in Gemini API.");if(void 0!==s8(e,["referenceImages"]))throw Error("referenceImages parameter is not supported in Gemini API.");if(void 0!==s8(e,["mask"]))throw Error("mask parameter is not supported in Gemini API.");if(void 0!==s8(e,["compressionQuality"]))throw Error("compressionQuality parameter is not supported in Gemini API.")}(a,r),r}(this.apiClient,e);return s=s6("{model}:predictLongRunning",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=s8(e,["name"]);null!=r&&s9(t,["name"],r);let n=s8(e,["metadata"]);null!=n&&s9(t,["metadata"],n);let i=s8(e,["done"]);null!=i&&s9(t,["done"],i);let s=s8(e,["error"]);null!=s&&s9(t,["error"],s);let o=s8(e,["response","generateVideoResponse"]);return null!=o&&s9(t,["response"],function(e){let t={},r=s8(e,["generatedSamples"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["_self"]);return null!=r&&s9(t,["video"],function(e){let t={},r=s8(e,["video","uri"]);null!=r&&s9(t,["uri"],r);let n=s8(e,["video","encodedVideo"]);null!=n&&s9(t,["videoBytes"],s7(n));let i=s8(e,["encoding"]);return null!=i&&s9(t,["mimeType"],i),t}(r)),t})(e))),s9(t,["generatedVideos"],e)}let n=s8(e,["raiMediaFilteredCount"]);null!=n&&s9(t,["raiMediaFilteredCount"],n);let i=s8(e,["raiMediaFilteredReasons"]);return null!=i&&s9(t,["raiMediaFilteredReasons"],i),t}(o)),t}(e),r=new oh;return Object.assign(r,t),r})}}}class a6 extends s3{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){let t=e.operation,r=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let e,n=t.name.split("/operations/")[0];r&&"httpOptions"in r&&(e=r.httpOptions);let i=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:n,config:{httpOptions:e}});return t._fromAPIResponse({apiResponse:i,isVertexAI:!0})}{let e=await this.getVideosOperationInternal({operationName:t.name,config:r});return t._fromAPIResponse({apiResponse:e,isVertexAI:!1})}}async get(e){let t=e.operation,r=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let e,n=t.name.split("/operations/")[0];r&&"httpOptions"in r&&(e=r.httpOptions);let i=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:n,config:{httpOptions:e}});return t._fromAPIResponse({apiResponse:i,isVertexAI:!0})}{let e=await this.getVideosOperationInternal({operationName:t.name,config:r});return t._fromAPIResponse({apiResponse:e,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e){let t={},r=s8(e,["operationName"]);return null!=r&&s9(t,["_url","operationName"],r),t}(e);return s=s6("{operationName}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json())}{let t=function(e){let t={},r=s8(e,["operationName"]);return null!=r&&s9(t,["_url","operationName"],r),t}(e);return s=s6("{operationName}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json())}}async fetchPredictVideosOperationInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e){let t={},r=s8(e,["operationName"]);null!=r&&s9(t,["operationName"],r);let n=s8(e,["resourceName"]);return null!=n&&s9(t,["_url","resourceName"],n),t}(e);return n=s6("{resourceName}:fetchPredictOperation",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json())}throw Error("This method is only supported by the Vertex AI.")}}function a9(e){let t={},r=s8(e,["prebuiltVoiceConfig"]);return null!=r&&s9(t,["prebuiltVoiceConfig"],function(e){let t={},r=s8(e,["voiceName"]);return null!=r&&s9(t,["voiceName"],r),t}(r)),t}class a8 extends s3{constructor(e){super(),this.apiClient=e}async create(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let s=function(e,t){let r={},n=s8(t,["config"]);return null!=n&&s9(r,["config"],function(e,t,r){let n=s8(t,["expireTime"]);void 0!==r&&null!=n&&s9(r,["expireTime"],n);let i=s8(t,["newSessionExpireTime"]);void 0!==r&&null!=i&&s9(r,["newSessionExpireTime"],i);let s=s8(t,["uses"]);void 0!==r&&null!=s&&s9(r,["uses"],s);let o=s8(t,["liveConnectConstraints"]);void 0!==r&&null!=o&&s9(r,["bidiGenerateContentSetup"],function(e,t){let r={},n=s8(t,["model"]);null!=n&&s9(r,["setup","model"],oS(e,n));let i=s8(t,["config"]);return null!=i&&s9(r,["config"],function(e,t){let r=s8(e,["generationConfig"]);void 0!==t&&null!=r&&s9(t,["setup","generationConfig"],r);let n=s8(e,["responseModalities"]);void 0!==t&&null!=n&&s9(t,["setup","generationConfig","responseModalities"],n);let i=s8(e,["temperature"]);void 0!==t&&null!=i&&s9(t,["setup","generationConfig","temperature"],i);let s=s8(e,["topP"]);void 0!==t&&null!=s&&s9(t,["setup","generationConfig","topP"],s);let o=s8(e,["topK"]);void 0!==t&&null!=o&&s9(t,["setup","generationConfig","topK"],o);let a=s8(e,["maxOutputTokens"]);void 0!==t&&null!=a&&s9(t,["setup","generationConfig","maxOutputTokens"],a);let l=s8(e,["mediaResolution"]);void 0!==t&&null!=l&&s9(t,["setup","generationConfig","mediaResolution"],l);let u=s8(e,["seed"]);void 0!==t&&null!=u&&s9(t,["setup","generationConfig","seed"],u);let c=s8(e,["speechConfig"]);void 0!==t&&null!=c&&s9(t,["setup","generationConfig","speechConfig"],function(e){let t={},r=s8(e,["voiceConfig"]);null!=r&&s9(t,["voiceConfig"],a9(r));let n=s8(e,["multiSpeakerVoiceConfig"]);null!=n&&s9(t,["multiSpeakerVoiceConfig"],function(e){let t={},r=s8(e,["speakerVoiceConfigs"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["speaker"]);null!=r&&s9(t,["speaker"],r);let n=s8(e,["voiceConfig"]);return null!=n&&s9(t,["voiceConfig"],a9(n)),t})(e))),s9(t,["speakerVoiceConfigs"],e)}return t}(n));let i=s8(e,["languageCode"]);return null!=i&&s9(t,["languageCode"],i),t}(oL(c)));let d=s8(e,["enableAffectiveDialog"]);void 0!==t&&null!=d&&s9(t,["setup","generationConfig","enableAffectiveDialog"],d);let h=s8(e,["systemInstruction"]);void 0!==t&&null!=h&&s9(t,["setup","systemInstruction"],function(e){let t={},r=s8(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["videoMetadata"]);null!=r&&s9(t,["videoMetadata"],function(e){let t={},r=s8(e,["fps"]);null!=r&&s9(t,["fps"],r);let n=s8(e,["endOffset"]);null!=n&&s9(t,["endOffset"],n);let i=s8(e,["startOffset"]);return null!=i&&s9(t,["startOffset"],i),t}(r));let n=s8(e,["thought"]);null!=n&&s9(t,["thought"],n);let i=s8(e,["inlineData"]);null!=i&&s9(t,["inlineData"],function(e){let t={};if(void 0!==s8(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=s8(e,["data"]);null!=r&&s9(t,["data"],r);let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(i));let s=s8(e,["fileData"]);null!=s&&s9(t,["fileData"],function(e){let t={};if(void 0!==s8(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=s8(e,["fileUri"]);null!=r&&s9(t,["fileUri"],r);let n=s8(e,["mimeType"]);return null!=n&&s9(t,["mimeType"],n),t}(s));let o=s8(e,["thoughtSignature"]);null!=o&&s9(t,["thoughtSignature"],o);let a=s8(e,["functionCall"]);null!=a&&s9(t,["functionCall"],function(e){let t={},r=s8(e,["id"]);null!=r&&s9(t,["id"],r);let n=s8(e,["args"]);null!=n&&s9(t,["args"],n);let i=s8(e,["name"]);return null!=i&&s9(t,["name"],i),t}(a));let l=s8(e,["codeExecutionResult"]);null!=l&&s9(t,["codeExecutionResult"],l);let u=s8(e,["executableCode"]);null!=u&&s9(t,["executableCode"],u);let c=s8(e,["functionResponse"]);null!=c&&s9(t,["functionResponse"],c);let d=s8(e,["text"]);return null!=d&&s9(t,["text"],d),t})(e))),s9(t,["parts"],e)}let n=s8(e,["role"]);return null!=n&&s9(t,["role"],n),t}(oN(h)));let p=s8(e,["tools"]);if(void 0!==t&&null!=p){let e=oB(p);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["behavior"]);null!=r&&s9(t,["behavior"],r);let n=s8(e,["description"]);null!=n&&s9(t,["description"],n);let i=s8(e,["name"]);null!=i&&s9(t,["name"],i);let s=s8(e,["parameters"]);null!=s&&s9(t,["parameters"],s);let o=s8(e,["parametersJsonSchema"]);null!=o&&s9(t,["parametersJsonSchema"],o);let a=s8(e,["response"]);null!=a&&s9(t,["response"],a);let l=s8(e,["responseJsonSchema"]);return null!=l&&s9(t,["responseJsonSchema"],l),t})(e))),s9(t,["functionDeclarations"],e)}if(void 0!==s8(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let n=s8(e,["googleSearch"]);null!=n&&s9(t,["googleSearch"],function(e){let t={},r=s8(e,["timeRangeFilter"]);if(null!=r&&s9(t,["timeRangeFilter"],function(e){let t={},r=s8(e,["startTime"]);null!=r&&s9(t,["startTime"],r);let n=s8(e,["endTime"]);return null!=n&&s9(t,["endTime"],n),t}(r)),void 0!==s8(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return t}(n));let i=s8(e,["googleSearchRetrieval"]);if(null!=i&&s9(t,["googleSearchRetrieval"],function(e){let t={},r=s8(e,["dynamicRetrievalConfig"]);return null!=r&&s9(t,["dynamicRetrievalConfig"],function(e){let t={},r=s8(e,["mode"]);null!=r&&s9(t,["mode"],r);let n=s8(e,["dynamicThreshold"]);return null!=n&&s9(t,["dynamicThreshold"],n),t}(r)),t}(i)),void 0!==s8(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==s8(e,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");null!=s8(e,["urlContext"])&&s9(t,["urlContext"],{});let s=s8(e,["computerUse"]);null!=s&&s9(t,["computerUse"],function(e){let t={},r=s8(e,["environment"]);null!=r&&s9(t,["environment"],r);let n=s8(e,["excludedPredefinedFunctions"]);return null!=n&&s9(t,["excludedPredefinedFunctions"],n),t}(s));let o=s8(e,["codeExecution"]);return null!=o&&s9(t,["codeExecution"],o),t})(oF(e)))),s9(t,["setup","tools"],e)}let f=s8(e,["sessionResumption"]);void 0!==t&&null!=f&&s9(t,["setup","sessionResumption"],function(e){let t={},r=s8(e,["handle"]);if(null!=r&&s9(t,["handle"],r),void 0!==s8(e,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return t}(f));let g=s8(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&s9(t,["setup","inputAudioTranscription"],{});let m=s8(e,["outputAudioTranscription"]);void 0!==t&&null!=m&&s9(t,["setup","outputAudioTranscription"],{});let y=s8(e,["realtimeInputConfig"]);void 0!==t&&null!=y&&s9(t,["setup","realtimeInputConfig"],function(e){let t={},r=s8(e,["automaticActivityDetection"]);null!=r&&s9(t,["automaticActivityDetection"],function(e){let t={},r=s8(e,["disabled"]);null!=r&&s9(t,["disabled"],r);let n=s8(e,["startOfSpeechSensitivity"]);null!=n&&s9(t,["startOfSpeechSensitivity"],n);let i=s8(e,["endOfSpeechSensitivity"]);null!=i&&s9(t,["endOfSpeechSensitivity"],i);let s=s8(e,["prefixPaddingMs"]);null!=s&&s9(t,["prefixPaddingMs"],s);let o=s8(e,["silenceDurationMs"]);return null!=o&&s9(t,["silenceDurationMs"],o),t}(r));let n=s8(e,["activityHandling"]);null!=n&&s9(t,["activityHandling"],n);let i=s8(e,["turnCoverage"]);return null!=i&&s9(t,["turnCoverage"],i),t}(y));let v=s8(e,["contextWindowCompression"]);void 0!==t&&null!=v&&s9(t,["setup","contextWindowCompression"],function(e){let t={},r=s8(e,["triggerTokens"]);null!=r&&s9(t,["triggerTokens"],r);let n=s8(e,["slidingWindow"]);return null!=n&&s9(t,["slidingWindow"],function(e){let t={},r=s8(e,["targetTokens"]);return null!=r&&s9(t,["targetTokens"],r),t}(n)),t}(v));let _=s8(e,["proactivity"]);return void 0!==t&&null!=_&&s9(t,["setup","proactivity"],function(e){let t={},r=s8(e,["proactiveAudio"]);return null!=r&&s9(t,["proactiveAudio"],r),t}(_)),{}}(i,r)),r}(e,o));let a=s8(t,["lockAdditionalFields"]);return void 0!==r&&null!=a&&s9(r,["fieldMask"],a),{}}(e,n,r)),r}(this.apiClient,e);n=s6("auth_tokens",s._url),i=s._query,delete s.config,delete s._url,delete s._query;let o=function(e,t){let r=null,n=e.bidiGenerateContentSetup;if("object"==typeof n&&null!==n&&"setup"in n){let t=n.setup;"object"==typeof t&&null!==t?(e.bidiGenerateContentSetup=t,r=t):delete e.bidiGenerateContentSetup}else void 0!==n&&delete e.bidiGenerateContentSetup;let i=e.fieldMask;if(r){let n=function(e){let t=[];for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)){let n=e[r];if("object"==typeof n&&null!=n&&Object.keys(n).length>0){let e=Object.keys(n).map(e=>`${r}.${e}`);t.push(...e)}else t.push(r)}return t.join(",")}(r);if(Array.isArray(null==t?void 0:t.lockAdditionalFields)&&(null==t?void 0:t.lockAdditionalFields.length)===0)n?e.fieldMask=n:delete e.fieldMask;else if((null==t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==i&&Array.isArray(i)&&i.length>0){let t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],r=[];i.length>0&&(r=i.map(e=>t.includes(e)?`generationConfig.${e}`:e));let s=[];n&&s.push(n),r.length>0&&s.push(...r),s.length>0?e.fieldMask=s.join(","):delete e.fieldMask}else delete e.fieldMask}else null!==i&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}(s,e.config);return this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json()).then(e=>(function(e){let t={},r=s8(e,["name"]);return null!=r&&s9(t,["name"],r),t})(e))}}}let a7="x-goog-api-key",le="https://www.googleapis.com/auth/cloud-platform";class lt{constructor(e){if(void 0!==e.apiKey){this.apiKey=e.apiKey;return}let t=function(e){let t;if(!e)return{scopes:[le]};if((t=e).scopes){if("string"==typeof t.scopes&&t.scopes!==le||Array.isArray(t.scopes)&&0>t.scopes.indexOf(le))throw Error(`Invalid auth scopes. Scopes must include: ${le}`)}else t.scopes=[le];return t}(e.googleAuthOptions);this.googleAuth=new s0.GoogleAuth(t)}async addAuthHeaders(e){if(void 0!==this.apiKey){if(this.apiKey.startsWith("auth_tokens/"))throw Error("Ephemeral tokens are only supported by the live API.");this.addKeyHeader(e);return}return this.addGoogleAuthHeaders(e)}addKeyHeader(e){if(null===e.get(a7)){if(void 0===this.apiKey)throw Error("Trying to set API key header but apiKey is not set");e.append(a7,this.apiKey)}}async addGoogleAuthHeaders(e){if(void 0===this.googleAuth)throw Error("Trying to set google-auth headers but googleAuth is unset");let t=await this.googleAuth.getRequestHeaders();for(let r in t)null===e.get(r)&&e.append(r,t[r])}}class lr{async download(e,t){if(e.downloadPath){let r=await ln(e,t);if(r instanceof oe){let t=(0,s1.createWriteStream)(e.downloadPath);s2.Readable.fromWeb(r.responseInternal.body).pipe(t)}else(0,s1.writeFile)(e.downloadPath,r,{encoding:"base64"},t=>{if(t)throw Error(`Failed to write file to ${e.downloadPath}: ${t}`)})}}}async function ln(e,t){var r,n,i;let s=oV(e.file);if(void 0!==s)return await t.request({path:`files/${s}:download`,httpMethod:"GET",queryParams:{alt:"media"},httpOptions:null==(r=e.config)?void 0:r.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal});if(oH(e.file)){let t=null==(i=e.file.video)?void 0:i.videoBytes;if("string"==typeof t)return t;throw Error("Failed to download generated video, Uri or videoBytes not found.")}if(o$(e.file)){let t=e.file.videoBytes;if("string"==typeof t)return t;throw Error("Failed to download video, Uri or videoBytes not found.")}throw Error("Unsupported file type")}class li{create(e,t,r){return new ls(e,t,r)}}class ls{constructor(e,t,r){this.url=e,this.headers=t,this.callbacks=r}connect(){this.ws=new s5.default(this.url,{headers:this.headers}),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.close()}}function lo(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["name"]);null!=n&&s9(t,["name"],n);let i=s8(e,["state"]);null!=i&&s9(t,["state"],oG(i));let s=s8(e,["createTime"]);null!=s&&s9(t,["createTime"],s);let o=s8(e,["tuningTask","startTime"]);null!=o&&s9(t,["startTime"],o);let a=s8(e,["tuningTask","completeTime"]);null!=a&&s9(t,["endTime"],a);let l=s8(e,["updateTime"]);null!=l&&s9(t,["updateTime"],l);let u=s8(e,["description"]);null!=u&&s9(t,["description"],u);let c=s8(e,["baseModel"]);null!=c&&s9(t,["baseModel"],c);let d=s8(e,["_self"]);null!=d&&s9(t,["tunedModel"],function(e){let t={},r=s8(e,["name"]);null!=r&&s9(t,["model"],r);let n=s8(e,["name"]);return null!=n&&s9(t,["endpoint"],n),t}(d));let h=s8(e,["customBaseModel"]);null!=h&&s9(t,["customBaseModel"],h);let p=s8(e,["experiment"]);null!=p&&s9(t,["experiment"],p);let f=s8(e,["labels"]);null!=f&&s9(t,["labels"],f);let g=s8(e,["outputUri"]);null!=g&&s9(t,["outputUri"],g);let m=s8(e,["pipelineJob"]);null!=m&&s9(t,["pipelineJob"],m);let y=s8(e,["serviceAccount"]);null!=y&&s9(t,["serviceAccount"],y);let v=s8(e,["tunedModelDisplayName"]);return null!=v&&s9(t,["tunedModelDisplayName"],v),t}function la(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["name"]);null!=n&&s9(t,["name"],n);let i=s8(e,["state"]);null!=i&&s9(t,["state"],oG(i));let s=s8(e,["createTime"]);null!=s&&s9(t,["createTime"],s);let o=s8(e,["startTime"]);null!=o&&s9(t,["startTime"],o);let a=s8(e,["endTime"]);null!=a&&s9(t,["endTime"],a);let l=s8(e,["updateTime"]);null!=l&&s9(t,["updateTime"],l);let u=s8(e,["error"]);null!=u&&s9(t,["error"],u);let c=s8(e,["description"]);null!=c&&s9(t,["description"],c);let d=s8(e,["baseModel"]);null!=d&&s9(t,["baseModel"],d);let h=s8(e,["tunedModel"]);null!=h&&s9(t,["tunedModel"],function(e){let t={},r=s8(e,["model"]);null!=r&&s9(t,["model"],r);let n=s8(e,["endpoint"]);null!=n&&s9(t,["endpoint"],n);let i=s8(e,["checkpoints"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["checkpointId"]);null!=r&&s9(t,["checkpointId"],r);let n=s8(e,["epoch"]);null!=n&&s9(t,["epoch"],n);let i=s8(e,["step"]);null!=i&&s9(t,["step"],i);let s=s8(e,["endpoint"]);return null!=s&&s9(t,["endpoint"],s),t})(e))),s9(t,["checkpoints"],e)}return t}(h));let p=s8(e,["preTunedModel"]);null!=p&&s9(t,["preTunedModel"],p);let f=s8(e,["supervisedTuningSpec"]);null!=f&&s9(t,["supervisedTuningSpec"],f);let g=s8(e,["tuningDataStats"]);null!=g&&s9(t,["tuningDataStats"],g);let m=s8(e,["encryptionSpec"]);null!=m&&s9(t,["encryptionSpec"],m);let y=s8(e,["partnerModelTuningSpec"]);null!=y&&s9(t,["partnerModelTuningSpec"],y);let v=s8(e,["customBaseModel"]);null!=v&&s9(t,["customBaseModel"],v);let _=s8(e,["experiment"]);null!=_&&s9(t,["experiment"],_);let b=s8(e,["labels"]);null!=b&&s9(t,["labels"],b);let E=s8(e,["outputUri"]);null!=E&&s9(t,["outputUri"],E);let S=s8(e,["pipelineJob"]);null!=S&&s9(t,["pipelineJob"],S);let w=s8(e,["serviceAccount"]);null!=w&&s9(t,["serviceAccount"],w);let T=s8(e,["tunedModelDisplayName"]);return null!=T&&s9(t,["tunedModelDisplayName"],T),t}class ll extends s3{constructor(e){super(),this.apiClient=e,this.get=async e=>await this.getInternal(e),this.list=async(e={})=>new o6(es.PAGED_ITEM_TUNING_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.tune=async e=>{var t;if(this.apiClient.isVertexAI())if(e.baseModel.startsWith("projects/")){let r={tunedModelName:e.baseModel};(null==(t=e.config)?void 0:t.preTunedModelCheckpointId)&&(r.checkpointId=e.config.preTunedModelCheckpointId);let n=Object.assign(Object.assign({},e),{preTunedModel:r});return n.baseModel=void 0,await this.tuneInternal(n)}else{let t=Object.assign({},e);return await this.tuneInternal(t)}{let t=Object.assign({},e),r=await this.tuneMldevInternal(t),n="";return void 0!==r.metadata&&void 0!==r.metadata.tunedModel?n=r.metadata.tunedModel:void 0!==r.name&&r.name.includes("/operations/")&&(n=r.name.split("/operations/")[0]),{name:n,state:x.JOB_STATE_QUEUED}}}}async getInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e){let t={},r=s8(e,["name"]);return null!=r&&s9(t,["_url","name"],r),t}(e);return s=s6("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>la(e))}{let t=function(e){let t={},r=s8(e,["name"]);return null!=r&&s9(t,["_url","name"],r),t}(e);return s=s6("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>lo(e))}}async listInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e){let t={},r=s8(e,["config"]);return null!=r&&function(e,t){let r=s8(e,["pageSize"]);void 0!==t&&null!=r&&s9(t,["_query","pageSize"],r);let n=s8(e,["pageToken"]);void 0!==t&&null!=n&&s9(t,["_query","pageToken"],n);let i=s8(e,["filter"]);void 0!==t&&null!=i&&s9(t,["_query","filter"],i)}(r,t),t}(e);return s=s6("tuningJobs",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["nextPageToken"]);null!=n&&s9(t,["nextPageToken"],n);let i=s8(e,["tuningJobs"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>la(e))),s9(t,["tuningJobs"],e)}return t}(e),r=new op;return Object.assign(r,t),r})}{let t=function(e){let t={},r=s8(e,["config"]);return null!=r&&function(e,t){let r=s8(e,["pageSize"]);void 0!==t&&null!=r&&s9(t,["_query","pageSize"],r);let n=s8(e,["pageToken"]);void 0!==t&&null!=n&&s9(t,["_query","pageToken"],n);let i=s8(e,["filter"]);void 0!==t&&null!=i&&s9(t,["_query","filter"],i)}(r,t),t}(e);return s=s6("tunedModels",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["nextPageToken"]);null!=n&&s9(t,["nextPageToken"],n);let i=s8(e,["tunedModels"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>lo(e))),s9(t,["tuningJobs"],e)}return t}(e),r=new op;return Object.assign(r,t),r})}}async cancel(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e){let t={},r=s8(e,["name"]);return null!=r&&s9(t,["_url","name"],r),t}(e);s=s6("{name}:cancel",n._url),o=n._query,delete n._url,delete n._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal})}else{let t=function(e){let t={},r=s8(e,["name"]);return null!=r&&s9(t,["_url","name"],r),t}(e);s=s6("{name}:cancel",t._url),o=t._query,delete t._url,delete t._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(n=e.config)?void 0:n.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal})}}async tuneInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e){let t={},r=s8(e,["baseModel"]);null!=r&&s9(t,["baseModel"],r);let n=s8(e,["preTunedModel"]);null!=n&&s9(t,["preTunedModel"],n);let i=s8(e,["trainingDataset"]);null!=i&&s9(t,["supervisedTuningSpec","trainingDatasetUri"],function(e,t){let r=s8(e,["gcsUri"]);void 0!==t&&null!=r&&s9(t,["supervisedTuningSpec","trainingDatasetUri"],r);let n=s8(e,["vertexDatasetResource"]);if(void 0!==t&&null!=n&&s9(t,["supervisedTuningSpec","trainingDatasetUri"],n),void 0!==s8(e,["examples"]))throw Error("examples parameter is not supported in Vertex AI.");return{}}(i,t));let s=s8(e,["config"]);return null!=s&&function(e,t){let r=s8(e,["validationDataset"]);void 0!==t&&null!=r&&s9(t,["supervisedTuningSpec"],function(e,t){let r={},n=s8(e,["gcsUri"]);null!=n&&s9(r,["validationDatasetUri"],n);let i=s8(e,["vertexDatasetResource"]);return void 0!==t&&null!=i&&s9(t,["supervisedTuningSpec","trainingDatasetUri"],i),r}(r,{}));let n=s8(e,["tunedModelDisplayName"]);void 0!==t&&null!=n&&s9(t,["tunedModelDisplayName"],n);let i=s8(e,["description"]);void 0!==t&&null!=i&&s9(t,["description"],i);let s=s8(e,["epochCount"]);void 0!==t&&null!=s&&s9(t,["supervisedTuningSpec","hyperParameters","epochCount"],s);let o=s8(e,["learningRateMultiplier"]);void 0!==t&&null!=o&&s9(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],o);let a=s8(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=a&&s9(t,["supervisedTuningSpec","exportLastCheckpointOnly"],a);let l=s8(e,["adapterSize"]);if(void 0!==t&&null!=l&&s9(t,["supervisedTuningSpec","hyperParameters","adapterSize"],l),void 0!==s8(e,["batchSize"]))throw Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==s8(e,["learningRate"]))throw Error("learningRate parameter is not supported in Vertex AI.");let u=s8(e,["labels"]);void 0!==t&&null!=u&&s9(t,["labels"],u)}(s,t),t}(e);return n=s6("tuningJobs",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>la(e))}throw Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=s8(e,["baseModel"]);null!=r&&s9(t,["baseModel"],r);let n=s8(e,["preTunedModel"]);null!=n&&s9(t,["preTunedModel"],n);let i=s8(e,["trainingDataset"]);null!=i&&s9(t,["tuningTask","trainingData"],function(e){let t={};if(void 0!==s8(e,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==s8(e,["vertexDatasetResource"]))throw Error("vertexDatasetResource parameter is not supported in Gemini API.");let r=s8(e,["examples"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=s8(e,["textInput"]);null!=r&&s9(t,["textInput"],r);let n=s8(e,["output"]);return null!=n&&s9(t,["output"],n),t})(e))),s9(t,["examples","examples"],e)}return t}(i));let s=s8(e,["config"]);return null!=s&&function(e,t){if(void 0!==s8(e,["validationDataset"]))throw Error("validationDataset parameter is not supported in Gemini API.");let r=s8(e,["tunedModelDisplayName"]);if(void 0!==t&&null!=r&&s9(t,["displayName"],r),void 0!==s8(e,["description"]))throw Error("description parameter is not supported in Gemini API.");let n=s8(e,["epochCount"]);void 0!==t&&null!=n&&s9(t,["tuningTask","hyperparameters","epochCount"],n);let i=s8(e,["learningRateMultiplier"]);if(null!=i&&s9({},["tuningTask","hyperparameters","learningRateMultiplier"],i),void 0!==s8(e,["exportLastCheckpointOnly"]))throw Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==s8(e,["preTunedModelCheckpointId"]))throw Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==s8(e,["adapterSize"]))throw Error("adapterSize parameter is not supported in Gemini API.");let s=s8(e,["batchSize"]);void 0!==t&&null!=s&&s9(t,["tuningTask","hyperparameters","batchSize"],s);let o=s8(e,["learningRate"]);if(void 0!==t&&null!=o&&s9(t,["tuningTask","hyperparameters","learningRate"],o),void 0!==s8(e,["labels"]))throw Error("labels parameter is not supported in Gemini API.")}(s,t),t}(e);return n=s6("tunedModels",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(r=e.config)?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>(function(e){let t={},r=s8(e,["sdkHttpResponse"]);null!=r&&s9(t,["sdkHttpResponse"],r);let n=s8(e,["name"]);null!=n&&s9(t,["name"],n);let i=s8(e,["metadata"]);null!=i&&s9(t,["metadata"],i);let s=s8(e,["done"]);null!=s&&s9(t,["done"],s);let o=s8(e,["error"]);return null!=o&&s9(t,["error"],o),t})(e))}}}let lu="x-goog-upload-status";async function lc(e,t,r){var n,i,s;let o=0,a=0,l=new oe(new Response),u="upload";for(o=e.size;a<o;){let s=Math.min(8388608,o-a),c=e.slice(a,a+s);a+s>=o&&(u+=", finalize");let d=0,h=1e3;for(;d<3&&(null==(n=null==(l=await r.request({path:"",body:c,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(s)}}}))?void 0:l.headers)||!n[lu]);)d++,await lh(h),h*=2;if(a+=s,(null==(i=null==l?void 0:l.headers)?void 0:i[lu])!=="active")break;if(o<=a)throw Error("All content has been uploaded, but the upload status is not finalized.")}let c=await (null==l?void 0:l.json());if((null==(s=null==l?void 0:l.headers)?void 0:s[lu])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return c.file}async function ld(e){return{size:e.size,type:e.type}}function lh(e){return new Promise(t=>setTimeout(t,e))}class lp{async stat(e){let t={size:0,type:void 0};return"string"==typeof e?(t.size=(await s4.stat(e)).size,t.type=this.inferMimeType(e),t):await ld(e)}async upload(e,t,r){return"string"==typeof e?await this.uploadFileFromPath(e,t,r):lc(e,t,r)}inferMimeType(e){return({aac:"audio/aac",abw:"application/x-abiword",arc:"application/x-freearc",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bmp:"image/bmp",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gz:"application/gzip",gif:"image/gif",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"text/javascript",json:"application/json",jsonld:"application/ld+json",kml:"application/vnd.google-earth.kml+xml",kmz:"application/vnd.google-earth.kmz+xml",mjs:"text/javascript",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",opus:"audio/opus",otf:"font/otf",png:"image/png",pdf:"application/pdf",php:"application/x-httpd-php",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/vnd.rar",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",ts:"video/mp2t",ttf:"font/ttf",txt:"text/plain",vsd:"application/vnd.visio",wav:"audio/wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip","3gp":"video/3gpp","3g2":"video/3gpp2","7z":"application/x-7z-compressed"})[e.slice(e.lastIndexOf(".")+1).toLowerCase()]}async uploadFileFromPath(e,t,r){var n,i,s;let o,a=0,l=0,u=new oe(new Response),c="upload";try{if(!(o=await s4.open(e,"r")))throw Error("Failed to open file");for(a=(await o.stat()).size;l<a;){let e=Math.min(8388608,a-l);l+e>=a&&(c+=", finalize");let s=new Uint8Array(e),{bytesRead:d}=await o.read(s,0,e,l);if(d!==e)throw Error(`Failed to read ${e} bytes from file at offset ${l}. bytes actually read: ${d}`);let h=new Blob([s]),p=0,f=1e3;for(;p<3&&(null==(n=null==(u=await r.request({path:"",body:h,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(l),"Content-Length":String(d)}}}))?void 0:u.headers)||!n[lu]);)p++,await lh(f),f*=2;if(l+=d,(null==(i=null==u?void 0:u.headers)?void 0:i[lu])!=="active")break;if(a<=l)throw Error("All content has been uploaded, but the upload status is not finalized.")}let d=await (null==u?void 0:u.json());if((null==(s=null==u?void 0:u.headers)?void 0:s[lu])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return d.file}finally{o&&await o.close()}}}function lf(e){var t,r,n;return null!=(n=null==(r=null==(t=null==process?void 0:process.env)?void 0:t[e])?void 0:r.trim())?n:void 0}let lg=new class{constructor(e){var t,r,n,o,a,l;if((e.project||e.location)&&e.apiKey)throw Error("Project/location and API key are mutually exclusive in the client initializer.");this.vertexai=null!=(r=null!=(t=e.vertexai)?t:function(e){var t;return void 0!==(t=lf(e))&&"true"===t.toLowerCase()}("GOOGLE_GENAI_USE_VERTEXAI"))&&r;let u=function(){let e=lf("GOOGLE_API_KEY"),t=lf("GEMINI_API_KEY");return e&&t&&console.warn("Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY."),e||t||void 0}(),c=lf("GOOGLE_CLOUD_PROJECT"),d=lf("GOOGLE_CLOUD_LOCATION");this.apiKey=null!=(n=e.apiKey)?n:u,this.project=null!=(o=e.project)?o:c,this.location=null!=(a=e.location)?a:d,e.vertexai&&((null==(l=e.googleAuthOptions)?void 0:l.credentials)&&(console.debug("The user provided Google Cloud credentials will take precedence over the API key from the environment variable."),this.apiKey=void 0),(c||d)&&e.apiKey?(console.debug("The user provided Vertex AI API key will take precedence over the project/location from the environment variables."),this.project=void 0,this.location=void 0):(e.project||e.location)&&u?(console.debug("The user provided project/location will take precedence over the API key from the environment variables."),this.apiKey=void 0):(c||d)&&u&&(console.debug("The project/location from the environment variables will take precedence over the API key from the environment variables."),this.apiKey=void 0));let h=function(e,t,r,n){return(null==e?void 0:e.baseUrl)?e.baseUrl:t?null!=s?s:r:null!=i?i:n}(e.httpOptions,e.vertexai,lf("GOOGLE_VERTEX_BASE_URL"),lf("GOOGLE_GEMINI_BASE_URL"));h&&(e.httpOptions?e.httpOptions.baseUrl=h:e.httpOptions={baseUrl:h}),this.apiVersion=e.apiVersion;let p=new lt({apiKey:this.apiKey,googleAuthOptions:e.googleAuthOptions});this.apiClient=new a$({auth:p,project:this.project,location:this.location,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:"gl-node/"+process.version,uploader:new lp,downloader:new lr}),this.models=new a3(this.apiClient),this.live=new aQ(this.apiClient,p,new li),this.batches=new o9(this.apiClient),this.chats=new al(this.models,this.apiClient),this.caches=new ar(this.apiClient),this.files=new ah(this.apiClient),this.operations=new a6(this.apiClient),this.authTokens=new a8(this.apiClient),this.tunings=new ll(this.apiClient)}}({apiKey:process.env.GEMINI_API_KEY}),lm=sZ.createFunction({name:"Generate Industry Insights"},{cron:"0 0 * * 0"},async({step:e})=>{for(let{industry:t}of(await e.run("Fetch industries",async()=>sQ.industryInsight.findMany({select:{industry:!0}})))){let r,n=`
        Analyze the current state of the ${t} industry and provide insights in ONLY the following JSON format:
        {
          "salaryRanges": [
            { "role": "string", "min": number, "max": number, "median": number, "location": "string" }
          ],
          "growthRate": number,
          "demandLevel": "High" | "Medium" | "Low",
          "topSkills": ["skill1", "skill2"],
          "marketOutlook": "Positive" | "Neutral" | "Negative",
          "keyTrends": ["trend1", "trend2"],
          "recommendedSkills": ["skill1", "skill2"]
        }
        IMPORTANT: Return ONLY the JSON. Include at least 5 roles and 5 skills/trends. No notes or markdown.
      `,i=(await e.ai.wrap("gemini",async e=>(await lg.generate({model:"gemini-2.0-flash",input:e})).outputText||"",n)).replace(/```(?:json)?\n?/g,"").trim();try{r=JSON.parse(i)}catch(e){console.warn(`Failed to parse insights for ${t}:`,e.message),r={salaryRanges:[{role:"Example Role",min:0,max:0,median:0,location:"Unknown"}],growthRate:0,demandLevel:"Medium",topSkills:[],marketOutlook:"Neutral",keyTrends:[],recommendedSkills:[]}}await e.run(`Update ${t} insights`,async()=>{await sQ.industryInsight.update({where:{industry:t},data:{...r,lastUpdated:new Date,nextUpdate:new Date(Date.now()+6048e5)}})})}}),{GET:ly,POST:lv,PUT:l_}=(e=>{let t=new sc({frameworkName:"nextjs",...e,handler:(t,...r)=>{let[n,i]=r,s=e=>{let t="function"==typeof n.headers.get?n.headers.get(e):n.headers[e];return Array.isArray(t)?t[0]:t};return{body:()=>"function"==typeof n.json?n.json():n.body,headers:s,method:()=>t||n.method||"",isProduction:()=>{try{return!0}catch(e){}},queryString:(e,t)=>{let r=n.query?.[e]||t.searchParams.get(e);return Array.isArray(r)?r[0]:r},url:()=>{let t;try{t=new URL(n.url)}catch{}if(t){let r=e.serveHost||s("host");if(r){let e=new URL(r.includes("://")?r:`${t.protocol}//${r}`);t.protocol=e.protocol,t.host=e.host,t.port=e.port,t.username=e.username,t.password=e.password}return t}let r=e.serveHost||s("host")||"";return new URL(n.url,`https://${r}`)},transformResponse:({body:e,headers:t,status:r})=>{if((e=>(e=>"object"==typeof e&&null!==e)(e)&&"function"==typeof e.setHeader&&"function"==typeof e.status&&"function"==typeof e.send)(i)){for(let[e,r]of Object.entries(t))i.setHeader(e,r);i.status(r),i.send(e);return}return new("undefined"!=typeof Response?Response:(0,tH("cross-fetch").Response))(e,{status:r,headers:t})},transformStreamingResponse:({body:e,headers:t,status:r})=>new Response(e,{status:r,headers:t})}}}).createHandler(),r=t.bind(null,void 0);return Object.defineProperty(r,"length",{value:1}),Object.defineProperties(r,{GET:{value:t.bind(null,"GET")},POST:{value:t.bind(null,"POST")},PUT:{value:t.bind(null,"PUT")}})})({client:sZ,functions:[lm]});var lb=e.i(91762);let lE=new eo.AppRouteRouteModule({definition:{kind:ea.APP_ROUTE,page:"/api/inngest/route",pathname:"/api/inngest",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/inngest/route.js",nextConfigOutput:"",userland:lb}),{workAsyncStorage:lS,workUnitAsyncStorage:lw,serverHooks:lT}=lE;function lC(){if(!0===globalThis[tO])return;let e=function(e){let t=eL.cache(e=>[]);return function(r,n){let i,s;if(n&&n.signal)return e(r,n);if("string"!=typeof r||n){let t="string"==typeof r||r instanceof URL?new Request(r,n):r;if("GET"!==t.method&&"HEAD"!==t.method||t.keepalive)return e(r,n);s=JSON.stringify([t.method,Array.from(t.headers.entries()),t.mode,t.redirect,t.credentials,t.referrer,t.referrerPolicy,t.integrity]),i=t.url}else s='["GET",[],null,"follow",null,null,null,null]',i=r;let o=t(i);for(let e=0,t=o.length;e<t;e+=1){let[t,r]=o[e];if(t===s)return r.then(()=>{let t=o[e][2];if(!t)throw Object.defineProperty(new eK("No cached response"),"__NEXT_ERROR_CODE",{value:"E579",enumerable:!1,configurable:!0});let[r,n]=eZ(t);return o[e][2]=n,r})}let a=e(r,n),l=[s,a,null];return o.push(l),a.then(e=>{let[t,r]=eZ(e);return l[2]=r,t})}}(globalThis.fetch);globalThis.fetch=function(e,{workAsyncStorage:t,workUnitAsyncStorage:r}){let n=async function(n,i){var s,o;let a;try{(a=new URL(n instanceof Request?n.url:n)).username="",a.password=""}catch{a=void 0}let l=(null==a?void 0:a.href)??"",u=(null==i||null==(s=i.method)?void 0:s.toUpperCase())||"GET",c=(null==i||null==(o=i.next)?void 0:o.internal)===!0,d="1"===process.env.NEXT_OTEL_FETCH_DISABLED,h=c?void 0:performance.timeOrigin+performance.now(),p=t.getStore(),f=r.getStore(),g=f?(0,eq.getCacheSignal)(f):null;g&&g.beginRead();let m=eM().trace(c?ed.internalFetch:ef.fetch,{hideSpan:d,kind:eA.CLIENT,spanName:["fetch",u,l].filter(Boolean).join(" "),attributes:{"http.url":l,"http.method":u,"net.peer.name":null==a?void 0:a.hostname,"net.peer.port":(null==a?void 0:a.port)||void 0}},async()=>{var t;let r,s,o,a,u,d;if(c||!p||p.isDraftMode)return e(n,i);let m=n&&"object"==typeof n&&"string"==typeof n.method,y=e=>(null==i?void 0:i[e])||(m?n[e]:null),v=e=>{var t,r,s;return void 0!==(null==i||null==(t=i.next)?void 0:t[e])?null==i||null==(r=i.next)?void 0:r[e]:m?null==(s=n.next)?void 0:s[e]:void 0},_=v("revalidate"),b=_,E=function(e,t){let r=[],n=[];for(let i=0;i<e.length;i++){let s=e[i];if("string"!=typeof s?n.push({tag:s,reason:"invalid type, must be a string"}):s.length>256?n.push({tag:s,reason:"exceeded max length of 256"}):r.push(s),r.length>128){console.warn(`Warning: exceeded max tag count for ${t}, dropped tags:`,e.slice(i).join(", "));break}}if(n.length>0)for(let{tag:e,reason:r}of(console.warn(`Warning: invalid tags passed to ${t}: `),n))console.log(`tag: "${e}" ${r}`);return r}(v("tags")||[],`fetch ${n.toString()}`);if(f)switch(f.type){case"prerender":case"prerender-runtime":case"prerender-client":case"prerender-ppr":case"prerender-legacy":case"cache":case"private-cache":r=f}if(r&&Array.isArray(E)){let e=r.tags??(r.tags=[]);for(let t of E)e.includes(t)||e.push(t)}let S=null==f?void 0:f.implicitTags,w=p.fetchCache;f&&"unstable-cache"===f.type&&(w="force-no-store");let T=!!p.isUnstableNoStore,C=y("cache"),A="";"string"==typeof C&&void 0!==b&&("force-cache"===C&&0===b||"no-store"===C&&(b>0||!1===b))&&(s=`Specified "cache: ${C}" and "revalidate: ${b}", only one should be specified.`,C=void 0,b=void 0);let O="no-cache"===C||"no-store"===C||"force-no-store"===w||"only-no-store"===w,x=!w&&!C&&!b&&p.forceDynamic;"force-cache"===C&&void 0===b?b=!1:(O||x)&&(b=0),("no-cache"===C||"no-store"===C)&&(A=`cache: ${C}`),d=function(e,t){try{let r;if(!1===e)r=0xfffffffe;else if("number"==typeof e&&!isNaN(e)&&e>-1)r=e;else if(void 0!==e)throw Object.defineProperty(Error(`Invalid revalidate value "${e}" on "${t}", must be a non-negative number or false`),"__NEXT_ERROR_CODE",{value:"E179",enumerable:!1,configurable:!0});return r}catch(e){if(e instanceof Error&&e.message.includes("Invalid revalidate"))throw e;return}}(b,p.route);let I=y("headers"),k="function"==typeof(null==I?void 0:I.get)?I:new Headers(I||{}),R=k.get("authorization")||k.get("cookie"),P=!["get","head"].includes((null==(t=y("method"))?void 0:t.toLowerCase())||"get"),N=void 0==w&&(void 0==C||"default"===C)&&void 0==b,D=!!((R||P)&&(null==r?void 0:r.revalidate)===0),M=!1;if(!D&&N&&(p.isBuildTimePrerendering?M=!0:D=!0),N&&void 0!==f)switch(f.type){case"prerender":case"prerender-runtime":case"prerender-client":return g&&(g.endRead(),g=null),e$(f.renderSignal,p.route,"fetch()")}switch(w){case"force-no-store":A="fetchCache = force-no-store";break;case"only-no-store":if("force-cache"===C||void 0!==d&&d>0)throw Object.defineProperty(Error(`cache: 'force-cache' used on fetch for ${l} with 'export const fetchCache = 'only-no-store'`),"__NEXT_ERROR_CODE",{value:"E448",enumerable:!1,configurable:!0});A="fetchCache = only-no-store";break;case"only-cache":if("no-store"===C)throw Object.defineProperty(Error(`cache: 'no-store' used on fetch for ${l} with 'export const fetchCache = 'only-cache'`),"__NEXT_ERROR_CODE",{value:"E521",enumerable:!1,configurable:!0});break;case"force-cache":(void 0===b||0===b)&&(A="fetchCache = force-cache",d=0xfffffffe)}if(void 0===d?"default-cache"!==w||T?"default-no-store"===w?(d=0,A="fetchCache = default-no-store"):T?(d=0,A="noStore call"):D?(d=0,A="auto no cache"):(A="auto cache",d=r?r.revalidate:0xfffffffe):(d=0xfffffffe,A="fetchCache = default-cache"):A||(A=`revalidate: ${d}`),!(p.forceStatic&&0===d)&&!D&&r&&d<r.revalidate){if(0===d){if(f)switch(f.type){case"prerender":case"prerender-client":case"prerender-runtime":return g&&(g.endRead(),g=null),e$(f.renderSignal,p.route,"fetch()")}eJ(p,f,`revalidate: 0 fetch ${n} ${p.route}`)}r&&_===d&&(r.revalidate=d)}let j="number"==typeof d&&d>0,{incrementalCache:U}=p,L=!1;if(f)switch(f.type){case"request":case"cache":case"private-cache":L=f.isHmrRefresh??!1,a=f.serverComponentsHmrCache}if(U&&(j||a))try{o=await U.generateCacheKey(l,m?n:i)}catch(e){console.error("Failed to generate cache key for",n)}let F=p.nextFetchId??1;p.nextFetchId=F+1;let B=()=>{},q=async(t,r)=>{let u=["cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","window","duplex",...t?[]:["signal"]];if(m){let e=n,t={body:e._ogBody||e.body};for(let r of u)t[r]=e[r];n=new Request(e.url,t)}else if(i){let{_ogBody:e,body:r,signal:n,...s}=i;i={...s,body:e||r,signal:t?void 0:n}}let c={...i,next:{...null==i?void 0:i.next,fetchType:"origin",fetchIdx:F}};return e(n,c).then(async e=>{if(!t&&h&&tx(p,{start:h,url:l,cacheReason:r||A,cacheStatus:0===d||r?"skip":"miss",cacheWarning:s,status:e.status,method:c.method||"GET"}),200===e.status&&U&&o&&(j||a)){let t=d>=0xfffffffe?31536e3:d,r=j?{fetchCache:!0,fetchUrl:l,fetchIdx:F,tags:E,isImplicitBuildTimeCache:M}:void 0;switch(null==f?void 0:f.type){case"prerender":case"prerender-client":case"prerender-runtime":return tI(e,o,r,U,t,B);case"prerender-ppr":case"prerender-legacy":case"request":case"cache":case"private-cache":case"unstable-cache":case void 0:return tk(p,e,o,r,U,a,t,n,B)}}return await B(),e}).catch(e=>{throw B(),e})},G=!1,H=!1;if(o&&U){let e;if(L&&a&&(e=a.get(o),H=!0),j&&!e){B=await U.lock(o);let t=p.isOnDemandRevalidate?null:await U.get(o,{kind:e0.FETCH,revalidate:d,fetchUrl:l,fetchIdx:F,tags:E,softTags:null==S?void 0:S.tags});if(N&&f)switch(f.type){case"prerender":case"prerender-client":case"prerender-runtime":await new Promise(e=>setImmediate(e))}if(t?await B():u="cache-control: no-cache (hard refresh)",(null==t?void 0:t.value)&&t.value.kind===eQ.FETCH)if(p.isRevalidate&&t.isStale)G=!0;else{if(t.isStale&&(p.pendingRevalidates??={},!p.pendingRevalidates[o])){let e=q(!0).then(async e=>({body:await e.arrayBuffer(),headers:e.headers,status:e.status,statusText:e.statusText})).finally(()=>{p.pendingRevalidates??={},delete p.pendingRevalidates[o||""]});e.catch(console.error),p.pendingRevalidates[o]=e}e=t.value.data}}if(e){h&&tx(p,{start:h,url:l,cacheReason:A,cacheStatus:H?"hmr":"hit",cacheWarning:s,status:e.status||200,method:(null==i?void 0:i.method)||"GET"});let t=new Response(Buffer.from(e.body,"base64"),{headers:e.headers,status:e.status});return Object.defineProperty(t,"url",{value:e.url}),t}}if(p.isStaticGeneration&&i&&"object"==typeof i){let{cache:e}=i;if("no-store"===e){if(f)switch(f.type){case"prerender":case"prerender-client":case"prerender-runtime":return g&&(g.endRead(),g=null),e$(f.renderSignal,p.route,"fetch()")}eJ(p,f,`no-store fetch ${n} ${p.route}`)}let t="next"in i,{next:s={}}=i;if("number"==typeof s.revalidate&&r&&s.revalidate<r.revalidate){if(0===s.revalidate){if(f)switch(f.type){case"prerender":case"prerender-client":case"prerender-runtime":return e$(f.renderSignal,p.route,"fetch()")}eJ(p,f,`revalidate: 0 fetch ${n} ${p.route}`)}p.forceStatic&&0===s.revalidate||(r.revalidate=s.revalidate)}t&&delete i.next}if(!o||!G)return q(!1,u);{let e=o;p.pendingRevalidates??={};let t=p.pendingRevalidates[e];if(t){let e=await t;return new Response(e.body,{headers:e.headers,status:e.status,statusText:e.statusText})}let r=q(!0,u).then(eZ);return(t=r.then(async e=>{let t=e[0];return{body:await t.arrayBuffer(),headers:t.headers,status:t.status,statusText:t.statusText}}).finally(()=>{var t;(null==(t=p.pendingRevalidates)?void 0:t[e])&&delete p.pendingRevalidates[e]})).catch(()=>{}),p.pendingRevalidates[e]=t,r.then(e=>e[1])}});if(g)try{return await m}finally{g&&g.endRead()}return m};return n.__nextPatched=!0,n.__nextGetStaticStore=()=>t,n._nextOriginalFetch=e,globalThis[tO]=!0,Object.defineProperty(n,"name",{value:"fetch",writable:!1}),n}(e,{workAsyncStorage:lS,workUnitAsyncStorage:lw})}async function lA(e,t,r){var n,i;let s="/api/inngest/route";s=s.replace(/\/index$/,"")||"/";let o=await lE.prepare(e,t,{srcPage:s,multiZoneDraftMode:!1});if(!o)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:a,params:l,nextConfig:u,isDraftMode:c,prerenderManifest:d,routerServerContext:h,isOnDemandRevalidate:p,revalidateOnlyGenerated:f,resolvedPathname:g}=o,m=(i=s.split("/").reduce((e,t,r,n)=>t?"("===t[0]&&t.endsWith(")")||"@"===t[0]||("page"===t||"route"===t)&&r===n.length-1?e:e+"/"+t:e,"")).startsWith("/")?i:"/"+i,y=!!(d.dynamicRoutes[m]||d.routes[g]);if(y&&!c){let e=!!d.routes[g],t=d.dynamicRoutes[m];if(t&&!1===t.fallback&&!e)throw new tG.NoFallbackError}let v=null;!y||lE.isDev||c||(v="/index"===(v=g)?"/":v);let _=!0===lE.isDev||!y,b=y&&!_,E=e.method||"GET",S=eM(),w=S.getActiveScopeSpan(),T={params:l,prerenderManifest:d,renderOpts:{experimental:{cacheComponents:!!u.experimental.cacheComponents,authInterrupts:!!u.experimental.authInterrupts},supportsDynamicResponse:_,incrementalCache:e9(e,"incrementalCache"),cacheLifeProfiles:null==(n=u.experimental)?void 0:n.cacheLife,isRevalidate:b,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>lE.onRequestError(e,t,n,h)},sharedContext:{buildId:a}},C=new tL(e),A=new tF(t),O=tb.fromNodeNextRequest(C,function(e){let{errored:t,destroyed:r}=e;if(t||r)return AbortSignal.abort(t??new tv);let{signal:n}=t_(e);return n}(t));try{let n=async r=>lE.handle(O,T).finally(()=>{if(!r)return;r.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let n=S.getRootSpanAttributes();if(!n)return;if(n.get("next.span_type")!==el.handleRequest)return void console.warn(`Unexpected root span type '${n.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let i=n.get("next.route");if(i){let e=`${E} ${i}`;r.setAttributes({"next.route":i,"http.route":i,"next.span_name":e}),r.updateName(e)}else r.updateName(`${E} ${e.url}`)}),i=async i=>{var o,a;let l=async({previousCacheEntry:o})=>{try{if(!e9(e,"minimalMode")&&p&&f&&!o)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await n(i);e.fetchMetrics=T.renderOpts.fetchMetrics;let a=T.renderOpts.pendingWaitUntil;a&&r.waitUntil&&(r.waitUntil(a),a=void 0);let l=T.renderOpts.collectedTags;if(!y)return await tq(C,A,s,T.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=te(s.headers);l&&(t[ej]=l),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==T.renderOpts.collectedRevalidate&&!(T.renderOpts.collectedRevalidate>=0xfffffffe)&&T.renderOpts.collectedRevalidate,n=void 0===T.renderOpts.collectedExpire||T.renderOpts.collectedExpire>=0xfffffffe?void 0:T.renderOpts.collectedExpire;return{value:{kind:eQ.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==o?void 0:o.isStale)&&await lE.onRequestError(e,t,{routerKind:"App Router",routePath:s,routeType:"route",revalidateReason:tB({isRevalidate:b,isOnDemandRevalidate:p})},h),t}},g=await lE.handleResponse({req:e,nextConfig:u,cacheKey:v,routeKind:ea.APP_ROUTE,isFallback:!1,prerenderManifest:d,isRoutePPREnabled:!1,isOnDemandRevalidate:p,revalidateOnlyGenerated:f,responseGenerator:l,waitUntil:r.waitUntil});if(!y)return null;if((null==g||null==(o=g.value)?void 0:o.kind)!==eQ.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==g||null==(a=g.value)?void 0:a.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});e9(e,"minimalMode")||t.setHeader("x-nextjs-cache",p?"REVALIDATED":g.isMiss?"MISS":g.isStale?"STALE":"HIT"),c&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=e8(g.value.headers);return e9(e,"minimalMode")&&y||m.delete(ej),!g.cacheControl||t.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",function({revalidate:e,expire:t}){let r="number"==typeof e&&void 0!==t&&e<t?`, stale-while-revalidate=${t-e}`:"";return 0===e?"private, no-cache, no-store, max-age=0, must-revalidate":"number"==typeof e?`s-maxage=${e}${r}`:`s-maxage=31536000${r}`}(g.cacheControl)),await tq(C,A,new Response(g.value.body,{headers:m,status:g.value.status||200})),null};w?await i(w):await S.withPropagatedContext(e.headers,()=>S.trace(el.handleRequest,{spanName:`${E} ${e.url}`,kind:eA.SERVER,attributes:{"http.method":E,"http.target":e.url}},i))}catch(t){if(w||t instanceof tG.NoFallbackError||await lE.onRequestError(e,t,{routerKind:"App Router",routePath:m,routeType:"route",revalidateReason:tB({isRevalidate:b,isOnDemandRevalidate:p})}),y)throw t;return await tq(C,A,new Response(null,{status:500})),null}}}];

//# sourceMappingURL=%5Broot-of-the-server%5D__e5ac657b._.js.map