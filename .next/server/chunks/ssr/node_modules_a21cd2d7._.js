module.exports=[53255,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GCE_LINUX_BIOS_PATHS=void 0,c.isGoogleCloudServerless=f,c.isGoogleComputeEngineLinux=g,c.isGoogleComputeEngineMACAddress=h,c.isGoogleComputeEngine=i,c.detectGCPResidency=function(){return f()||i()},a.r(22734);let d=a.r(46786);c.GCE_LINUX_BIOS_PATHS={BIOS_DATE:"/sys/class/dmi/id/bios_date",BIOS_VENDOR:"/sys/class/dmi/id/bios_vendor"};let e=/^42:01/;function f(){return!!(process.env.CLOUD_RUN_JOB||process.env.FUNCTION_NAME||process.env.K_SERVICE)}function g(){if("linux"!==(0,d.platform)())return!1}function h(){for(let a of Object.values((0,d.networkInterfaces)()))if(a){for(let{mac:b}of a)if(e.test(b))return!0}return!1}function i(){return g()||h()}},48256,(a,b,c)=>{function d(a,b,c,d){return Math.round(a/c)+" "+d+(b>=1.5*c?"s":"")}b.exports=function(a,b){b=b||{};var c,e,f,g,h=typeof a;if("string"===h&&a.length>0){var i=a;if(!((i=String(i)).length>100)){var j=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(j){var k=parseFloat(j[1]);switch((j[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*k;case"weeks":case"week":case"w":return 6048e5*k;case"days":case"day":case"d":return 864e5*k;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*k;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*k;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*k;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return k;default:break}}}return}if("number"===h&&isFinite(a)){return b.long?(e=Math.abs(c=a))>=864e5?d(c,e,864e5,"day"):e>=36e5?d(c,e,36e5,"hour"):e>=6e4?d(c,e,6e4,"minute"):e>=1e3?d(c,e,1e3,"second"):c+" ms":(g=Math.abs(f=a))>=864e5?Math.round(f/864e5)+"d":g>=36e5?Math.round(f/36e5)+"h":g>=6e4?Math.round(f/6e4)+"m":g>=1e3?Math.round(f/1e3)+"s":f+"ms"}throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))}},93830,(a,b,c)=>{b.exports=function(b){function c(a){let b,e,f,g=null;function h(...a){if(!h.enabled)return;let d=Number(new Date);h.diff=d-(b||d),h.prev=b,h.curr=d,b=d,a[0]=c.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");let e=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(b,d)=>{if("%%"===b)return"%";e++;let f=c.formatters[d];if("function"==typeof f){let c=a[e];b=f.call(h,c),a.splice(e,1),e--}return b}),c.formatArgs.call(h,a),(h.log||c.log).apply(h,a)}return h.namespace=a,h.useColors=c.useColors(),h.color=c.selectColor(a),h.extend=d,h.destroy=c.destroy,Object.defineProperty(h,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==g?g:(e!==c.namespaces&&(e=c.namespaces,f=c.enabled(a)),f),set:a=>{g=a}}),"function"==typeof c.init&&c.init(h),h}function d(a,b){let d=c(this.namespace+(void 0===b?":":b)+a);return d.log=this.log,d}function e(a,b){let c=0,d=0,e=-1,f=0;for(;c<a.length;)if(d<b.length&&(b[d]===a[c]||"*"===b[d]))"*"===b[d]?(e=d,f=c):c++,d++;else{if(-1===e)return!1;d=e+1,c=++f}for(;d<b.length&&"*"===b[d];)d++;return d===b.length}return c.debug=c,c.default=c,c.coerce=function(a){return a instanceof Error?a.stack||a.message:a},c.disable=function(){let a=[...c.names,...c.skips.map(a=>"-"+a)].join(",");return c.enable(""),a},c.enable=function(a){for(let b of(c.save(a),c.namespaces=a,c.names=[],c.skips=[],("string"==typeof a?a:"").trim().replace(/\s+/g,",").split(",").filter(Boolean)))"-"===b[0]?c.skips.push(b.slice(1)):c.names.push(b)},c.enabled=function(a){for(let b of c.skips)if(e(a,b))return!1;for(let b of c.names)if(e(a,b))return!0;return!1},c.humanize=a.r(48256),c.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(b).forEach(a=>{c[a]=b[a]}),c.names=[],c.skips=[],c.formatters={},c.selectColor=function(a){let b=0;for(let c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c)|0;return c.colors[Math.abs(b)%c.colors.length]},c.enable(c.load()),c}},36354,(a,b,c)=>{"use strict";b.exports=(a,b=process.argv)=>{let c=a.startsWith("-")?"":1===a.length?"-":"--",d=b.indexOf(c+a),e=b.indexOf("--");return -1!==d&&(-1===e||d<e)}},45681,(a,b,c)=>{"use strict";let d;a.r(46786);let e=a.r(70722),f=a.r(36354),{env:g}=process;function h(a){return 0!==a&&{level:a,hasBasic:!0,has256:a>=2,has16m:a>=3}}function i(a,b){if(0===d)return 0;if(f("color=16m")||f("color=full")||f("color=truecolor"))return 3;if(f("color=256"))return 2;if(a&&!b&&void 0===d)return 0;let c=d||0;if("dumb"===g.TERM)return c;if("CI"in g)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(a=>a in g)||"codeship"===g.CI_NAME?1:c;if("TEAMCITY_VERSION"in g)return+!!/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(g.TEAMCITY_VERSION);if("truecolor"===g.COLORTERM)return 3;if("TERM_PROGRAM"in g){let a=parseInt((g.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(g.TERM_PROGRAM){case"iTerm.app":return a>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(g.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(g.TERM)||"COLORTERM"in g?1:c}f("no-color")||f("no-colors")||f("color=false")||f("color=never")?d=0:(f("color")||f("colors")||f("color=true")||f("color=always"))&&(d=1),"FORCE_COLOR"in g&&(d="true"===g.FORCE_COLOR?1:"false"===g.FORCE_COLOR?0:0===g.FORCE_COLOR.length?1:Math.min(parseInt(g.FORCE_COLOR,10),3)),b.exports={supportsColor:function(a){return h(i(a,a&&a.isTTY))},stdout:h(i(!0,e.isatty(1))),stderr:h(i(!0,e.isatty(2)))}},16956,(a,b,c)=>{let d=a.r(70722),e=a.r(24361);c.init=function(a){a.inspectOpts={};let b=Object.keys(c.inspectOpts);for(let d=0;d<b.length;d++)a.inspectOpts[b[d]]=c.inspectOpts[b[d]]},c.log=function(...a){return process.stderr.write(e.formatWithOptions(c.inspectOpts,...a)+"\n")},c.formatArgs=function(a){let{namespace:d,useColors:e}=this;if(e){let c=this.color,e="\x1b[3"+(c<8?c:"8;5;"+c),f=`  ${e};1m${d} \u001B[0m`;a[0]=f+a[0].split("\n").join("\n"+f),a.push(e+"m+"+b.exports.humanize(this.diff)+"\x1b[0m")}else a[0]=(c.inspectOpts.hideDate?"":new Date().toISOString()+" ")+d+" "+a[0]},c.save=function(a){a?process.env.DEBUG=a:delete process.env.DEBUG},c.load=function(){return process.env.DEBUG},c.useColors=function(){return"colors"in c.inspectOpts?!!c.inspectOpts.colors:d.isatty(process.stderr.fd)},c.destroy=e.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),c.colors=[6,2,3,4,5,1];try{let b=a.r(45681);b&&(b.stderr||b).level>=2&&(c.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(a){}c.inspectOpts=Object.keys(process.env).filter(a=>/^debug_/i.test(a)).reduce((a,b)=>{let c=b.substring(6).toLowerCase().replace(/_([a-z])/g,(a,b)=>b.toUpperCase()),d=process.env[b];return d=!!/^(yes|on|true|enabled)$/i.test(d)||!/^(no|off|false|disabled)$/i.test(d)&&("null"===d?null:Number(d)),a[c]=d,a},{}),b.exports=a.r(93830)(c);let{formatters:f}=b.exports;f.o=function(a){return this.inspectOpts.colors=this.useColors,e.inspect(a,this.inspectOpts).split("\n").map(a=>a.trim()).join(" ")},f.O=function(a){return this.inspectOpts.colors=this.useColors,e.inspect(a,this.inspectOpts)}},58077,(a,b,c)=>{c.formatArgs=function(a){if(a[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+a[0]+(this.useColors?"%c ":" ")+"+"+b.exports.humanize(this.diff),!this.useColors)return;let c="color: "+this.color;a.splice(1,0,c,"color: inherit");let d=0,e=0;a[0].replace(/%[a-zA-Z%]/g,a=>{"%%"!==a&&(d++,"%c"===a&&(e=d))}),a.splice(e,0,c)},c.save=function(a){try{a?c.storage.setItem("debug",a):c.storage.removeItem("debug")}catch(a){}},c.load=function(){let a;try{a=c.storage.getItem("debug")||c.storage.getItem("DEBUG")}catch(a){}return!a&&"undefined"!=typeof process&&"env"in process&&(a=process.env.DEBUG),a},c.useColors=function(){let a;return!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof navigator&&navigator.userAgent&&(a=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(a[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},c.storage=function(){try{return localStorage}catch(a){}}(),c.destroy=(()=>{let a=!1;return()=>{a||(a=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),c.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],c.log=console.debug||console.log||(()=>{}),b.exports=a.r(93830)(c);let{formatters:d}=b.exports;d.j=function(a){try{return JSON.stringify(a)}catch(a){return"[UnexpectedJSONParseError]: "+a.message}}},61998,(a,b,c)=>{"undefined"==typeof process||"renderer"===process.type||process.__nwjs?b.exports=a.r(58077):b.exports=a.r(16956)},71798,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),f=a.e&&a.e.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)"default"!==c&&Object.prototype.hasOwnProperty.call(a,c)&&d(b,a,c);return e(b,a),b};Object.defineProperty(c,"__esModule",{value:!0}),c.req=c.json=c.toBuffer=void 0;let g=f(a.r(21517)),h=f(a.r(24836));async function i(a){let b=0,c=[];for await(let d of a)b+=d.length,c.push(d);return Buffer.concat(c,b)}c.toBuffer=i,c.json=async function(a){let b=(await i(a)).toString("utf8");try{return JSON.parse(b)}catch(a){throw a.message+=` (input: ${b})`,a}},c.req=function(a,b={}){let c=(("string"==typeof a?a:a.href).startsWith("https:")?h:g).request(a,b),d=new Promise((a,b)=>{c.once("response",a).once("error",b).end()});return c.then=d.then.bind(d),c}},21595,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),f=a.e&&a.e.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)"default"!==c&&Object.prototype.hasOwnProperty.call(a,c)&&d(b,a,c);return e(b,a),b},g=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.Agent=void 0;let h=f(a.r(4446)),i=f(a.r(21517)),j=a.r(24836);g(a.r(71798),c);let k=Symbol("AgentBaseInternalState");class l extends i.Agent{constructor(a){super(a),this[k]={}}isSecureEndpoint(a){if(a){if("boolean"==typeof a.secureEndpoint)return a.secureEndpoint;if("string"==typeof a.protocol)return"https:"===a.protocol}let{stack:b}=Error();return"string"==typeof b&&b.split("\n").some(a=>-1!==a.indexOf("(https.js:")||-1!==a.indexOf("node:https:"))}incrementSockets(a){if(this.maxSockets===1/0&&this.maxTotalSockets===1/0)return null;this.sockets[a]||(this.sockets[a]=[]);let b=new h.Socket({writable:!1});return this.sockets[a].push(b),this.totalSocketCount++,b}decrementSockets(a,b){if(!this.sockets[a]||null===b)return;let c=this.sockets[a],d=c.indexOf(b);-1!==d&&(c.splice(d,1),this.totalSocketCount--,0===c.length&&delete this.sockets[a])}getName(a){return this.isSecureEndpoint(a)?j.Agent.prototype.getName.call(this,a):super.getName(a)}createSocket(a,b,c){let d={...b,secureEndpoint:this.isSecureEndpoint(b)},e=this.getName(d),f=this.incrementSockets(e);Promise.resolve().then(()=>this.connect(a,d)).then(g=>{if(this.decrementSockets(e,f),g instanceof i.Agent)try{return g.addRequest(a,d)}catch(a){return c(a)}this[k].currentSocket=g,super.createSocket(a,b,c)},a=>{this.decrementSockets(e,f),c(a)})}createConnection(){let a=this[k].currentSocket;if(this[k].currentSocket=void 0,!a)throw Error("No socket was returned in the `connect()` function");return a}get defaultPort(){return this[k].defaultPort??("https:"===this.protocol?443:80)}set defaultPort(a){this[k]&&(this[k].defaultPort=a)}get protocol(){return this[k].protocol??(this.isSecureEndpoint()?"https:":"http:")}set protocol(a){this[k]&&(this[k].protocol=a)}}c.Agent=l},91244,(a,b,c)=>{"use strict";var d=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0}),c.parseProxyResponse=void 0;let e=(0,d(a.r(61998)).default)("https-proxy-agent:parse-proxy-response");c.parseProxyResponse=function(a){return new Promise((b,c)=>{let d=0,f=[];function g(){let i=a.read();i?function(i){f.push(i),d+=i.length;let j=Buffer.concat(f,d),k=j.indexOf("\r\n\r\n");if(-1===k){e("have not received end of HTTP headers yet..."),g();return}let l=j.slice(0,k).toString("ascii").split("\r\n"),m=l.shift();if(!m)return a.destroy(),c(Error("No header received from proxy CONNECT response"));let n=m.split(" "),o=+n[1],p=n.slice(2).join(" "),q={};for(let b of l){if(!b)continue;let d=b.indexOf(":");if(-1===d)return a.destroy(),c(Error(`Invalid header from proxy CONNECT response: "${b}"`));let e=b.slice(0,d).toLowerCase(),f=b.slice(d+1).trimStart(),g=q[e];"string"==typeof g?q[e]=[g,f]:Array.isArray(g)?g.push(f):q[e]=f}e("got proxy server response: %o %o",m,q),h(),b({connect:{statusCode:o,statusText:p,headers:q},buffered:j})}(i):a.once("readable",g)}function h(){a.removeListener("end",i),a.removeListener("error",j),a.removeListener("readable",g)}function i(){h(),e("onend"),c(Error("Proxy connection ended before receiving CONNECT response"))}function j(a){h(),e("onerror %o",a),c(a)}a.on("error",j),a.on("end",i),g()})}},48081,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),f=a.e&&a.e.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)"default"!==c&&Object.prototype.hasOwnProperty.call(a,c)&&d(b,a,c);return e(b,a),b},g=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0}),c.HttpsProxyAgent=void 0;let h=f(a.r(4446)),i=f(a.r(55004)),j=g(a.r(49719)),k=g(a.r(61998)),l=a.r(21595),m=a.r(92509),n=a.r(91244),o=(0,k.default)("https-proxy-agent"),p=a=>void 0===a.servername&&a.host&&!h.isIP(a.host)?{...a,servername:a.host}:a;class q extends l.Agent{constructor(a,b){super(b),this.options={path:void 0},this.proxy="string"==typeof a?new m.URL(a):a,this.proxyHeaders=b?.headers??{},o("Creating new HttpsProxyAgent instance: %o",this.proxy.href);let c=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),d=this.proxy.port?parseInt(this.proxy.port,10):"https:"===this.proxy.protocol?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...b?s(b,"headers"):null,host:c,port:d}}async connect(a,b){let c,{proxy:d}=this;if(!b.host)throw TypeError('No "host" provided');"https:"===d.protocol?(o("Creating `tls.Socket`: %o",this.connectOpts),c=i.connect(p(this.connectOpts))):(o("Creating `net.Socket`: %o",this.connectOpts),c=h.connect(this.connectOpts));let e="function"==typeof this.proxyHeaders?this.proxyHeaders():{...this.proxyHeaders},f=h.isIPv6(b.host)?`[${b.host}]`:b.host,g=`CONNECT ${f}:${b.port} HTTP/1.1\r
`;if(d.username||d.password){let a=`${decodeURIComponent(d.username)}:${decodeURIComponent(d.password)}`;e["Proxy-Authorization"]=`Basic ${Buffer.from(a).toString("base64")}`}for(let a of(e.Host=`${f}:${b.port}`,e["Proxy-Connection"]||(e["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close"),Object.keys(e)))g+=`${a}: ${e[a]}\r
`;let k=(0,n.parseProxyResponse)(c);c.write(`${g}\r
`);let{connect:l,buffered:m}=await k;if(a.emit("proxyConnect",l),this.emit("proxyConnect",l,a),200===l.statusCode)return(a.once("socket",r),b.secureEndpoint)?(o("Upgrading socket connection to TLS"),i.connect({...s(p(b),"host","path","port"),socket:c})):c;c.destroy();let q=new h.Socket({writable:!1});return q.readable=!0,a.once("socket",a=>{o("Replaying proxy buffer for failed request"),(0,j.default)(a.listenerCount("data")>0),a.push(m),a.push(null)}),q}}function r(a){a.resume()}function s(a,...b){let c,d={};for(c in a)b.includes(c)||(d[c]=a[c]);return d}q.protocols=["http","https"],c.HttpsProxyAgent=q},79398,(a,b,c)=>{"use strict";var d=Object.prototype.hasOwnProperty,e=Object.prototype.toString,f=Object.defineProperty,g=Object.getOwnPropertyDescriptor,h=function(a){return"function"==typeof Array.isArray?Array.isArray(a):"[object Array]"===e.call(a)},i=function(a){if(!a||"[object Object]"!==e.call(a))return!1;var b,c=d.call(a,"constructor"),f=a.constructor&&a.constructor.prototype&&d.call(a.constructor.prototype,"isPrototypeOf");if(a.constructor&&!c&&!f)return!1;for(b in a);return void 0===b||d.call(a,b)},j=function(a,b){f&&"__proto__"===b.name?f(a,b.name,{enumerable:!0,configurable:!0,value:b.newValue,writable:!0}):a[b.name]=b.newValue},k=function(a,b){if("__proto__"===b){if(!d.call(a,b))return;else if(g)return g(a,b).value}return a[b]};b.exports=function a(){var b,c,d,e,f,g,l=arguments[0],m=1,n=arguments.length,o=!1;for("boolean"==typeof l&&(o=l,l=arguments[1]||{},m=2),(null==l||"object"!=typeof l&&"function"!=typeof l)&&(l={});m<n;++m)if(b=arguments[m],null!=b)for(c in b)d=k(l,c),l!==(e=k(b,c))&&(o&&e&&(i(e)||(f=h(e)))?(f?(f=!1,g=d&&h(d)?d:[]):g=d&&i(d)?d:{},j(l,{name:c,newValue:a(o,g,e)})):void 0!==e&&j(l,{name:c,newValue:e}));return l}},51933,(a,b,c)=>{"use strict";var d={};function e(a,b){!b.unsigned&&--a;let c=b.unsigned?0:-Math.pow(2,a),d=Math.pow(2,a)-1,e=b.moduloBitLength?Math.pow(2,b.moduloBitLength):Math.pow(2,a),f=b.moduloBitLength?Math.pow(2,b.moduloBitLength-1):Math.pow(2,a-1);return function(a,g){g||(g={});let h=+a;if(g.enforceRange){if(!Number.isFinite(h))throw TypeError("Argument is not a finite number");if((h=(h<0?-1:1)*Math.floor(Math.abs(h)))<c||h>d)throw TypeError("Argument is not in byte range");return h}if(!isNaN(h)&&g.clamp){var i;return(h=(i=h)%1==.5&&(1&i)==0?Math.floor(i):Math.round(i))<c&&(h=c),h>d&&(h=d),h}if(!Number.isFinite(h)||0===h)return 0;if(h=(h<0?-1:1)*Math.floor(Math.abs(h))%e,!b.unsigned&&h>=f)return h-e;if(b.unsigned){if(h<0)h+=e;else if(-0===h)return 0}return h}}b.exports=d,d.void=function(){},d.boolean=function(a){return!!a},d.byte=e(8,{unsigned:!1}),d.octet=e(8,{unsigned:!0}),d.short=e(16,{unsigned:!1}),d["unsigned short"]=e(16,{unsigned:!0}),d.long=e(32,{unsigned:!1}),d["unsigned long"]=e(32,{unsigned:!0}),d["long long"]=e(32,{unsigned:!1,moduloBitLength:64}),d["unsigned long long"]=e(32,{unsigned:!0,moduloBitLength:64}),d.double=function(a){let b=+a;if(!Number.isFinite(b))throw TypeError("Argument is not a finite floating-point value");return b},d["unrestricted double"]=function(a){let b=+a;if(isNaN(b))throw TypeError("Argument is NaN");return b},d.float=d.double,d["unrestricted float"]=d["unrestricted double"],d.DOMString=function(a,b){return(b||(b={}),b.treatNullAsEmptyString&&null===a)?"":String(a)},d.ByteString=function(a,b){let c,d=String(a);for(let a=0;void 0!==(c=d.codePointAt(a));++a)if(c>255)throw TypeError("Argument is not a valid bytestring");return d},d.USVString=function(a){let b=String(a),c=b.length,d=[];for(let a=0;a<c;++a){let e=b.charCodeAt(a);if(e<55296||e>57343)d.push(String.fromCodePoint(e));else if(56320<=e&&e<=57343)d.push(String.fromCodePoint(65533));else if(a===c-1)d.push(String.fromCodePoint(65533));else{let c=b.charCodeAt(a+1);if(56320<=c&&c<=57343){let b=1023&e,f=1023&c;d.push(String.fromCodePoint(65536+1024*b+f)),++a}else d.push(String.fromCodePoint(65533))}}return d.join("")},d.Date=function(a,b){if(!(a instanceof Date))throw TypeError("Argument is not a Date object");if(!isNaN(a))return a},d.RegExp=function(a,b){return a instanceof RegExp||(a=new RegExp(a)),a}},39534,(a,b,c)=>{"use strict";b.exports.mixin=function(a,b){let c=Object.getOwnPropertyNames(b);for(let d=0;d<c.length;++d)Object.defineProperty(a,c[d],Object.getOwnPropertyDescriptor(b,c[d]))},b.exports.wrapperSymbol=Symbol("wrapper"),b.exports.implSymbol=Symbol("impl"),b.exports.wrapperForImpl=function(a){return a[b.exports.wrapperSymbol]},b.exports.implForWrapper=function(a){return a[b.exports.implSymbol]}},33205,(a,b,c)=>{"use strict";var d=a.r(92097),e=a.r(45736),f={TRANSITIONAL:0,NONTRANSITIONAL:1};function g(a){return a.split("\0").map(function(a){return a.normalize("NFC")}).join("\0")}function h(a){for(var b=0,c=e.length-1;b<=c;){var d=Math.floor((b+c)/2),f=e[d];if(f[0][0]<=a&&f[0][1]>=a)return f;f[0][0]>a?c=d-1:b=d+1}return null}var i=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g;function j(a){return a.replace(i,"_").length}var k=/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E4-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u192B\u1930-\u193B\u19B0-\u19C0\u19C8\u19C9\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFC-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C4\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2D]|\uD800[\uDDFD\uDEE0\uDF76-\uDF7A]|\uD802[\uDE01-\uDE03\uDE05\uDE06\uDE0C-\uDE0F\uDE38-\uDE3A\uDE3F\uDEE5\uDEE6]|\uD804[\uDC00-\uDC02\uDC38-\uDC46\uDC7F-\uDC82\uDCB0-\uDCBA\uDD00-\uDD02\uDD27-\uDD34\uDD73\uDD80-\uDD82\uDDB3-\uDDC0\uDE2C-\uDE37\uDEDF-\uDEEA\uDF01-\uDF03\uDF3C\uDF3E-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF57\uDF62\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDCB0-\uDCC3\uDDAF-\uDDB5\uDDB8-\uDDC0\uDE30-\uDE40\uDEAB-\uDEB7]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF51-\uDF7E\uDF8F-\uDF92]|\uD82F[\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD83A[\uDCD0-\uDCD6]|\uDB40[\uDD00-\uDDEF]/;function l(a,b,c){var e=function(a,b,c){for(var d=!1,e="",g=j(a),i=0;i<g;++i){var k=a.codePointAt(i),l=h(k);switch(l[1]){case"disallowed":d=!0,e+=String.fromCodePoint(k);break;case"ignored":break;case"mapped":e+=String.fromCodePoint.apply(String,l[2]);break;case"deviation":c===f.TRANSITIONAL?e+=String.fromCodePoint.apply(String,l[2]):e+=String.fromCodePoint(k);break;case"valid":e+=String.fromCodePoint(k);break;case"disallowed_STD3_mapped":b?(d=!0,e+=String.fromCodePoint(k)):e+=String.fromCodePoint.apply(String,l[2]);break;case"disallowed_STD3_valid":b&&(d=!0),e+=String.fromCodePoint(k)}}return{string:e,error:d}}(a,b,c);e.string=g(e.string);for(var i=e.string.split("."),m=0;m<i.length;++m)try{var n=function(a,b){"xn--"===a.substr(0,4)&&(a=d.toUnicode(a),f.NONTRANSITIONAL);var c=!1;(g(a)!==a||"-"===a[3]&&"-"===a[4]||"-"===a[0]||"-"===a[a.length-1]||-1!==a.indexOf(".")||0===a.search(k))&&(c=!0);for(var e=j(a),i=0;i<e;++i){var m=h(a.codePointAt(i));if(l===f.TRANSITIONAL&&"valid"!==m[1]||l===f.NONTRANSITIONAL&&"valid"!==m[1]&&"deviation"!==m[1]){c=!0;break}}return{label:a,error:c}}(i[m]);i[m]=n.label,e.error=e.error||n.error}catch(a){e.error=!0}return{string:i.join("."),error:e.error}}b.exports.toASCII=function(a,b,c,e){var f=l(a,b,c),g=f.string.split(".");if(g=g.map(function(a){try{return d.toASCII(a)}catch(b){return f.error=!0,a}}),e){var h=g.slice(0,g.length-1).join(".").length;(h.length>253||0===h.length)&&(f.error=!0);for(var i=0;i<g.length;++i)if(g.length>63||0===g.length){f.error=!0;break}}return f.error?null:g.join(".")},b.exports.toUnicode=function(a,b){var c=l(a,b,f.NONTRANSITIONAL);return{domain:c.string,error:c.error}},b.exports.PROCESSING_OPTIONS=f},16114,(a,b,c)=>{"use strict";let d=a.r(92097),e=a.r(33205),f={ftp:21,file:null,gopher:70,http:80,https:443,ws:80,wss:443},g=Symbol("failure");function h(a){return d.ucs2.decode(a).length}function i(a,b){let c=a[b];return isNaN(c)?void 0:String.fromCodePoint(c)}function j(a){return a>=48&&a<=57}function k(a){return a>=65&&a<=90||a>=97&&a<=122}function l(a){return j(a)||a>=65&&a<=70||a>=97&&a<=102}function m(a){return"."===a||"%2e"===a.toLowerCase()}function n(a){return 2===a.length&&k(a.codePointAt(0))&&(":"===a[1]||"|"===a[1])}function o(a){return void 0!==f[a]}function p(a){return o(a.scheme)}function q(a){let b=a.toString(16).toUpperCase();return 1===b.length&&(b="0"+b),"%"+b}function r(a){return a<=31||a>126}let s=new Set([32,34,35,60,62,63,96,123,125]);function t(a){return r(a)||s.has(a)}let u=new Set([47,58,59,61,64,91,92,93,94,124]);function v(a){return t(a)||u.has(a)}function w(a,b){let c=String.fromCodePoint(a);if(b(a)){let a=new Buffer(c),b="";for(let c=0;c<a.length;++c)b+=q(a[c]);return b}return c}function x(a,b){if("["===a[0])return"]"!==a[a.length-1]?g:function(a){let b=[0,0,0,0,0,0,0,0],c=0,e=null,f=0;if(58===(a=d.ucs2.decode(a))[f]){if(58!==a[f+1])return g;f+=2,e=++c}for(;f<a.length;){if(8===c)return g;if(58===a[f]){if(null!==e)return g;++f,e=++c;continue}let d=0,h=0;for(;h<4&&l(a[f]);)d=16*d+parseInt(i(a,f),16),++f,++h;if(46===a[f]){if(0===h||(f-=h,c>6))return g;let d=0;for(;void 0!==a[f];){let e=null;if(d>0)if(46!==a[f]||!(d<4))return g;else++f;if(!j(a[f]))return g;for(;j(a[f]);){let b=parseInt(i(a,f));if(null===e)e=b;else{if(0===e)return g;e=10*e+b}if(e>255)return g;++f}b[c]=256*b[c]+e,(2==++d||4===d)&&++c}if(4!==d)return g;break}if(58===a[f]){if(void 0===a[++f])return g}else if(void 0!==a[f])return g;b[c]=d,++c}if(null!==e){let a=c-e;for(c=7;0!==c&&a>0;){let d=b[e+a-1];b[e+a-1]=b[c],b[c]=d,--c,--a}}else if(null===e&&8!==c)return g;return b}(a.substring(1,a.length-1));if(!b){var c=a;if(-1!==c.search(/\u0000|\u0009|\u000A|\u000D|\u0020|#|\/|:|\?|@|\[|\\|\]/))return g;let b="",e=d.ucs2.decode(c);for(let a=0;a<e.length;++a)b+=w(e[a],r);return b}let f=function(a){let b=new Buffer(a),c=[];for(let a=0;a<b.length;++a)37!==b[a]?c.push(b[a]):37===b[a]&&l(b[a+1])&&l(b[a+2])?(c.push(parseInt(b.slice(a+1,a+3).toString(),16)),a+=2):c.push(b[a]);return new Buffer(c).toString()}(a),h=e.toASCII(f,!1,e.PROCESSING_OPTIONS.NONTRANSITIONAL,!1);if(null===h||-1!==h.search(/\u0000|\u0009|\u000A|\u000D|\u0020|#|%|\/|:|\?|@|\[|\\|\]/))return g;let k=function(a){let b=a.split(".");if(""===b[b.length-1]&&b.length>1&&b.pop(),b.length>4)return a;let c=[];for(let d of b){if(""===d)return a;let b=function(a){let b=10;return(a.length>=2&&"0"===a.charAt(0)&&"x"===a.charAt(1).toLowerCase()?(a=a.substring(2),b=16):a.length>=2&&"0"===a.charAt(0)&&(a=a.substring(1),b=8),""===a)?0:(10===b?/[^0-9]/:16===b?/[^0-9A-Fa-f]/:/[^0-7]/).test(a)?g:parseInt(a,b)}(d);if(b===g)return a;c.push(b)}for(let a=0;a<c.length-1;++a)if(c[a]>255)return g;if(c[c.length-1]>=Math.pow(256,5-c.length))return g;let d=c.pop(),e=0;for(let a of c)d+=a*Math.pow(256,3-e),++e;return d}(h);return"number"==typeof k||k===g?k:h}function y(a){if("number"==typeof a){let b="",c=a;for(let a=1;a<=4;++a)b=String(c%256)+b,4!==a&&(b="."+b),c=Math.floor(c/256);return b}return a instanceof Array?"["+function(a){let b="",c=function(a){let b=null,c=1,d=null,e=0;for(let f=0;f<a.length;++f)0!==a[f]?(e>c&&(b=d,c=e),d=null,e=0):(null===d&&(d=f),++e);return e>c&&(b=d,c=e),{idx:b,len:c}}(a).idx,d=!1;for(let e=0;e<=7;++e)if(!d||0!==a[e]){if(d&&(d=!1),c===e){b+=0===e?"::":":",d=!0;continue}b+=a[e].toString(16),7!==e&&(b+=":")}return b}(a)+"]":a}function z(a){let b=a.path;if(0!==b.length){var c;"file"===a.scheme&&1===b.length&&(c=b[0],/^[A-Za-z]:$/.test(c))||b.pop()}}function A(a){return""!==a.username||""!==a.password}function B(a,b,c,e,f){if(this.pointer=0,this.input=a,this.base=b||null,this.encodingOverride=c||"utf-8",this.stateOverride=f,this.url=e,this.failure=!1,this.parseError=!1,!this.url){this.url={scheme:"",username:"",password:"",host:null,port:null,path:[],query:null,fragment:null,cannotBeABaseURL:!1};let a=this.input.replace(/^[\u0000-\u001F\u0020]+|[\u0000-\u001F\u0020]+$/g,"");a!==this.input&&(this.parseError=!0),this.input=a}let h=this.input.replace(/\u0009|\u000A|\u000D/g,"");for(h!==this.input&&(this.parseError=!0),this.input=h,this.state=f||"scheme start",this.buffer="",this.atFlag=!1,this.arrFlag=!1,this.passwordTokenSeenFlag=!1,this.input=d.ucs2.decode(this.input);this.pointer<=this.input.length;++this.pointer){let a=this.input[this.pointer],b=isNaN(a)?void 0:String.fromCodePoint(a),c=this["parse "+this.state](a,b);if(c){if(c===g){this.failure=!0;break}}else break}}B.prototype["parse scheme start"]=function(a,b){if(k(a))this.buffer+=b.toLowerCase(),this.state="scheme";else{if(this.stateOverride)return this.parseError=!0,g;this.state="no scheme",--this.pointer}return!0},B.prototype["parse scheme"]=function(a,b){if(k(a)||j(a)||43===a||45===a||46===a)this.buffer+=b.toLowerCase();else if(58===a){if(this.stateOverride&&(p(this.url)&&!o(this.buffer)||!p(this.url)&&o(this.buffer)||(A(this.url)||null!==this.url.port)&&"file"===this.buffer||"file"===this.url.scheme&&(""===this.url.host||null===this.url.host))||(this.url.scheme=this.buffer,this.buffer="",this.stateOverride))return!1;"file"===this.url.scheme?((47!==this.input[this.pointer+1]||47!==this.input[this.pointer+2])&&(this.parseError=!0),this.state="file"):p(this.url)&&null!==this.base&&this.base.scheme===this.url.scheme?this.state="special relative or authority":p(this.url)?this.state="special authority slashes":47===this.input[this.pointer+1]?(this.state="path or authority",++this.pointer):(this.url.cannotBeABaseURL=!0,this.url.path.push(""),this.state="cannot-be-a-base-URL path")}else{if(this.stateOverride)return this.parseError=!0,g;this.buffer="",this.state="no scheme",this.pointer=-1}return!0},B.prototype["parse no scheme"]=function(a){return null===this.base||this.base.cannotBeABaseURL&&35!==a?g:(this.base.cannotBeABaseURL&&35===a?(this.url.scheme=this.base.scheme,this.url.path=this.base.path.slice(),this.url.query=this.base.query,this.url.fragment="",this.url.cannotBeABaseURL=!0,this.state="fragment"):("file"===this.base.scheme?this.state="file":this.state="relative",--this.pointer),!0)},B.prototype["parse special relative or authority"]=function(a){return 47===a&&47===this.input[this.pointer+1]?(this.state="special authority ignore slashes",++this.pointer):(this.parseError=!0,this.state="relative",--this.pointer),!0},B.prototype["parse path or authority"]=function(a){return 47===a?this.state="authority":(this.state="path",--this.pointer),!0},B.prototype["parse relative"]=function(a){return this.url.scheme=this.base.scheme,isNaN(a)?(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(),this.url.query=this.base.query):47===a?this.state="relative slash":63===a?(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(),this.url.query="",this.state="query"):35===a?(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(),this.url.query=this.base.query,this.url.fragment="",this.state="fragment"):p(this.url)&&92===a?(this.parseError=!0,this.state="relative slash"):(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(0,this.base.path.length-1),this.state="path",--this.pointer),!0},B.prototype["parse relative slash"]=function(a){return p(this.url)&&(47===a||92===a)?(92===a&&(this.parseError=!0),this.state="special authority ignore slashes"):47===a?this.state="authority":(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.state="path",--this.pointer),!0},B.prototype["parse special authority slashes"]=function(a){return 47===a&&47===this.input[this.pointer+1]?(this.state="special authority ignore slashes",++this.pointer):(this.parseError=!0,this.state="special authority ignore slashes",--this.pointer),!0},B.prototype["parse special authority ignore slashes"]=function(a){return 47!==a&&92!==a?(this.state="authority",--this.pointer):this.parseError=!0,!0},B.prototype["parse authority"]=function(a,b){if(64===a){this.parseError=!0,this.atFlag&&(this.buffer="%40"+this.buffer),this.atFlag=!0;let a=h(this.buffer);for(let b=0;b<a;++b){let a=this.buffer.codePointAt(b);if(58===a&&!this.passwordTokenSeenFlag){this.passwordTokenSeenFlag=!0;continue}let c=w(a,v);this.passwordTokenSeenFlag?this.url.password+=c:this.url.username+=c}this.buffer=""}else if(isNaN(a)||47===a||63===a||35===a||p(this.url)&&92===a){if(this.atFlag&&""===this.buffer)return this.parseError=!0,g;this.pointer-=h(this.buffer)+1,this.buffer="",this.state="host"}else this.buffer+=b;return!0},B.prototype["parse hostname"]=B.prototype["parse host"]=function(a,b){if(this.stateOverride&&"file"===this.url.scheme)--this.pointer,this.state="file host";else if(58!==a||this.arrFlag)if(isNaN(a)||47===a||63===a||35===a||p(this.url)&&92===a){if(--this.pointer,p(this.url)&&""===this.buffer)return this.parseError=!0,g;if(this.stateOverride&&""===this.buffer&&(A(this.url)||null!==this.url.port))return this.parseError=!0,!1;let a=x(this.buffer,p(this.url));if(a===g)return g;if(this.url.host=a,this.buffer="",this.state="path start",this.stateOverride)return!1}else 91===a?this.arrFlag=!0:93===a&&(this.arrFlag=!1),this.buffer+=b;else{if(""===this.buffer)return this.parseError=!0,g;let a=x(this.buffer,p(this.url));if(a===g)return g;if(this.url.host=a,this.buffer="",this.state="port","hostname"===this.stateOverride)return!1}return!0},B.prototype["parse port"]=function(a,b){if(j(a))this.buffer+=b;else{if(!(isNaN(a)||47===a||63===a||35===a||p(this.url)&&92===a)&&!this.stateOverride)return this.parseError=!0,g;if(""!==this.buffer){let a=parseInt(this.buffer);if(a>65535)return this.parseError=!0,g;this.url.port=a===f[this.url.scheme]?null:a,this.buffer=""}if(this.stateOverride)return!1;this.state="path start",--this.pointer}return!0};let C=new Set([47,92,63,35]);B.prototype["parse file"]=function(a){if(this.url.scheme="file",47===a||92===a)92===a&&(this.parseError=!0),this.state="file slash";else if(null!==this.base&&"file"===this.base.scheme)if(isNaN(a))this.url.host=this.base.host,this.url.path=this.base.path.slice(),this.url.query=this.base.query;else if(63===a)this.url.host=this.base.host,this.url.path=this.base.path.slice(),this.url.query="",this.state="query";else if(35===a)this.url.host=this.base.host,this.url.path=this.base.path.slice(),this.url.query=this.base.query,this.url.fragment="",this.state="fragment";else{var b;this.input.length-this.pointer-1!=0&&(b=this.input[this.pointer+1],k(a)&&(58===b||124===b))&&(!(this.input.length-this.pointer-1>=2)||C.has(this.input[this.pointer+2]))?this.parseError=!0:(this.url.host=this.base.host,this.url.path=this.base.path.slice(),z(this.url)),this.state="path",--this.pointer}else this.state="path",--this.pointer;return!0},B.prototype["parse file slash"]=function(a){if(47===a||92===a)92===a&&(this.parseError=!0),this.state="file host";else{if(null!==this.base&&"file"===this.base.scheme){var b;2===(b=this.base.path[0]).length&&k(b.codePointAt(0))&&":"===b[1]?this.url.path.push(this.base.path[0]):this.url.host=this.base.host}this.state="path",--this.pointer}return!0},B.prototype["parse file host"]=function(a,b){if(isNaN(a)||47===a||92===a||63===a||35===a)if(--this.pointer,!this.stateOverride&&n(this.buffer))this.parseError=!0,this.state="path";else if(""===this.buffer){if(this.url.host="",this.stateOverride)return!1;this.state="path start"}else{let a=x(this.buffer,p(this.url));if(a===g)return g;if("localhost"===a&&(a=""),this.url.host=a,this.stateOverride)return!1;this.buffer="",this.state="path start"}else this.buffer+=b;return!0},B.prototype["parse path start"]=function(a){return p(this.url)?(92===a&&(this.parseError=!0),this.state="path",47!==a&&92!==a&&--this.pointer):this.stateOverride||63!==a?this.stateOverride||35!==a?void 0!==a&&(this.state="path",47!==a&&--this.pointer):(this.url.fragment="",this.state="fragment"):(this.url.query="",this.state="query"),!0},B.prototype["parse path"]=function(a){if(isNaN(a)||47===a||p(this.url)&&92===a||!this.stateOverride&&(63===a||35===a)){var b;if((p(this.url)&&92===a&&(this.parseError=!0),".."===(b=(b=this.buffer).toLowerCase())||"%2e."===b||".%2e"===b||"%2e%2e"===b)?(z(this.url),47===a||p(this.url)&&92===a||this.url.path.push("")):m(this.buffer)&&47!==a&&!(p(this.url)&&92===a)?this.url.path.push(""):m(this.buffer)||("file"===this.url.scheme&&0===this.url.path.length&&n(this.buffer)&&(""!==this.url.host&&null!==this.url.host&&(this.parseError=!0,this.url.host=""),this.buffer=this.buffer[0]+":"),this.url.path.push(this.buffer)),this.buffer="","file"===this.url.scheme&&(void 0===a||63===a||35===a))for(;this.url.path.length>1&&""===this.url.path[0];)this.parseError=!0,this.url.path.shift();63===a&&(this.url.query="",this.state="query"),35===a&&(this.url.fragment="",this.state="fragment")}else 37!==a||l(this.input[this.pointer+1])&&l(this.input[this.pointer+2])||(this.parseError=!0),this.buffer+=w(a,t);return!0},B.prototype["parse cannot-be-a-base-URL path"]=function(a){return 63===a?(this.url.query="",this.state="query"):35===a?(this.url.fragment="",this.state="fragment"):(isNaN(a)||37===a||(this.parseError=!0),37!==a||l(this.input[this.pointer+1])&&l(this.input[this.pointer+2])||(this.parseError=!0),isNaN(a)||(this.url.path[0]=this.url.path[0]+w(a,r))),!0},B.prototype["parse query"]=function(a,b){if(isNaN(a)||!this.stateOverride&&35===a){p(this.url)&&"ws"!==this.url.scheme&&"wss"!==this.url.scheme||(this.encodingOverride="utf-8");let b=new Buffer(this.buffer);for(let a=0;a<b.length;++a)b[a]<33||b[a]>126||34===b[a]||35===b[a]||60===b[a]||62===b[a]?this.url.query+=q(b[a]):this.url.query+=String.fromCodePoint(b[a]);this.buffer="",35===a&&(this.url.fragment="",this.state="fragment")}else 37!==a||l(this.input[this.pointer+1])&&l(this.input[this.pointer+2])||(this.parseError=!0),this.buffer+=b;return!0},B.prototype["parse fragment"]=function(a){return isNaN(a)||(0===a?this.parseError=!0:(37!==a||l(this.input[this.pointer+1])&&l(this.input[this.pointer+2])||(this.parseError=!0),this.url.fragment+=w(a,r))),!0},b.exports.serializeURL=function(a,b){let c=a.scheme+":";if(null!==a.host?(c+="//",(""!==a.username||""!==a.password)&&(c+=a.username,""!==a.password&&(c+=":"+a.password),c+="@"),c+=y(a.host),null!==a.port&&(c+=":"+a.port)):null===a.host&&"file"===a.scheme&&(c+="//"),a.cannotBeABaseURL)c+=a.path[0];else for(let b of a.path)c+="/"+b;return null!==a.query&&(c+="?"+a.query),b||null===a.fragment||(c+="#"+a.fragment),c},b.exports.serializeURLOrigin=function(a){switch(a.scheme){case"blob":try{return b.exports.serializeURLOrigin(b.exports.parseURL(a.path[0]))}catch(a){return"null"}case"ftp":case"gopher":case"http":case"https":case"ws":case"wss":var c;let d;return d=(c={scheme:a.scheme,host:a.host,port:a.port}).scheme+"://"+y(c.host),null!==c.port&&(d+=":"+c.port),d;case"file":return"file://";default:return"null"}},b.exports.basicURLParse=function(a,b){void 0===b&&(b={});let c=new B(a,b.baseURL,b.encodingOverride,b.url,b.stateOverride);return c.failure?"failure":c.url},b.exports.setTheUsername=function(a,b){a.username="";let c=d.ucs2.decode(b);for(let b=0;b<c.length;++b)a.username+=w(c[b],v)},b.exports.setThePassword=function(a,b){a.password="";let c=d.ucs2.decode(b);for(let b=0;b<c.length;++b)a.password+=w(c[b],v)},b.exports.serializeHost=y,b.exports.cannotHaveAUsernamePasswordPort=function(a){return null===a.host||""===a.host||a.cannotBeABaseURL||"file"===a.scheme},b.exports.serializeInteger=function(a){return String(a)},b.exports.parseURL=function(a,c){return void 0===c&&(c={}),b.exports.basicURLParse(a,{baseURL:c.baseURL,encodingOverride:c.encodingOverride})}},96983,(a,b,c)=>{"use strict";let d=a.r(16114);c.implementation=class{constructor(a){let b=a[0],c=a[1],e=null;if(void 0!==c&&"failure"===(e=d.basicURLParse(c)))throw TypeError("Invalid base URL");let f=d.basicURLParse(b,{baseURL:e});if("failure"===f)throw TypeError("Invalid URL");this._url=f}get href(){return d.serializeURL(this._url)}set href(a){let b=d.basicURLParse(a);if("failure"===b)throw TypeError("Invalid URL");this._url=b}get origin(){return d.serializeURLOrigin(this._url)}get protocol(){return this._url.scheme+":"}set protocol(a){d.basicURLParse(a+":",{url:this._url,stateOverride:"scheme start"})}get username(){return this._url.username}set username(a){d.cannotHaveAUsernamePasswordPort(this._url)||d.setTheUsername(this._url,a)}get password(){return this._url.password}set password(a){d.cannotHaveAUsernamePasswordPort(this._url)||d.setThePassword(this._url,a)}get host(){let a=this._url;return null===a.host?"":null===a.port?d.serializeHost(a.host):d.serializeHost(a.host)+":"+d.serializeInteger(a.port)}set host(a){this._url.cannotBeABaseURL||d.basicURLParse(a,{url:this._url,stateOverride:"host"})}get hostname(){return null===this._url.host?"":d.serializeHost(this._url.host)}set hostname(a){this._url.cannotBeABaseURL||d.basicURLParse(a,{url:this._url,stateOverride:"hostname"})}get port(){return null===this._url.port?"":d.serializeInteger(this._url.port)}set port(a){d.cannotHaveAUsernamePasswordPort(this._url)||(""===a?this._url.port=null:d.basicURLParse(a,{url:this._url,stateOverride:"port"}))}get pathname(){return this._url.cannotBeABaseURL?this._url.path[0]:0===this._url.path.length?"":"/"+this._url.path.join("/")}set pathname(a){this._url.cannotBeABaseURL||(this._url.path=[],d.basicURLParse(a,{url:this._url,stateOverride:"path start"}))}get search(){return null===this._url.query||""===this._url.query?"":"?"+this._url.query}set search(a){let b=this._url;if(""===a){b.query=null;return}let c="?"===a[0]?a.substring(1):a;b.query="",d.basicURLParse(c,{url:b,stateOverride:"query"})}get hash(){return null===this._url.fragment||""===this._url.fragment?"":"#"+this._url.fragment}set hash(a){if(""===a){this._url.fragment=null;return}let b="#"===a[0]?a.substring(1):a;this._url.fragment="",d.basicURLParse(b,{url:this._url,stateOverride:"fragment"})}toJSON(){return this.href}}},60007,(a,b,c)=>{"use strict";let d=a.r(51933),e=a.r(39534),f=a.r(96983),g=e.implSymbol;function h(a){if(!this||this[g]||!(this instanceof h))throw TypeError("Failed to construct 'URL': Please use the 'new' operator, this DOM object constructor cannot be called as a function.");if(arguments.length<1)throw TypeError("Failed to construct 'URL': 1 argument required, but only "+arguments.length+" present.");let c=[];for(let a=0;a<arguments.length&&a<2;++a)c[a]=arguments[a];c[0]=d.USVString(c[0]),void 0!==c[1]&&(c[1]=d.USVString(c[1])),b.exports.setup(this,c)}h.prototype.toJSON=function(){if(!this||!b.exports.is(this))throw TypeError("Illegal invocation");let a=[];for(let b=0;b<arguments.length&&b<0;++b)a[b]=arguments[b];return this[g].toJSON.apply(this[g],a)},Object.defineProperty(h.prototype,"href",{get(){return this[g].href},set(a){a=d.USVString(a),this[g].href=a},enumerable:!0,configurable:!0}),h.prototype.toString=function(){if(!this||!b.exports.is(this))throw TypeError("Illegal invocation");return this.href},Object.defineProperty(h.prototype,"origin",{get(){return this[g].origin},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"protocol",{get(){return this[g].protocol},set(a){a=d.USVString(a),this[g].protocol=a},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"username",{get(){return this[g].username},set(a){a=d.USVString(a),this[g].username=a},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"password",{get(){return this[g].password},set(a){a=d.USVString(a),this[g].password=a},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"host",{get(){return this[g].host},set(a){a=d.USVString(a),this[g].host=a},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"hostname",{get(){return this[g].hostname},set(a){a=d.USVString(a),this[g].hostname=a},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"port",{get(){return this[g].port},set(a){a=d.USVString(a),this[g].port=a},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"pathname",{get(){return this[g].pathname},set(a){a=d.USVString(a),this[g].pathname=a},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"search",{get(){return this[g].search},set(a){a=d.USVString(a),this[g].search=a},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"hash",{get(){return this[g].hash},set(a){a=d.USVString(a),this[g].hash=a},enumerable:!0,configurable:!0}),b.exports={is:a=>!!a&&a[g]instanceof f.implementation,create(a,b){let c=Object.create(h.prototype);return this.setup(c,a,b),c},setup(a,b,c){c||(c={}),c.wrapper=a,a[g]=new f.implementation(b,c),a[g][e.wrapperSymbol]=a},interface:h,expose:{Window:{URL:h},Worker:{URL:h}}}},97884,(a,b,c)=>{"use strict";c.URL=a.r(60007).interface,c.serializeURL=a.r(16114).serializeURL,c.serializeURLOrigin=a.r(16114).serializeURLOrigin,c.basicURLParse=a.r(16114).basicURLParse,c.setTheUsername=a.r(16114).setTheUsername,c.setThePassword=a.r(16114).setThePassword,c.serializeHost=a.r(16114).serializeHost,c.serializeInteger=a.r(16114).serializeInteger,c.parseURL=a.r(16114).parseURL},98445,a=>{"use strict";let b;a.s(["AbortError",()=>S,"FetchError",()=>m,"Headers",()=>C,"Request",()=>R,"Response",()=>J,"default",()=>Y]);var c=a.i(88947),d=a.i(21517),e=a.i(92509),f=a.i(97884),g=a.i(24836),h=a.i(6461);let i=c.default.Readable,j=Symbol("buffer"),k=Symbol("type");class l{constructor(){this[k]="";let a=arguments[0],b=arguments[1],c=[];if(a){let b=Number(a.length);for(let d=0;d<b;d++){let b,e=a[d];(b=e instanceof Buffer?e:ArrayBuffer.isView(e)?Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?Buffer.from(e):e instanceof l?e[j]:Buffer.from("string"==typeof e?e:String(e))).length,c.push(b)}}this[j]=Buffer.concat(c);let d=b&&void 0!==b.type&&String(b.type).toLowerCase();d&&!/[^\u0020-\u007E]/.test(d)&&(this[k]=d)}get size(){return this[j].length}get type(){return this[k]}text(){return Promise.resolve(this[j].toString())}arrayBuffer(){let a=this[j];return Promise.resolve(a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength))}stream(){let a=new i;return a._read=function(){},a.push(this[j]),a.push(null),a}toString(){return"[object Blob]"}slice(){let a,b=this.size,c=arguments[0],d=arguments[1];a=void 0===c?0:c<0?Math.max(b+c,0):Math.min(c,b);let e=Math.max((void 0===d?b:d<0?Math.max(b+d,0):Math.min(d,b))-a,0),f=this[j].slice(a,a+e),g=new l([],{type:arguments[2]});return g[j]=f,g}}function m(a,b,c){Error.call(this,a),this.message=a,this.type=b,c&&(this.code=this.errno=c.code),Error.captureStackTrace(this,this.constructor)}Object.defineProperties(l.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(l.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0}),m.prototype=Object.create(Error.prototype),m.prototype.constructor=m,m.prototype.name="FetchError";try{b=(()=>{let a=Error("Cannot find module 'encoding'");throw a.code="MODULE_NOT_FOUND",a})().convert}catch(a){}let n=Symbol("Body internals"),o=c.default.PassThrough;function p(a){var b=this,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=d.size,f=d.timeout;null==a?a=null:r(a)?a=Buffer.from(a.toString()):s(a)||Buffer.isBuffer(a)||("[object ArrayBuffer]"===Object.prototype.toString.call(a)?a=Buffer.from(a):ArrayBuffer.isView(a)?a=Buffer.from(a.buffer,a.byteOffset,a.byteLength):a instanceof c.default||(a=Buffer.from(String(a)))),this[n]={body:a,disturbed:!1,error:null},this.size=void 0===e?0:e,this.timeout=void 0===f?0:f,a instanceof c.default&&a.on("error",function(a){let c="AbortError"===a.name?a:new m(`Invalid response body while trying to fetch ${b.url}: ${a.message}`,"system",a);b[n].error=c})}function q(){var a=this;if(this[n].disturbed)return p.Promise.reject(TypeError(`body used already for: ${this.url}`));if(this[n].disturbed=!0,this[n].error)return p.Promise.reject(this[n].error);let b=this.body;if(null===b)return p.Promise.resolve(Buffer.alloc(0));if(s(b)&&(b=b.stream()),Buffer.isBuffer(b))return p.Promise.resolve(b);if(!(b instanceof c.default))return p.Promise.resolve(Buffer.alloc(0));let d=[],e=0,f=!1;return new p.Promise(function(c,g){let h;a.timeout&&(h=setTimeout(function(){f=!0,g(new m(`Response timeout while trying to fetch ${a.url} (over ${a.timeout}ms)`,"body-timeout"))},a.timeout)),b.on("error",function(b){"AbortError"===b.name?(f=!0,g(b)):g(new m(`Invalid response body while trying to fetch ${a.url}: ${b.message}`,"system",b))}),b.on("data",function(b){if(!f&&null!==b){if(a.size&&e+b.length>a.size){f=!0,g(new m(`content size at ${a.url} over limit: ${a.size}`,"max-size"));return}e+=b.length,d.push(b)}}),b.on("end",function(){if(!f){clearTimeout(h);try{c(Buffer.concat(d,e))}catch(b){g(new m(`Could not create Buffer from response body for ${a.url}: ${b.message}`,"system",b))}}})})}function r(a){return"object"==typeof a&&"function"==typeof a.append&&"function"==typeof a.delete&&"function"==typeof a.get&&"function"==typeof a.getAll&&"function"==typeof a.has&&"function"==typeof a.set&&("URLSearchParams"===a.constructor.name||"[object URLSearchParams]"===Object.prototype.toString.call(a)||"function"==typeof a.sort)}function s(a){return"object"==typeof a&&"function"==typeof a.arrayBuffer&&"string"==typeof a.type&&"function"==typeof a.stream&&"function"==typeof a.constructor&&"string"==typeof a.constructor.name&&/^(Blob|File)$/.test(a.constructor.name)&&/^(Blob|File)$/.test(a[Symbol.toStringTag])}function t(a){let b,d,e=a.body;if(a.bodyUsed)throw Error("cannot clone body after it is used");return e instanceof c.default&&"function"!=typeof e.getBoundary&&(b=new o,d=new o,e.pipe(b),e.pipe(d),a[n].body=b,e=d),e}function u(a){if(null===a)return null;if("string"==typeof a)return"text/plain;charset=UTF-8";if(r(a))return"application/x-www-form-urlencoded;charset=UTF-8";if(s(a))return a.type||null;if(Buffer.isBuffer(a))return null;else if("[object ArrayBuffer]"===Object.prototype.toString.call(a))return null;else if(ArrayBuffer.isView(a))return null;else if("function"==typeof a.getBoundary)return`multipart/form-data;boundary=${a.getBoundary()}`;else if(a instanceof c.default)return null;else return"text/plain;charset=UTF-8"}function v(a){let b=a.body;return null===b?0:s(b)?b.size:Buffer.isBuffer(b)?b.length:b&&"function"==typeof b.getLengthSync?b._lengthRetrievers&&0==b._lengthRetrievers.length||b.hasKnownLength&&b.hasKnownLength()?b.getLengthSync():null:null}p.prototype={get body(){return this[n].body},get bodyUsed(){return this[n].disturbed},arrayBuffer(){return q.call(this).then(function(a){return a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength)})},blob(){let a=this.headers&&this.headers.get("content-type")||"";return q.call(this).then(function(b){return Object.assign(new l([],{type:a.toLowerCase()}),{[j]:b})})},json(){var a=this;return q.call(this).then(function(b){try{return JSON.parse(b.toString())}catch(b){return p.Promise.reject(new m(`invalid json response body at ${a.url} reason: ${b.message}`,"invalid-json"))}})},text(){return q.call(this).then(function(a){return a.toString()})},buffer(){return q.call(this)},textConverted(){var a=this;return q.call(this).then(function(c){return function(a,c){let d,e;if("function"!=typeof b)throw Error("The package `encoding` must be installed to use the textConverted() function");let f=c.get("content-type"),g="utf-8";return f&&(d=/charset=([^;]*)/i.exec(f)),e=a.slice(0,1024).toString(),!d&&e&&(d=/<meta.+?charset=(['"])(.+?)\1/i.exec(e)),!d&&e&&(!(d=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(e))&&(d=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(e))&&d.pop(),d&&(d=/charset=(.*)/i.exec(d.pop()))),!d&&e&&(d=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(e)),d&&("gb2312"===(g=d.pop())||"gbk"===g)&&(g="gb18030"),b(a,"UTF-8",g).toString()}(c,a.headers)})}},Object.defineProperties(p.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),p.mixIn=function(a){for(let b of Object.getOwnPropertyNames(p.prototype))if(!(b in a)){let c=Object.getOwnPropertyDescriptor(p.prototype,b);Object.defineProperty(a,b,c)}},p.Promise=a.g.Promise;let w=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,x=/[^\t\x20-\x7e\x80-\xff]/;function y(a){if(a=`${a}`,w.test(a)||""===a)throw TypeError(`${a} is not a legal HTTP header name`)}function z(a){if(a=`${a}`,x.test(a))throw TypeError(`${a} is not a legal HTTP header value`)}function A(a,b){for(let c in b=b.toLowerCase(),a)if(c.toLowerCase()===b)return c}let B=Symbol("map");class C{constructor(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[B]=Object.create(null),a instanceof C){let b=a.raw();for(let a of Object.keys(b))for(let c of b[a])this.append(a,c);return}if(null==a);else if("object"==typeof a){let b=a[Symbol.iterator];if(null!=b){if("function"!=typeof b)throw TypeError("Header pairs must be iterable");let c=[];for(let b of a){if("object"!=typeof b||"function"!=typeof b[Symbol.iterator])throw TypeError("Each header pair must be iterable");c.push(Array.from(b))}for(let a of c){if(2!==a.length)throw TypeError("Each header pair must be a name/value tuple");this.append(a[0],a[1])}}else for(let b of Object.keys(a)){let c=a[b];this.append(b,c)}}else throw TypeError("Provided initializer must be an object")}get(a){y(a=`${a}`);let b=A(this[B],a);return void 0===b?null:this[B][b].join(", ")}forEach(a){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,c=D(this),d=0;for(;d<c.length;){var e=c[d];let f=e[0],g=e[1];a.call(b,g,f,this),c=D(this),d++}}set(a,b){a=`${a}`,b=`${b}`,y(a),z(b);let c=A(this[B],a);this[B][void 0!==c?c:a]=[b]}append(a,b){a=`${a}`,b=`${b}`,y(a),z(b);let c=A(this[B],a);void 0!==c?this[B][c].push(b):this[B][a]=[b]}has(a){return y(a=`${a}`),void 0!==A(this[B],a)}delete(a){y(a=`${a}`);let b=A(this[B],a);void 0!==b&&delete this[B][b]}raw(){return this[B]}keys(){return F(this,"key")}values(){return F(this,"value")}[Symbol.iterator](){return F(this,"key+value")}}function D(a){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key+value";return Object.keys(a[B]).sort().map("key"===b?function(a){return a.toLowerCase()}:"value"===b?function(b){return a[B][b].join(", ")}:function(b){return[b.toLowerCase(),a[B][b].join(", ")]})}C.prototype.entries=C.prototype[Symbol.iterator],Object.defineProperty(C.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(C.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});let E=Symbol("internal");function F(a,b){let c=Object.create(G);return c[E]={target:a,kind:b,index:0},c}let G=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==G)throw TypeError("Value of `this` is not a HeadersIterator");var a=this[E];let b=a.target,c=a.kind,d=a.index,e=D(b,c);return d>=e.length?{value:void 0,done:!0}:(this[E].index=d+1,{value:e[d],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));Object.defineProperty(G,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});let H=Symbol("Response internals"),I=d.default.STATUS_CODES;class J{constructor(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};p.call(this,a,b);let c=b.status||200,d=new C(b.headers);if(null!=a&&!d.has("Content-Type")){let b=u(a);b&&d.append("Content-Type",b)}this[H]={url:b.url,status:c,statusText:b.statusText||I[c],headers:d,counter:b.counter}}get url(){return this[H].url||""}get status(){return this[H].status}get ok(){return this[H].status>=200&&this[H].status<300}get redirected(){return this[H].counter>0}get statusText(){return this[H].statusText}get headers(){return this[H].headers}clone(){return new J(t(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}p.mixIn(J.prototype),Object.defineProperties(J.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(J.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});let K=Symbol("Request internals"),L=e.default.URL||f.default.URL,M=e.default.parse,N=e.default.format;function O(a){return/^[a-zA-Z][a-zA-Z\d+\-.]*:/.exec(a)&&(a=new L(a).toString()),M(a)}let P="destroy"in c.default.Readable.prototype;function Q(a){return"object"==typeof a&&"object"==typeof a[K]}class R{constructor(a){let b,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Q(a)?b=O(a.url):(b=a&&a.href?O(a.href):O(`${a}`),a={});let d=c.method||a.method||"GET";if(d=d.toUpperCase(),(null!=c.body||Q(a)&&null!==a.body)&&("GET"===d||"HEAD"===d))throw TypeError("Request with GET/HEAD method cannot have body");let e=null!=c.body?c.body:Q(a)&&null!==a.body?t(a):null;p.call(this,e,{timeout:c.timeout||a.timeout||0,size:c.size||a.size||0});let f=new C(c.headers||a.headers||{});if(null!=e&&!f.has("Content-Type")){let a=u(e);a&&f.append("Content-Type",a)}let g=Q(a)?a.signal:null;if("signal"in c&&(g=c.signal),null!=g&&!function(a){let b=a&&"object"==typeof a&&Object.getPrototypeOf(a);return!!(b&&"AbortSignal"===b.constructor.name)}(g))throw TypeError("Expected signal to be an instanceof AbortSignal");this[K]={method:d,redirect:c.redirect||a.redirect||"follow",headers:f,parsedURL:b,signal:g},this.follow=void 0!==c.follow?c.follow:void 0!==a.follow?a.follow:20,this.compress=void 0!==c.compress?c.compress:void 0===a.compress||a.compress,this.counter=c.counter||a.counter||0,this.agent=c.agent||a.agent}get method(){return this[K].method}get url(){return N(this[K].parsedURL)}get headers(){return this[K].headers}get redirect(){return this[K].redirect}get signal(){return this[K].signal}clone(){return new R(this)}}function S(a){Error.call(this,a),this.type="aborted",this.message=a,Error.captureStackTrace(this,this.constructor)}p.mixIn(R.prototype),Object.defineProperty(R.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(R.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}}),S.prototype=Object.create(Error.prototype),S.prototype.constructor=S,S.prototype.name="AbortError";let T=e.default.URL||f.default.URL,U=c.default.PassThrough,V=function(a,b){let c=new T(b).hostname,d=new T(a).hostname;return c===d||"."===c[c.length-d.length-1]&&c.endsWith(d)};function W(a,b){if(!W.Promise)throw Error("native promise missing, set fetch.Promise to your favorite alternative");return p.Promise=W.Promise,new W.Promise(function(e,f){var i,j;let k,l,n=new R(a,b),o=function(a){let b=a[K].parsedURL,d=new C(a[K].headers);if(d.has("Accept")||d.set("Accept","*/*"),!b.protocol||!b.hostname)throw TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(b.protocol))throw TypeError("Only HTTP(S) protocols are supported");if(a.signal&&a.body instanceof c.default.Readable&&!P)throw Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let e=null;if(null==a.body&&/^(POST|PUT)$/i.test(a.method)&&(e="0"),null!=a.body){let b=v(a);"number"==typeof b&&(e=String(b))}e&&d.set("Content-Length",e),d.has("User-Agent")||d.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),a.compress&&!d.has("Accept-Encoding")&&d.set("Accept-Encoding","gzip,deflate");let f=a.agent;return"function"==typeof f&&(f=f(b)),Object.assign({},b,{method:a.method,headers:function(a){let b=Object.assign({__proto__:null},a[B]),c=A(a[B],"Host");return void 0!==c&&(b[c]=b[c][0]),b}(d),agent:f})}(n),p=("https:"===o.protocol?g.default:d.default).request,q=n.signal,r=null,t=function(){let a=new S("The user aborted a request.");f(a),n.body&&n.body instanceof c.default.Readable&&X(n.body,a),r&&r.body&&r.body.emit("error",a)};if(q&&q.aborted)return void t();let u=function(){t(),z()},y=p(o);function z(){y.abort(),q&&q.removeEventListener("abort",u),clearTimeout(k)}q&&q.addEventListener("abort",u),n.timeout&&y.once("socket",function(a){k=setTimeout(function(){f(new m(`network timeout at: ${n.url}`,"request-timeout")),z()},n.timeout)}),y.on("error",function(a){f(new m(`request to ${n.url} failed, reason: ${a.message}`,"system",a)),r&&r.body&&X(r.body,a),z()}),i=y,j=function(a){(!q||!q.aborted)&&r&&r.body&&X(r.body,a)},i.on("socket",function(a){l=a}),i.on("response",function(a){let b=a.headers;"chunked"!==b["transfer-encoding"]||b["content-length"]||a.once("close",function(a){if(l&&l.listenerCount("data")>0&&!a){let a=Error("Premature close");a.code="ERR_STREAM_PREMATURE_CLOSE",j(a)}})}),14>parseInt(process.version.substring(1))&&y.on("socket",function(a){a.addListener("close",function(b){let c=a.listenerCount("data")>0;if(r&&c&&!b&&!(q&&q.aborted)){let a=Error("Premature close");a.code="ERR_STREAM_PREMATURE_CLOSE",r.body.emit("error",a)}})}),y.on("response",function(a){clearTimeout(k);let b=function(a){let b=new C;for(let c of Object.keys(a))if(!w.test(c))if(Array.isArray(a[c]))for(let d of a[c])x.test(d)||(void 0===b[B][c]?b[B][c]=[d]:b[B][c].push(d));else x.test(a[c])||(b[B][c]=[a[c]]);return b}(a.headers);if(W.isRedirect(a.statusCode)){let d=b.get("Location"),g=null;try{g=null===d?null:new T(d,n.url).toString()}catch(a){if("manual"!==n.redirect){f(new m(`uri requested responds with an invalid redirect URL: ${d}`,"invalid-redirect")),z();return}}switch(n.redirect){case"error":f(new m(`uri requested responds with a redirect, redirect mode is set to error: ${n.url}`,"no-redirect")),z();return;case"manual":if(null!==g)try{b.set("Location",g)}catch(a){f(a)}break;case"follow":var c;if(null===g)break;if(n.counter>=n.follow){f(new m(`maximum redirect reached at: ${n.url}`,"max-redirect")),z();return}let h={headers:new C(n.headers),follow:n.follow,counter:n.counter+1,agent:n.agent,compress:n.compress,method:n.method,body:n.body,signal:n.signal,timeout:n.timeout,size:n.size};if(!V(n.url,g)||(c=n.url,new T(g).protocol!==new T(c).protocol))for(let a of["authorization","www-authenticate","cookie","cookie2"])h.headers.delete(a);if(303!==a.statusCode&&n.body&&null===v(n)){f(new m("Cannot follow redirect with body being a readable stream","unsupported-redirect")),z();return}(303===a.statusCode||(301===a.statusCode||302===a.statusCode)&&"POST"===n.method)&&(h.method="GET",h.body=void 0,h.headers.delete("content-length")),e(W(new R(g,h))),z();return}}a.once("end",function(){q&&q.removeEventListener("abort",u)});let d=a.pipe(new U),g={url:n.url,status:a.statusCode,statusText:a.statusMessage,headers:b,size:n.size,timeout:n.timeout,counter:n.counter},i=b.get("Content-Encoding");if(!n.compress||"HEAD"===n.method||null===i||204===a.statusCode||304===a.statusCode)return void e(r=new J(d,g));let j={flush:h.default.Z_SYNC_FLUSH,finishFlush:h.default.Z_SYNC_FLUSH};if("gzip"==i||"x-gzip"==i)return void e(r=new J(d=d.pipe(h.default.createGunzip(j)),g));if("deflate"==i||"x-deflate"==i){let b=a.pipe(new U);b.once("data",function(a){e(r=new J(d=(15&a[0])==8?d.pipe(h.default.createInflate()):d.pipe(h.default.createInflateRaw()),g))}),b.on("end",function(){r||e(r=new J(d,g))});return}if("br"==i&&"function"==typeof h.default.createBrotliDecompress)return void e(r=new J(d=d.pipe(h.default.createBrotliDecompress()),g));e(r=new J(d,g))});let D=n.body;null===D?y.end():s(D)?D.stream().pipe(y):Buffer.isBuffer(D)?(y.write(D),y.end()):D.pipe(y)})}function X(a,b){a.destroy?a.destroy(b):(a.emit("error",b),a.end())}W.isRedirect=function(a){return 301===a||302===a||303===a||307===a||308===a},W.Promise=a.g.Promise;let Y=W},4385,(a,b,c)=>{"use strict";let d=a=>null!==a&&"object"==typeof a&&"function"==typeof a.pipe;d.writable=a=>d(a)&&!1!==a.writable&&"function"==typeof a._write&&"object"==typeof a._writableState,d.readable=a=>d(a)&&!1!==a.readable&&"function"==typeof a._read&&"object"==typeof a._readableState,d.duplex=a=>d.writable(a)&&d.readable(a),d.transform=a=>d.duplex(a)&&"function"==typeof a._transform,b.exports=d},94107,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.pkg=void 0,c.pkg=a.r(451)},33985,(a,b,c)=>{"use strict";var d,e=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0}),c.GaxiosError=c.GAXIOS_ERROR_SYMBOL=void 0,c.defaultErrorRedactor=function a(b){let c="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.";function d(a){if(a)for(let b of Object.keys(a))/^authentication$/i.test(b)&&(a[b]=c),/^authorization$/i.test(b)&&(a[b]=c),/secret/i.test(b)&&(a[b]=c)}function e(a,b){if("object"==typeof a&&null!==a&&"string"==typeof a[b]){let d=a[b];(/grant_type=/i.test(d)||/assertion=/i.test(d)||/secret/i.test(d))&&(a[b]=c)}}function g(a){"object"==typeof a&&null!==a&&("grant_type"in a&&(a.grant_type=c),"assertion"in a&&(a.assertion=c),"client_secret"in a&&(a.client_secret=c))}if(b.config){d(b.config.headers),e(b.config,"data"),g(b.config.data),e(b.config,"body"),g(b.config.body);try{let a=new f.URL("",b.config.url);a.searchParams.has("token")&&a.searchParams.set("token",c),a.searchParams.has("client_secret")&&a.searchParams.set("client_secret",c),b.config.url=a.toString()}catch(a){}}return b.response&&(a({config:b.response.config}),d(b.response.headers),e(b.response,"data"),g(b.response.data)),b};let f=a.r(92509),g=a.r(94107),h=e(a.r(79398));c.GAXIOS_ERROR_SYMBOL=Symbol.for(`${g.pkg.name}-gaxios-error`);class i extends Error{static[(d=c.GAXIOS_ERROR_SYMBOL,Symbol.hasInstance)](a){return!!a&&"object"==typeof a&&c.GAXIOS_ERROR_SYMBOL in a&&a[c.GAXIOS_ERROR_SYMBOL]===g.pkg.version||Function.prototype[Symbol.hasInstance].call(i,a)}constructor(a,b,c,e){var f;if(super(a),this.config=b,this.response=c,this.error=e,this[d]=g.pkg.version,this.config=(0,h.default)(!0,{},b),this.response&&(this.response.config=(0,h.default)(!0,{},this.response.config)),this.response){try{this.response.data=function(a,b){switch(a){case"stream":default:return b;case"json":return JSON.parse(JSON.stringify(b));case"arraybuffer":return JSON.parse(Buffer.from(b).toString("utf8"));case"blob":return JSON.parse(b.text())}}(this.config.responseType,null==(f=this.response)?void 0:f.data)}catch(a){}this.status=this.response.status}e&&"code"in e&&e.code&&(this.code=e.code),b.errorRedactor&&b.errorRedactor({config:this.config,response:this.response})}}c.GaxiosError=i},94706,(a,b,c)=>{"use strict";async function d(a){var b,c;let d=f(a);if(!a||!a.config||!d&&!a.config.retry)return{shouldRetry:!1};(d=d||{}).currentRetryAttempt=d.currentRetryAttempt||0,d.retry=void 0===d.retry||null===d.retry?3:d.retry,d.httpMethodsToRetry=d.httpMethodsToRetry||["GET","HEAD","PUT","OPTIONS","DELETE"],d.noResponseRetries=void 0===d.noResponseRetries||null===d.noResponseRetries?2:d.noResponseRetries,d.retryDelayMultiplier=d.retryDelayMultiplier?d.retryDelayMultiplier:2,d.timeOfFirstRequest=d.timeOfFirstRequest?d.timeOfFirstRequest:Date.now(),d.totalTimeout=d.totalTimeout?d.totalTimeout:Number.MAX_SAFE_INTEGER,d.maxRetryDelay=d.maxRetryDelay?d.maxRetryDelay:Number.MAX_SAFE_INTEGER,d.statusCodesToRetry=d.statusCodesToRetry||[[100,199],[408,408],[429,429],[500,599]],a.config.retryConfig=d;let g=d.shouldRetry||e;if(!await g(a))return{shouldRetry:!1,config:a.config};let h=Math.min(((b=d).currentRetryAttempt?0:null!=(c=b.retryDelay)?c:100)+(Math.pow(b.retryDelayMultiplier,b.currentRetryAttempt)-1)/2*1e3,b.totalTimeout-(Date.now()-b.timeOfFirstRequest),b.maxRetryDelay);a.config.retryConfig.currentRetryAttempt+=1;let i=d.retryBackoff?d.retryBackoff(a,h):new Promise(a=>{setTimeout(a,h)});return d.onRetryAttempt&&d.onRetryAttempt(a),await i,{shouldRetry:!0,config:a.config}}function e(a){var b;let c=f(a);if("AbortError"===a.name||(null==(b=a.error)?void 0:b.name)==="AbortError"||!c||0===c.retry||!a.response&&(c.currentRetryAttempt||0)>=c.noResponseRetries||!a.config.method||0>c.httpMethodsToRetry.indexOf(a.config.method.toUpperCase()))return!1;if(a.response&&a.response.status){let b=!1;for(let[d,e]of c.statusCodesToRetry){let c=a.response.status;if(c>=d&&c<=e){b=!0;break}}if(!b)return!1}return c.currentRetryAttempt=c.currentRetryAttempt||0,!(c.currentRetryAttempt>=c.retry)}function f(a){if(a&&a.config&&a.config.retryConfig)return a.config.retryConfig}Object.defineProperty(c,"__esModule",{value:!0}),c.getRetryConfig=d},80741,a=>{"use strict";let b,c;a.s(["NIL",()=>v,"parse",()=>p,"stringify",()=>l,"v1",()=>o,"v3",()=>r,"v4",()=>t,"v5",()=>u,"validate",()=>i,"version",()=>w],80741),a.s([],2121),a.i(2121);var d=a.i(54799);let e=new Uint8Array(256),f=e.length;function g(){return f>e.length-16&&(d.default.randomFillSync(e),f=0),e.slice(f,f+=16)}let h=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,i=function(a){return"string"==typeof a&&h.test(a)},j=[];for(let a=0;a<256;++a)j.push((a+256).toString(16).slice(1));function k(a,b=0){return j[a[b+0]]+j[a[b+1]]+j[a[b+2]]+j[a[b+3]]+"-"+j[a[b+4]]+j[a[b+5]]+"-"+j[a[b+6]]+j[a[b+7]]+"-"+j[a[b+8]]+j[a[b+9]]+"-"+j[a[b+10]]+j[a[b+11]]+j[a[b+12]]+j[a[b+13]]+j[a[b+14]]+j[a[b+15]]}let l=function(a,b=0){let c=k(a,b);if(!i(c))throw TypeError("Stringified UUID is invalid");return c},m=0,n=0,o=function(a,d,e){let f=d&&e||0,h=d||Array(16),i=(a=a||{}).node||b,j=void 0!==a.clockseq?a.clockseq:c;if(null==i||null==j){let d=a.random||(a.rng||g)();null==i&&(i=b=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==j&&(j=c=(d[6]<<8|d[7])&16383)}let l=void 0!==a.msecs?a.msecs:Date.now(),o=void 0!==a.nsecs?a.nsecs:n+1,p=l-m+(o-n)/1e4;if(p<0&&void 0===a.clockseq&&(j=j+1&16383),(p<0||l>m)&&void 0===a.nsecs&&(o=0),o>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");m=l,n=o,c=j;let q=((0xfffffff&(l+=122192928e5))*1e4+o)%0x100000000;h[f++]=q>>>24&255,h[f++]=q>>>16&255,h[f++]=q>>>8&255,h[f++]=255&q;let r=l/0x100000000*1e4&0xfffffff;h[f++]=r>>>8&255,h[f++]=255&r,h[f++]=r>>>24&15|16,h[f++]=r>>>16&255,h[f++]=j>>>8|128,h[f++]=255&j;for(let a=0;a<6;++a)h[f+a]=i[a];return d||k(h)},p=function(a){let b;if(!i(a))throw TypeError("Invalid UUID");let c=new Uint8Array(16);return c[0]=(b=parseInt(a.slice(0,8),16))>>>24,c[1]=b>>>16&255,c[2]=b>>>8&255,c[3]=255&b,c[4]=(b=parseInt(a.slice(9,13),16))>>>8,c[5]=255&b,c[6]=(b=parseInt(a.slice(14,18),16))>>>8,c[7]=255&b,c[8]=(b=parseInt(a.slice(19,23),16))>>>8,c[9]=255&b,c[10]=(b=parseInt(a.slice(24,36),16))/0x10000000000&255,c[11]=b/0x100000000&255,c[12]=b>>>24&255,c[13]=b>>>16&255,c[14]=b>>>8&255,c[15]=255&b,c};function q(a,b,c){function d(a,d,e,f){var g;if("string"==typeof a&&(a=function(a){a=unescape(encodeURIComponent(a));let b=[];for(let c=0;c<a.length;++c)b.push(a.charCodeAt(c));return b}(a)),"string"==typeof d&&(d=p(d)),(null==(g=d)?void 0:g.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let h=new Uint8Array(16+a.length);if(h.set(d),h.set(a,d.length),(h=c(h))[6]=15&h[6]|b,h[8]=63&h[8]|128,e){f=f||0;for(let a=0;a<16;++a)e[f+a]=h[a];return e}return k(h)}try{d.name=a}catch(a){}return d.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",d.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",d}let r=q("v3",48,function(a){return Array.isArray(a)?a=Buffer.from(a):"string"==typeof a&&(a=Buffer.from(a,"utf8")),d.default.createHash("md5").update(a).digest()}),s={randomUUID:d.default.randomUUID},t=function(a,b,c){if(s.randomUUID&&!b&&!a)return s.randomUUID();let d=(a=a||{}).random||(a.rng||g)();if(d[6]=15&d[6]|64,d[8]=63&d[8]|128,b){c=c||0;for(let a=0;a<16;++a)b[c+a]=d[a];return b}return k(d)},u=q("v5",80,function(a){return Array.isArray(a)?a=Buffer.from(a):"string"==typeof a&&(a=Buffer.from(a,"utf8")),d.default.createHash("sha1").update(a).digest()}),v="00000000-0000-0000-0000-000000000000",w=function(a){if(!i(a))throw TypeError("Invalid UUID");return parseInt(a.slice(14,15),16)}},2458,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GaxiosInterceptorManager=void 0;class d extends Set{}c.GaxiosInterceptorManager=d},41610,(a,b,c)=>{"use strict";var d,e,f,g,h,i,j,k=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),l=a.e&&a.e.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),m=a.e&&a.e.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)"default"!==c&&Object.prototype.hasOwnProperty.call(a,c)&&k(b,a,c);return l(b,a),b},n=a.e&&a.e.__classPrivateFieldGet||function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)},o=a.e&&a.e.__classPrivateFieldSet||function(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c},p=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0}),c.Gaxios=void 0;let q=p(a.r(79398)),r=a.r(24836),s=p(a.r(98445)),t=p(a.r(45706)),u=p(a.r(4385)),v=a.r(92509),w=a.r(33985),x=a.r(94706),y=a.r(88947),z=a.r(80741),A=a.r(2458),B=(0,s.default);function C(a,b){for(let c of(b=b.toLowerCase(),Object.keys((null==a?void 0:a.headers)||{})))if(b===c.toLowerCase())return a.headers[c]}class D{constructor(a){d.add(this),this.agentCache=new Map,this.defaults=a||{},this.interceptors={request:new A.GaxiosInterceptorManager,response:new A.GaxiosInterceptorManager}}async request(a={}){return a=await n(this,d,"m",h).call(this,a),a=await n(this,d,"m",f).call(this,a),n(this,d,"m",g).call(this,this._request(a))}async _defaultAdapter(a){let b=a.fetchImplementation||B,c=await b(a.url,a),d=await this.getResponseData(a,c);return this.translateResponse(a,c,d)}async _request(a={}){var b;try{let b;if(b=a.adapter?await a.adapter(a,this._defaultAdapter.bind(this)):await this._defaultAdapter(a),!a.validateStatus(b.status)){if("stream"===a.responseType){let a="";await new Promise(c=>{(null==b?void 0:b.data).on("data",b=>{a+=b}),(null==b?void 0:b.data).on("end",c)}),b.data=a}throw new w.GaxiosError(`Request failed with status code ${b.status}`,a,b)}return b}catch(f){let c=f instanceof w.GaxiosError?f:new w.GaxiosError(f.message,a,void 0,f),{shouldRetry:d,config:e}=await (0,x.getRetryConfig)(c);if(d&&e)return c.config.retryConfig.currentRetryAttempt=e.retryConfig.currentRetryAttempt,a.retryConfig=null==(b=c.config)?void 0:b.retryConfig,this._request(a);throw c}}async getResponseData(a,b){switch(a.responseType){case"stream":return b.body;case"json":{let a=await b.text();try{a=JSON.parse(a)}catch(a){}return a}case"arraybuffer":return b.arrayBuffer();case"blob":return b.blob();case"text":return b.text();default:return this.getResponseDataFromContentType(b)}}validateStatus(a){return a>=200&&a<300}paramsSerializer(a){return t.default.stringify(a)}translateResponse(a,b,c){let d={};return b.headers.forEach((a,b)=>{d[b]=a}),{config:a,data:c,headers:d,status:b.status,statusText:b.statusText,request:{responseURL:b.url}}}async getResponseDataFromContentType(a){let b=a.headers.get("Content-Type");if(null===b)return a.text();if((b=b.toLowerCase()).includes("application/json")){let b=await a.text();try{b=JSON.parse(b)}catch(a){}return b}return b.match(/^text\//)?a.text():a.blob()}async *getMultipartRequest(a,b){let c=`--${b}--`;for(let c of a){let a=c.headers["Content-Type"]||"application/octet-stream",d=`--${b}\r
Content-Type: ${a}\r
\r
`;yield d,"string"==typeof c.content?yield c.content:yield*c.content,yield"\r\n"}yield c}}c.Gaxios=D,d=new WeakSet,e=function(a,b=[]){var c,d;let e=new v.URL(a),f=[...b];for(let a of(null==(d=null!=(c=process.env.NO_PROXY)?c:process.env.no_proxy)?void 0:d.split(","))||[])f.push(a.trim());for(let a of f)if(a instanceof RegExp){if(a.test(e.toString()))return!1}else if(a instanceof v.URL){if(a.origin===e.origin)return!1}else if(a.startsWith("*.")||a.startsWith(".")){let b=a.replace(/^\*\./,".");if(e.hostname.endsWith(b))return!1}else if(a===e.origin||a===e.hostname||a===e.href)return!1;return!0},f=async function(a){let b=Promise.resolve(a);for(let a of this.interceptors.request.values())a&&(b=b.then(a.resolved,a.rejected));return b},g=async function(a){let b=Promise.resolve(a);for(let a of this.interceptors.response.values())a&&(b=b.then(a.resolved,a.rejected));return b},h=async function(a){var b,c,f,g;let h=(0,q.default)(!0,{},this.defaults,a);if(!h.url)throw Error("URL is required.");let i=h.baseUrl||h.baseURL;if(i&&(h.url=i.toString()+h.url),h.paramsSerializer=h.paramsSerializer||this.paramsSerializer,h.params&&Object.keys(h.params).length>0){let a=h.paramsSerializer(h.params);a.startsWith("?")&&(a=a.slice(1));let b=h.url.toString().includes("?")?"&":"?";h.url=h.url+b+a}if("number"==typeof a.maxContentLength&&(h.size=a.maxContentLength),"number"==typeof a.maxRedirects&&(h.follow=a.maxRedirects),h.headers=h.headers||{},void 0===h.multipart&&h.data){let a="undefined"!=typeof FormData&&(null==h?void 0:h.data)instanceof FormData;u.default.readable(h.data)?h.body=h.data:"undefined"!=typeof Buffer&&Buffer.isBuffer(h.data)?(h.body=h.data,C(h,"Content-Type")||(h.headers["Content-Type"]="application/json")):"object"==typeof h.data?a||("application/x-www-form-urlencoded"===C(h,"content-type")?h.body=h.paramsSerializer(h.data):(C(h,"Content-Type")||(h.headers["Content-Type"]="application/json"),h.body=JSON.stringify(h.data))):h.body=h.data}else if(h.multipart&&h.multipart.length>0){let a=(0,z.v4)();h.headers["Content-Type"]=`multipart/related; boundary=${a}`;let b=new y.PassThrough;h.body=b,(0,y.pipeline)(this.getMultipartRequest(h.multipart,a),b,()=>{})}h.validateStatus=h.validateStatus||this.validateStatus,h.responseType=h.responseType||"unknown",h.headers.Accept||"json"!==h.responseType||(h.headers.Accept="application/json"),h.method=h.method||"GET";let k=h.proxy||(null==(b=null==process?void 0:process.env)?void 0:b.HTTPS_PROXY)||(null==(c=null==process?void 0:process.env)?void 0:c.https_proxy)||(null==(f=null==process?void 0:process.env)?void 0:f.HTTP_PROXY)||(null==(g=null==process?void 0:process.env)?void 0:g.http_proxy),l=n(this,d,"m",e).call(this,h.url,h.noProxy);if(h.agent);else if(k&&l){let a=await n(D,D,"m",j).call(D);this.agentCache.has(k)?h.agent=this.agentCache.get(k):(h.agent=new a(k,{cert:h.cert,key:h.key}),this.agentCache.set(k,h.agent))}else h.cert&&h.key&&(this.agentCache.has(h.key)?h.agent=this.agentCache.get(h.key):(h.agent=new r.Agent({cert:h.cert,key:h.key}),this.agentCache.set(h.key,h.agent)));return"function"!=typeof h.errorRedactor&&!1!==h.errorRedactor&&(h.errorRedactor=w.defaultErrorRedactor),h},j=async function(){return o(this,D,n(this,D,"f",i)||(await Promise.resolve().then(()=>m(a.r(48081)))).HttpsProxyAgent,"f",i),n(this,D,"f",i)},i={value:void 0}},48376,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.instance=c.Gaxios=c.GaxiosError=void 0,c.request=h;let f=a.r(41610);Object.defineProperty(c,"Gaxios",{enumerable:!0,get:function(){return f.Gaxios}});var g=a.r(33985);async function h(a){return c.instance.request(a)}Object.defineProperty(c,"GaxiosError",{enumerable:!0,get:function(){return g.GaxiosError}}),e(a.r(2458),c),c.instance=new f.Gaxios},48594,(a,b,c)=>{!function(c){"use strict";var d,e=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,f=Math.ceil,g=Math.floor,h="[BigNumber Error] ",i=h+"Number primitive has more than 15 significant digits: ",j=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function k(a){var b=0|a;return a>0||a===b?b:b-1}function l(a){for(var b,c,d=1,e=a.length,f=a[0]+"";d<e;){for(c=14-(b=a[d++]+"").length;c--;b="0"+b);f+=b}for(e=f.length;48===f.charCodeAt(--e););return f.slice(0,e+1||1)}function m(a,b){var c,d,e=a.c,f=b.c,g=a.s,h=b.s,i=a.e,j=b.e;if(!g||!h)return null;if(c=e&&!e[0],d=f&&!f[0],c||d)return c?d?0:-h:g;if(g!=h)return g;if(c=g<0,d=i==j,!e||!f)return d?0:!e^c?1:-1;if(!d)return i>j^c?1:-1;for(g=0,h=(i=e.length)<(j=f.length)?i:j;g<h;g++)if(e[g]!=f[g])return e[g]>f[g]^c?1:-1;return i==j?0:i>j^c?1:-1}function n(a,b,c,d){if(a<b||a>c||a!==g(a))throw Error(h+(d||"Argument")+("number"==typeof a?a<b||a>c?" out of range: ":" not an integer: ":" not a primitive number: ")+String(a))}function o(a){var b=a.c.length-1;return k(a.e/14)==b&&a.c[b]%2!=0}function p(a,b){return(a.length>1?a.charAt(0)+"."+a.slice(1):a)+(b<0?"e":"e+")+b}function q(a,b,c){var d,e;if(b<0){for(e=c+".";++b;e+=c);a=e+a}else if(d=a.length,++b>d){for(e=c,b-=d;--b;e+=c);a+=e}else b<d&&(a=a.slice(0,b)+"."+a.slice(b));return a}if((d=function a(b){var c,d,r,s,t,u,v,w,x,y=M.prototype={constructor:M,toString:null,valueOf:null},z=new M(1),A=20,B=4,C=-7,D=21,E=-1e7,F=1e7,G=!1,H=1,I=0,J={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},K="0123456789abcdefghijklmnopqrstuvwxyz",L=!0;function M(a,b){var c,d,f,h,j,k,l,m,o=this;if(!(o instanceof M))return new M(a,b);if(null==b){if(a&&!0===a._isBigNumber){o.s=a.s,!a.c||a.e>F?o.c=o.e=null:a.e<E?o.c=[o.e=0]:(o.e=a.e,o.c=a.c.slice());return}if((k="number"==typeof a)&&0*a==0){if(o.s=1/a<0?(a=-a,-1):1,a===~~a){for(h=0,j=a;j>=10;j/=10,h++);h>F?o.c=o.e=null:(o.e=h,o.c=[a]);return}m=String(a)}else{if(!e.test(m=String(a)))return x(o,m,k);o.s=45==m.charCodeAt(0)?(m=m.slice(1),-1):1}(h=m.indexOf("."))>-1&&(m=m.replace(".","")),(j=m.search(/e/i))>0?(h<0&&(h=j),h+=+m.slice(j+1),m=m.substring(0,j)):h<0&&(h=m.length)}else{if(n(b,2,K.length,"Base"),10==b&&L)return Q(o=new M(a),A+o.e+1,B);if(m=String(a),k="number"==typeof a){if(0*a!=0)return x(o,m,k,b);if(o.s=1/a<0?(m=m.slice(1),-1):1,M.DEBUG&&m.replace(/^0\.0*|\./,"").length>15)throw Error(i+a)}else o.s=45===m.charCodeAt(0)?(m=m.slice(1),-1):1;for(c=K.slice(0,b),h=j=0,l=m.length;j<l;j++)if(0>c.indexOf(d=m.charAt(j))){if("."==d){if(j>h){h=l;continue}}else if(!f&&(m==m.toUpperCase()&&(m=m.toLowerCase())||m==m.toLowerCase()&&(m=m.toUpperCase()))){f=!0,j=-1,h=0;continue}return x(o,String(a),k,b)}k=!1,(h=(m=w(m,b,10,o.s)).indexOf("."))>-1?m=m.replace(".",""):h=m.length}for(j=0;48===m.charCodeAt(j);j++);for(l=m.length;48===m.charCodeAt(--l););if(m=m.slice(j,++l)){if(l-=j,k&&M.DEBUG&&l>15&&(a>0x1fffffffffffff||a!==g(a)))throw Error(i+o.s*a);if((h=h-j-1)>F)o.c=o.e=null;else if(h<E)o.c=[o.e=0];else{if(o.e=h,o.c=[],j=(h+1)%14,h<0&&(j+=14),j<l){for(j&&o.c.push(+m.slice(0,j)),l-=14;j<l;)o.c.push(+m.slice(j,j+=14));j=14-(m=m.slice(j)).length}else j-=l;for(;j--;m+="0");o.c.push(+m)}}else o.c=[o.e=0]}function N(a,b,c,d){var e,f,g,h,i;if(null==c?c=B:n(c,0,8),!a.c)return a.toString();if(e=a.c[0],g=a.e,null==b)i=l(a.c),i=1==d||2==d&&(g<=C||g>=D)?p(i,g):q(i,g,"0");else if(f=(a=Q(new M(a),b,c)).e,h=(i=l(a.c)).length,1==d||2==d&&(b<=f||f<=C)){for(;h<b;i+="0",h++);i=p(i,f)}else if(b-=g+(2===d&&f>g),i=q(i,f,"0"),f+1>h){if(--b>0)for(i+=".";b--;i+="0");}else if((b+=f-h)>0)for(f+1==h&&(i+=".");b--;i+="0");return a.s<0&&e?"-"+i:i}function O(a,b){for(var c,d,e=1,f=new M(a[0]);e<a.length;e++)(d=new M(a[e])).s&&(c=m(f,d))!==b&&(0!==c||f.s!==b)||(f=d);return f}function P(a,b,c){for(var d=1,e=b.length;!b[--e];b.pop());for(e=b[0];e>=10;e/=10,d++);return(c=d+14*c-1)>F?a.c=a.e=null:c<E?a.c=[a.e=0]:(a.e=c,a.c=b),a}function Q(a,b,c,d){var e,h,i,k,l,m,n,o=a.c;if(o){a:{for(e=1,k=o[0];k>=10;k/=10,e++);if((h=b-e)<0)h+=14,i=b,n=g((l=o[m=0])/j[e-i-1]%10);else if((m=f((h+1)/14))>=o.length)if(d){for(;o.length<=m;o.push(0));l=n=0,e=1,h%=14,i=h-14+1}else break a;else{for(e=1,l=k=o[m];k>=10;k/=10,e++);h%=14,n=(i=h-14+e)<0?0:g(l/j[e-i-1]%10)}if(d=d||b<0||null!=o[m+1]||(i<0?l:l%j[e-i-1]),d=c<4?(n||d)&&(0==c||c==(a.s<0?3:2)):n>5||5==n&&(4==c||d||6==c&&(h>0?i>0?l/j[e-i]:0:o[m-1])%10&1||c==(a.s<0?8:7)),b<1||!o[0])return o.length=0,d?(b-=a.e+1,o[0]=j[(14-b%14)%14],a.e=-b||0):o[0]=a.e=0,a;if(0==h?(o.length=m,k=1,m--):(o.length=m+1,k=j[14-h],o[m]=i>0?g(l/j[e-i]%j[i])*k:0),d)for(;;)if(0==m){for(h=1,i=o[0];i>=10;i/=10,h++);for(i=o[0]+=k,k=1;i>=10;i/=10,k++);h!=k&&(a.e++,1e14==o[0]&&(o[0]=1));break}else{if(o[m]+=k,1e14!=o[m])break;o[m--]=0,k=1}for(h=o.length;0===o[--h];o.pop());}a.e>F?a.c=a.e=null:a.e<E&&(a.c=[a.e=0])}return a}function R(a){var b,c=a.e;return null===c?a.toString():(b=l(a.c),b=c<=C||c>=D?p(b,c):q(b,c,"0"),a.s<0?"-"+b:b)}return M.clone=a,M.ROUND_UP=0,M.ROUND_DOWN=1,M.ROUND_CEIL=2,M.ROUND_FLOOR=3,M.ROUND_HALF_UP=4,M.ROUND_HALF_DOWN=5,M.ROUND_HALF_EVEN=6,M.ROUND_HALF_CEIL=7,M.ROUND_HALF_FLOOR=8,M.EUCLID=9,M.config=M.set=function(a){var b,c;if(null!=a)if("object"==typeof a){if(a.hasOwnProperty(b="DECIMAL_PLACES")&&(n(c=a[b],0,1e9,b),A=c),a.hasOwnProperty(b="ROUNDING_MODE")&&(n(c=a[b],0,8,b),B=c),a.hasOwnProperty(b="EXPONENTIAL_AT")&&((c=a[b])&&c.pop?(n(c[0],-1e9,0,b),n(c[1],0,1e9,b),C=c[0],D=c[1]):(n(c,-1e9,1e9,b),C=-(D=c<0?-c:c))),a.hasOwnProperty(b="RANGE"))if((c=a[b])&&c.pop)n(c[0],-1e9,-1,b),n(c[1],1,1e9,b),E=c[0],F=c[1];else if(n(c,-1e9,1e9,b),c)E=-(F=c<0?-c:c);else throw Error(h+b+" cannot be zero: "+c);if(a.hasOwnProperty(b="CRYPTO"))if(!!(c=a[b])===c)if(c)if("undefined"!=typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))G=c;else throw G=!c,Error(h+"crypto unavailable");else G=c;else throw Error(h+b+" not true or false: "+c);if(a.hasOwnProperty(b="MODULO_MODE")&&(n(c=a[b],0,9,b),H=c),a.hasOwnProperty(b="POW_PRECISION")&&(n(c=a[b],0,1e9,b),I=c),a.hasOwnProperty(b="FORMAT"))if("object"==typeof(c=a[b]))J=c;else throw Error(h+b+" not an object: "+c);if(a.hasOwnProperty(b="ALPHABET")){if("string"!=typeof(c=a[b])||/^.?$|[+\-.\s]|(.).*\1/.test(c))throw Error(h+b+" invalid: "+c);L="0123456789"==c.slice(0,10),K=c}}else throw Error(h+"Object expected: "+a);return{DECIMAL_PLACES:A,ROUNDING_MODE:B,EXPONENTIAL_AT:[C,D],RANGE:[E,F],CRYPTO:G,MODULO_MODE:H,POW_PRECISION:I,FORMAT:J,ALPHABET:K}},M.isBigNumber=function(a){if(!a||!0!==a._isBigNumber)return!1;if(!M.DEBUG)return!0;var b,c,d=a.c,e=a.e,f=a.s;a:if("[object Array]"==({}).toString.call(d)){if((1===f||-1===f)&&e>=-1e9&&e<=1e9&&e===g(e)){if(0===d[0]){if(0===e&&1===d.length)return!0;break a}if((b=(e+1)%14)<1&&(b+=14),String(d[0]).length==b){for(b=0;b<d.length;b++)if((c=d[b])<0||c>=1e14||c!==g(c))break a;if(0!==c)return!0}}}else if(null===d&&null===e&&(null===f||1===f||-1===f))return!0;throw Error(h+"Invalid BigNumber: "+a)},M.maximum=M.max=function(){return O(arguments,-1)},M.minimum=M.min=function(){return O(arguments,1)},c=0x20000000000000*Math.random()&2097151?function(){return g(0x20000000000000*Math.random())}:function(){return(0x40000000*Math.random()|0)*8388608+(8388608*Math.random()|0)},M.random=function(a){var b,d,e,i,k,l=0,m=[],o=new M(z);if(null==a?a=A:n(a,0,1e9),i=f(a/14),G)if(crypto.getRandomValues){for(b=crypto.getRandomValues(new Uint32Array(i*=2));l<i;)(k=131072*b[l]+(b[l+1]>>>11))>=9e15?(d=crypto.getRandomValues(new Uint32Array(2)),b[l]=d[0],b[l+1]=d[1]):(m.push(k%1e14),l+=2);l=i/2}else if(crypto.randomBytes){for(b=crypto.randomBytes(i*=7);l<i;)(k=(31&b[l])*0x1000000000000+0x10000000000*b[l+1]+0x100000000*b[l+2]+0x1000000*b[l+3]+(b[l+4]<<16)+(b[l+5]<<8)+b[l+6])>=9e15?crypto.randomBytes(7).copy(b,l):(m.push(k%1e14),l+=7);l=i/7}else throw G=!1,Error(h+"crypto unavailable");if(!G)for(;l<i;)(k=c())<9e15&&(m[l++]=k%1e14);for(i=m[--l],a%=14,i&&a&&(k=j[14-a],m[l]=g(i/k)*k);0===m[l];m.pop(),l--);if(l<0)m=[e=0];else{for(e=-1;0===m[0];m.splice(0,1),e-=14);for(l=1,k=m[0];k>=10;k/=10,l++);l<14&&(e-=14-l)}return o.e=e,o.c=m,o},M.sum=function(){for(var a=1,b=arguments,c=new M(b[0]);a<b.length;)c=c.plus(b[a++]);return c},w=function(){var a="0123456789";function b(a,b,c,d){for(var e,f,g=[0],h=0,i=a.length;h<i;){for(f=g.length;f--;g[f]*=b);for(g[0]+=d.indexOf(a.charAt(h++)),e=0;e<g.length;e++)g[e]>c-1&&(null==g[e+1]&&(g[e+1]=0),g[e+1]+=g[e]/c|0,g[e]%=c)}return g.reverse()}return function(c,d,e,f,g){var h,i,j,k,m,n,o,p,r=c.indexOf("."),s=A,t=B;for(r>=0&&(k=I,I=0,c=c.replace(".",""),n=(p=new M(d)).pow(c.length-r),I=k,p.c=b(q(l(n.c),n.e,"0"),10,e,a),p.e=p.c.length),j=k=(o=b(c,d,e,g?(h=K,a):(h=a,K))).length;0==o[--k];o.pop());if(!o[0])return h.charAt(0);if(r<0?--j:(n.c=o,n.e=j,n.s=f,o=(n=v(n,p,s,t,e)).c,m=n.r,j=n.e),r=o[i=j+s+1],k=e/2,m=m||i<0||null!=o[i+1],m=t<4?(null!=r||m)&&(0==t||t==(n.s<0?3:2)):r>k||r==k&&(4==t||m||6==t&&1&o[i-1]||t==(n.s<0?8:7)),i<1||!o[0])c=m?q(h.charAt(1),-s,h.charAt(0)):h.charAt(0);else{if(o.length=i,m)for(--e;++o[--i]>e;)o[i]=0,i||(++j,o=[1].concat(o));for(k=o.length;!o[--k];);for(r=0,c="";r<=k;c+=h.charAt(o[r++]));c=q(c,j,h.charAt(0))}return c}}(),v=function(){function a(a,b,c){var d,e,f,g,h=0,i=a.length,j=b%1e7,k=b/1e7|0;for(a=a.slice();i--;)d=k*(f=a[i]%1e7)+(g=a[i]/1e7|0)*j,h=((e=j*f+d%1e7*1e7+h)/c|0)+(d/1e7|0)+k*g,a[i]=e%c;return h&&(a=[h].concat(a)),a}function b(a,b,c,d){var e,f;if(c!=d)f=c>d?1:-1;else for(e=f=0;e<c;e++)if(a[e]!=b[e]){f=a[e]>b[e]?1:-1;break}return f}function c(a,b,c,d){for(var e=0;c--;)a[c]-=e,e=+(a[c]<b[c]),a[c]=e*d+a[c]-b[c];for(;!a[0]&&a.length>1;a.splice(0,1));}return function(d,e,f,h,i){var j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=d.s==e.s?1:-1,C=d.c,D=e.c;if(!C||!C[0]||!D||!D[0])return new M(!d.s||!e.s||(C?D&&C[0]==D[0]:!D)?NaN:C&&0==C[0]||!D?0*B:B/0);for(s=(r=new M(B)).c=[],B=f+(l=d.e-e.e)+1,i||(i=1e14,l=k(d.e/14)-k(e.e/14),B=B/14|0),m=0;D[m]==(C[m]||0);m++);if(D[m]>(C[m]||0)&&l--,B<0)s.push(1),n=!0;else{for(x=C.length,z=D.length,m=0,B+=2,(o=g(i/(D[0]+1)))>1&&(D=a(D,o,i),C=a(C,o,i),z=D.length,x=C.length),w=z,u=(t=C.slice(0,z)).length;u<z;t[u++]=0);A=[0].concat(A=D.slice()),y=D[0],D[1]>=i/2&&y++;do{if(o=0,(j=b(D,t,z,u))<0){if(v=t[0],z!=u&&(v=v*i+(t[1]||0)),(o=g(v/y))>1)for(o>=i&&(o=i-1),q=(p=a(D,o,i)).length,u=t.length;1==b(p,t,q,u);)o--,c(p,z<q?A:D,q,i),q=p.length,j=1;else 0==o&&(j=o=1),q=(p=D.slice()).length;if(q<u&&(p=[0].concat(p)),c(t,p,u,i),u=t.length,-1==j)for(;1>b(D,t,z,u);)o++,c(t,z<u?A:D,u,i),u=t.length}else 0===j&&(o++,t=[0]);s[m++]=o,t[0]?t[u++]=C[w]||0:(t=[C[w]],u=1)}while((w++<x||null!=t[0])&&B--)n=null!=t[0],s[0]||s.splice(0,1)}if(1e14==i){for(m=1,B=s[0];B>=10;B/=10,m++);Q(r,f+(r.e=m+14*l-1)+1,h,n)}else r.e=l,r.r=+n;return r}}(),d=/^(-?)0([xbo])(?=\w[\w.]*$)/i,r=/^([^.]+)\.$/,s=/^\.([^.]+)$/,t=/^-?(Infinity|NaN)$/,u=/^\s*\+(?=[\w.])|^\s+|\s+$/g,x=function(a,b,c,e){var f,g=c?b:b.replace(u,"");if(t.test(g))a.s=isNaN(g)?null:g<0?-1:1;else{if(!c&&(g=g.replace(d,function(a,b,c){return f="x"==(c=c.toLowerCase())?16:"b"==c?2:8,e&&e!=f?a:b}),e&&(f=e,g=g.replace(r,"$1").replace(s,"0.$1")),b!=g))return new M(g,f);if(M.DEBUG)throw Error(h+"Not a"+(e?" base "+e:"")+" number: "+b);a.s=null}a.c=a.e=null},y.absoluteValue=y.abs=function(){var a=new M(this);return a.s<0&&(a.s=1),a},y.comparedTo=function(a,b){return m(this,new M(a,b))},y.decimalPlaces=y.dp=function(a,b){var c,d,e;if(null!=a)return n(a,0,1e9),null==b?b=B:n(b,0,8),Q(new M(this),a+this.e+1,b);if(!(c=this.c))return null;if(d=((e=c.length-1)-k(this.e/14))*14,e=c[e])for(;e%10==0;e/=10,d--);return d<0&&(d=0),d},y.dividedBy=y.div=function(a,b){return v(this,new M(a,b),A,B)},y.dividedToIntegerBy=y.idiv=function(a,b){return v(this,new M(a,b),0,1)},y.exponentiatedBy=y.pow=function(a,b){var c,d,e,i,j,k,l,m,n,p=this;if((a=new M(a)).c&&!a.isInteger())throw Error(h+"Exponent not an integer: "+R(a));if(null!=b&&(b=new M(b)),k=a.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!a.c||!a.c[0])return n=new M(Math.pow(+R(p),k?a.s*(2-o(a)):+R(a))),b?n.mod(b):n;if(l=a.s<0,b){if(b.c?!b.c[0]:!b.s)return new M(NaN);(d=!l&&p.isInteger()&&b.isInteger())&&(p=p.mod(b))}else{if(a.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||k&&p.c[1]>=24e7:p.c[0]<8e13||k&&p.c[0]<=9999975e7)))return i=p.s<0&&o(a)?-0:0,p.e>-1&&(i=1/i),new M(l?1/i:i);I&&(i=f(I/14+2))}for(k?(c=new M(.5),l&&(a.s=1),m=o(a)):m=(e=Math.abs(+R(a)))%2,n=new M(z);;){if(m){if(!(n=n.times(p)).c)break;i?n.c.length>i&&(n.c.length=i):d&&(n=n.mod(b))}if(e){if(0===(e=g(e/2)))break;m=e%2}else if(Q(a=a.times(c),a.e+1,1),a.e>14)m=o(a);else{if(0==(e=+R(a)))break;m=e%2}p=p.times(p),i?p.c&&p.c.length>i&&(p.c.length=i):d&&(p=p.mod(b))}return d?n:(l&&(n=z.div(n)),b?n.mod(b):i?Q(n,I,B,j):n)},y.integerValue=function(a){var b=new M(this);return null==a?a=B:n(a,0,8),Q(b,b.e+1,a)},y.isEqualTo=y.eq=function(a,b){return 0===m(this,new M(a,b))},y.isFinite=function(){return!!this.c},y.isGreaterThan=y.gt=function(a,b){return m(this,new M(a,b))>0},y.isGreaterThanOrEqualTo=y.gte=function(a,b){return 1===(b=m(this,new M(a,b)))||0===b},y.isInteger=function(){return!!this.c&&k(this.e/14)>this.c.length-2},y.isLessThan=y.lt=function(a,b){return 0>m(this,new M(a,b))},y.isLessThanOrEqualTo=y.lte=function(a,b){return -1===(b=m(this,new M(a,b)))||0===b},y.isNaN=function(){return!this.s},y.isNegative=function(){return this.s<0},y.isPositive=function(){return this.s>0},y.isZero=function(){return!!this.c&&0==this.c[0]},y.minus=function(a,b){var c,d,e,f,g=this.s;if(b=(a=new M(a,b)).s,!g||!b)return new M(NaN);if(g!=b)return a.s=-b,this.plus(a);var h=this.e/14,i=a.e/14,j=this.c,l=a.c;if(!h||!i){if(!j||!l)return j?(a.s=-b,a):new M(l?this:NaN);if(!j[0]||!l[0])return l[0]?(a.s=-b,a):new M(j[0]?this:3==B?-0:0)}if(h=k(h),i=k(i),j=j.slice(),g=h-i){for((f=g<0)?(g=-g,e=j):(i=h,e=l),e.reverse(),b=g;b--;e.push(0));e.reverse()}else for(d=(f=(g=j.length)<(b=l.length))?g:b,g=b=0;b<d;b++)if(j[b]!=l[b]){f=j[b]<l[b];break}if(f&&(e=j,j=l,l=e,a.s=-a.s),(b=(d=l.length)-(c=j.length))>0)for(;b--;j[c++]=0);for(b=1e14-1;d>g;){if(j[--d]<l[d]){for(c=d;c&&!j[--c];j[c]=b);--j[c],j[d]+=1e14}j[d]-=l[d]}for(;0==j[0];j.splice(0,1),--i);return j[0]?P(a,j,i):(a.s=3==B?-1:1,a.c=[a.e=0],a)},y.modulo=y.mod=function(a,b){var c,d;return(a=new M(a,b),this.c&&a.s&&(!a.c||a.c[0]))?a.c&&(!this.c||this.c[0])?(9==H?(d=a.s,a.s=1,c=v(this,a,0,3),a.s=d,c.s*=d):c=v(this,a,0,H),(a=this.minus(c.times(a))).c[0]||1!=H||(a.s=this.s),a):new M(this):new M(NaN)},y.multipliedBy=y.times=function(a,b){var c,d,e,f,g,h,i,j,l,m,n,o,p,q=this.c,r=(a=new M(a,b)).c;if(!q||!r||!q[0]||!r[0])return this.s&&a.s&&(!q||q[0]||r)&&(!r||r[0]||q)?(a.s*=this.s,q&&r?(a.c=[0],a.e=0):a.c=a.e=null):a.c=a.e=a.s=null,a;for(d=k(this.e/14)+k(a.e/14),a.s*=this.s,(i=q.length)<(m=r.length)&&(p=q,q=r,r=p,e=i,i=m,m=e),e=i+m,p=[];e--;p.push(0));for(e=m;--e>=0;){for(c=0,n=r[e]%1e7,o=r[e]/1e7|0,f=e+(g=i);f>e;)h=o*(j=q[--g]%1e7)+(l=q[g]/1e7|0)*n,c=((j=n*j+h%1e7*1e7+p[f]+c)/1e14|0)+(h/1e7|0)+o*l,p[f--]=j%1e14;p[f]=c}return c?++d:p.splice(0,1),P(a,p,d)},y.negated=function(){var a=new M(this);return a.s=-a.s||null,a},y.plus=function(a,b){var c,d=this.s;if(b=(a=new M(a,b)).s,!d||!b)return new M(NaN);if(d!=b)return a.s=-b,this.minus(a);var e=this.e/14,f=a.e/14,g=this.c,h=a.c;if(!e||!f){if(!g||!h)return new M(d/0);if(!g[0]||!h[0])return h[0]?a:new M(g[0]?this:0*d)}if(e=k(e),f=k(f),g=g.slice(),d=e-f){for(d>0?(f=e,c=h):(d=-d,c=g),c.reverse();d--;c.push(0));c.reverse()}for((d=g.length)-(b=h.length)<0&&(c=h,h=g,g=c,b=d),d=0;b;)d=(g[--b]=g[b]+h[b]+d)/1e14|0,g[b]=1e14===g[b]?0:g[b]%1e14;return d&&(g=[d].concat(g),++f),P(a,g,f)},y.precision=y.sd=function(a,b){var c,d,e;if(null!=a&&!!a!==a)return n(a,1,1e9),null==b?b=B:n(b,0,8),Q(new M(this),a,b);if(!(c=this.c))return null;if(d=14*(e=c.length-1)+1,e=c[e]){for(;e%10==0;e/=10,d--);for(e=c[0];e>=10;e/=10,d++);}return a&&this.e+1>d&&(d=this.e+1),d},y.shiftedBy=function(a){return n(a,-0x1fffffffffffff,0x1fffffffffffff),this.times("1e"+a)},y.squareRoot=y.sqrt=function(){var a,b,c,d,e,f=this.c,g=this.s,h=this.e,i=A+4,j=new M("0.5");if(1!==g||!f||!f[0])return new M(!g||g<0&&(!f||f[0])?NaN:f?this:1/0);if(0==(g=Math.sqrt(+R(this)))||g==1/0?(((b=l(f)).length+h)%2==0&&(b+="0"),g=Math.sqrt(+b),h=k((h+1)/2)-(h<0||h%2),c=new M(b=g==1/0?"5e"+h:(b=g.toExponential()).slice(0,b.indexOf("e")+1)+h)):c=new M(g+""),c.c[0]){for((g=(h=c.e)+i)<3&&(g=0);;)if(e=c,c=j.times(e.plus(v(this,e,i,1))),l(e.c).slice(0,g)===(b=l(c.c)).slice(0,g)){if(c.e<h&&--g,"9999"!=(b=b.slice(g-3,g+1))&&(d||"4999"!=b)){+b&&(+b.slice(1)||"5"!=b.charAt(0))||(Q(c,c.e+A+2,1),a=!c.times(c).eq(this));break}if(!d&&(Q(e,e.e+A+2,0),e.times(e).eq(this))){c=e;break}i+=4,g+=4,d=1}}return Q(c,c.e+A+1,B,a)},y.toExponential=function(a,b){return null!=a&&(n(a,0,1e9),a++),N(this,a,b,1)},y.toFixed=function(a,b){return null!=a&&(n(a,0,1e9),a=a+this.e+1),N(this,a,b)},y.toFormat=function(a,b,c){var d;if(null==c)null!=a&&b&&"object"==typeof b?(c=b,b=null):a&&"object"==typeof a?(c=a,a=b=null):c=J;else if("object"!=typeof c)throw Error(h+"Argument not an object: "+c);if(d=this.toFixed(a,b),this.c){var e,f=d.split("."),g=+c.groupSize,i=+c.secondaryGroupSize,j=c.groupSeparator||"",k=f[0],l=f[1],m=this.s<0,n=m?k.slice(1):k,o=n.length;if(i&&(e=g,g=i,i=e,o-=e),g>0&&o>0){for(e=o%g||g,k=n.substr(0,e);e<o;e+=g)k+=j+n.substr(e,g);i>0&&(k+=j+n.slice(e)),m&&(k="-"+k)}d=l?k+(c.decimalSeparator||"")+((i=+c.fractionGroupSize)?l.replace(RegExp("\\d{"+i+"}\\B","g"),"$&"+(c.fractionGroupSeparator||"")):l):k}return(c.prefix||"")+d+(c.suffix||"")},y.toFraction=function(a){var b,c,d,e,f,g,i,k,m,n,o,p,q=this.c;if(null!=a&&(!(i=new M(a)).isInteger()&&(i.c||1!==i.s)||i.lt(z)))throw Error(h+"Argument "+(i.isInteger()?"out of range: ":"not an integer: ")+R(i));if(!q)return new M(this);for(b=new M(z),m=c=new M(z),d=k=new M(z),p=l(q),f=b.e=p.length-this.e-1,b.c[0]=j[(g=f%14)<0?14+g:g],a=!a||i.comparedTo(b)>0?f>0?b:m:i,g=F,F=1/0,i=new M(p),k.c[0]=0;n=v(i,b,0,1),1!=(e=c.plus(n.times(d))).comparedTo(a);)c=d,d=e,m=k.plus(n.times(e=m)),k=e,b=i.minus(n.times(e=b)),i=e;return e=v(a.minus(c),d,0,1),k=k.plus(e.times(m)),c=c.plus(e.times(d)),k.s=m.s=this.s,f*=2,o=1>v(m,d,f,B).minus(this).abs().comparedTo(v(k,c,f,B).minus(this).abs())?[m,d]:[k,c],F=g,o},y.toNumber=function(){return+R(this)},y.toPrecision=function(a,b){return null!=a&&n(a,1,1e9),N(this,a,b,2)},y.toString=function(a){var b,c=this,d=c.s,e=c.e;return null===e?d?(b="Infinity",d<0&&(b="-"+b)):b="NaN":(null==a?b=e<=C||e>=D?p(l(c.c),e):q(l(c.c),e,"0"):10===a&&L?b=q(l((c=Q(new M(c),A+e+1,B)).c),c.e,"0"):(n(a,2,K.length,"Base"),b=w(q(l(c.c),e,"0"),10,a,d,!0)),d<0&&c.c[0]&&(b="-"+b)),b},y.valueOf=y.toJSON=function(){return R(this)},y._isBigNumber=!0,null!=b&&M.set(b),M}()).default=d.BigNumber=d,"function"==typeof define&&define.amd)a.r,void 0!==d&&a.v(d);else b.exports?b.exports=d:(c||(c="undefined"!=typeof self&&self?self:window),c.BigNumber=d)}(a.e)},35898,(a,b,c)=>{var d=a.r(48594),e=b.exports;!function(){"use strict";var a,b,c,f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function h(a){return f.lastIndex=0,f.test(a)?'"'+a.replace(f,function(a){var b=g[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}"function"!=typeof e.stringify&&(e.stringify=function(e,f,g){var i;if(a="",b="","number"==typeof g)for(i=0;i<g;i+=1)b+=" ";else"string"==typeof g&&(b=g);if(c=f,f&&"function"!=typeof f&&("object"!=typeof f||"number"!=typeof f.length))throw Error("JSON.stringify");return function e(f,g){var i,j,k,l,m,n=a,o=g[f],p=null!=o&&(o instanceof d||d.isBigNumber(o));switch(o&&"object"==typeof o&&"function"==typeof o.toJSON&&(o=o.toJSON(f)),"function"==typeof c&&(o=c.call(g,f,o)),typeof o){case"string":if(p)return o;return h(o);case"number":return isFinite(o)?String(o):"null";case"boolean":case"null":case"bigint":return String(o);case"object":if(!o)return"null";if(a+=b,m=[],"[object Array]"===Object.prototype.toString.apply(o)){for(i=0,l=o.length;i<l;i+=1)m[i]=e(i,o)||"null";return k=0===m.length?"[]":a?"[\n"+a+m.join(",\n"+a)+"\n"+n+"]":"["+m.join(",")+"]",a=n,k}if(c&&"object"==typeof c)for(i=0,l=c.length;i<l;i+=1)"string"==typeof c[i]&&(k=e(j=c[i],o))&&m.push(h(j)+(a?": ":":")+k);else Object.keys(o).forEach(function(b){var c=e(b,o);c&&m.push(h(b)+(a?": ":":")+c)});return k=0===m.length?"{}":a?"{\n"+a+m.join(",\n"+a)+"\n"+n+"}":"{"+m.join(",")+"}",a=n,k}}("",{"":e})})}()},42672,(a,b,c)=>{var d=null;let e=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,f=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;b.exports=function(b){"use strict";var c={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(null!=b){if(!0===b.strict&&(c.strict=!0),!0===b.storeAsString&&(c.storeAsString=!0),c.alwaysParseAsBig=!0===b.alwaysParseAsBig&&b.alwaysParseAsBig,c.useNativeBigInt=!0===b.useNativeBigInt&&b.useNativeBigInt,void 0!==b.constructorAction)if("error"===b.constructorAction||"ignore"===b.constructorAction||"preserve"===b.constructorAction)c.constructorAction=b.constructorAction;else throw Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${b.constructorAction}`);if(void 0!==b.protoAction)if("error"===b.protoAction||"ignore"===b.protoAction||"preserve"===b.protoAction)c.protoAction=b.protoAction;else throw Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${b.protoAction}`)}var g,h,i,j,k={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},l=function(a){throw{name:"SyntaxError",message:a,at:g,text:i}},m=function(a){return a&&a!==h&&l("Expected '"+a+"' instead of '"+h+"'"),h=i.charAt(g),g+=1,h},n=function(){var b,e="";for("-"===h&&(e="-",m("-"));h>="0"&&h<="9";)e+=h,m();if("."===h)for(e+=".";m()&&h>="0"&&h<="9";)e+=h;if("e"===h||"E"===h)for(e+=h,m(),("-"===h||"+"===h)&&(e+=h,m());h>="0"&&h<="9";)e+=h,m();if(isFinite(b=+e))return(null==d&&(d=a.r(48594)),e.length>15)?c.storeAsString?e:c.useNativeBigInt?BigInt(e):new d(e):c.alwaysParseAsBig?c.useNativeBigInt?BigInt(b):new d(b):b;l("Bad number")},o=function(){var a,b,c,d="";if('"'===h)for(var e=g;m();){if('"'===h)return g-1>e&&(d+=i.substring(e,g-1)),m(),d;if("\\"===h){if(g-1>e&&(d+=i.substring(e,g-1)),m(),"u"===h){for(b=0,c=0;b<4&&isFinite(a=parseInt(m(),16));b+=1)c=16*c+a;d+=String.fromCharCode(c)}else if("string"==typeof k[h])d+=k[h];else break;e=g}}l("Bad string")},p=function(){for(;h&&h<=" ";)m()},q=function(){switch(h){case"t":return m("t"),m("r"),m("u"),m("e"),!0;case"f":return m("f"),m("a"),m("l"),m("s"),m("e"),!1;case"n":return m("n"),m("u"),m("l"),m("l"),null}l("Unexpected '"+h+"'")},r=function(){var a=[];if("["===h){if(m("["),p(),"]"===h)return m("]"),a;for(;h;){if(a.push(j()),p(),"]"===h)return m("]"),a;m(","),p()}}l("Bad array")},s=function(){var a,b=Object.create(null);if("{"===h){if(m("{"),p(),"}"===h)return m("}"),b;for(;h;){if(a=o(),p(),m(":"),!0===c.strict&&Object.hasOwnProperty.call(b,a)&&l('Duplicate key "'+a+'"'),!0===e.test(a)?"error"===c.protoAction?l("Object contains forbidden prototype property"):"ignore"===c.protoAction?j():b[a]=j():!0===f.test(a)?"error"===c.constructorAction?l("Object contains forbidden constructor property"):"ignore"===c.constructorAction?j():b[a]=j():b[a]=j(),p(),"}"===h)return m("}"),b;m(","),p()}}l("Bad object")};return j=function(){switch(p(),h){case"{":return s();case"[":return r();case'"':return o();case"-":return n();default:return h>="0"&&h<="9"?n():q()}},function(a,b){var c;return i=a+"",g=0,h=" ",c=j(),p(),h&&l("Syntax error"),"function"==typeof b?function a(c,d){var e,f=c[d];return f&&"object"==typeof f&&Object.keys(f).forEach(function(b){void 0!==(e=a(f,b))?f[b]=e:delete f[b]}),b.call(c,d,f)}({"":c},""):c}}},82827,(a,b,c)=>{var d=a.r(35898).stringify,e=a.r(42672);b.exports=function(a){return{parse:e(a),stringify:d}},b.exports.parse=e(),b.exports.stringify=d},78494,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Colours=void 0;class d{static isEnabled(a){return a.isTTY&&("function"!=typeof a.getColorDepth||a.getColorDepth()>2)}static refresh(){d.enabled=d.isEnabled(process.stderr),this.enabled?(d.reset="\x1b[0m",d.bright="\x1b[1m",d.dim="\x1b[2m",d.red="\x1b[31m",d.green="\x1b[32m",d.yellow="\x1b[33m",d.blue="\x1b[34m",d.magenta="\x1b[35m",d.cyan="\x1b[36m",d.white="\x1b[37m",d.grey="\x1b[90m"):(d.reset="",d.bright="",d.dim="",d.red="",d.green="",d.yellow="",d.blue="",d.magenta="",d.cyan="",d.white="",d.grey="")}}c.Colours=d,d.enabled=!1,d.reset="",d.bright="",d.dim="",d.red="",d.green="",d.yellow="",d.blue="",d.magenta="",d.cyan="",d.white="",d.grey="",d.refresh()},71247,(a,b,c)=>{"use strict";let d;var e,f=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),g=a.e&&a.e.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),h=a.e&&a.e.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)"default"!==c&&Object.prototype.hasOwnProperty.call(a,c)&&f(b,a,c);return g(b,a),b};Object.defineProperty(c,"__esModule",{value:!0}),c.env=c.DebugLogBackendBase=c.placeholder=c.AdhocDebugLogger=c.LogSeverity=void 0,c.getNodeBackend=p,c.getDebugBackend=function(a){return new q(a)},c.getStructuredBackend=function(a){return new r(a)},c.setBackend=function(a){d=a,s.clear()},c.log=t;let i=a.r(87769),j=h(a.r(59639)),k=h(a.r(12057)),l=a.r(78494);!function(a){a.DEFAULT="DEFAULT",a.DEBUG="DEBUG",a.INFO="INFO",a.WARNING="WARNING",a.ERROR="ERROR"}(e||(c.LogSeverity=e={}));class m extends i.EventEmitter{constructor(a,b){super(),this.namespace=a,this.upstream=b,this.func=Object.assign(this.invoke.bind(this),{instance:this,on:(a,b)=>this.on(a,b)}),this.func.debug=(...a)=>this.invokeSeverity(e.DEBUG,...a),this.func.info=(...a)=>this.invokeSeverity(e.INFO,...a),this.func.warn=(...a)=>this.invokeSeverity(e.WARNING,...a),this.func.error=(...a)=>this.invokeSeverity(e.ERROR,...a),this.func.sublog=a=>t(a,this.func)}invoke(a,...b){this.upstream&&this.upstream(a,...b),this.emit("log",a,b)}invokeSeverity(a,...b){this.invoke({severity:a},...b)}}c.AdhocDebugLogger=m,c.placeholder=new m("",()=>{}).func;class n{constructor(){var a;this.cached=new Map,this.filters=[],this.filtersSet=!1;let b=null!=(a=j.env[c.env.nodeEnables])?a:"*";"all"===b&&(b="*"),this.filters=b.split(",")}log(a,b,...c){try{this.filtersSet||(this.setFilters(),this.filtersSet=!0);let d=this.cached.get(a);d||(d=this.makeLogger(a),this.cached.set(a,d)),d(b,...c)}catch(a){console.error(a)}}}c.DebugLogBackendBase=n;class o extends n{constructor(){super(...arguments),this.enabledRegexp=/.*/g}isEnabled(a){return this.enabledRegexp.test(a)}makeLogger(a){return this.enabledRegexp.test(a)?(b,...c)=>{var d;let f,g=`${l.Colours.green}${a}${l.Colours.reset}`,h=`${l.Colours.yellow}${j.pid}${l.Colours.reset}`;switch(b.severity){case e.ERROR:f=`${l.Colours.red}${b.severity}${l.Colours.reset}`;break;case e.INFO:f=`${l.Colours.magenta}${b.severity}${l.Colours.reset}`;break;case e.WARNING:f=`${l.Colours.yellow}${b.severity}${l.Colours.reset}`;break;default:f=null!=(d=b.severity)?d:e.DEFAULT}let i=k.formatWithOptions({colors:l.Colours.enabled},...c),m=Object.assign({},b);delete m.severity;let n=Object.getOwnPropertyNames(m).length?JSON.stringify(m):"",o=n?`${l.Colours.grey}${n}${l.Colours.reset}`:"";console.error("%s [%s|%s] %s%s",h,g,f,i,n?` ${o}`:"")}:()=>{}}setFilters(){let a=this.filters.join(",").replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^");this.enabledRegexp=RegExp(`^${a}$`,"i")}}function p(){return new o}class q extends n{constructor(a){super(),this.debugPkg=a}makeLogger(a){let b=this.debugPkg(a);return(a,...c)=>{b(c[0],...c.slice(1))}}setFilters(){var a;let b=null!=(a=j.env.NODE_DEBUG)?a:"";j.env.NODE_DEBUG=`${b}${b?",":""}${this.filters.join(",")}`}}class r extends n{constructor(a){super(),this.upstream=null!=a?a:new o}makeLogger(a){let b=this.upstream.makeLogger(a);return(a,...c)=>{var d;let f=JSON.stringify(Object.assign({severity:null!=(d=a.severity)?d:e.INFO,message:k.format(...c)},a));b(a,f)}}setFilters(){this.upstream.setFilters()}}c.env={nodeEnables:"GOOGLE_SDK_NODE_LOGGING"};let s=new Map;function t(a,b){let e;if(!j.env[c.env.nodeEnables]||!a)return c.placeholder;b&&(a=`${b.instance.namespace}:${a}`);let f=s.get(a);if(f)return f.func;if(null===d)return c.placeholder;void 0===d&&(d=p());let g=new m(a,(b,...c)=>{if(e!==d){if(null===d)return;void 0===d&&(d=p()),e=d}null==d||d.log(a,b,...c)});return s.set(a,g),g.func}},13551,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),e(a.r(71247),c)},76120,(a,b,c)=>{"use strict";let d;var e=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),f=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||e(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.gcpResidencyCache=c.METADATA_SERVER_DETECTION=c.HEADERS=c.HEADER_VALUE=c.HEADER_NAME=c.SECONDARY_HOST_ADDRESS=c.HOST_ADDRESS=c.BASE_PATH=void 0,c.instance=function(a){return m("instance",a)},c.project=function(a){return m("project",a)},c.universe=function(a){return m("universe",a)},c.bulk=o,c.isAvailable=p,c.resetIsAvailableCache=function(){d=void 0},c.getGCPResidency=q,c.setGCPResidency=r,c.requestTimeout=s;let g=a.r(48376),h=a.r(82827),i=a.r(53255),j=a.r(13551);c.BASE_PATH="/computeMetadata/v1",c.HOST_ADDRESS="http://169.254.169.254",c.SECONDARY_HOST_ADDRESS="http://metadata.google.internal.",c.HEADER_NAME="Metadata-Flavor",c.HEADER_VALUE="Google",c.HEADERS=Object.freeze({[c.HEADER_NAME]:c.HEADER_VALUE});let k=j.log("gcp metadata");function l(a){return a||(a=process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST||c.HOST_ADDRESS),/^https?:\/\//.test(a)||(a=`http://${a}`),new URL(c.BASE_PATH,a).href}async function m(a,b={},d=3,e=!1){let f="",i={},j={};("object"==typeof a?(f=a.metadataKey,i=a.params||i,j=a.headers||j,d=a.noResponseRetries||d,e=a.fastFail||e):f=a,"string"==typeof b)?f+=`/${b}`:(Object.keys(b).forEach(a=>{switch(a){case"params":case"property":case"headers":break;case"qs":throw Error("'qs' is not a valid configuration option. Please use 'params' instead.");default:throw Error(`'${a}' is not a valid configuration option.`)}}),b.property&&(f+=`/${b.property}`),j=b.headers||j,i=b.params||i);let o=e?n:g.request,p={url:`${l()}/${f}`,headers:{...c.HEADERS,...j},retryConfig:{noResponseRetries:d},params:i,responseType:"text",timeout:s()};k.info("instance request %j",p);let q=await o(p);if(k.info("instance metadata is %s",q.data),q.headers[c.HEADER_NAME.toLowerCase()]!==c.HEADER_VALUE)throw Error(`Invalid response from metadata service: incorrect ${c.HEADER_NAME} header. Expected '${c.HEADER_VALUE}', got ${q.headers[c.HEADER_NAME.toLowerCase()]?`'${q.headers[c.HEADER_NAME.toLowerCase()]}'`:"no header"}`);if("string"==typeof q.data)try{return h.parse(q.data)}catch(a){}return q.data}async function n(a){var b;let d={...a,url:null==(b=a.url)?void 0:b.toString().replace(l(),l(c.SECONDARY_HOST_ADDRESS))},e=!1,f=(0,g.request)(a).then(a=>(e=!0,a)).catch(a=>{if(e)return h;throw e=!0,a}),h=(0,g.request)(d).then(a=>(e=!0,a)).catch(a=>{if(e)return f;throw e=!0,a});return Promise.race([f,h])}async function o(a){let b={};return await Promise.all(a.map(a=>(async()=>{let c=await m(a);b[a.metadataKey]=c})())),b}async function p(){if(process.env.METADATA_SERVER_DETECTION){let a=process.env.METADATA_SERVER_DETECTION.trim().toLocaleLowerCase();if(!(a in c.METADATA_SERVER_DETECTION))throw RangeError(`Unknown \`METADATA_SERVER_DETECTION\` env variable. Got \`${a}\`, but it should be \`${Object.keys(c.METADATA_SERVER_DETECTION).join("`, `")}\`, or unset`);switch(a){case"assume-present":return!0;case"none":return!1;case"bios-only":return q()}}try{return void 0===d&&(d=m("instance",void 0,process.env.DETECT_GCP_RETRIES?Number(process.env.DETECT_GCP_RETRIES):0,!(process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST))),await d,!0}catch(a){if(process.env.DEBUG_AUTH&&console.info(a),"request-timeout"===a.type||a.response&&404===a.response.status)return!1;if(!(a.response&&404===a.response.status)&&(!a.code||!["EHOSTDOWN","EHOSTUNREACH","ENETUNREACH","ENOENT","ENOTFOUND","ECONNREFUSED"].includes(a.code))){let b="UNKNOWN";a.code&&(b=a.code),process.emitWarning(`received unexpected error = ${a.message} code = ${b}`,"MetadataLookupWarning")}return!1}}function q(){return null===c.gcpResidencyCache&&r(),c.gcpResidencyCache}function r(a=null){c.gcpResidencyCache=null!==a?a:(0,i.detectGCPResidency)()}function s(){return 3e3*!q()}c.METADATA_SERVER_DETECTION=Object.freeze({"assume-present":"don't try to ping the metadata server, but assume it's present",none:"don't try to ping the metadata server, but don't try to use it either","bios-only":"treat the result of a BIOS probe as canonical (don't fall back to pinging)","ping-only":"skip the BIOS probe, and go straight to pinging"}),c.gcpResidencyCache=null,f(a.r(53255),c)},61283,(a,b,c)=>{"use strict";c.byteLength=function(a){var b=j(a),c=b[0],d=b[1];return(c+d)*3/4-d},c.toByteArray=function(a){var b,c,d=j(a),g=d[0],h=d[1],i=new f((g+h)*3/4-h),k=0,l=h>0?g-4:g;for(c=0;c<l;c+=4)b=e[a.charCodeAt(c)]<<18|e[a.charCodeAt(c+1)]<<12|e[a.charCodeAt(c+2)]<<6|e[a.charCodeAt(c+3)],i[k++]=b>>16&255,i[k++]=b>>8&255,i[k++]=255&b;return 2===h&&(b=e[a.charCodeAt(c)]<<2|e[a.charCodeAt(c+1)]>>4,i[k++]=255&b),1===h&&(b=e[a.charCodeAt(c)]<<10|e[a.charCodeAt(c+1)]<<4|e[a.charCodeAt(c+2)]>>2,i[k++]=b>>8&255,i[k++]=255&b),i},c.fromByteArray=function(a){for(var b,c=a.length,e=c%3,f=[],g=0,h=c-e;g<h;g+=16383)f.push(function(a,b,c){for(var e,f=[],g=b;g<c;g+=3)e=(a[g]<<16&0xff0000)+(a[g+1]<<8&65280)+(255&a[g+2]),f.push(d[e>>18&63]+d[e>>12&63]+d[e>>6&63]+d[63&e]);return f.join("")}(a,g,g+16383>h?h:g+16383));return 1===e?f.push(d[(b=a[c-1])>>2]+d[b<<4&63]+"=="):2===e&&f.push(d[(b=(a[c-2]<<8)+a[c-1])>>10]+d[b>>4&63]+d[b<<2&63]+"="),f.join("")};for(var d=[],e=[],f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,i=g.length;h<i;++h)d[h]=g[h],e[g.charCodeAt(h)]=h;function j(a){var b=a.length;if(b%4>0)throw Error("Invalid string. Length must be a multiple of 4");var c=a.indexOf("=");-1===c&&(c=b);var d=c===b?0:4-c%4;return[c,d]}e[45]=62,e[95]=63},16835,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BrowserCrypto=void 0;let d=a.r(61283),e=a.r(42676);class f{constructor(){throw Error("SubtleCrypto not found. Make sure it's an https:// website.")}async sha256DigestBase64(a){let b=new TextEncoder().encode(a),c=await window.crypto.subtle.digest("SHA-256",b);return d.fromByteArray(new Uint8Array(c))}randomBytesBase64(a){let b=new Uint8Array(a);return window.crypto.getRandomValues(b),d.fromByteArray(b)}static padBase64(a){for(;a.length%4!=0;)a+="=";return a}async verify(a,b,c){let e={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},g=new TextEncoder().encode(b),h=d.toByteArray(f.padBase64(c)),i=await window.crypto.subtle.importKey("jwk",a,e,!0,["verify"]);return await window.crypto.subtle.verify(e,i,h,g)}async sign(a,b){let c={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},e=new TextEncoder().encode(b),f=await window.crypto.subtle.importKey("jwk",a,c,!0,["sign"]),g=await window.crypto.subtle.sign(c,f,e);return d.fromByteArray(new Uint8Array(g))}decodeBase64StringUtf8(a){let b=d.toByteArray(f.padBase64(a));return new TextDecoder().decode(b)}encodeBase64StringUtf8(a){let b=new TextEncoder().encode(a);return d.fromByteArray(b)}async sha256DigestHex(a){let b=new TextEncoder().encode(a),c=await window.crypto.subtle.digest("SHA-256",b);return(0,e.fromArrayBufferToHex)(c)}async signWithHmacSha256(a,b){let c="string"==typeof a?a:String.fromCharCode(...new Uint16Array(a)),d=new TextEncoder,e=await window.crypto.subtle.importKey("raw",d.encode(c),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return window.crypto.subtle.sign("HMAC",e,d.encode(b))}}c.BrowserCrypto=f},20664,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.NodeCrypto=void 0;let d=a.r(54799);c.NodeCrypto=class{async sha256DigestBase64(a){return d.createHash("sha256").update(a).digest("base64")}randomBytesBase64(a){return d.randomBytes(a).toString("base64")}async verify(a,b,c){let e=d.createVerify("RSA-SHA256");return e.update(b),e.end(),e.verify(a,c,"base64")}async sign(a,b){let c=d.createSign("RSA-SHA256");return c.update(b),c.end(),c.sign(a,"base64")}decodeBase64StringUtf8(a){return Buffer.from(a,"base64").toString("utf-8")}encodeBase64StringUtf8(a){return Buffer.from(a,"utf-8").toString("base64")}async sha256DigestHex(a){return d.createHash("sha256").update(a).digest("hex")}async signWithHmacSha256(a,b){var c,e;let f="string"==typeof a?a:(c=a,Buffer.from(c));return(e=d.createHmac("sha256",f).update(b).digest()).buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}}},42676,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.createCrypto=function(){return function(){;}(),new d.NodeCrypto},c.hasBrowserCrypto=e,c.fromArrayBufferToHex=function(a){return Array.from(new Uint8Array(a)).map(a=>a.toString(16).padStart(2,"0")).join("")},a.r(16835);let d=a.r(20664);function e(){return!1}},79471,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.validate=function(a){for(let b of[{invalid:"uri",expected:"url"},{invalid:"json",expected:"data"},{invalid:"qs",expected:"params"}])if(a[b.invalid])throw Error(`'${b.invalid}' is not a valid configuration option. Please use '${b.expected}' instead. This library is using Axios for requests. Please see https://github.com/axios/axios to learn more about the valid request options.`)}},85617,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DefaultTransporter=void 0;let d=a.r(48376),e=a.r(79471),f=a.r(91829),g="google-api-nodejs-client";class h{constructor(){this.instance=new d.Gaxios}configure(a={}){a.headers=a.headers||{};{let b=a.headers["User-Agent"];if(b?b.includes(`${g}/`)||(a.headers["User-Agent"]=`${b} ${h.USER_AGENT}`):a.headers["User-Agent"]=h.USER_AGENT,!a.headers["x-goog-api-client"]){let b=process.version.replace(/^v/,"");a.headers["x-goog-api-client"]=`gl-node/${b}`}}return a}request(a){return a=this.configure(a),(0,e.validate)(a),this.instance.request(a).catch(a=>{throw this.processError(a)})}get defaults(){return this.instance.defaults}set defaults(a){this.instance.defaults=a}processError(a){let b=a.response,c=b?b.data:null;return b&&c&&c.error&&200!==b.status?"string"==typeof c.error?(a.message=c.error,a.status=b.status):Array.isArray(c.error.errors)?(a.message=c.error.errors.map(a=>a.message).join("\n"),a.code=c.error.code,a.errors=c.error.errors):(a.message=c.error.message,a.code=c.error.code):b&&b.status>=400&&(a.message=c,a.status=b.status),a}}c.DefaultTransporter=h,h.USER_AGENT=`${g}/${f.version}`},10891,(a,b,c)=>{var d=a.r(874),e=d.Buffer;function f(a,b){for(var c in a)b[c]=a[c]}function g(a,b,c){return e(a,b,c)}e.from&&e.alloc&&e.allocUnsafe&&e.allocUnsafeSlow?b.exports=d:(f(d,c),c.Buffer=g),g.prototype=Object.create(e.prototype),f(e,g),g.from=function(a,b,c){if("number"==typeof a)throw TypeError("Argument must not be a number");return e(a,b,c)},g.alloc=function(a,b,c){if("number"!=typeof a)throw TypeError("Argument must be a number");var d=e(a);return void 0!==b?"string"==typeof c?d.fill(b,c):d.fill(b):d.fill(0),d},g.allocUnsafe=function(a){if("number"!=typeof a)throw TypeError("Argument must be a number");return e(a)},g.allocUnsafeSlow=function(a){if("number"!=typeof a)throw TypeError("Argument must be a number");return d.SlowBuffer(a)}},12940,(a,b,c)=>{"use strict";function d(a){return(a/8|0)+ +(a%8!=0)}var e={ES256:d(256),ES384:d(384),ES512:d(521)};b.exports=function(a){var b=e[a];if(b)return b;throw Error('Unknown algorithm "'+a+'"')}},84020,(a,b,c)=>{"use strict";var d=a.r(10891).Buffer,e=a.r(12940);function f(a){if(d.isBuffer(a))return a;if("string"==typeof a)return d.from(a,"base64");throw TypeError("ECDSA signature must be a Base64 string or a Buffer")}function g(a,b,c){for(var d=0;b+d<c&&0===a[b+d];)++d;return a[b+d]>=128&&--d,d}b.exports={derToJose:function(a,b){a=f(a);var c=e(b),g=c+1,h=a.length,i=0;if(48!==a[i++])throw Error('Could not find expected "seq"');var j=a[i++];if(129===j&&(j=a[i++]),h-i<j)throw Error('"seq" specified length of "'+j+'", only "'+(h-i)+'" remaining');if(2!==a[i++])throw Error('Could not find expected "int" for "r"');var k=a[i++];if(h-i-2<k)throw Error('"r" specified length of "'+k+'", only "'+(h-i-2)+'" available');if(g<k)throw Error('"r" specified length of "'+k+'", max of "'+g+'" is acceptable');var l=i;if(i+=k,2!==a[i++])throw Error('Could not find expected "int" for "s"');var m=a[i++];if(h-i!==m)throw Error('"s" specified length of "'+m+'", expected "'+(h-i)+'"');if(g<m)throw Error('"s" specified length of "'+m+'", max of "'+g+'" is acceptable');var n=i;if((i+=m)!==h)throw Error('Expected to consume entire buffer, but "'+(h-i)+'" bytes remain');var o=c-k,p=c-m,q=d.allocUnsafe(o+k+p+m);for(i=0;i<o;++i)q[i]=0;a.copy(q,i,l+Math.max(-o,0),l+k),i=c;for(var r=i;i<r+p;++i)q[i]=0;return a.copy(q,i,n+Math.max(-p,0),n+m),q=(q=q.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(a,b){a=f(a);var c=e(b),h=a.length;if(h!==2*c)throw TypeError('"'+b+'" signatures must be "'+2*c+'" bytes, saw "'+h+'"');var i=g(a,0,c),j=g(a,c,a.length),k=c-i,l=c-j,m=2+k+1+1+l,n=m<128,o=d.allocUnsafe((n?2:3)+m),p=0;return o[p++]=48,n?o[p++]=m:(o[p++]=129,o[p++]=255&m),o[p++]=2,o[p++]=k,i<0?(o[p++]=0,p+=a.copy(o,p,0,c)):p+=a.copy(o,p,i,c),o[p++]=2,o[p++]=l,j<0?(o[p++]=0,a.copy(o,p,c)):a.copy(o,p,c+j),o}}},75701,(a,b,c)=>{"use strict";var d,e,f,g,h=a.e&&a.e.__classPrivateFieldGet||function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)};function i(a){return a.replace(/([_][^_])/g,a=>a.slice(1).toUpperCase())}Object.defineProperty(c,"__esModule",{value:!0}),c.LRUCache=void 0,c.snakeToCamel=i,c.originalOrCamelOptions=function(a){return{get:function(b){var c;let d=a||{};return null!=(c=d[b])?c:d[i(b)]}}},c.LRUCache=class{constructor(a){d.add(this),e.set(this,new Map),this.capacity=a.capacity,this.maxAge=a.maxAge}set(a,b){h(this,d,"m",f).call(this,a,b),h(this,d,"m",g).call(this)}get(a){let b=h(this,e,"f").get(a);if(b)return h(this,d,"m",f).call(this,a,b.value),h(this,d,"m",g).call(this),b.value}},e=new WeakMap,d=new WeakSet,f=function(a,b){h(this,e,"f").delete(a),h(this,e,"f").set(a,{value:b,lastAccessed:Date.now()})},g=function(){let a=this.maxAge?Date.now()-this.maxAge:0,b=h(this,e,"f").entries().next();for(;!b.done&&(h(this,e,"f").size>this.capacity||b.value[1].lastAccessed<a);)h(this,e,"f").delete(b.value[0]),b=h(this,e,"f").entries().next()}},28050,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AuthClient=c.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=c.DEFAULT_UNIVERSE=void 0;let d=a.r(27699),e=a.r(48376),f=a.r(85617),g=a.r(75701);c.DEFAULT_UNIVERSE="googleapis.com",c.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=3e5;class h extends d.EventEmitter{constructor(a={}){var b,d,e,h,i;super(),this.credentials={},this.eagerRefreshThresholdMillis=c.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS,this.forceRefreshOnFailure=!1,this.universeDomain=c.DEFAULT_UNIVERSE;let j=(0,g.originalOrCamelOptions)(a);this.apiKey=a.apiKey,this.projectId=null!=(b=j.get("project_id"))?b:null,this.quotaProjectId=j.get("quota_project_id"),this.credentials=null!=(d=j.get("credentials"))?d:{},this.universeDomain=null!=(e=j.get("universe_domain"))?e:c.DEFAULT_UNIVERSE,this.transporter=null!=(h=a.transporter)?h:new f.DefaultTransporter,a.transporterOptions&&(this.transporter.defaults=a.transporterOptions),a.eagerRefreshThresholdMillis&&(this.eagerRefreshThresholdMillis=a.eagerRefreshThresholdMillis),this.forceRefreshOnFailure=null!=(i=a.forceRefreshOnFailure)&&i}get gaxios(){return this.transporter instanceof e.Gaxios?this.transporter:this.transporter instanceof f.DefaultTransporter||"instance"in this.transporter&&this.transporter.instance instanceof e.Gaxios?this.transporter.instance:null}setCredentials(a){this.credentials=a}addSharedMetadataHeaders(a){return!a["x-goog-user-project"]&&this.quotaProjectId&&(a["x-goog-user-project"]=this.quotaProjectId),a}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}c.AuthClient=h},97122,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.LoginTicket=void 0,c.LoginTicket=class{constructor(a,b){this.envelope=a,this.payload=b}getEnvelope(){return this.envelope}getPayload(){return this.payload}getUserId(){let a=this.getPayload();return a&&a.sub?a.sub:null}getAttributes(){return{envelope:this.getEnvelope(),payload:this.getPayload()}}}},35246,(a,b,c)=>{"use strict";var d,e,f;Object.defineProperty(c,"__esModule",{value:!0}),c.OAuth2Client=c.ClientAuthentication=c.CertificateFormat=c.CodeChallengeMethod=void 0;let g=a.r(48376),h=a.r(45706),i=a.r(88947),j=a.r(84020),k=a.r(42676),l=a.r(28050),m=a.r(97122);!function(a){a.Plain="plain",a.S256="S256"}(d||(c.CodeChallengeMethod=d={})),function(a){a.PEM="PEM",a.JWK="JWK"}(e||(c.CertificateFormat=e={})),function(a){a.ClientSecretPost="ClientSecretPost",a.ClientSecretBasic="ClientSecretBasic",a.None="None"}(f||(c.ClientAuthentication=f={}));class n extends l.AuthClient{constructor(a,b,c){let d=a&&"object"==typeof a?a:{clientId:a,clientSecret:b,redirectUri:c};super(d),this.certificateCache={},this.certificateExpiry=null,this.certificateCacheFormat=e.PEM,this.refreshTokenPromises=new Map,this._clientId=d.clientId,this._clientSecret=d.clientSecret,this.redirectUri=d.redirectUri,this.endpoints={tokenInfoUrl:"https://oauth2.googleapis.com/tokeninfo",oauth2AuthBaseUrl:"https://accounts.google.com/o/oauth2/v2/auth",oauth2TokenUrl:"https://oauth2.googleapis.com/token",oauth2RevokeUrl:"https://oauth2.googleapis.com/revoke",oauth2FederatedSignonPemCertsUrl:"https://www.googleapis.com/oauth2/v1/certs",oauth2FederatedSignonJwkCertsUrl:"https://www.googleapis.com/oauth2/v3/certs",oauth2IapPublicKeyUrl:"https://www.gstatic.com/iap/verify/public_key",...d.endpoints},this.clientAuthentication=d.clientAuthentication||f.ClientSecretPost,this.issuers=d.issuers||["accounts.google.com","https://accounts.google.com",this.universeDomain]}generateAuthUrl(a={}){if(a.code_challenge_method&&!a.code_challenge)throw Error("If a code_challenge_method is provided, code_challenge must be included.");return a.response_type=a.response_type||"code",a.client_id=a.client_id||this._clientId,a.redirect_uri=a.redirect_uri||this.redirectUri,Array.isArray(a.scope)&&(a.scope=a.scope.join(" ")),this.endpoints.oauth2AuthBaseUrl.toString()+"?"+h.stringify(a)}generateCodeVerifier(){throw Error("generateCodeVerifier is removed, please use generateCodeVerifierAsync instead.")}async generateCodeVerifierAsync(){let a=(0,k.createCrypto)(),b=a.randomBytesBase64(96).replace(/\+/g,"~").replace(/=/g,"_").replace(/\//g,"-"),c=(await a.sha256DigestBase64(b)).split("=")[0].replace(/\+/g,"-").replace(/\//g,"_");return{codeVerifier:b,codeChallenge:c}}getToken(a,b){let c="string"==typeof a?{code:a}:a;if(!b)return this.getTokenAsync(c);this.getTokenAsync(c).then(a=>b(null,a.tokens,a.res),a=>b(a,null,a.response))}async getTokenAsync(a){let b=this.endpoints.oauth2TokenUrl.toString(),c={"Content-Type":"application/x-www-form-urlencoded"},d={client_id:a.client_id||this._clientId,code_verifier:a.codeVerifier,code:a.code,grant_type:"authorization_code",redirect_uri:a.redirect_uri||this.redirectUri};if(this.clientAuthentication===f.ClientSecretBasic){let a=Buffer.from(`${this._clientId}:${this._clientSecret}`);c.Authorization=`Basic ${a.toString("base64")}`}this.clientAuthentication===f.ClientSecretPost&&(d.client_secret=this._clientSecret);let e=await this.transporter.request({...n.RETRY_CONFIG,method:"POST",url:b,data:h.stringify(d),headers:c}),g=e.data;return e.data&&e.data.expires_in&&(g.expiry_date=new Date().getTime()+1e3*e.data.expires_in,delete g.expires_in),this.emit("tokens",g),{tokens:g,res:e}}async refreshToken(a){if(!a)return this.refreshTokenNoCache(a);if(this.refreshTokenPromises.has(a))return this.refreshTokenPromises.get(a);let b=this.refreshTokenNoCache(a).then(b=>(this.refreshTokenPromises.delete(a),b),b=>{throw this.refreshTokenPromises.delete(a),b});return this.refreshTokenPromises.set(a,b),b}async refreshTokenNoCache(a){var b;let c;if(!a)throw Error("No refresh token is set.");let d=this.endpoints.oauth2TokenUrl.toString(),e={refresh_token:a,client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token"};try{c=await this.transporter.request({...n.RETRY_CONFIG,method:"POST",url:d,data:h.stringify(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}catch(a){throw a instanceof g.GaxiosError&&"invalid_grant"===a.message&&(null==(b=a.response)?void 0:b.data)&&/ReAuth/i.test(a.response.data.error_description)&&(a.message=JSON.stringify(a.response.data)),a}let f=c.data;return c.data&&c.data.expires_in&&(f.expiry_date=new Date().getTime()+1e3*c.data.expires_in,delete f.expires_in),this.emit("tokens",f),{tokens:f,res:c}}refreshAccessToken(a){if(!a)return this.refreshAccessTokenAsync();this.refreshAccessTokenAsync().then(b=>a(null,b.credentials,b.res),a)}async refreshAccessTokenAsync(){let a=await this.refreshToken(this.credentials.refresh_token),b=a.tokens;return b.refresh_token=this.credentials.refresh_token,this.credentials=b,{credentials:this.credentials,res:a.res}}getAccessToken(a){if(!a)return this.getAccessTokenAsync();this.getAccessTokenAsync().then(b=>a(null,b.token,b.res),a)}async getAccessTokenAsync(){if(!(!this.credentials.access_token||this.isTokenExpiring()))return{token:this.credentials.access_token};{if(!this.credentials.refresh_token)if(this.refreshHandler){let a=await this.processAndValidateRefreshHandler();if(null==a?void 0:a.access_token)return this.setCredentials(a),{token:this.credentials.access_token}}else throw Error("No refresh token or refresh handler callback is set.");let a=await this.refreshAccessTokenAsync();if(!a.credentials||a.credentials&&!a.credentials.access_token)throw Error("Could not refresh access token.");return{token:a.credentials.access_token,res:a.res}}}async getRequestHeaders(a){return(await this.getRequestMetadataAsync(a)).headers}async getRequestMetadataAsync(a){let b=this.credentials;if(!b.access_token&&!b.refresh_token&&!this.apiKey&&!this.refreshHandler)throw Error("No access, refresh token, API key or refresh handler callback is set.");if(b.access_token&&!this.isTokenExpiring()){b.token_type=b.token_type||"Bearer";let a={Authorization:b.token_type+" "+b.access_token};return{headers:this.addSharedMetadataHeaders(a)}}if(this.refreshHandler){let a=await this.processAndValidateRefreshHandler();if(null==a?void 0:a.access_token){this.setCredentials(a);let b={Authorization:"Bearer "+this.credentials.access_token};return{headers:this.addSharedMetadataHeaders(b)}}}if(this.apiKey)return{headers:{"X-Goog-Api-Key":this.apiKey}};let c=null,d=null;try{d=(c=await this.refreshToken(b.refresh_token)).tokens}catch(a){throw a.response&&(403===a.response.status||404===a.response.status)&&(a.message=`Could not refresh access token: ${a.message}`),a}let e=this.credentials;e.token_type=e.token_type||"Bearer",d.refresh_token=e.refresh_token,this.credentials=d;let f={Authorization:e.token_type+" "+d.access_token};return{headers:this.addSharedMetadataHeaders(f),res:c.res}}static getRevokeTokenUrl(a){return new n().getRevokeTokenURL(a).toString()}getRevokeTokenURL(a){let b=new URL(this.endpoints.oauth2RevokeUrl);return b.searchParams.append("token",a),b}revokeToken(a,b){let c={...n.RETRY_CONFIG,url:this.getRevokeTokenURL(a).toString(),method:"POST"};if(!b)return this.transporter.request(c);this.transporter.request(c).then(a=>b(null,a),b)}revokeCredentials(a){if(!a)return this.revokeCredentialsAsync();this.revokeCredentialsAsync().then(b=>a(null,b),a)}async revokeCredentialsAsync(){let a=this.credentials.access_token;if(this.credentials={},a)return this.revokeToken(a);throw Error("No access token to revoke.")}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestMetadataAsync(a.url);a.headers=a.headers||{},b.headers&&b.headers["x-goog-user-project"]&&(a.headers["x-goog-user-project"]=b.headers["x-goog-user-project"]),b.headers&&b.headers.Authorization&&(a.headers.Authorization=b.headers.Authorization),this.apiKey&&(a.headers["X-Goog-Api-Key"]=this.apiKey),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,e=this.credentials&&this.credentials.access_token&&this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure),f=this.credentials&&this.credentials.access_token&&!this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure)&&this.refreshHandler,g=c.config.data instanceof i.Readable,h=401===d||403===d;if(!b&&h&&!g&&e)return await this.refreshAccessTokenAsync(),this.requestAsync(a,!0);if(!b&&h&&!g&&f){let b=await this.processAndValidateRefreshHandler();return(null==b?void 0:b.access_token)&&this.setCredentials(b),this.requestAsync(a,!0)}}throw d}return c}verifyIdToken(a,b){if(b&&"function"!=typeof b)throw Error("This method accepts an options object as the first parameter, which includes the idToken, audience, and maxExpiry.");if(!b)return this.verifyIdTokenAsync(a);this.verifyIdTokenAsync(a).then(a=>b(null,a),b)}async verifyIdTokenAsync(a){if(!a.idToken)throw Error("The verifyIdToken method requires an ID Token");let b=await this.getFederatedSignonCertsAsync();return await this.verifySignedJwtWithCertsAsync(a.idToken,b.certs,a.audience,this.issuers,a.maxExpiry)}async getTokenInfo(a){let{data:b}=await this.transporter.request({...n.RETRY_CONFIG,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${a}`},url:this.endpoints.tokenInfoUrl.toString()}),c=Object.assign({expiry_date:new Date().getTime()+1e3*b.expires_in,scopes:b.scope.split(" ")},b);return delete c.expires_in,delete c.scope,c}getFederatedSignonCerts(a){if(!a)return this.getFederatedSignonCertsAsync();this.getFederatedSignonCertsAsync().then(b=>a(null,b.certs,b.res),a)}async getFederatedSignonCertsAsync(){let a,b,c=new Date().getTime(),d=(0,k.hasBrowserCrypto)()?e.JWK:e.PEM;if(this.certificateExpiry&&c<this.certificateExpiry.getTime()&&this.certificateCacheFormat===d)return{certs:this.certificateCache,format:d};switch(d){case e.PEM:b=this.endpoints.oauth2FederatedSignonPemCertsUrl.toString();break;case e.JWK:b=this.endpoints.oauth2FederatedSignonJwkCertsUrl.toString();break;default:throw Error(`Unsupported certificate format ${d}`)}try{a=await this.transporter.request({...n.RETRY_CONFIG,url:b})}catch(a){throw a instanceof Error&&(a.message=`Failed to retrieve verification certificates: ${a.message}`),a}let f=a?a.headers["cache-control"]:void 0,g=-1;if(f){let a=RegExp("max-age=([0-9]*)").exec(f);a&&2===a.length&&(g=1e3*Number(a[1]))}let h={};switch(d){case e.PEM:h=a.data;break;case e.JWK:for(let b of a.data.keys)h[b.kid]=b;break;default:throw Error(`Unsupported certificate format ${d}`)}let i=new Date;return this.certificateExpiry=-1===g?null:new Date(i.getTime()+g),this.certificateCache=h,this.certificateCacheFormat=d,{certs:h,format:d,res:a}}getIapPublicKeys(a){if(!a)return this.getIapPublicKeysAsync();this.getIapPublicKeysAsync().then(b=>a(null,b.pubkeys,b.res),a)}async getIapPublicKeysAsync(){let a,b=this.endpoints.oauth2IapPublicKeyUrl.toString();try{a=await this.transporter.request({...n.RETRY_CONFIG,url:b})}catch(a){throw a instanceof Error&&(a.message=`Failed to retrieve verification certificates: ${a.message}`),a}return{pubkeys:a.data,res:a}}verifySignedJwtWithCerts(){throw Error("verifySignedJwtWithCerts is removed, please use verifySignedJwtWithCertsAsync instead.")}async verifySignedJwtWithCertsAsync(a,b,c,d,e){let f,g,h=(0,k.createCrypto)();e||(e=n.DEFAULT_MAX_TOKEN_LIFETIME_SECS_);let i=a.split(".");if(3!==i.length)throw Error("Wrong number of segments in token: "+a);let l=i[0]+"."+i[1],o=i[2];try{f=JSON.parse(h.decodeBase64StringUtf8(i[0]))}catch(a){throw a instanceof Error&&(a.message=`Can't parse token envelope: ${i[0]}': ${a.message}`),a}if(!f)throw Error("Can't parse token envelope: "+i[0]);try{g=JSON.parse(h.decodeBase64StringUtf8(i[1]))}catch(a){throw a instanceof Error&&(a.message=`Can't parse token payload '${i[0]}`),a}if(!g)throw Error("Can't parse token payload: "+i[1]);if(!Object.prototype.hasOwnProperty.call(b,f.kid))throw Error("No pem found for envelope: "+JSON.stringify(f));let p=b[f.kid];if("ES256"===f.alg&&(o=j.joseToDer(o,"ES256").toString("base64")),!await h.verify(p,l,o))throw Error("Invalid token signature: "+a);if(!g.iat)throw Error("No issue time in token: "+JSON.stringify(g));if(!g.exp)throw Error("No expiration time in token: "+JSON.stringify(g));let q=Number(g.iat);if(isNaN(q))throw Error("iat field using invalid format");let r=Number(g.exp);if(isNaN(r))throw Error("exp field using invalid format");let s=new Date().getTime()/1e3;if(r>=s+e)throw Error("Expiration time too far in future: "+JSON.stringify(g));let t=q-n.CLOCK_SKEW_SECS_,u=r+n.CLOCK_SKEW_SECS_;if(s<t)throw Error("Token used too early, "+s+" < "+t+": "+JSON.stringify(g));if(s>u)throw Error("Token used too late, "+s+" > "+u+": "+JSON.stringify(g));if(d&&0>d.indexOf(g.iss))throw Error("Invalid issuer, expected one of ["+d+"], but got "+g.iss);if(null!=c){let a=g.aud;if(!(c.constructor===Array?c.indexOf(a)>-1:a===c))throw Error("Wrong recipient, payload audience != requiredAudience")}return new m.LoginTicket(f,g)}async processAndValidateRefreshHandler(){if(this.refreshHandler){let a=await this.refreshHandler();if(!a.access_token)throw Error("No access token is returned by the refreshHandler callback.");return a}}isTokenExpiring(){let a=this.credentials.expiry_date;return!!a&&a<=new Date().getTime()+this.eagerRefreshThresholdMillis}}c.OAuth2Client=n,n.GOOGLE_TOKEN_INFO_URL="https://oauth2.googleapis.com/tokeninfo",n.CLOCK_SKEW_SECS_=300,n.DEFAULT_MAX_TOKEN_LIFETIME_SECS_=86400},77078,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Compute=void 0;let d=a.r(48376),e=a.r(76120),f=a.r(35246);class g extends f.OAuth2Client{constructor(a={}){super(a),this.credentials={expiry_date:1,refresh_token:"compute-placeholder"},this.serviceAccountEmail=a.serviceAccountEmail||"default",this.scopes=Array.isArray(a.scopes)?a.scopes:a.scopes?[a.scopes]:[]}async refreshTokenNoCache(a){let b,c=`service-accounts/${this.serviceAccountEmail}/token`;try{let a={property:c};this.scopes.length>0&&(a.params={scopes:this.scopes.join(",")}),b=await e.instance(a)}catch(a){throw a instanceof d.GaxiosError&&(a.message=`Could not refresh access token: ${a.message}`,this.wrapError(a)),a}let f=b;return b&&b.expires_in&&(f.expiry_date=new Date().getTime()+1e3*b.expires_in,delete f.expires_in),this.emit("tokens",f),{tokens:f,res:null}}async fetchIdToken(a){let b,c=`service-accounts/${this.serviceAccountEmail}/identity?format=full&audience=${a}`;try{b=await e.instance({property:c})}catch(a){throw a instanceof Error&&(a.message=`Could not fetch ID token: ${a.message}`),a}return b}wrapError(a){let b=a.response;b&&b.status&&(a.status=b.status,403===b.status?a.message="A Forbidden error was returned while attempting to retrieve an access token for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have the correct permission scopes specified: "+a.message:404===b.status&&(a.message="A Not Found error was returned while attempting to retrieve an accesstoken for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have any permission scopes specified: "+a.message))}}c.Compute=g},73736,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.IdTokenClient=void 0;let d=a.r(35246);class e extends d.OAuth2Client{constructor(a){super(a),this.targetAudience=a.targetAudience,this.idTokenProvider=a.idTokenProvider}async getRequestMetadataAsync(a){if(!this.credentials.id_token||!this.credentials.expiry_date||this.isTokenExpiring()){let a=await this.idTokenProvider.fetchIdToken(this.targetAudience);this.credentials={id_token:a,expiry_date:this.getIdTokenExpiryDate(a)}}return{headers:{Authorization:"Bearer "+this.credentials.id_token}}}getIdTokenExpiryDate(a){let b=a.split(".")[1];if(b)return 1e3*JSON.parse(Buffer.from(b,"base64").toString("ascii")).exp}}c.IdTokenClient=e},64783,(a,b,c)=>{"use strict";var d;let e;Object.defineProperty(c,"__esModule",{value:!0}),c.GCPEnv=void 0,c.clear=function(){e=void 0},c.getEnv=g;let f=a.r(76120);async function g(){return e||(e=h())}async function h(){d.NONE;return process.env.GAE_SERVICE||process.env.GAE_MODULE_NAME?d.APP_ENGINE:process.env.FUNCTION_NAME||process.env.FUNCTION_TARGET?d.CLOUD_FUNCTIONS:await j()?await i()?d.KUBERNETES_ENGINE:process.env.K_CONFIGURATION?d.CLOUD_RUN:d.COMPUTE_ENGINE:d.NONE}async function i(){try{return await f.instance("attributes/cluster-name"),!0}catch(a){return!1}}async function j(){return f.isAvailable()}!function(a){a.APP_ENGINE="APP_ENGINE",a.KUBERNETES_ENGINE="KUBERNETES_ENGINE",a.CLOUD_FUNCTIONS="CLOUD_FUNCTIONS",a.COMPUTE_ENGINE="COMPUTE_ENGINE",a.CLOUD_RUN="CLOUD_RUN",a.NONE="NONE"}(d||(c.GCPEnv=d={}))},34380,(a,b,c)=>{var d=a.r(10891).Buffer,e=a.r(88947);function f(a){if(this.buffer=null,this.writable=!0,this.readable=!0,!a)return this.buffer=d.alloc(0),this;if("function"==typeof a.pipe)return this.buffer=d.alloc(0),a.pipe(this),this;if(a.length||"object"==typeof a)return this.buffer=a,this.writable=!1,process.nextTick((function(){this.emit("end",a),this.readable=!1,this.emit("close")}).bind(this)),this;throw TypeError("Unexpected data type ("+typeof a+")")}a.r(24361).inherits(f,e),f.prototype.write=function(a){this.buffer=d.concat([this.buffer,d.from(a)]),this.emit("data",a)},f.prototype.end=function(a){a&&this.write(a),this.emit("end",a),this.emit("close"),this.writable=!1,this.readable=!1},b.exports=f},39887,(a,b,c)=>{"use strict";var d=a.r(874).Buffer,e=a.r(874).SlowBuffer;function f(a,b){if(!d.isBuffer(a)||!d.isBuffer(b)||a.length!==b.length)return!1;for(var c=0,e=0;e<a.length;e++)c|=a[e]^b[e];return 0===c}b.exports=f,f.install=function(){d.prototype.equal=e.prototype.equal=function(a){return f(this,a)}};var g=d.prototype.equal,h=e.prototype.equal;f.restore=function(){d.prototype.equal=g,e.prototype.equal=h}},34024,(a,b,c)=>{var d,e=a.r(10891).Buffer,f=a.r(54799),g=a.r(84020),h=a.r(24361),i="secret must be a string or buffer",j="key must be a string or a buffer",k="function"==typeof f.createPublicKey;function l(a){if(!e.isBuffer(a)&&"string"!=typeof a&&(!k||"object"!=typeof a||"string"!=typeof a.type||"string"!=typeof a.asymmetricKeyType||"function"!=typeof a.export))throw p(j)}function m(a){if(!e.isBuffer(a)&&"string"!=typeof a&&"object"!=typeof a)throw p("key must be a string, a buffer or an object")}function n(a){return a.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function o(a){var b=4-(a=a.toString()).length%4;if(4!==b)for(var c=0;c<b;++c)a+="=";return a.replace(/\-/g,"+").replace(/_/g,"/")}function p(a){var b=[].slice.call(arguments,1);return TypeError(h.format.bind(h,a).apply(null,b))}function q(a){var b;return b=a,e.isBuffer(b)||"string"==typeof b||(a=JSON.stringify(a)),a}function r(a){return function(b,c){!function(a){if(!e.isBuffer(a)){if("string"!=typeof a){if(!k||"object"!=typeof a||"secret"!==a.type||"function"!=typeof a.export)throw p(i)}}}(c),b=q(b);var d=f.createHmac("sha"+a,c);return n((d.update(b),d.digest("base64")))}}k&&(j+=" or a KeyObject",i+="or a KeyObject");var s="timingSafeEqual"in f?function(a,b){return a.byteLength===b.byteLength&&f.timingSafeEqual(a,b)}:function(b,c){return d||(d=a.r(39887)),d(b,c)};function t(a){return function(b,c,d){var f=r(a)(b,d);return s(e.from(c),e.from(f))}}function u(a){return function(b,c){m(c),b=q(b);var d=f.createSign("RSA-SHA"+a);return n((d.update(b),d.sign(c,"base64")))}}function v(a){return function(b,c,d){l(d),b=q(b),c=o(c);var e=f.createVerify("RSA-SHA"+a);return e.update(b),e.verify(d,c,"base64")}}function w(a){return function(b,c){m(c),b=q(b);var d=f.createSign("RSA-SHA"+a);return n((d.update(b),d.sign({key:c,padding:f.constants.RSA_PKCS1_PSS_PADDING,saltLength:f.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function x(a){return function(b,c,d){l(d),b=q(b),c=o(c);var e=f.createVerify("RSA-SHA"+a);return e.update(b),e.verify({key:d,padding:f.constants.RSA_PKCS1_PSS_PADDING,saltLength:f.constants.RSA_PSS_SALTLEN_DIGEST},c,"base64")}}function y(a){var b=u(a);return function(){var c=b.apply(null,arguments);return g.derToJose(c,"ES"+a)}}function z(a){var b=v(a);return function(c,d,e){return b(c,d=g.joseToDer(d,"ES"+a).toString("base64"),e)}}function A(){return function(){return""}}function B(){return function(a,b){return""===b}}b.exports=function(a){var b=a.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/);if(!b)throw p('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',a);var c=(b[1]||b[3]).toLowerCase(),d=b[2];return{sign:({hs:r,rs:u,ps:w,es:y,none:A})[c](d),verify:({hs:t,rs:v,ps:x,es:z,none:B})[c](d)}}},54682,(a,b,c)=>{var d=a.r(874).Buffer;b.exports=function(a){return"string"==typeof a?a:"number"==typeof a||d.isBuffer(a)?a.toString():JSON.stringify(a)}},49511,(a,b,c)=>{var d=a.r(10891).Buffer,e=a.r(34380),f=a.r(34024),g=a.r(88947),h=a.r(54682),i=a.r(24361);function j(a,b){return d.from(a,b).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function k(a){var b,c,d,e=a.header,g=a.payload,k=a.secret||a.privateKey,l=a.encoding,m=f(e.alg),n=(b=(b=l)||"utf8",c=j(h(e),"binary"),d=j(h(g),b),i.format("%s.%s",c,d)),o=m.sign(n,k);return i.format("%s.%s",n,o)}function l(a){var b=new e(a.secret||a.privateKey||a.key);this.readable=!0,this.header=a.header,this.encoding=a.encoding,this.secret=this.privateKey=this.key=b,this.payload=new e(a.payload),this.secret.once("close",(function(){!this.payload.writable&&this.readable&&this.sign()}).bind(this)),this.payload.once("close",(function(){!this.secret.writable&&this.readable&&this.sign()}).bind(this))}i.inherits(l,g),l.prototype.sign=function(){try{var a=k({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",a),this.emit("data",a),this.emit("end"),this.readable=!1,a}catch(a){this.readable=!1,this.emit("error",a),this.emit("close")}},l.sign=k,b.exports=l},75188,(a,b,c)=>{var d=a.r(10891).Buffer,e=a.r(34380),f=a.r(34024),g=a.r(88947),h=a.r(54682),i=a.r(24361),j=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function k(a){var b=a.split(".",1)[0],c=d.from(b,"base64").toString("binary");if("[object Object]"===Object.prototype.toString.call(c))return c;try{return JSON.parse(c)}catch(a){return}}function l(a){return a.split(".")[2]}function m(a){return j.test(a)&&!!k(a)}function n(a,b,c){if(!b){var d=Error("Missing algorithm parameter for jws.verify");throw d.code="MISSING_ALGORITHM",d}var e=l(a=h(a)),g=a.split(".",2).join(".");return f(b).verify(g,e,c)}function o(a,b){if(b=b||{},!m(a=h(a)))return null;var c,e,f=k(a);if(!f)return null;var g=(c=c||"utf8",e=a.split(".")[1],d.from(e,"base64").toString(c));return("JWT"===f.typ||b.json)&&(g=JSON.parse(g,b.encoding)),{header:f,payload:g,signature:l(a)}}function p(a){var b=new e((a=a||{}).secret||a.publicKey||a.key);this.readable=!0,this.algorithm=a.algorithm,this.encoding=a.encoding,this.secret=this.publicKey=this.key=b,this.signature=new e(a.signature),this.secret.once("close",(function(){!this.signature.writable&&this.readable&&this.verify()}).bind(this)),this.signature.once("close",(function(){!this.secret.writable&&this.readable&&this.verify()}).bind(this))}i.inherits(p,g),p.prototype.verify=function(){try{var a=n(this.signature.buffer,this.algorithm,this.key.buffer),b=o(this.signature.buffer,this.encoding);return this.emit("done",a,b),this.emit("data",a),this.emit("end"),this.readable=!1,a}catch(a){this.readable=!1,this.emit("error",a),this.emit("close")}},p.decode=o,p.isValid=m,p.verify=n,b.exports=p},81649,(a,b,c)=>{var d=a.r(49511),e=a.r(75188);c.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],c.sign=d.sign,c.verify=e.verify,c.decode=e.decode,c.isValid=e.isValid,c.createSign=function(a){return new d(a)},c.createVerify=function(a){return new e(a)}},26644,(a,b,c)=>{"use strict";var d,e,f,g,h,i,j,k,l=a.e&&a.e.__classPrivateFieldGet||function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)},m=a.e&&a.e.__classPrivateFieldSet||function(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c};Object.defineProperty(c,"__esModule",{value:!0}),c.GoogleToken=void 0;let n=a.r(22734),o=a.r(48376),p=a.r(81649),q=a.r(14747),r=(0,a.r(24361).promisify)(n.readFile),s="https://www.googleapis.com/oauth2/v4/token";class t extends Error{constructor(a,b){super(a),this.code=b}}c.GoogleToken=class{get accessToken(){return this.rawToken?this.rawToken.access_token:void 0}get idToken(){return this.rawToken?this.rawToken.id_token:void 0}get tokenType(){return this.rawToken?this.rawToken.token_type:void 0}get refreshToken(){return this.rawToken?this.rawToken.refresh_token:void 0}constructor(a){d.add(this),this.transporter={request:a=>(0,o.request)(a)},e.set(this,void 0),l(this,d,"m",j).call(this,a)}hasExpired(){let a=new Date().getTime();return!this.rawToken||!this.expiresAt||a>=this.expiresAt}isTokenExpiring(){var a;let b=new Date().getTime(),c=null!=(a=this.eagerRefreshThresholdMillis)?a:0;return!this.rawToken||!this.expiresAt||this.expiresAt<=b+c}getToken(a,b={}){if("object"==typeof a&&(b=a,a=void 0),b=Object.assign({forceRefresh:!1},b),a){let c=a;l(this,d,"m",f).call(this,b).then(a=>c(null,a),a);return}return l(this,d,"m",f).call(this,b)}async getCredentials(a){switch(q.extname(a)){case".json":{let b=JSON.parse(await r(a,"utf8")),c=b.private_key,d=b.client_email;if(!c||!d)throw new t("private_key and client_email are required.","MISSING_CREDENTIALS");return{privateKey:c,clientEmail:d}}case".der":case".crt":case".pem":return{privateKey:await r(a,"utf8")};case".p12":case".pfx":throw new t("*.p12 certificates are not supported after v6.1.2. Consider utilizing *.json format or converting *.p12 to *.pem using the OpenSSL CLI.","UNKNOWN_CERTIFICATE_TYPE");default:throw new t("Unknown certificate type. Type is determined based on file extension. Current supported extensions are *.json, and *.pem.","UNKNOWN_CERTIFICATE_TYPE")}}revokeToken(a){return a?void l(this,d,"m",i).call(this).then(()=>a(),a):l(this,d,"m",i).call(this)}},e=new WeakMap,d=new WeakSet,f=async function(a){if(l(this,e,"f")&&!a.forceRefresh)return l(this,e,"f");try{return await m(this,e,l(this,d,"m",g).call(this,a),"f")}finally{m(this,e,void 0,"f")}},g=async function(a){if(!1===this.isTokenExpiring()&&!1===a.forceRefresh)return Promise.resolve(this.rawToken);if(!this.key&&!this.keyFile)throw Error("No key or keyFile set.");if(!this.key&&this.keyFile){let a=await this.getCredentials(this.keyFile);this.key=a.privateKey,this.iss=a.clientEmail||this.iss,a.clientEmail||l(this,d,"m",h).call(this)}return l(this,d,"m",k).call(this)},h=function(){if(!this.iss)throw new t("email is required.","MISSING_CREDENTIALS")},i=async function(){if(!this.accessToken)throw Error("No token to revoke.");let a="https://accounts.google.com/o/oauth2/revoke?token="+this.accessToken;await this.transporter.request({url:a,retry:!0}),l(this,d,"m",j).call(this,{email:this.iss,sub:this.sub,key:this.key,keyFile:this.keyFile,scope:this.scope,additionalClaims:this.additionalClaims})},j=function(a={}){this.keyFile=a.keyFile,this.key=a.key,this.rawToken=void 0,this.iss=a.email||a.iss,this.sub=a.sub,this.additionalClaims=a.additionalClaims,"object"==typeof a.scope?this.scope=a.scope.join(" "):this.scope=a.scope,this.eagerRefreshThresholdMillis=a.eagerRefreshThresholdMillis,a.transporter&&(this.transporter=a.transporter)},k=async function(){var a,b;let c=Math.floor(new Date().getTime()/1e3),d=this.additionalClaims||{},e=Object.assign({iss:this.iss,scope:this.scope,aud:s,exp:c+3600,iat:c,sub:this.sub},d),f=p.sign({header:{alg:"RS256"},payload:e,secret:this.key});try{let a=await this.transporter.request({method:"POST",url:s,data:{grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:f},headers:{"Content-Type":"application/x-www-form-urlencoded"},responseType:"json",retryConfig:{httpMethodsToRetry:["POST"]}});return this.rawToken=a.data,this.expiresAt=null===a.data.expires_in||void 0===a.data.expires_in?void 0:(c+a.data.expires_in)*1e3,this.rawToken}catch(d){this.rawToken=void 0,this.tokenExpires=void 0;let c=d.response&&(null==(a=d.response)?void 0:a.data)?null==(b=d.response)?void 0:b.data:{};if(c.error){let a=c.error_description?`: ${c.error_description}`:"";d.message=`${c.error}${a}`}throw d}}},34414,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.JWTAccess=void 0;let d=a.r(81649),e=a.r(75701),f={alg:"RS256",typ:"JWT"};class g{constructor(a,b,c,d){this.cache=new e.LRUCache({capacity:500,maxAge:36e5}),this.email=a,this.key=b,this.keyId=c,this.eagerRefreshThresholdMillis=null!=d?d:3e5}getCachedKey(a,b){let c=a;if(b&&Array.isArray(b)&&b.length?c=a?`${a}_${b.join("_")}`:`${b.join("_")}`:"string"==typeof b&&(c=a?`${a}_${b}`:b),!c)throw Error("Scopes or url must be provided");return c}getRequestHeaders(a,b,c){let e,h=this.getCachedKey(a,c),i=this.cache.get(h),j=Date.now();if(i&&i.expiration-j>this.eagerRefreshThresholdMillis)return i.headers;let k=Math.floor(Date.now()/1e3),l=g.getExpirationTime(k);if(Array.isArray(c)&&(c=c.join(" ")),e=c?{iss:this.email,sub:this.email,scope:c,exp:l,iat:k}:{iss:this.email,sub:this.email,aud:a,exp:l,iat:k},b){for(let a in e)if(b[a])throw Error(`The '${a}' property is not allowed when passing additionalClaims. This claim is included in the JWT by default.`)}let m=this.keyId?{...f,kid:this.keyId}:f,n=Object.assign(e,b),o=d.sign({header:m,payload:n,secret:this.key}),p={Authorization:`Bearer ${o}`};return this.cache.set(h,{expiration:1e3*l,headers:p}),p}static getExpirationTime(a){return a+3600}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!a.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!a.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=a.client_email,this.key=a.private_key,this.keyId=a.private_key_id,this.projectId=a.project_id}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}fromStreamAsync(a){return new Promise((b,c)=>{a||c(Error("Must pass in a stream containing the service account auth settings."));let d="";a.setEncoding("utf8").on("data",a=>d+=a).on("error",c).on("end",()=>{try{let a=JSON.parse(d);this.fromJSON(a),b()}catch(a){c(a)}})})}}c.JWTAccess=g},2629,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.JWT=void 0;let d=a.r(26644),e=a.r(34414),f=a.r(35246),g=a.r(28050);class h extends f.OAuth2Client{constructor(a,b,c,d,e,f){let g=a&&"object"==typeof a?a:{email:a,keyFile:b,key:c,keyId:f,scopes:d,subject:e};super(g),this.email=g.email,this.keyFile=g.keyFile,this.key=g.key,this.keyId=g.keyId,this.scopes=g.scopes,this.subject=g.subject,this.additionalClaims=g.additionalClaims,this.credentials={refresh_token:"jwt-placeholder",expiry_date:1}}createScoped(a){let b=new h(this);return b.scopes=a,b}async getRequestMetadataAsync(a){a=this.defaultServicePath?`https://${this.defaultServicePath}/`:a;let b=!this.hasUserScopes()&&a||this.useJWTAccessWithScope&&this.hasAnyScopes()||this.universeDomain!==g.DEFAULT_UNIVERSE;if(this.subject&&this.universeDomain!==g.DEFAULT_UNIVERSE)throw RangeError(`Service Account user is configured for the credential. Domain-wide delegation is not supported in universes other than ${g.DEFAULT_UNIVERSE}`);if(!this.apiKey&&b)if(this.additionalClaims&&this.additionalClaims.target_audience){let{tokens:a}=await this.refreshToken();return{headers:this.addSharedMetadataHeaders({Authorization:`Bearer ${a.id_token}`})}}else{let b;this.access||(this.access=new e.JWTAccess(this.email,this.key,this.keyId,this.eagerRefreshThresholdMillis)),this.hasUserScopes()?b=this.scopes:a||(b=this.defaultScopes);let c=this.useJWTAccessWithScope||this.universeDomain!==g.DEFAULT_UNIVERSE,d=await this.access.getRequestHeaders(null!=a?a:void 0,this.additionalClaims,c?b:void 0);return{headers:this.addSharedMetadataHeaders(d)}}return this.hasAnyScopes()||this.apiKey?super.getRequestMetadataAsync(a):{headers:{}}}async fetchIdToken(a){let b=new d.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:{target_audience:a},transporter:this.transporter});if(await b.getToken({forceRefresh:!0}),!b.idToken)throw Error("Unknown error: Failed to fetch ID token");return b.idToken}hasUserScopes(){return!!this.scopes&&this.scopes.length>0}hasAnyScopes(){return!!this.scopes&&!!(this.scopes.length>0)||!!this.defaultScopes&&!!(this.defaultScopes.length>0)}authorize(a){if(!a)return this.authorizeAsync();this.authorizeAsync().then(b=>a(null,b),a)}async authorizeAsync(){let a=await this.refreshToken();if(!a)throw Error("No result returned");return this.credentials=a.tokens,this.credentials.refresh_token="jwt-placeholder",this.key=this.gtoken.key,this.email=this.gtoken.iss,a.tokens}async refreshTokenNoCache(a){let b=this.createGToken(),c={access_token:(await b.getToken({forceRefresh:this.isTokenExpiring()})).access_token,token_type:"Bearer",expiry_date:b.expiresAt,id_token:b.idToken};return this.emit("tokens",c),{res:null,tokens:c}}createGToken(){return this.gtoken||(this.gtoken=new d.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:this.additionalClaims,transporter:this.transporter})),this.gtoken}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!a.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!a.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=a.client_email,this.key=a.private_key,this.keyId=a.private_key_id,this.projectId=a.project_id,this.quotaProjectId=a.quota_project_id,this.universeDomain=a.universe_domain||this.universeDomain}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}fromStreamAsync(a){return new Promise((b,c)=>{if(!a)throw Error("Must pass in a stream containing the service account auth settings.");let d="";a.setEncoding("utf8").on("error",c).on("data",a=>d+=a).on("end",()=>{try{let a=JSON.parse(d);this.fromJSON(a),b()}catch(a){c(a)}})})}fromAPIKey(a){if("string"!=typeof a)throw Error("Must provide an API Key string.");this.apiKey=a}async getCredentials(){if(this.key)return{private_key:this.key,client_email:this.email};if(this.keyFile){let a=this.createGToken(),b=await a.getCredentials(this.keyFile);return{private_key:b.privateKey,client_email:b.clientEmail}}throw Error("A key or a keyFile must be provided to getCredentials.")}}c.JWT=h},53904,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.UserRefreshClient=c.USER_REFRESH_ACCOUNT_TYPE=void 0;let d=a.r(35246),e=a.r(45706);c.USER_REFRESH_ACCOUNT_TYPE="authorized_user";class f extends d.OAuth2Client{constructor(a,b,c,d,e){let f=a&&"object"==typeof a?a:{clientId:a,clientSecret:b,refreshToken:c,eagerRefreshThresholdMillis:d,forceRefreshOnFailure:e};super(f),this._refreshToken=f.refreshToken,this.credentials.refresh_token=f.refreshToken}async refreshTokenNoCache(a){return super.refreshTokenNoCache(this._refreshToken)}async fetchIdToken(a){return(await this.transporter.request({...f.RETRY_CONFIG,url:this.endpoints.oauth2TokenUrl,headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",data:(0,e.stringify)({client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token",refresh_token:this._refreshToken,target_audience:a})})).data.id_token}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the user refresh token");if("authorized_user"!==a.type)throw Error('The incoming JSON object does not have the "authorized_user" type');if(!a.client_id)throw Error("The incoming JSON object does not contain a client_id field");if(!a.client_secret)throw Error("The incoming JSON object does not contain a client_secret field");if(!a.refresh_token)throw Error("The incoming JSON object does not contain a refresh_token field");this._clientId=a.client_id,this._clientSecret=a.client_secret,this._refreshToken=a.refresh_token,this.credentials.refresh_token=a.refresh_token,this.quotaProjectId=a.quota_project_id,this.universeDomain=a.universe_domain||this.universeDomain}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}async fromStreamAsync(a){return new Promise((b,c)=>{if(!a)return c(Error("Must pass in a stream containing the user refresh token."));let d="";a.setEncoding("utf8").on("error",c).on("data",a=>d+=a).on("end",()=>{try{let a=JSON.parse(d);return this.fromJSON(a),b()}catch(a){return c(a)}})})}static fromJSON(a){let b=new f;return b.fromJSON(a),b}}c.UserRefreshClient=f},7064,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Impersonated=c.IMPERSONATED_ACCOUNT_TYPE=void 0;let d=a.r(35246),e=a.r(48376),f=a.r(75701);c.IMPERSONATED_ACCOUNT_TYPE="impersonated_service_account";class g extends d.OAuth2Client{constructor(a={}){var b,c,e,g,h,i;if(super(a),this.credentials={expiry_date:1,refresh_token:"impersonated-placeholder"},this.sourceClient=null!=(b=a.sourceClient)?b:new d.OAuth2Client,this.targetPrincipal=null!=(c=a.targetPrincipal)?c:"",this.delegates=null!=(e=a.delegates)?e:[],this.targetScopes=null!=(g=a.targetScopes)?g:[],this.lifetime=null!=(h=a.lifetime)?h:3600,(0,f.originalOrCamelOptions)(a).get("universe_domain")){if(this.sourceClient.universeDomain!==this.universeDomain)throw RangeError(`Universe domain ${this.sourceClient.universeDomain} in source credentials does not match ${this.universeDomain} universe domain set for impersonated credentials.`)}else this.universeDomain=this.sourceClient.universeDomain;this.endpoint=null!=(i=a.endpoint)?i:`https://iamcredentials.${this.universeDomain}`}async sign(a){await this.sourceClient.getAccessToken();let b=`projects/-/serviceAccounts/${this.targetPrincipal}`,c=`${this.endpoint}/v1/${b}:signBlob`,d={delegates:this.delegates,payload:Buffer.from(a).toString("base64")};return(await this.sourceClient.request({...g.RETRY_CONFIG,url:c,data:d,method:"POST"})).data}getTargetPrincipal(){return this.targetPrincipal}async refreshToken(){var a,b,c,d,f,h;try{await this.sourceClient.getAccessToken();let a="projects/-/serviceAccounts/"+this.targetPrincipal,b=`${this.endpoint}/v1/${a}:generateAccessToken`,c={delegates:this.delegates,scope:this.targetScopes,lifetime:this.lifetime+"s"},d=await this.sourceClient.request({...g.RETRY_CONFIG,url:b,data:c,method:"POST"}),e=d.data;return this.credentials.access_token=e.accessToken,this.credentials.expiry_date=Date.parse(e.expireTime),{tokens:this.credentials,res:d}}catch(j){if(!(j instanceof Error))throw j;let g=0,i="";if(j instanceof e.GaxiosError&&(g=null==(c=null==(b=null==(a=null==j?void 0:j.response)?void 0:a.data)?void 0:b.error)?void 0:c.status,i=null==(h=null==(f=null==(d=null==j?void 0:j.response)?void 0:d.data)?void 0:f.error)?void 0:h.message),g&&i)throw j.message=`${g}: unable to impersonate: ${i}`,j;throw j.message=`unable to impersonate: ${j}`,j}}async fetchIdToken(a,b){var c,d;await this.sourceClient.getAccessToken();let e=`projects/-/serviceAccounts/${this.targetPrincipal}`,f=`${this.endpoint}/v1/${e}:generateIdToken`,h={delegates:this.delegates,audience:a,includeEmail:null==(c=null==b?void 0:b.includeEmail)||c,useEmailAzp:null==(d=null==b?void 0:b.includeEmail)||d};return(await this.sourceClient.request({...g.RETRY_CONFIG,url:f,data:h,method:"POST"})).data.token}}c.Impersonated=g},61671,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.OAuthClientAuthHandler=void 0,c.getErrorFromOAuthErrorResponse=function(a,b){let c=a.error,d=a.error_description,e=a.error_uri,f=`Error code ${c}`;void 0!==d&&(f+=`: ${d}`),void 0!==e&&(f+=` - ${e}`);let g=Error(f);if(b){let a=Object.keys(b);b.stack&&a.push("stack"),a.forEach(a=>{"message"!==a&&Object.defineProperty(g,a,{value:b[a],writable:!1,enumerable:!0})})}return g};let d=a.r(45706),e=a.r(42676),f=["PUT","POST","PATCH"];c.OAuthClientAuthHandler=class{constructor(a){this.clientAuthentication=a,this.crypto=(0,e.createCrypto)()}applyClientAuthenticationOptions(a,b){this.injectAuthenticatedHeaders(a,b),b||this.injectAuthenticatedRequestBody(a)}injectAuthenticatedHeaders(a,b){var c;if(b)a.headers=a.headers||{},Object.assign(a.headers,{Authorization:`Bearer ${b}}`});else if((null==(c=this.clientAuthentication)?void 0:c.confidentialClientType)==="basic"){a.headers=a.headers||{};let b=this.clientAuthentication.clientId,c=this.clientAuthentication.clientSecret||"",d=this.crypto.encodeBase64StringUtf8(`${b}:${c}`);Object.assign(a.headers,{Authorization:`Basic ${d}`})}}injectAuthenticatedRequestBody(a){var b;if((null==(b=this.clientAuthentication)?void 0:b.confidentialClientType)==="request-body"){let b=(a.method||"GET").toUpperCase();if(-1!==f.indexOf(b)){let b,c=a.headers||{};for(let a in c)if("content-type"===a.toLowerCase()&&c[a]){b=c[a].toLowerCase();break}if("application/x-www-form-urlencoded"===b){a.data=a.data||"";let b=d.parse(a.data);Object.assign(b,{client_id:this.clientAuthentication.clientId,client_secret:this.clientAuthentication.clientSecret||""}),a.data=d.stringify(b)}else if("application/json"===b)a.data=a.data||{},Object.assign(a.data,{client_id:this.clientAuthentication.clientId,client_secret:this.clientAuthentication.clientSecret||""});else throw Error(`${b} content-types are not supported with ${this.clientAuthentication.confidentialClientType} client authentication`)}else throw Error(`${b} HTTP method does not support ${this.clientAuthentication.confidentialClientType} client authentication`)}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}},89627,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StsCredentials=void 0;let d=a.r(48376),e=a.r(45706),f=a.r(85617),g=a.r(61671);class h extends g.OAuthClientAuthHandler{constructor(a,b){super(b),this.tokenExchangeEndpoint=a,this.transporter=new f.DefaultTransporter}async exchangeToken(a,b,c){var f,i,j;let k={grant_type:a.grantType,resource:a.resource,audience:a.audience,scope:null==(f=a.scope)?void 0:f.join(" "),requested_token_type:a.requestedTokenType,subject_token:a.subjectToken,subject_token_type:a.subjectTokenType,actor_token:null==(i=a.actingParty)?void 0:i.actorToken,actor_token_type:null==(j=a.actingParty)?void 0:j.actorTokenType,options:c&&JSON.stringify(c)};Object.keys(k).forEach(a=>{void 0===k[a]&&delete k[a]});let l={"Content-Type":"application/x-www-form-urlencoded"};Object.assign(l,b||{});let m={...h.RETRY_CONFIG,url:this.tokenExchangeEndpoint.toString(),method:"POST",headers:l,data:e.stringify(k),responseType:"json"};this.applyClientAuthenticationOptions(m);try{let a=await this.transporter.request(m),b=a.data;return b.res=a,b}catch(a){if(a instanceof d.GaxiosError&&a.response)throw(0,g.getErrorFromOAuthErrorResponse)(a.response.data,a);throw a}}}c.StsCredentials=h},74579,(a,b,c)=>{"use strict";var d,e,f,g=a.e&&a.e.__classPrivateFieldGet||function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)},h=a.e&&a.e.__classPrivateFieldSet||function(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c};Object.defineProperty(c,"__esModule",{value:!0}),c.BaseExternalAccountClient=c.DEFAULT_UNIVERSE=c.CLOUD_RESOURCE_MANAGER=c.EXTERNAL_ACCOUNT_TYPE=c.EXPIRATION_TIME_OFFSET=void 0;let i=a.r(88947),j=a.r(28050),k=a.r(89627),l=a.r(75701),m="https://www.googleapis.com/auth/cloud-platform";c.EXPIRATION_TIME_OFFSET=3e5,c.EXTERNAL_ACCOUNT_TYPE="external_account",c.CLOUD_RESOURCE_MANAGER="https://cloudresourcemanager.googleapis.com/v1/projects/";let n=a.r(91829);var o=a.r(28050);Object.defineProperty(c,"DEFAULT_UNIVERSE",{enumerable:!0,get:function(){return o.DEFAULT_UNIVERSE}});class p extends j.AuthClient{constructor(a,b){var f;super({...a,...b}),d.add(this),e.set(this,null);let g=(0,l.originalOrCamelOptions)(a),h=g.get("type");if(h&&h!==c.EXTERNAL_ACCOUNT_TYPE)throw Error(`Expected "${c.EXTERNAL_ACCOUNT_TYPE}" type but received "${a.type}"`);let i=g.get("client_id"),j=g.get("client_secret"),n=null!=(f=g.get("token_url"))?f:"https://sts.{universeDomain}/v1/token".replace("{universeDomain}",this.universeDomain),o=g.get("subject_token_type"),p=g.get("workforce_pool_user_project"),q=g.get("service_account_impersonation_url"),r=g.get("service_account_impersonation"),s=(0,l.originalOrCamelOptions)(r).get("token_lifetime_seconds");this.cloudResourceManagerURL=new URL(g.get("cloud_resource_manager_url")||`https://cloudresourcemanager.${this.universeDomain}/v1/projects/`),i&&(this.clientAuth={confidentialClientType:"basic",clientId:i,clientSecret:j}),this.stsCredential=new k.StsCredentials(n,this.clientAuth),this.scopes=g.get("scopes")||[m],this.cachedAccessToken=null,this.audience=g.get("audience"),this.subjectTokenType=o,this.workforcePoolUserProject=p;let t=RegExp("//iam\\.googleapis\\.com/locations/[^/]+/workforcePools/[^/]+/providers/.+");if(this.workforcePoolUserProject&&!this.audience.match(t))throw Error("workforcePoolUserProject should not be set for non-workforce pool credentials.");this.serviceAccountImpersonationUrl=q,this.serviceAccountImpersonationLifetime=s,this.serviceAccountImpersonationLifetime?this.configLifetimeRequested=!0:(this.configLifetimeRequested=!1,this.serviceAccountImpersonationLifetime=3600),this.projectNumber=this.getProjectNumber(this.audience),this.supplierContext={audience:this.audience,subjectTokenType:this.subjectTokenType,transporter:this.transporter}}getServiceAccountEmail(){var a;if(this.serviceAccountImpersonationUrl){if(this.serviceAccountImpersonationUrl.length>256)throw RangeError(`URL is too long: ${this.serviceAccountImpersonationUrl}`);let b=/serviceAccounts\/(?<email>[^:]+):generateAccessToken$/.exec(this.serviceAccountImpersonationUrl);return(null==(a=null==b?void 0:b.groups)?void 0:a.email)||null}return null}setCredentials(a){super.setCredentials(a),this.cachedAccessToken=a}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b={Authorization:`Bearer ${a.token}`};return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async getProjectId(){let a=this.projectNumber||this.workforcePoolUserProject;if(this.projectId)return this.projectId;if(a){let b=await this.getRequestHeaders(),c=await this.transporter.request({...p.RETRY_CONFIG,headers:b,url:`${this.cloudResourceManagerURL.toString()}${a}`,responseType:"json"});return this.projectId=c.data.projectId,this.projectId}return null}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=a.headers||{},b&&b["x-goog-user-project"]&&(a.headers["x-goog-user-project"]=b["x-goog-user-project"]),b&&b.Authorization&&(a.headers.Authorization=b.Authorization),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,e=c.config.data instanceof i.Readable;if(!b&&(401===d||403===d)&&!e&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw d}return c}async refreshAccessTokenAsync(){h(this,e,g(this,e,"f")||g(this,d,"m",f).call(this),"f");try{return await g(this,e,"f")}finally{h(this,e,null,"f")}}getProjectNumber(a){let b=a.match(/\/projects\/([^/]+)/);return b?b[1]:null}async getImpersonatedAccessToken(a){let b={...p.RETRY_CONFIG,url:this.serviceAccountImpersonationUrl,method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},data:{scope:this.getScopesArray(),lifetime:this.serviceAccountImpersonationLifetime+"s"},responseType:"json"},c=await this.transporter.request(b),d=c.data;return{access_token:d.accessToken,expiry_date:new Date(d.expireTime).getTime(),res:c}}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}getScopesArray(){return"string"==typeof this.scopes?[this.scopes]:this.scopes||[m]}getMetricsHeaderValue(){let a=process.version.replace(/^v/,""),b=void 0!==this.serviceAccountImpersonationUrl,c=this.credentialSourceType?this.credentialSourceType:"unknown";return`gl-node/${a} auth/${n.version} google-byoid-sdk source/${c} sa-impersonation/${b} config-lifetime/${this.configLifetimeRequested}`}}c.BaseExternalAccountClient=p,e=new WeakMap,d=new WeakSet,f=async function(){let a=await this.retrieveSubjectToken(),b={grantType:"urn:ietf:params:oauth:grant-type:token-exchange",audience:this.audience,requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:a,subjectTokenType:this.subjectTokenType,scope:this.serviceAccountImpersonationUrl?[m]:this.getScopesArray()},c=!this.clientAuth&&this.workforcePoolUserProject?{userProject:this.workforcePoolUserProject}:void 0,d={"x-goog-api-client":this.getMetricsHeaderValue()},e=await this.stsCredential.exchangeToken(b,d,c);return this.serviceAccountImpersonationUrl?this.cachedAccessToken=await this.getImpersonatedAccessToken(e.access_token):e.expires_in?this.cachedAccessToken={access_token:e.access_token,expiry_date:new Date().getTime()+1e3*e.expires_in,res:e.res}:this.cachedAccessToken={access_token:e.access_token,res:e.res},this.credentials={},Object.assign(this.credentials,this.cachedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedAccessToken.expiry_date,access_token:this.cachedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedAccessToken}},42467,(a,b,c)=>{"use strict";var d,e,f;Object.defineProperty(c,"__esModule",{value:!0}),c.FileSubjectTokenSupplier=void 0;let g=a.r(24361),h=a.r(22734),i=(0,g.promisify)(null!=(d=h.readFile)?d:()=>{}),j=(0,g.promisify)(null!=(e=h.realpath)?e:()=>{}),k=(0,g.promisify)(null!=(f=h.lstat)?f:()=>{});c.FileSubjectTokenSupplier=class{constructor(a){this.filePath=a.filePath,this.formatType=a.formatType,this.subjectTokenFieldName=a.subjectTokenFieldName}async getSubjectToken(a){let b,c=this.filePath;try{if(c=await j(c),!(await k(c)).isFile())throw Error()}catch(a){throw a instanceof Error&&(a.message=`The file at ${c} does not exist, or it is not a file. ${a.message}`),a}let d=await i(c,{encoding:"utf8"});if("text"===this.formatType?b=d:"json"===this.formatType&&this.subjectTokenFieldName&&(b=JSON.parse(d)[this.subjectTokenFieldName]),!b)throw Error("Unable to parse the subject_token from the credential_source file");return b}}},61041,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.UrlSubjectTokenSupplier=void 0,c.UrlSubjectTokenSupplier=class{constructor(a){this.url=a.url,this.formatType=a.formatType,this.subjectTokenFieldName=a.subjectTokenFieldName,this.headers=a.headers,this.additionalGaxiosOptions=a.additionalGaxiosOptions}async getSubjectToken(a){let b,c={...this.additionalGaxiosOptions,url:this.url,method:"GET",headers:this.headers,responseType:this.formatType};if("text"===this.formatType?b=(await a.transporter.request(c)).data:"json"===this.formatType&&this.subjectTokenFieldName&&(b=(await a.transporter.request(c)).data[this.subjectTokenFieldName]),!b)throw Error("Unable to parse the subject_token from the credential_source URL");return b}}},22330,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.IdentityPoolClient=void 0;let d=a.r(74579),e=a.r(75701),f=a.r(42467),g=a.r(61041);class h extends d.BaseExternalAccountClient{constructor(a,b){super(a,b);let c=(0,e.originalOrCamelOptions)(a),d=c.get("credential_source"),i=c.get("subject_token_supplier");if(!d&&!i)throw Error("A credential source or subject token supplier must be specified.");if(d&&i)throw Error("Only one of credential source or subject token supplier can be specified.");if(i)this.subjectTokenSupplier=i,this.credentialSourceType="programmatic";else{let a=(0,e.originalOrCamelOptions)(d),b=(0,e.originalOrCamelOptions)(a.get("format")),c=b.get("type")||"text",i=b.get("subject_token_field_name");if("json"!==c&&"text"!==c)throw Error(`Invalid credential_source format "${c}"`);if("json"===c&&!i)throw Error("Missing subject_token_field_name for JSON credential_source format");let j=a.get("file"),k=a.get("url"),l=a.get("headers");if(j&&k)throw Error('No valid Identity Pool "credential_source" provided, must be either file or url.');if(j&&!k)this.credentialSourceType="file",this.subjectTokenSupplier=new f.FileSubjectTokenSupplier({filePath:j,formatType:c,subjectTokenFieldName:i});else if(!j&&k)this.credentialSourceType="url",this.subjectTokenSupplier=new g.UrlSubjectTokenSupplier({url:k,formatType:c,subjectTokenFieldName:i,headers:l,additionalGaxiosOptions:h.RETRY_CONFIG});else throw Error('No valid Identity Pool "credential_source" provided, must be either file or url.')}}async retrieveSubjectToken(){return this.subjectTokenSupplier.getSubjectToken(this.supplierContext)}}c.IdentityPoolClient=h},62889,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AwsRequestSigner=void 0;let d=a.r(42676),e="AWS4-HMAC-SHA256";async function f(a,b,c){return await a.signWithHmacSha256(b,c)}async function g(a,b,c,d,e){let g=await f(a,`AWS4${b}`,c),h=await f(a,g,d),i=await f(a,h,e);return await f(a,i,"aws4_request")}async function h(a){let b=a.additionalAmzHeaders||{},c=a.requestPayload||"",h=a.host.split(".")[0],i=new Date,j=i.toISOString().replace(/[-:]/g,"").replace(/\.[0-9]+/,""),k=i.toISOString().replace(/[-]/g,"").replace(/T.*/,""),l={};Object.keys(b).forEach(a=>{l[a.toLowerCase()]=b[a]}),a.securityCredentials.token&&(l["x-amz-security-token"]=a.securityCredentials.token);let m=Object.assign({host:a.host},l.date?{}:{"x-amz-date":j},l),n="",o=Object.keys(m).sort();o.forEach(a=>{n+=`${a}:${m[a]}
`});let p=o.join(";"),q=await a.crypto.sha256DigestHex(c),r=`${a.method}
${a.canonicalUri}
${a.canonicalQuerystring}
${n}
${p}
${q}`,s=`${k}/${a.region}/${h}/aws4_request`,t=`${e}
${j}
${s}
`+await a.crypto.sha256DigestHex(r),u=await g(a.crypto,a.securityCredentials.secretAccessKey,k,a.region,h),v=await f(a.crypto,u,t),w=`${e} Credential=${a.securityCredentials.accessKeyId}/${s}, SignedHeaders=${p}, Signature=${(0,d.fromArrayBufferToHex)(v)}`;return{amzDate:l.date?void 0:j,authorizationHeader:w,canonicalQuerystring:a.canonicalQuerystring}}c.AwsRequestSigner=class{constructor(a,b){this.getCredentials=a,this.region=b,this.crypto=(0,d.createCrypto)()}async getRequestOptions(a){if(!a.url)throw Error('"url" is required in "amzOptions"');let b="object"==typeof a.data?JSON.stringify(a.data):a.data,c=a.url,d=a.method||"GET",e=a.body||b,f=a.headers,g=await this.getCredentials(),i=new URL(c),j=await h({crypto:this.crypto,host:i.host,canonicalUri:i.pathname,canonicalQuerystring:i.search.substr(1),method:d,region:this.region,securityCredentials:g,requestPayload:e,additionalAmzHeaders:f}),k=Object.assign(j.amzDate?{"x-amz-date":j.amzDate}:{},{Authorization:j.authorizationHeader,host:i.host},f||{});g.token&&Object.assign(k,{"x-amz-security-token":g.token});let l={url:c,method:d,headers:k};return void 0!==e&&(l.body=e),l}}},67167,(a,b,c)=>{"use strict";var d,e,f,g,h,i,j=a.e&&a.e.__classPrivateFieldGet||function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)};Object.defineProperty(c,"__esModule",{value:!0}),c.DefaultAwsSecurityCredentialsSupplier=void 0,c.DefaultAwsSecurityCredentialsSupplier=class{constructor(a){d.add(this),this.regionUrl=a.regionUrl,this.securityCredentialsUrl=a.securityCredentialsUrl,this.imdsV2SessionTokenUrl=a.imdsV2SessionTokenUrl,this.additionalGaxiosOptions=a.additionalGaxiosOptions}async getAwsRegion(a){if(j(this,d,"a",h))return j(this,d,"a",h);let b={};if(!j(this,d,"a",h)&&this.imdsV2SessionTokenUrl&&(b["x-aws-ec2-metadata-token"]=await j(this,d,"m",e).call(this,a.transporter)),!this.regionUrl)throw Error('Unable to determine AWS region due to missing "options.credential_source.region_url"');let c={...this.additionalGaxiosOptions,url:this.regionUrl,method:"GET",responseType:"text",headers:b},f=await a.transporter.request(c);return f.data.substr(0,f.data.length-1)}async getAwsSecurityCredentials(a){if(j(this,d,"a",i))return j(this,d,"a",i);let b={};this.imdsV2SessionTokenUrl&&(b["x-aws-ec2-metadata-token"]=await j(this,d,"m",e).call(this,a.transporter));let c=await j(this,d,"m",f).call(this,b,a.transporter),h=await j(this,d,"m",g).call(this,c,b,a.transporter);return{accessKeyId:h.AccessKeyId,secretAccessKey:h.SecretAccessKey,token:h.Token}}},d=new WeakSet,e=async function(a){let b={...this.additionalGaxiosOptions,url:this.imdsV2SessionTokenUrl,method:"PUT",responseType:"text",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"300"}};return(await a.request(b)).data},f=async function(a,b){if(!this.securityCredentialsUrl)throw Error('Unable to determine AWS role name due to missing "options.credential_source.url"');let c={...this.additionalGaxiosOptions,url:this.securityCredentialsUrl,method:"GET",responseType:"text",headers:a};return(await b.request(c)).data},g=async function(a,b,c){return(await c.request({...this.additionalGaxiosOptions,url:`${this.securityCredentialsUrl}/${a}`,responseType:"json",headers:b})).data},h=function(){return process.env.AWS_REGION||process.env.AWS_DEFAULT_REGION||null},i=function(){return process.env.AWS_ACCESS_KEY_ID&&process.env.AWS_SECRET_ACCESS_KEY?{accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY,token:process.env.AWS_SESSION_TOKEN}:null}},79949,(a,b,c)=>{"use strict";var d,e,f=a.e&&a.e.__classPrivateFieldGet||function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)};Object.defineProperty(c,"__esModule",{value:!0}),c.AwsClient=void 0;let g=a.r(62889),h=a.r(74579),i=a.r(67167),j=a.r(75701);class k extends h.BaseExternalAccountClient{constructor(a,b){super(a,b);let c=(0,j.originalOrCamelOptions)(a),g=c.get("credential_source"),h=c.get("aws_security_credentials_supplier");if(!g&&!h)throw Error("A credential source or AWS security credentials supplier must be specified.");if(g&&h)throw Error("Only one of credential source or AWS security credentials supplier can be specified.");if(h)this.awsSecurityCredentialsSupplier=h,this.regionalCredVerificationUrl=f(d,d,"f",e),this.credentialSourceType="programmatic";else{let a=(0,j.originalOrCamelOptions)(g);this.environmentId=a.get("environment_id");let b=a.get("region_url"),c=a.get("url"),d=a.get("imdsv2_session_token_url");this.awsSecurityCredentialsSupplier=new i.DefaultAwsSecurityCredentialsSupplier({regionUrl:b,securityCredentialsUrl:c,imdsV2SessionTokenUrl:d}),this.regionalCredVerificationUrl=a.get("regional_cred_verification_url"),this.credentialSourceType="aws",this.validateEnvironmentId()}this.awsRequestSigner=null,this.region=""}validateEnvironmentId(){var a;let b=null==(a=this.environmentId)?void 0:a.match(/^(aws)(\d+)$/);if(b&&this.regionalCredVerificationUrl){if(1!==parseInt(b[2],10))throw Error(`aws version "${b[2]}" is not supported in the current build.`)}else throw Error('No valid AWS "credential_source" provided')}async retrieveSubjectToken(){this.awsRequestSigner||(this.region=await this.awsSecurityCredentialsSupplier.getAwsRegion(this.supplierContext),this.awsRequestSigner=new g.AwsRequestSigner(async()=>this.awsSecurityCredentialsSupplier.getAwsSecurityCredentials(this.supplierContext),this.region));let a=await this.awsRequestSigner.getRequestOptions({...d.RETRY_CONFIG,url:this.regionalCredVerificationUrl.replace("{region}",this.region),method:"POST"}),b=[],c=Object.assign({"x-goog-cloud-target-resource":this.audience},a.headers);for(let a in c)b.push({key:a,value:c[a]});return encodeURIComponent(JSON.stringify({url:a.url,method:a.method,headers:b}))}}c.AwsClient=k,d=k,e={value:"https://sts.{region}.amazonaws.com?Action=GetCallerIdentity&Version=2011-06-15"},k.AWS_EC2_METADATA_IPV4_ADDRESS="169.254.169.254",k.AWS_EC2_METADATA_IPV6_ADDRESS="fd00:ec2::254"},39105,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.InvalidSubjectTokenError=c.InvalidMessageFieldError=c.InvalidCodeFieldError=c.InvalidTokenTypeFieldError=c.InvalidExpirationTimeFieldError=c.InvalidSuccessFieldError=c.InvalidVersionFieldError=c.ExecutableResponseError=c.ExecutableResponse=void 0;let d="urn:ietf:params:oauth:token-type:saml2",e="urn:ietf:params:oauth:token-type:id_token",f="urn:ietf:params:oauth:token-type:jwt";c.ExecutableResponse=class{constructor(a){if(!a.version)throw new h("Executable response must contain a 'version' field.");if(void 0===a.success)throw new i("Executable response must contain a 'success' field.");if(this.version=a.version,this.success=a.success,this.success){if(this.expirationTime=a.expiration_time,this.tokenType=a.token_type,this.tokenType!==d&&this.tokenType!==e&&this.tokenType!==f)throw new j(`Executable response must contain a 'token_type' field when successful and it must be one of ${e}, ${f}, or ${d}.`);if(this.tokenType===d){if(!a.saml_response)throw new m(`Executable response must contain a 'saml_response' field when token_type=${d}.`);this.subjectToken=a.saml_response}else{if(!a.id_token)throw new m(`Executable response must contain a 'id_token' field when token_type=${e} or ${f}.`);this.subjectToken=a.id_token}}else{if(!a.code)throw new k("Executable response must contain a 'code' field when unsuccessful.");if(!a.message)throw new l("Executable response must contain a 'message' field when unsuccessful.");this.errorCode=a.code,this.errorMessage=a.message}}isValid(){return!this.isExpired()&&this.success}isExpired(){return void 0!==this.expirationTime&&this.expirationTime<Math.round(Date.now()/1e3)}};class g extends Error{constructor(a){super(a),Object.setPrototypeOf(this,new.target.prototype)}}c.ExecutableResponseError=g;class h extends g{}c.InvalidVersionFieldError=h;class i extends g{}c.InvalidSuccessFieldError=i,c.InvalidExpirationTimeFieldError=class extends g{};class j extends g{}c.InvalidTokenTypeFieldError=j;class k extends g{}c.InvalidCodeFieldError=k;class l extends g{}c.InvalidMessageFieldError=l;class m extends g{}c.InvalidSubjectTokenError=m},1420,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PluggableAuthHandler=void 0;let d=a.r(1064),e=a.r(39105),f=a.r(33405),g=a.r(22734);class h{constructor(a){if(!a.command)throw Error("No command provided.");if(this.commandComponents=h.parseCommand(a.command),this.timeoutMillis=a.timeoutMillis,!this.timeoutMillis)throw Error("No timeoutMillis provided.");this.outputFile=a.outputFile}retrieveResponseFromExecutable(a){return new Promise((b,c)=>{let g=f.spawn(this.commandComponents[0],this.commandComponents.slice(1),{env:{...process.env,...Object.fromEntries(a)}}),h="";g.stdout.on("data",a=>{h+=a}),g.stderr.on("data",a=>{h+=a});let i=setTimeout(()=>(g.removeAllListeners(),g.kill(),c(Error("The executable failed to finish within the timeout specified."))),this.timeoutMillis);g.on("close",a=>{if(clearTimeout(i),0!==a)return c(new d.ExecutableError(h,a.toString()));try{let a=JSON.parse(h),c=new e.ExecutableResponse(a);return b(c)}catch(a){if(a instanceof e.ExecutableResponseError)return c(a);return c(new e.ExecutableResponseError(`The executable returned an invalid response: ${h}`))}})})}async retrieveCachedResponse(){let a;if(!this.outputFile||0===this.outputFile.length)return;try{a=await g.promises.realpath(this.outputFile)}catch(a){return}if(!(await g.promises.lstat(a)).isFile())return;let b=await g.promises.readFile(a,{encoding:"utf8"});if(""!==b)try{let a=JSON.parse(b);if(new e.ExecutableResponse(a).isValid())return new e.ExecutableResponse(a);return}catch(a){if(a instanceof e.ExecutableResponseError)throw a;throw new e.ExecutableResponseError(`The output file contained an invalid response: ${b}`)}}static parseCommand(a){let b=a.match(/(?:[^\s"]+|"[^"]*")+/g);if(!b)throw Error(`Provided command: "${a}" could not be parsed.`);for(let a=0;a<b.length;a++)'"'===b[a][0]&&'"'===b[a].slice(-1)&&(b[a]=b[a].slice(1,-1));return b}}c.PluggableAuthHandler=h},1064,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PluggableAuthClient=c.ExecutableError=void 0;let d=a.r(74579),e=a.r(39105),f=a.r(1420);class g extends Error{constructor(a,b){super(`The executable failed with exit code: ${b} and error message: ${a}.`),this.code=b,Object.setPrototypeOf(this,new.target.prototype)}}c.ExecutableError=g;class h extends d.BaseExternalAccountClient{constructor(a,b){if(super(a,b),!a.credential_source.executable||(this.command=a.credential_source.executable.command,!this.command))throw Error('No valid Pluggable Auth "credential_source" provided.');if(void 0===a.credential_source.executable.timeout_millis)this.timeoutMillis=3e4;else if(this.timeoutMillis=a.credential_source.executable.timeout_millis,this.timeoutMillis<5e3||this.timeoutMillis>12e4)throw Error("Timeout must be between 5000120000 milliseconds.");this.outputFile=a.credential_source.executable.output_file,this.handler=new f.PluggableAuthHandler({command:this.command,timeoutMillis:this.timeoutMillis,outputFile:this.outputFile}),this.credentialSourceType="executable"}async retrieveSubjectToken(){let a;if("1"!==process.env.GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES)throw Error("Pluggable Auth executables need to be explicitly allowed to run by setting the GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES environment Variable to 1.");if(this.outputFile&&(a=await this.handler.retrieveCachedResponse()),!a){let b=new Map;b.set("GOOGLE_EXTERNAL_ACCOUNT_AUDIENCE",this.audience),b.set("GOOGLE_EXTERNAL_ACCOUNT_TOKEN_TYPE",this.subjectTokenType),b.set("GOOGLE_EXTERNAL_ACCOUNT_INTERACTIVE","0"),this.outputFile&&b.set("GOOGLE_EXTERNAL_ACCOUNT_OUTPUT_FILE",this.outputFile);let c=this.getServiceAccountEmail();c&&b.set("GOOGLE_EXTERNAL_ACCOUNT_IMPERSONATED_EMAIL",c),a=await this.handler.retrieveResponseFromExecutable(b)}if(a.version>1)throw Error("Version of executable is not currently supported, maximum supported version is 1.");if(!a.success)throw new g(a.errorMessage,a.errorCode);if(this.outputFile&&!a.expirationTime)throw new e.InvalidExpirationTimeFieldError("The executable response must contain the `expiration_time` field for successful responses when an output_file has been specified in the configuration.");if(a.isExpired())throw Error("Executable response is expired.");return a.subjectToken}}c.PluggableAuthClient=h},44686,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ExternalAccountClient=void 0;let d=a.r(74579),e=a.r(22330),f=a.r(79949),g=a.r(1064);c.ExternalAccountClient=class{constructor(){throw Error("ExternalAccountClients should be initialized via: ExternalAccountClient.fromJSON(), directly via explicit constructors, eg. new AwsClient(options), new IdentityPoolClient(options), newPluggableAuthClientOptions, or via new GoogleAuth(options).getClient()")}static fromJSON(a,b){var c,h;return a&&a.type===d.EXTERNAL_ACCOUNT_TYPE?(null==(c=a.credential_source)?void 0:c.environment_id)?new f.AwsClient(a,b):(null==(h=a.credential_source)?void 0:h.executable)?new g.PluggableAuthClient(a,b):new e.IdentityPoolClient(a,b):null}}},69464,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ExternalAccountAuthorizedUserClient=c.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE=void 0;let d=a.r(28050),e=a.r(61671),f=a.r(48376),g=a.r(88947),h=a.r(74579);c.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE="external_account_authorized_user";class i extends e.OAuthClientAuthHandler{constructor(a,b,c){super(c),this.url=a,this.transporter=b}async refreshToken(a,b){let c=new URLSearchParams({grant_type:"refresh_token",refresh_token:a}),d={"Content-Type":"application/x-www-form-urlencoded",...b},g={...i.RETRY_CONFIG,url:this.url,method:"POST",headers:d,data:c.toString(),responseType:"json"};this.applyClientAuthenticationOptions(g);try{let a=await this.transporter.request(g),b=a.data;return b.res=a,b}catch(a){if(a instanceof f.GaxiosError&&a.response)throw(0,e.getErrorFromOAuthErrorResponse)(a.response.data,a);throw a}}}class j extends d.AuthClient{constructor(a,b){var c;super({...a,...b}),a.universe_domain&&(this.universeDomain=a.universe_domain),this.refreshToken=a.refresh_token;let d={confidentialClientType:"basic",clientId:a.client_id,clientSecret:a.client_secret};this.externalAccountAuthorizedUserHandler=new i(null!=(c=a.token_url)?c:"https://sts.{universeDomain}/v1/oauthtoken".replace("{universeDomain}",this.universeDomain),this.transporter,d),this.cachedAccessToken=null,this.quotaProjectId=a.quota_project_id,"number"!=typeof(null==b?void 0:b.eagerRefreshThresholdMillis)?this.eagerRefreshThresholdMillis=h.EXPIRATION_TIME_OFFSET:this.eagerRefreshThresholdMillis=b.eagerRefreshThresholdMillis,this.forceRefreshOnFailure=!!(null==b?void 0:b.forceRefreshOnFailure)}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b={Authorization:`Bearer ${a.token}`};return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=a.headers||{},b&&b["x-goog-user-project"]&&(a.headers["x-goog-user-project"]=b["x-goog-user-project"]),b&&b.Authorization&&(a.headers.Authorization=b.Authorization),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,e=c.config.data instanceof g.Readable;if(!b&&(401===d||403===d)&&!e&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw d}return c}async refreshAccessTokenAsync(){let a=await this.externalAccountAuthorizedUserHandler.refreshToken(this.refreshToken);return this.cachedAccessToken={access_token:a.access_token,expiry_date:new Date().getTime()+1e3*a.expires_in,res:a.res},void 0!==a.refresh_token&&(this.refreshToken=a.refresh_token),this.cachedAccessToken}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}}c.ExternalAccountAuthorizedUserClient=j},28796,(a,b,c)=>{"use strict";var d,e,f,g,h=a.e&&a.e.__classPrivateFieldGet||function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)},i=a.e&&a.e.__classPrivateFieldSet||function(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c};Object.defineProperty(c,"__esModule",{value:!0}),c.GoogleAuth=c.GoogleAuthExceptionMessages=c.CLOUD_SDK_CLIENT_ID=void 0;let j=a.r(33405),k=a.r(22734),l=a.r(76120),m=a.r(46786),n=a.r(14747),o=a.r(42676),p=a.r(85617),q=a.r(77078),r=a.r(73736),s=a.r(64783),t=a.r(2629),u=a.r(53904),v=a.r(7064),w=a.r(44686),x=a.r(74579),y=a.r(28050),z=a.r(69464),A=a.r(75701);c.CLOUD_SDK_CLIENT_ID="764086051850-6qr4p6gpi6hn506pt8ejuq83di341hur.apps.googleusercontent.com",c.GoogleAuthExceptionMessages={API_KEY_WITH_CREDENTIALS:"API Keys and Credentials are mutually exclusive authentication methods and cannot be used together.",NO_PROJECT_ID_FOUND:"Unable to detect a Project Id in the current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_CREDENTIALS_FOUND:"Unable to find credentials in current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_ADC_FOUND:"Could not load the default credentials. Browse to https://cloud.google.com/docs/authentication/getting-started for more information.",NO_UNIVERSE_DOMAIN_FOUND:"Unable to detect a Universe Domain in the current environment.\nTo learn more about Universe Domain retrieval, visit: \nhttps://cloud.google.com/compute/docs/metadata/predefined-metadata-keys"};class B{get isGCE(){return this.checkIsGCE}constructor(a={}){if(d.add(this),this.checkIsGCE=void 0,this.jsonContent=null,this.cachedCredential=null,e.set(this,null),this.clientOptions={},this._cachedProjectId=a.projectId||null,this.cachedCredential=a.authClient||null,this.keyFilename=a.keyFilename||a.keyFile,this.scopes=a.scopes,this.clientOptions=a.clientOptions||{},this.jsonContent=a.credentials||null,this.apiKey=a.apiKey||this.clientOptions.apiKey||null,this.apiKey&&(this.jsonContent||this.clientOptions.credentials))throw RangeError(c.GoogleAuthExceptionMessages.API_KEY_WITH_CREDENTIALS);a.universeDomain&&(this.clientOptions.universeDomain=a.universeDomain)}setGapicJWTValues(a){a.defaultServicePath=this.defaultServicePath,a.useJWTAccessWithScope=this.useJWTAccessWithScope,a.defaultScopes=this.defaultScopes}getProjectId(a){if(!a)return this.getProjectIdAsync();this.getProjectIdAsync().then(b=>a(null,b),a)}async getProjectIdOptional(){try{return await this.getProjectId()}catch(a){if(a instanceof Error&&a.message===c.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)return null;throw a}}async findAndCacheProjectId(){let a=null;if((a=await this.getProductionProjectId())||(a=await this.getFileProjectId()),a||(a=await this.getDefaultServiceProjectId()),a||(a=await this.getGCEProjectId()),a||(a=await this.getExternalAccountClientProjectId()),a)return this._cachedProjectId=a,a;throw Error(c.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)}async getProjectIdAsync(){return this._cachedProjectId?this._cachedProjectId:(this._findProjectIdPromise||(this._findProjectIdPromise=this.findAndCacheProjectId()),this._findProjectIdPromise)}async getUniverseDomainFromMetadataServer(){var a;let b;try{(b=await l.universe("universe-domain"))||(b=y.DEFAULT_UNIVERSE)}catch(c){if(c&&(null==(a=null==c?void 0:c.response)?void 0:a.status)===404)b=y.DEFAULT_UNIVERSE;else throw c}return b}async getUniverseDomain(){let a=(0,A.originalOrCamelOptions)(this.clientOptions).get("universe_domain");try{null!=a||(a=(await this.getClient()).universeDomain)}catch(b){null!=a||(a=y.DEFAULT_UNIVERSE)}return a}getAnyScopes(){return this.scopes||this.defaultScopes}getApplicationDefault(a={},b){let c;if("function"==typeof a?b=a:c=a,!b)return this.getApplicationDefaultAsync(c);this.getApplicationDefaultAsync(c).then(a=>b(null,a.credential,a.projectId),b)}async getApplicationDefaultAsync(a={}){let b;if(this.cachedCredential)return await h(this,d,"m",f).call(this,this.cachedCredential,null);if((b=await this._tryGetApplicationCredentialsFromEnvironmentVariable(a))||(b=await this._tryGetApplicationCredentialsFromWellKnownFile(a)))return b instanceof t.JWT?b.scopes=this.scopes:b instanceof x.BaseExternalAccountClient&&(b.scopes=this.getAnyScopes()),await h(this,d,"m",f).call(this,b);if(await this._checkIsGCE())return a.scopes=this.getAnyScopes(),await h(this,d,"m",f).call(this,new q.Compute(a));throw Error(c.GoogleAuthExceptionMessages.NO_ADC_FOUND)}async _checkIsGCE(){return void 0===this.checkIsGCE&&(this.checkIsGCE=l.getGCPResidency()||await l.isAvailable()),this.checkIsGCE}async _tryGetApplicationCredentialsFromEnvironmentVariable(a){let b=process.env.GOOGLE_APPLICATION_CREDENTIALS||process.env.google_application_credentials;if(!b||0===b.length)return null;try{return this._getApplicationCredentialsFromFilePath(b,a)}catch(a){throw a instanceof Error&&(a.message=`Unable to read the credential file specified by the GOOGLE_APPLICATION_CREDENTIALS environment variable: ${a.message}`),a}}async _tryGetApplicationCredentialsFromWellKnownFile(a){let b=null;if(this._isWindows())b=process.env.APPDATA;else{let a=process.env.HOME;a&&(b=n.join(a,".config"))}return(b&&(b=n.join(b,"gcloud","application_default_credentials.json"),k.existsSync(b)||(b=null)),b)?await this._getApplicationCredentialsFromFilePath(b,a):null}async _getApplicationCredentialsFromFilePath(a,b={}){if(!a||0===a.length)throw Error("The file path is invalid.");try{if(a=k.realpathSync(a),!k.lstatSync(a).isFile())throw Error()}catch(b){throw b instanceof Error&&(b.message=`The file at ${a} does not exist, or it is not a file. ${b.message}`),b}let c=k.createReadStream(a);return this.fromStream(c,b)}fromImpersonatedJSON(a){var b,c,d,e;if(!a)throw Error("Must pass in a JSON object containing an  impersonated refresh token");if(a.type!==v.IMPERSONATED_ACCOUNT_TYPE)throw Error(`The incoming JSON object does not have the "${v.IMPERSONATED_ACCOUNT_TYPE}" type`);if(!a.source_credentials)throw Error("The incoming JSON object does not contain a source_credentials field");if(!a.service_account_impersonation_url)throw Error("The incoming JSON object does not contain a service_account_impersonation_url field");let f=this.fromJSON(a.source_credentials);if((null==(b=a.service_account_impersonation_url)?void 0:b.length)>256)throw RangeError(`Target principal is too long: ${a.service_account_impersonation_url}`);let g=null==(d=null==(c=/(?<target>[^/]+):(generateAccessToken|generateIdToken)$/.exec(a.service_account_impersonation_url))?void 0:c.groups)?void 0:d.target;if(!g)throw RangeError(`Cannot extract target principal from ${a.service_account_impersonation_url}`);let h=null!=(e=this.getAnyScopes())?e:[];return new v.Impersonated({...a,sourceClient:f,targetPrincipal:g,targetScopes:Array.isArray(h)?h:[h]})}fromJSON(a,b={}){let c,d=(0,A.originalOrCamelOptions)(b).get("universe_domain");return a.type===u.USER_REFRESH_ACCOUNT_TYPE?(c=new u.UserRefreshClient(b)).fromJSON(a):a.type===v.IMPERSONATED_ACCOUNT_TYPE?c=this.fromImpersonatedJSON(a):a.type===x.EXTERNAL_ACCOUNT_TYPE?(c=w.ExternalAccountClient.fromJSON(a,b)).scopes=this.getAnyScopes():a.type===z.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE?c=new z.ExternalAccountAuthorizedUserClient(a,b):(b.scopes=this.scopes,c=new t.JWT(b),this.setGapicJWTValues(c),c.fromJSON(a)),d&&(c.universeDomain=d),c}_cacheClientFromJSON(a,b){let c=this.fromJSON(a,b);return this.jsonContent=a,this.cachedCredential=c,c}fromStream(a,b={},c){let d={};if("function"==typeof b?c=b:d=b,!c)return this.fromStreamAsync(a,d);this.fromStreamAsync(a,d).then(a=>c(null,a),c)}fromStreamAsync(a,b){return new Promise((c,d)=>{if(!a)throw Error("Must pass in a stream containing the Google auth settings.");let e=[];a.setEncoding("utf8").on("error",d).on("data",a=>e.push(a)).on("end",()=>{try{try{let a=JSON.parse(e.join("")),d=this._cacheClientFromJSON(a,b);return c(d)}catch(b){if(!this.keyFilename)throw b;let a=new t.JWT({...this.clientOptions,keyFile:this.keyFilename});return this.cachedCredential=a,this.setGapicJWTValues(a),c(a)}}catch(a){return d(a)}})})}fromAPIKey(a,b={}){return new t.JWT({...b,apiKey:a})}_isWindows(){let a=m.platform();return!!a&&!!(a.length>=3)&&"win"===a.substring(0,3).toLowerCase()}async getDefaultServiceProjectId(){return new Promise(a=>{(0,j.exec)("gcloud config config-helper --format json",(b,c)=>{if(!b&&c)try{let b=JSON.parse(c).configuration.properties.core.project;a(b);return}catch(a){}a(null)})})}getProductionProjectId(){return process.env.GCLOUD_PROJECT||process.env.GOOGLE_CLOUD_PROJECT||process.env.gcloud_project||process.env.google_cloud_project}async getFileProjectId(){if(this.cachedCredential)return this.cachedCredential.projectId;if(this.keyFilename){let a=await this.getClient();if(a&&a.projectId)return a.projectId}let a=await this._tryGetApplicationCredentialsFromEnvironmentVariable();return a?a.projectId:null}async getExternalAccountClientProjectId(){if(!this.jsonContent||this.jsonContent.type!==x.EXTERNAL_ACCOUNT_TYPE)return null;let a=await this.getClient();return await a.getProjectId()}async getGCEProjectId(){try{return await l.project("project-id")}catch(a){return null}}getCredentials(a){if(!a)return this.getCredentialsAsync();this.getCredentialsAsync().then(b=>a(null,b),a)}async getCredentialsAsync(){let a=await this.getClient();if(a instanceof v.Impersonated)return{client_email:a.getTargetPrincipal()};if(a instanceof x.BaseExternalAccountClient){let b=a.getServiceAccountEmail();if(b)return{client_email:b,universe_domain:a.universeDomain}}if(this.jsonContent)return{client_email:this.jsonContent.client_email,private_key:this.jsonContent.private_key,universe_domain:this.jsonContent.universe_domain};if(await this._checkIsGCE()){let[a,b]=await Promise.all([l.instance("service-accounts/default/email"),this.getUniverseDomain()]);return{client_email:a,universe_domain:b}}throw Error(c.GoogleAuthExceptionMessages.NO_CREDENTIALS_FOUND)}async getClient(){if(this.cachedCredential)return this.cachedCredential;i(this,e,h(this,e,"f")||h(this,d,"m",g).call(this),"f");try{return await h(this,e,"f")}finally{i(this,e,null,"f")}}async getIdTokenClient(a){let b=await this.getClient();if(!("fetchIdToken"in b))throw Error("Cannot fetch ID token in this environment, use GCE or set the GOOGLE_APPLICATION_CREDENTIALS environment variable to a service account credentials JSON file.");return new r.IdTokenClient({targetAudience:a,idTokenProvider:b})}async getAccessToken(){let a=await this.getClient();return(await a.getAccessToken()).token}async getRequestHeaders(a){return(await this.getClient()).getRequestHeaders(a)}async authorizeRequest(a){let b=(a=a||{}).url||a.uri,c=await this.getClient(),d=await c.getRequestHeaders(b);return a.headers=Object.assign(a.headers||{},d),a}async request(a){return(await this.getClient()).request(a)}getEnv(){return(0,s.getEnv)()}async sign(a,b){let c=await this.getClient(),d=await this.getUniverseDomain();if(b=b||`https://iamcredentials.${d}/v1/projects/-/serviceAccounts/`,c instanceof v.Impersonated)return(await c.sign(a)).signedBlob;let e=(0,o.createCrypto)();if(c instanceof t.JWT&&c.key)return await e.sign(c.key,a);let f=await this.getCredentials();if(!f.client_email)throw Error("Cannot sign data without `client_email`.");return this.signBlob(e,f.client_email,a,b)}async signBlob(a,b,c,d){let e=new URL(d+`${b}:signBlob`);return(await this.request({method:"POST",url:e.href,data:{payload:a.encodeBase64StringUtf8(c)},retry:!0,retryConfig:{httpMethodsToRetry:["POST"]}})).data.signedBlob}}c.GoogleAuth=B,e=new WeakMap,d=new WeakSet,f=async function(a,b=process.env.GOOGLE_CLOUD_QUOTA_PROJECT||null){let c=await this.getProjectIdOptional();return b&&(a.quotaProjectId=b),this.cachedCredential=a,{credential:a,projectId:c}},g=async function(){if(this.jsonContent)return this._cacheClientFromJSON(this.jsonContent,this.clientOptions);if(this.keyFilename){let a=n.resolve(this.keyFilename),b=k.createReadStream(a);return await this.fromStreamAsync(b,this.clientOptions)}if(this.apiKey){let a=await this.fromAPIKey(this.apiKey,this.clientOptions);a.scopes=this.scopes;let{credential:b}=await h(this,d,"m",f).call(this,a);return b}{let{credential:a}=await this.getApplicationDefaultAsync(this.clientOptions);return a}},B.DefaultTransporter=p.DefaultTransporter},10918,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.IAMAuth=void 0,c.IAMAuth=class{constructor(a,b){this.selector=a,this.token=b,this.selector=a,this.token=b}getRequestHeaders(){return{"x-goog-iam-authority-selector":this.selector,"x-goog-iam-authorization-token":this.token}}}},23699,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DownscopedClient=c.EXPIRATION_TIME_OFFSET=c.MAX_ACCESS_BOUNDARY_RULES_COUNT=void 0;let d=a.r(88947),e=a.r(28050),f=a.r(89627);c.MAX_ACCESS_BOUNDARY_RULES_COUNT=10,c.EXPIRATION_TIME_OFFSET=3e5;class g extends e.AuthClient{constructor(a,b,d,e){if(super({...d,quotaProjectId:e}),this.authClient=a,this.credentialAccessBoundary=b,0===b.accessBoundary.accessBoundaryRules.length)throw Error("At least one access boundary rule needs to be defined.");if(b.accessBoundary.accessBoundaryRules.length>c.MAX_ACCESS_BOUNDARY_RULES_COUNT)throw Error(`The provided access boundary has more than ${c.MAX_ACCESS_BOUNDARY_RULES_COUNT} access boundary rules.`);for(let a of b.accessBoundary.accessBoundaryRules)if(0===a.availablePermissions.length)throw Error("At least one permission should be defined in access boundary rules.");this.stsCredential=new f.StsCredentials(`https://sts.${this.universeDomain}/v1/token`),this.cachedDownscopedAccessToken=null}setCredentials(a){if(!a.expiry_date)throw Error("The access token expiry_date field is missing in the provided credentials.");super.setCredentials(a),this.cachedDownscopedAccessToken=a}async getAccessToken(){return(!this.cachedDownscopedAccessToken||this.isExpired(this.cachedDownscopedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedDownscopedAccessToken.access_token,expirationTime:this.cachedDownscopedAccessToken.expiry_date,res:this.cachedDownscopedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b={Authorization:`Bearer ${a.token}`};return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=a.headers||{},b&&b["x-goog-user-project"]&&(a.headers["x-goog-user-project"]=b["x-goog-user-project"]),b&&b.Authorization&&(a.headers.Authorization=b.Authorization),c=await this.transporter.request(a)}catch(e){let c=e.response;if(c){let e=c.status,f=c.config.data instanceof d.Readable;if(!b&&(401===e||403===e)&&!f&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw e}return c}async refreshAccessTokenAsync(){var a;let b=(await this.authClient.getAccessToken()).token,c=await this.stsCredential.exchangeToken({grantType:"urn:ietf:params:oauth:grant-type:token-exchange",requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:b,subjectTokenType:"urn:ietf:params:oauth:token-type:access_token"},void 0,this.credentialAccessBoundary),d=(null==(a=this.authClient.credentials)?void 0:a.expiry_date)||null,e=c.expires_in?new Date().getTime()+1e3*c.expires_in:d;return this.cachedDownscopedAccessToken={access_token:c.access_token,expiry_date:e,res:c.res},this.credentials={},Object.assign(this.credentials,this.cachedDownscopedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedDownscopedAccessToken.expiry_date,access_token:this.cachedDownscopedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedDownscopedAccessToken}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}}c.DownscopedClient=g},52421,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PassThroughClient=void 0;let d=a.r(28050);class e extends d.AuthClient{async request(a){return this.transporter.request(a)}async getAccessToken(){return{}}async getRequestHeaders(){return{}}}c.PassThroughClient=e,new e().getAccessToken()},77530,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GoogleAuth=c.auth=c.DefaultTransporter=c.PassThroughClient=c.ExecutableError=c.PluggableAuthClient=c.DownscopedClient=c.BaseExternalAccountClient=c.ExternalAccountClient=c.IdentityPoolClient=c.AwsRequestSigner=c.AwsClient=c.UserRefreshClient=c.LoginTicket=c.ClientAuthentication=c.OAuth2Client=c.CodeChallengeMethod=c.Impersonated=c.JWT=c.JWTAccess=c.IdTokenClient=c.IAMAuth=c.GCPEnv=c.Compute=c.DEFAULT_UNIVERSE=c.AuthClient=c.gaxios=c.gcpMetadata=void 0;let d=a.r(28796);Object.defineProperty(c,"GoogleAuth",{enumerable:!0,get:function(){return d.GoogleAuth}}),c.gcpMetadata=a.r(76120),c.gaxios=a.r(48376);var e=a.r(28050);Object.defineProperty(c,"AuthClient",{enumerable:!0,get:function(){return e.AuthClient}}),Object.defineProperty(c,"DEFAULT_UNIVERSE",{enumerable:!0,get:function(){return e.DEFAULT_UNIVERSE}});var f=a.r(77078);Object.defineProperty(c,"Compute",{enumerable:!0,get:function(){return f.Compute}});var g=a.r(64783);Object.defineProperty(c,"GCPEnv",{enumerable:!0,get:function(){return g.GCPEnv}});var h=a.r(10918);Object.defineProperty(c,"IAMAuth",{enumerable:!0,get:function(){return h.IAMAuth}});var i=a.r(73736);Object.defineProperty(c,"IdTokenClient",{enumerable:!0,get:function(){return i.IdTokenClient}});var j=a.r(34414);Object.defineProperty(c,"JWTAccess",{enumerable:!0,get:function(){return j.JWTAccess}});var k=a.r(2629);Object.defineProperty(c,"JWT",{enumerable:!0,get:function(){return k.JWT}});var l=a.r(7064);Object.defineProperty(c,"Impersonated",{enumerable:!0,get:function(){return l.Impersonated}});var m=a.r(35246);Object.defineProperty(c,"CodeChallengeMethod",{enumerable:!0,get:function(){return m.CodeChallengeMethod}}),Object.defineProperty(c,"OAuth2Client",{enumerable:!0,get:function(){return m.OAuth2Client}}),Object.defineProperty(c,"ClientAuthentication",{enumerable:!0,get:function(){return m.ClientAuthentication}});var n=a.r(97122);Object.defineProperty(c,"LoginTicket",{enumerable:!0,get:function(){return n.LoginTicket}});var o=a.r(53904);Object.defineProperty(c,"UserRefreshClient",{enumerable:!0,get:function(){return o.UserRefreshClient}});var p=a.r(79949);Object.defineProperty(c,"AwsClient",{enumerable:!0,get:function(){return p.AwsClient}});var q=a.r(62889);Object.defineProperty(c,"AwsRequestSigner",{enumerable:!0,get:function(){return q.AwsRequestSigner}});var r=a.r(22330);Object.defineProperty(c,"IdentityPoolClient",{enumerable:!0,get:function(){return r.IdentityPoolClient}});var s=a.r(44686);Object.defineProperty(c,"ExternalAccountClient",{enumerable:!0,get:function(){return s.ExternalAccountClient}});var t=a.r(74579);Object.defineProperty(c,"BaseExternalAccountClient",{enumerable:!0,get:function(){return t.BaseExternalAccountClient}});var u=a.r(23699);Object.defineProperty(c,"DownscopedClient",{enumerable:!0,get:function(){return u.DownscopedClient}});var v=a.r(1064);Object.defineProperty(c,"PluggableAuthClient",{enumerable:!0,get:function(){return v.PluggableAuthClient}}),Object.defineProperty(c,"ExecutableError",{enumerable:!0,get:function(){return v.ExecutableError}});var w=a.r(52421);Object.defineProperty(c,"PassThroughClient",{enumerable:!0,get:function(){return w.PassThroughClient}});var x=a.r(85617);Object.defineProperty(c,"DefaultTransporter",{enumerable:!0,get:function(){return x.DefaultTransporter}}),c.auth=new d.GoogleAuth},77379,(a,b,c)=>{"use strict";let d=["nodebuffer","arraybuffer","fragments"],e="undefined"!=typeof Blob;e&&d.push("blob"),b.exports={BINARY_TYPES:d,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:e,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},65167,(a,b,c)=>{"use strict";let{EMPTY_BUFFER:d}=a.r(77379),e=Buffer[Symbol.species];function f(a,b,c,d,e){for(let f=0;f<e;f++)c[d+f]=a[f]^b[3&f]}function g(a,b){for(let c=0;c<a.length;c++)a[c]^=b[3&c]}function h(a){let b;return(h.readOnly=!0,Buffer.isBuffer(a))?a:(a instanceof ArrayBuffer?b=new e(a):ArrayBuffer.isView(a)?b=new e(a.buffer,a.byteOffset,a.byteLength):(b=Buffer.from(a),h.readOnly=!1),b)}if(b.exports={concat:function(a,b){if(0===a.length)return d;if(1===a.length)return a[0];let c=Buffer.allocUnsafe(b),f=0;for(let b=0;b<a.length;b++){let d=a[b];c.set(d,f),f+=d.length}return f<b?new e(c.buffer,c.byteOffset,f):c},mask:f,toArrayBuffer:function(a){return a.length===a.buffer.byteLength?a.buffer:a.buffer.slice(a.byteOffset,a.byteOffset+a.length)},toBuffer:h,unmask:g},!process.env.WS_NO_BUFFER_UTIL)try{let a=(()=>{let a=Error("Cannot find module 'bufferutil'");throw a.code="MODULE_NOT_FOUND",a})();b.exports.mask=function(b,c,d,e,g){g<48?f(b,c,d,e,g):a.mask(b,c,d,e,g)},b.exports.unmask=function(b,c){b.length<32?g(b,c):a.unmask(b,c)}}catch(a){}},95973,(a,b,c)=>{"use strict";let d=Symbol("kDone"),e=Symbol("kRun");b.exports=class{constructor(a){this[d]=()=>{this.pending--,this[e]()},this.concurrency=a||1/0,this.jobs=[],this.pending=0}add(a){this.jobs.push(a),this[e]()}[e](){if(this.pending!==this.concurrency&&this.jobs.length){let a=this.jobs.shift();this.pending++,a(this[d])}}}},24191,(a,b,c)=>{"use strict";let d,e=a.r(6461),f=a.r(65167),g=a.r(95973),{kStatusCode:h}=a.r(77379),i=Buffer[Symbol.species],j=Buffer.from([0,0,255,255]),k=Symbol("permessage-deflate"),l=Symbol("total-length"),m=Symbol("callback"),n=Symbol("buffers"),o=Symbol("error");function p(a){this[n].push(a),this[l]+=a.length}function q(a){if(this[l]+=a.length,this[k]._maxPayload<1||this[l]<=this[k]._maxPayload)return void this[n].push(a);this[o]=RangeError("Max payload size exceeded"),this[o].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[o][h]=1009,this.removeListener("data",q),this.reset()}function r(a){if(this[k]._inflate=null,this[o])return void this[m](this[o]);a[h]=1007,this[m](a)}b.exports=class{constructor(a,b,c){this._maxPayload=0|c,this._options=a||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!b,this._deflate=null,this._inflate=null,this.params=null,d||(d=new g(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let a={};return this._options.serverNoContextTakeover&&(a.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(a.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(a.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?a.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(a.client_max_window_bits=!0),a}accept(a){return a=this.normalizeParams(a),this.params=this._isServer?this.acceptAsServer(a):this.acceptAsClient(a),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let a=this._deflate[m];this._deflate.close(),this._deflate=null,a&&a(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(a){let b=this._options,c=a.find(a=>(!1!==b.serverNoContextTakeover||!a.server_no_context_takeover)&&(!a.server_max_window_bits||!1!==b.serverMaxWindowBits&&("number"!=typeof b.serverMaxWindowBits||!(b.serverMaxWindowBits>a.server_max_window_bits)))&&("number"!=typeof b.clientMaxWindowBits||!!a.client_max_window_bits));if(!c)throw Error("None of the extension offers can be accepted");return b.serverNoContextTakeover&&(c.server_no_context_takeover=!0),b.clientNoContextTakeover&&(c.client_no_context_takeover=!0),"number"==typeof b.serverMaxWindowBits&&(c.server_max_window_bits=b.serverMaxWindowBits),"number"==typeof b.clientMaxWindowBits?c.client_max_window_bits=b.clientMaxWindowBits:(!0===c.client_max_window_bits||!1===b.clientMaxWindowBits)&&delete c.client_max_window_bits,c}acceptAsClient(a){let b=a[0];if(!1===this._options.clientNoContextTakeover&&b.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(b.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&b.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(b.client_max_window_bits=this._options.clientMaxWindowBits);return b}normalizeParams(a){return a.forEach(a=>{Object.keys(a).forEach(b=>{let c=a[b];if(c.length>1)throw Error(`Parameter "${b}" must have only a single value`);if(c=c[0],"client_max_window_bits"===b){if(!0!==c){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else if("server_max_window_bits"===b){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if("client_no_context_takeover"===b||"server_no_context_takeover"===b){if(!0!==c)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else throw Error(`Unknown parameter "${b}"`);a[b]=c})}),a}decompress(a,b,c){d.add(d=>{this._decompress(a,b,(a,b)=>{d(),c(a,b)})})}compress(a,b,c){d.add(d=>{this._compress(a,b,(a,b)=>{d(),c(a,b)})})}_decompress(a,b,c){let d=this._isServer?"client":"server";if(!this._inflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._inflate=e.createInflateRaw({...this._options.zlibInflateOptions,windowBits:b}),this._inflate[k]=this,this._inflate[l]=0,this._inflate[n]=[],this._inflate.on("error",r),this._inflate.on("data",q)}this._inflate[m]=c,this._inflate.write(a),b&&this._inflate.write(j),this._inflate.flush(()=>{let a=this._inflate[o];if(a){this._inflate.close(),this._inflate=null,c(a);return}let e=f.concat(this._inflate[n],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[n]=[],b&&this.params[`${d}_no_context_takeover`]&&this._inflate.reset()),c(null,e)})}_compress(a,b,c){let d=this._isServer?"server":"client";if(!this._deflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._deflate=e.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:b}),this._deflate[l]=0,this._deflate[n]=[],this._deflate.on("data",p)}this._deflate[m]=c,this._deflate.write(a),this._deflate.flush(e.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let a=f.concat(this._deflate[n],this._deflate[l]);b&&(a=new i(a.buffer,a.byteOffset,a.length-4)),this._deflate[m]=null,this._deflate[l]=0,this._deflate[n]=[],b&&this.params[`${d}_no_context_takeover`]&&this._deflate.reset(),c(null,a)})}}},50308,(a,b,c)=>{"use strict";let{isUtf8:d}=a.r(874),{hasBlob:e}=a.r(77379);function f(a){let b=a.length,c=0;for(;c<b;)if((128&a[c])==0)c++;else if((224&a[c])==192){if(c+1===b||(192&a[c+1])!=128||(254&a[c])==192)return!1;c+=2}else if((240&a[c])==224){if(c+2>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||224===a[c]&&(224&a[c+1])==128||237===a[c]&&(224&a[c+1])==160)return!1;c+=3}else{if((248&a[c])!=240||c+3>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||(192&a[c+3])!=128||240===a[c]&&(240&a[c+1])==128||244===a[c]&&a[c+1]>143||a[c]>244)return!1;c+=4}return!0}if(b.exports={isBlob:function(a){return e&&"object"==typeof a&&"function"==typeof a.arrayBuffer&&"string"==typeof a.type&&"function"==typeof a.stream&&("Blob"===a[Symbol.toStringTag]||"File"===a[Symbol.toStringTag])},isValidStatusCode:function(a){return a>=1e3&&a<=1014&&1004!==a&&1005!==a&&1006!==a||a>=3e3&&a<=4999},isValidUTF8:f,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},d)b.exports.isValidUTF8=function(a){return a.length<24?f(a):d(a)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let a=(()=>{let a=Error("Cannot find module 'utf-8-validate'");throw a.code="MODULE_NOT_FOUND",a})();b.exports.isValidUTF8=function(b){return b.length<32?f(b):a(b)}}catch(a){}},23852,(a,b,c)=>{"use strict";let{Writable:d}=a.r(88947),e=a.r(24191),{BINARY_TYPES:f,EMPTY_BUFFER:g,kStatusCode:h,kWebSocket:i}=a.r(77379),{concat:j,toArrayBuffer:k,unmask:l}=a.r(65167),{isValidStatusCode:m,isValidUTF8:n}=a.r(50308),o=Buffer[Symbol.species];b.exports=class extends d{constructor(a={}){super(),this._allowSynchronousEvents=void 0===a.allowSynchronousEvents||a.allowSynchronousEvents,this._binaryType=a.binaryType||f[0],this._extensions=a.extensions||{},this._isServer=!!a.isServer,this._maxPayload=0|a.maxPayload,this._skipUTF8Validation=!!a.skipUTF8Validation,this[i]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(a,b,c){if(8===this._opcode&&0==this._state)return c();this._bufferedBytes+=a.length,this._buffers.push(a),this.startLoop(c)}consume(a){if(this._bufferedBytes-=a,a===this._buffers[0].length)return this._buffers.shift();if(a<this._buffers[0].length){let b=this._buffers[0];return this._buffers[0]=new o(b.buffer,b.byteOffset+a,b.length-a),new o(b.buffer,b.byteOffset,a)}let b=Buffer.allocUnsafe(a);do{let c=this._buffers[0],d=b.length-a;a>=c.length?b.set(this._buffers.shift(),d):(b.set(new Uint8Array(c.buffer,c.byteOffset,a),d),this._buffers[0]=new o(c.buffer,c.byteOffset+a,c.length-a)),a-=c.length}while(a>0)return b}startLoop(a){this._loop=!0;do switch(this._state){case 0:this.getInfo(a);break;case 1:this.getPayloadLength16(a);break;case 2:this.getPayloadLength64(a);break;case 3:this.getMask();break;case 4:this.getData(a);break;case 5:case 6:this._loop=!1;return}while(this._loop)this._errored||a()}getInfo(a){if(this._bufferedBytes<2){this._loop=!1;return}let b=this.consume(2);if((48&b[0])!=0)return void a(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));let c=(64&b[0])==64;if(c&&!this._extensions[e.extensionName])return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._fin=(128&b[0])==128,this._opcode=15&b[0],this._payloadLength=127&b[1],0===this._opcode){if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(!this._fragmented)return void a(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));this._compressed=c}else{if(!(this._opcode>7)||!(this._opcode<11))return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));if(!this._fin)return void a(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return void a(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&b[1])==128,this._isServer){if(!this._masked)return void a(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}else if(this._masked)return void a(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(a)}getPayloadLength16(a){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(a)}getPayloadLength64(a){if(this._bufferedBytes<8){this._loop=!1;return}let b=this.consume(8),c=b.readUInt32BE(0);if(c>2097151)return void a(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH"));this._payloadLength=0x100000000*c+b.readUInt32BE(4),this.haveLength(a)}haveLength(a){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return void a(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(a){let b=g;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}b=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!=0&&l(b,this._mask)}if(this._opcode>7)return void this.controlMessage(b,a);if(this._compressed){this._state=5,this.decompress(b,a);return}b.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(b)),this.dataMessage(a)}decompress(a,b){this._extensions[e.extensionName].decompress(a,this._fin,(a,c)=>{if(a)return b(a);if(c.length){if(this._messageLength+=c.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return void b(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(c)}this.dataMessage(b),0===this._state&&this.startLoop(b)})}dataMessage(a){if(!this._fin){this._state=0;return}let b=this._messageLength,c=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let d;d="nodebuffer"===this._binaryType?j(c,b):"arraybuffer"===this._binaryType?k(j(c,b)):"blob"===this._binaryType?new Blob(c):c,this._allowSynchronousEvents?(this.emit("message",d,!0),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!0),this._state=0,this.startLoop(a)}))}else{let d=j(c,b);if(!this._skipUTF8Validation&&!n(d))return void a(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));5===this._state||this._allowSynchronousEvents?(this.emit("message",d,!1),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!1),this._state=0,this.startLoop(a)}))}}controlMessage(a,b){if(8===this._opcode){if(0===a.length)this._loop=!1,this.emit("conclude",1005,g),this.end();else{let c=a.readUInt16BE(0);if(!m(c))return void b(this.createError(RangeError,`invalid status code ${c}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE"));let d=new o(a.buffer,a.byteOffset+2,a.length-2);if(!this._skipUTF8Validation&&!n(d))return void b(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));this._loop=!1,this.emit("conclude",c,d),this.end()}this._state=0;return}this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",a),this._state=0):(this._state=6,setImmediate(()=>{this.emit(9===this._opcode?"ping":"pong",a),this._state=0,this.startLoop(b)}))}createError(a,b,c,d,e){this._loop=!1,this._errored=!0;let f=new a(c?`Invalid WebSocket frame: ${b}`:b);return Error.captureStackTrace(f,this.createError),f.code=e,f[h]=d,f}}},14260,(a,b,c)=>{"use strict";let d,{Duplex:e}=a.r(88947),{randomFillSync:f}=a.r(54799),g=a.r(24191),{EMPTY_BUFFER:h,kWebSocket:i,NOOP:j}=a.r(77379),{isBlob:k,isValidStatusCode:l}=a.r(50308),{mask:m,toBuffer:n}=a.r(65167),o=Symbol("kByteLength"),p=Buffer.alloc(4),q=8192;class r{constructor(a,b,c){this._extensions=b||{},c&&(this._generateMask=c,this._maskBuffer=Buffer.alloc(4)),this._socket=a,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=j,this[i]=void 0}static frame(a,b){let c,e,g=!1,h=2,i=!1;b.mask&&(c=b.maskBuffer||p,b.generateMask?b.generateMask(c):(8192===q&&(void 0===d&&(d=Buffer.alloc(8192)),f(d,0,8192),q=0),c[0]=d[q++],c[1]=d[q++],c[2]=d[q++],c[3]=d[q++]),i=(c[0]|c[1]|c[2]|c[3])==0,h=6),"string"==typeof a?e=(!b.mask||i)&&void 0!==b[o]?b[o]:(a=Buffer.from(a)).length:(e=a.length,g=b.mask&&b.readOnly&&!i);let j=e;e>=65536?(h+=8,j=127):e>125&&(h+=2,j=126);let k=Buffer.allocUnsafe(g?e+h:h);return(k[0]=b.fin?128|b.opcode:b.opcode,b.rsv1&&(k[0]|=64),k[1]=j,126===j?k.writeUInt16BE(e,2):127===j&&(k[2]=k[3]=0,k.writeUIntBE(e,4,6)),b.mask)?(k[1]|=128,k[h-4]=c[0],k[h-3]=c[1],k[h-2]=c[2],k[h-1]=c[3],i)?[k,a]:g?(m(a,c,k,h,e),[k]):(m(a,c,a,0,e),[k,a]):[k,a]}close(a,b,c,d){let e;if(void 0===a)e=h;else if("number"==typeof a&&l(a))if(void 0!==b&&b.length){let c=Buffer.byteLength(b);if(c>123)throw RangeError("The message must not be greater than 123 bytes");(e=Buffer.allocUnsafe(2+c)).writeUInt16BE(a,0),"string"==typeof b?e.write(b,2):e.set(b,2)}else(e=Buffer.allocUnsafe(2)).writeUInt16BE(a,0);else throw TypeError("First argument must be a valid error code number");let f={[o]:e.length,fin:!0,generateMask:this._generateMask,mask:c,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,e,!1,f,d]):this.sendFrame(r.frame(e,f),d)}ping(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[o]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:9,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(r.frame(a,f),c)}pong(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[o]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:10,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(r.frame(a,f),c)}send(a,b,c){let d,e,f=this._extensions[g.extensionName],h=b.binary?2:1,i=b.compress;"string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),this._firstFragment?(this._firstFragment=!1,i&&f&&f.params[f._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(i=d>=f._threshold),this._compress=i):(i=!1,h=0),b.fin&&(this._firstFragment=!0);let j={[o]:d,fin:b.fin,generateMask:this._generateMask,mask:b.mask,maskBuffer:this._maskBuffer,opcode:h,readOnly:e,rsv1:i};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,this._compress,j,c]):this.getBlobData(a,this._compress,j,c):0!==this._state?this.enqueue([this.dispatch,a,this._compress,j,c]):this.dispatch(a,this._compress,j,c)}getBlobData(a,b,c,d){this._bufferedBytes+=c[o],this._state=2,a.arrayBuffer().then(a=>{if(this._socket.destroyed){let a=Error("The socket was closed while the blob was being read");process.nextTick(s,this,a,d);return}this._bufferedBytes-=c[o];let e=n(a);b?this.dispatch(e,b,c,d):(this._state=0,this.sendFrame(r.frame(e,c),d),this.dequeue())}).catch(a=>{process.nextTick(t,this,a,d)})}dispatch(a,b,c,d){if(!b)return void this.sendFrame(r.frame(a,c),d);let e=this._extensions[g.extensionName];this._bufferedBytes+=c[o],this._state=1,e.compress(a,c.fin,(a,b)=>{if(this._socket.destroyed)return void s(this,Error("The socket was closed while data was being compressed"),d);this._bufferedBytes-=c[o],this._state=0,c.readOnly=!1,this.sendFrame(r.frame(b,c),d),this.dequeue()})}dequeue(){for(;0===this._state&&this._queue.length;){let a=this._queue.shift();this._bufferedBytes-=a[3][o],Reflect.apply(a[0],this,a.slice(1))}}enqueue(a){this._bufferedBytes+=a[3][o],this._queue.push(a)}sendFrame(a,b){2===a.length?(this._socket.cork(),this._socket.write(a[0]),this._socket.write(a[1],b),this._socket.uncork()):this._socket.write(a[0],b)}}function s(a,b,c){"function"==typeof c&&c(b);for(let c=0;c<a._queue.length;c++){let d=a._queue[c],e=d[d.length-1];"function"==typeof e&&e(b)}}function t(a,b,c){s(a,b,c),a.onerror(b)}b.exports=r},53447,(a,b,c)=>{"use strict";let{kForOnEventAttribute:d,kListener:e}=a.r(77379),f=Symbol("kCode"),g=Symbol("kData"),h=Symbol("kError"),i=Symbol("kMessage"),j=Symbol("kReason"),k=Symbol("kTarget"),l=Symbol("kType"),m=Symbol("kWasClean");class n{constructor(a){this[k]=null,this[l]=a}get target(){return this[k]}get type(){return this[l]}}Object.defineProperty(n.prototype,"target",{enumerable:!0}),Object.defineProperty(n.prototype,"type",{enumerable:!0});class o extends n{constructor(a,b={}){super(a),this[f]=void 0===b.code?0:b.code,this[j]=void 0===b.reason?"":b.reason,this[m]=void 0!==b.wasClean&&b.wasClean}get code(){return this[f]}get reason(){return this[j]}get wasClean(){return this[m]}}Object.defineProperty(o.prototype,"code",{enumerable:!0}),Object.defineProperty(o.prototype,"reason",{enumerable:!0}),Object.defineProperty(o.prototype,"wasClean",{enumerable:!0});class p extends n{constructor(a,b={}){super(a),this[h]=void 0===b.error?null:b.error,this[i]=void 0===b.message?"":b.message}get error(){return this[h]}get message(){return this[i]}}Object.defineProperty(p.prototype,"error",{enumerable:!0}),Object.defineProperty(p.prototype,"message",{enumerable:!0});class q extends n{constructor(a,b={}){super(a),this[g]=void 0===b.data?null:b.data}get data(){return this[g]}}function r(a,b,c){"object"==typeof a&&a.handleEvent?a.handleEvent.call(a,c):a.call(b,c)}Object.defineProperty(q.prototype,"data",{enumerable:!0}),b.exports={CloseEvent:o,ErrorEvent:p,Event:n,EventTarget:{addEventListener(a,b,c={}){let f;for(let f of this.listeners(a))if(!c[d]&&f[e]===b&&!f[d])return;if("message"===a)f=function(a,c){let d=new q("message",{data:c?a:a.toString()});d[k]=this,r(b,this,d)};else if("close"===a)f=function(a,c){let d=new o("close",{code:a,reason:c.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});d[k]=this,r(b,this,d)};else if("error"===a)f=function(a){let c=new p("error",{error:a,message:a.message});c[k]=this,r(b,this,c)};else{if("open"!==a)return;f=function(){let a=new n("open");a[k]=this,r(b,this,a)}}f[d]=!!c[d],f[e]=b,c.once?this.once(a,f):this.on(a,f)},removeEventListener(a,b){for(let c of this.listeners(a))if(c[e]===b&&!c[d]){this.removeListener(a,c);break}}},MessageEvent:q}},82731,(a,b,c)=>{"use strict";let{tokenChars:d}=a.r(50308);function e(a,b,c){void 0===a[b]?a[b]=[c]:a[b].push(c)}b.exports={format:function(a){return Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>[b].concat(Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>!0===a?b:`${b}=${a}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(a){let b,c,f=Object.create(null),g=Object.create(null),h=!1,i=!1,j=!1,k=-1,l=-1,m=-1,n=0;for(;n<a.length;n++)if(l=a.charCodeAt(n),void 0===b)if(-1===m&&1===d[l])-1===k&&(k=n);else if(0!==n&&(32===l||9===l))-1===m&&-1!==k&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n);let c=a.slice(k,m);44===l?(e(f,c,g),g=Object.create(null)):b=c,k=m=-1}else throw SyntaxError(`Unexpected character at index ${n}`);else if(void 0===c)if(-1===m&&1===d[l])-1===k&&(k=n);else if(32===l||9===l)-1===m&&-1!==k&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n),e(g,a.slice(k,m),!0),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),k=m=-1}else if(61===l&&-1!==k&&-1===m)c=a.slice(k,n),k=m=-1;else throw SyntaxError(`Unexpected character at index ${n}`);else if(i){if(1!==d[l])throw SyntaxError(`Unexpected character at index ${n}`);-1===k?k=n:h||(h=!0),i=!1}else if(j)if(1===d[l])-1===k&&(k=n);else if(34===l&&-1!==k)j=!1,m=n;else if(92===l)i=!0;else throw SyntaxError(`Unexpected character at index ${n}`);else if(34===l&&61===a.charCodeAt(n-1))j=!0;else if(-1===m&&1===d[l])-1===k&&(k=n);else if(-1!==k&&(32===l||9===l))-1===m&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n);let d=a.slice(k,m);h&&(d=d.replace(/\\/g,""),h=!1),e(g,c,d),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),c=void 0,k=m=-1}else throw SyntaxError(`Unexpected character at index ${n}`);if(-1===k||j||32===l||9===l)throw SyntaxError("Unexpected end of input");-1===m&&(m=n);let o=a.slice(k,m);return void 0===b?e(f,o,g):(void 0===c?e(g,o,!0):h?e(g,c,o.replace(/\\/g,"")):e(g,c,o),e(f,b,g)),f}}},79126,(a,b,c)=>{"use strict";let d=a.r(27699),e=a.r(24836),f=a.r(21517),g=a.r(4446),h=a.r(55004),{randomBytes:i,createHash:j}=a.r(54799),{Duplex:k,Readable:l}=a.r(88947),{URL:m}=a.r(92509),n=a.r(24191),o=a.r(23852),p=a.r(14260),{isBlob:q}=a.r(50308),{BINARY_TYPES:r,EMPTY_BUFFER:s,GUID:t,kForOnEventAttribute:u,kListener:v,kStatusCode:w,kWebSocket:x,NOOP:y}=a.r(77379),{EventTarget:{addEventListener:z,removeEventListener:A}}=a.r(53447),{format:B,parse:C}=a.r(82731),{toBuffer:D}=a.r(65167),E=Symbol("kAborted"),F=[8,13],G=["CONNECTING","OPEN","CLOSING","CLOSED"],H=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class I extends d{constructor(a,b,c){super(),this._binaryType=r[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=s,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=I.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==a?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===b?b=[]:Array.isArray(b)||("object"==typeof b&&null!==b?(c=b,b=[]):b=[b]),function a(b,c,d,g){let h,k,l,o,p={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:F[1],maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...g,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(b._autoPong=p.autoPong,!F.includes(p.protocolVersion))throw RangeError(`Unsupported protocol version: ${p.protocolVersion} (supported versions: ${F.join(", ")})`);if(c instanceof m)h=c;else try{h=new m(c)}catch(a){throw SyntaxError(`Invalid URL: ${c}`)}"http:"===h.protocol?h.protocol="ws:":"https:"===h.protocol&&(h.protocol="wss:"),b._url=h.href;let q="wss:"===h.protocol,r="ws+unix:"===h.protocol;if("ws:"===h.protocol||q||r?r&&!h.pathname?k="The URL's pathname is empty":h.hash&&(k="The URL contains a fragment identifier"):k='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"',k){let a=SyntaxError(k);if(0!==b._redirects)return void J(b,a);throw a}let s=q?443:80,u=i(16).toString("base64"),v=q?e.request:f.request,w=new Set;if(p.createConnection=p.createConnection||(q?L:K),p.defaultPort=p.defaultPort||s,p.port=h.port||s,p.host=h.hostname.startsWith("[")?h.hostname.slice(1,-1):h.hostname,p.headers={...p.headers,"Sec-WebSocket-Version":p.protocolVersion,"Sec-WebSocket-Key":u,Connection:"Upgrade",Upgrade:"websocket"},p.path=h.pathname+h.search,p.timeout=p.handshakeTimeout,p.perMessageDeflate&&(l=new n(!0!==p.perMessageDeflate?p.perMessageDeflate:{},!1,p.maxPayload),p.headers["Sec-WebSocket-Extensions"]=B({[n.extensionName]:l.offer()})),d.length){for(let a of d){if("string"!=typeof a||!H.test(a)||w.has(a))throw SyntaxError("An invalid or duplicated subprotocol was specified");w.add(a)}p.headers["Sec-WebSocket-Protocol"]=d.join(",")}if(p.origin&&(p.protocolVersion<13?p.headers["Sec-WebSocket-Origin"]=p.origin:p.headers.Origin=p.origin),(h.username||h.password)&&(p.auth=`${h.username}:${h.password}`),r){let a=p.path.split(":");p.socketPath=a[0],p.path=a[1]}if(p.followRedirects){if(0===b._redirects){b._originalIpc=r,b._originalSecure=q,b._originalHostOrSocketPath=r?p.socketPath:h.host;let a=g&&g.headers;if(g={...g,headers:{}},a)for(let[b,c]of Object.entries(a))g.headers[b.toLowerCase()]=c}else if(0===b.listenerCount("redirect")){let a=r?!!b._originalIpc&&p.socketPath===b._originalHostOrSocketPath:!b._originalIpc&&h.host===b._originalHostOrSocketPath;a&&(!b._originalSecure||q)||(delete p.headers.authorization,delete p.headers.cookie,a||delete p.headers.host,p.auth=void 0)}p.auth&&!g.headers.authorization&&(g.headers.authorization="Basic "+Buffer.from(p.auth).toString("base64")),o=b._req=v(p),b._redirects&&b.emit("redirect",b.url,o)}else o=b._req=v(p);p.timeout&&o.on("timeout",()=>{M(b,o,"Opening handshake has timed out")}),o.on("error",a=>{null===o||o[E]||(o=b._req=null,J(b,a))}),o.on("response",e=>{let f=e.headers.location,h=e.statusCode;if(f&&p.followRedirects&&h>=300&&h<400){let e;if(++b._redirects>p.maxRedirects)return void M(b,o,"Maximum redirects exceeded");o.abort();try{e=new m(f,c)}catch(a){J(b,SyntaxError(`Invalid URL: ${f}`));return}a(b,e,d,g)}else b.emit("unexpected-response",o,e)||M(b,o,`Unexpected server response: ${e.statusCode}`)}),o.on("upgrade",(a,c,d)=>{let e;if(b.emit("upgrade",a),b.readyState!==I.CONNECTING)return;o=b._req=null;let f=a.headers.upgrade;if(void 0===f||"websocket"!==f.toLowerCase())return void M(b,c,"Invalid Upgrade header");let g=j("sha1").update(u+t).digest("base64");if(a.headers["sec-websocket-accept"]!==g)return void M(b,c,"Invalid Sec-WebSocket-Accept header");let h=a.headers["sec-websocket-protocol"];if(void 0!==h?w.size?w.has(h)||(e="Server sent an invalid subprotocol"):e="Server sent a subprotocol but none was requested":w.size&&(e="Server sent no subprotocol"),e)return void M(b,c,e);h&&(b._protocol=h);let i=a.headers["sec-websocket-extensions"];if(void 0!==i){let a;if(!l)return void M(b,c,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");try{a=C(i)}catch(a){M(b,c,"Invalid Sec-WebSocket-Extensions header");return}let d=Object.keys(a);if(1!==d.length||d[0]!==n.extensionName)return void M(b,c,"Server indicated an extension that was not requested");try{l.accept(a[n.extensionName])}catch(a){M(b,c,"Invalid Sec-WebSocket-Extensions header");return}b._extensions[n.extensionName]=l}b.setSocket(c,d,{allowSynchronousEvents:p.allowSynchronousEvents,generateMask:p.generateMask,maxPayload:p.maxPayload,skipUTF8Validation:p.skipUTF8Validation})}),p.finishRequest?p.finishRequest(o,b):o.end()}(this,a,b,c)):(this._autoPong=c.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(a){r.includes(a)&&(this._binaryType=a,this._receiver&&(this._receiver._binaryType=a))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(a,b,c){let d=new o({allowSynchronousEvents:c.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:c.maxPayload,skipUTF8Validation:c.skipUTF8Validation}),e=new p(a,this._extensions,c.generateMask);this._receiver=d,this._sender=e,this._socket=a,d[x]=this,e[x]=this,a[x]=this,d.on("conclude",O),d.on("drain",P),d.on("error",Q),d.on("message",S),d.on("ping",T),d.on("pong",U),e.onerror=W,a.setTimeout&&a.setTimeout(0),a.setNoDelay&&a.setNoDelay(),b.length>0&&a.unshift(b),a.on("close",Y),a.on("data",Z),a.on("end",$),a.on("error",_),this._readyState=I.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=I.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[n.extensionName]&&this._extensions[n.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=I.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(a,b){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING)return void M(this,this._req,"WebSocket was closed before the connection was established");if(this.readyState===I.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=I.CLOSING,this._sender.close(a,b,!this._isServer,a=>{!a&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),X(this)}}pause(){this.readyState!==I.CONNECTING&&this.readyState!==I.CLOSED&&(this._paused=!0,this._socket.pause())}ping(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)return void N(this,a,c);void 0===b&&(b=!this._isServer),this._sender.ping(a||s,b,c)}pong(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)return void N(this,a,c);void 0===b&&(b=!this._isServer),this._sender.pong(a||s,b,c)}resume(){this.readyState!==I.CONNECTING&&this.readyState!==I.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof b&&(c=b,b={}),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)return void N(this,a,c);let d={binary:"string"!=typeof a,mask:!this._isServer,compress:!0,fin:!0,...b};this._extensions[n.extensionName]||(d.compress=!1),this._sender.send(a||s,d,c)}terminate(){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING)return void M(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=I.CLOSING,this._socket.destroy())}}}function J(a,b){a._readyState=I.CLOSING,a._errorEmitted=!0,a.emit("error",b),a.emitClose()}function K(a){return a.path=a.socketPath,g.connect(a)}function L(a){return a.path=void 0,a.servername||""===a.servername||(a.servername=g.isIP(a.host)?"":a.host),h.connect(a)}function M(a,b,c){a._readyState=I.CLOSING;let d=Error(c);Error.captureStackTrace(d,M),b.setHeader?(b[E]=!0,b.abort(),b.socket&&!b.socket.destroyed&&b.socket.destroy(),process.nextTick(J,a,d)):(b.destroy(d),b.once("error",a.emit.bind(a,"error")),b.once("close",a.emitClose.bind(a)))}function N(a,b,c){if(b){let c=q(b)?b.size:D(b).length;a._socket?a._sender._bufferedBytes+=c:a._bufferedAmount+=c}if(c){let b=Error(`WebSocket is not open: readyState ${a.readyState} (${G[a.readyState]})`);process.nextTick(c,b)}}function O(a,b){let c=this[x];c._closeFrameReceived=!0,c._closeMessage=b,c._closeCode=a,void 0!==c._socket[x]&&(c._socket.removeListener("data",Z),process.nextTick(V,c._socket),1005===a?c.close():c.close(a,b))}function P(){let a=this[x];a.isPaused||a._socket.resume()}function Q(a){let b=this[x];void 0!==b._socket[x]&&(b._socket.removeListener("data",Z),process.nextTick(V,b._socket),b.close(a[w])),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a))}function R(){this[x].emitClose()}function S(a,b){this[x].emit("message",a,b)}function T(a){let b=this[x];b._autoPong&&b.pong(a,!this._isServer,y),b.emit("ping",a)}function U(a){this[x].emit("pong",a)}function V(a){a.resume()}function W(a){let b=this[x];b.readyState!==I.CLOSED&&(b.readyState===I.OPEN&&(b._readyState=I.CLOSING,X(b)),this._socket.end(),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a)))}function X(a){a._closeTimer=setTimeout(a._socket.destroy.bind(a._socket),3e4)}function Y(){let a,b=this[x];this.removeListener("close",Y),this.removeListener("data",Z),this.removeListener("end",$),b._readyState=I.CLOSING,this._readableState.endEmitted||b._closeFrameReceived||b._receiver._writableState.errorEmitted||null===(a=b._socket.read())||b._receiver.write(a),b._receiver.end(),this[x]=void 0,clearTimeout(b._closeTimer),b._receiver._writableState.finished||b._receiver._writableState.errorEmitted?b.emitClose():(b._receiver.on("error",R),b._receiver.on("finish",R))}function Z(a){this[x]._receiver.write(a)||this.pause()}function $(){let a=this[x];a._readyState=I.CLOSING,a._receiver.end(),this.end()}function _(){let a=this[x];this.removeListener("error",_),this.on("error",y),a&&(a._readyState=I.CLOSING,this.destroy())}Object.defineProperty(I,"CONNECTING",{enumerable:!0,value:G.indexOf("CONNECTING")}),Object.defineProperty(I.prototype,"CONNECTING",{enumerable:!0,value:G.indexOf("CONNECTING")}),Object.defineProperty(I,"OPEN",{enumerable:!0,value:G.indexOf("OPEN")}),Object.defineProperty(I.prototype,"OPEN",{enumerable:!0,value:G.indexOf("OPEN")}),Object.defineProperty(I,"CLOSING",{enumerable:!0,value:G.indexOf("CLOSING")}),Object.defineProperty(I.prototype,"CLOSING",{enumerable:!0,value:G.indexOf("CLOSING")}),Object.defineProperty(I,"CLOSED",{enumerable:!0,value:G.indexOf("CLOSED")}),Object.defineProperty(I.prototype,"CLOSED",{enumerable:!0,value:G.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(a=>{Object.defineProperty(I.prototype,a,{enumerable:!0})}),["open","error","close","message"].forEach(a=>{Object.defineProperty(I.prototype,`on${a}`,{enumerable:!0,get(){for(let b of this.listeners(a))if(b[u])return b[v];return null},set(b){for(let b of this.listeners(a))if(b[u]){this.removeListener(a,b);break}"function"==typeof b&&this.addEventListener(a,b,{[u]:!0})}})}),I.prototype.addEventListener=z,I.prototype.removeEventListener=A,b.exports=I},16816,(a,b,c)=>{"use strict";a.r(79126);let{Duplex:d}=a.r(88947);function e(a){a.emit("close")}function f(){!this.destroyed&&this._writableState.finished&&this.destroy()}function g(a){this.removeListener("error",g),this.destroy(),0===this.listenerCount("error")&&this.emit("error",a)}b.exports=function(a,b){let c=!0,h=new d({...b,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return a.on("message",function(b,c){let d=!c&&h._readableState.objectMode?b.toString():b;h.push(d)||a.pause()}),a.once("error",function(a){h.destroyed||(c=!1,h.destroy(a))}),a.once("close",function(){h.destroyed||h.push(null)}),h._destroy=function(b,d){if(a.readyState===a.CLOSED){d(b),process.nextTick(e,h);return}let f=!1;a.once("error",function(a){f=!0,d(a)}),a.once("close",function(){f||d(b),process.nextTick(e,h)}),c&&a.terminate()},h._final=function(b){if(a.readyState===a.CONNECTING)return void a.once("open",function(){h._final(b)});null!==a._socket&&(a._socket._writableState.finished?(b(),h._readableState.endEmitted&&h.destroy()):(a._socket.once("finish",function(){b()}),a.close()))},h._read=function(){a.isPaused&&a.resume()},h._write=function(b,c,d){if(a.readyState===a.CONNECTING)return void a.once("open",function(){h._write(b,c,d)});a.send(b,d)},h.on("end",f),h.on("error",g),h}},35816,(a,b,c)=>{"use strict";let{tokenChars:d}=a.r(50308);b.exports={parse:function(a){let b=new Set,c=-1,e=-1,f=0;for(;f<a.length;f++){let g=a.charCodeAt(f);if(-1===e&&1===d[g])-1===c&&(c=f);else if(0!==f&&(32===g||9===g))-1===e&&-1!==c&&(e=f);else if(44===g){if(-1===c)throw SyntaxError(`Unexpected character at index ${f}`);-1===e&&(e=f);let d=a.slice(c,e);if(b.has(d))throw SyntaxError(`The "${d}" subprotocol is duplicated`);b.add(d),c=e=-1}else throw SyntaxError(`Unexpected character at index ${f}`)}if(-1===c||-1!==e)throw SyntaxError("Unexpected end of input");let g=a.slice(c,f);if(b.has(g))throw SyntaxError(`The "${g}" subprotocol is duplicated`);return b.add(g),b}}},72513,(a,b,c)=>{"use strict";let d=a.r(27699),e=a.r(21517),{Duplex:f}=a.r(88947),{createHash:g}=a.r(54799),h=a.r(82731),i=a.r(24191),j=a.r(35816),k=a.r(79126),{GUID:l,kWebSocket:m}=a.r(77379),n=/^[+/0-9A-Za-z]{22}==$/;function o(a){a._state=2,a.emit("close")}function p(){this.destroy()}function q(a,b,c,d){c=c||e.STATUS_CODES[b],d={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(c),...d},a.once("finish",a.destroy),a.end(`HTTP/1.1 ${b} ${e.STATUS_CODES[b]}\r
`+Object.keys(d).map(a=>`${a}: ${d[a]}`).join("\r\n")+"\r\n\r\n"+c)}function r(a,b,c,d,e,f){if(a.listenerCount("wsClientError")){let d=Error(e);Error.captureStackTrace(d,r),a.emit("wsClientError",d,c,b)}else q(c,d,e,f)}b.exports=class extends d{constructor(a,b){if(super(),null==(a={allowSynchronousEvents:!0,autoPong:!0,maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:k,...a}).port&&!a.server&&!a.noServer||null!=a.port&&(a.server||a.noServer)||a.server&&a.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=a.port?(this._server=e.createServer((a,b)=>{let c=e.STATUS_CODES[426];b.writeHead(426,{"Content-Length":c.length,"Content-Type":"text/plain"}),b.end(c)}),this._server.listen(a.port,a.host,a.backlog,b)):a.server&&(this._server=a.server),this._server){let a=this.emit.bind(this,"connection");this._removeListeners=function(a,b){for(let c of Object.keys(b))a.on(c,b[c]);return function(){for(let c of Object.keys(b))a.removeListener(c,b[c])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(b,c,d)=>{this.handleUpgrade(b,c,d,a)}})}!0===a.perMessageDeflate&&(a.perMessageDeflate={}),a.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=a,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(a){if(2===this._state){a&&this.once("close",()=>{a(Error("The server is not running"))}),process.nextTick(o,this);return}if(a&&this.once("close",a),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(o,this);else{let a=this._server;this._removeListeners(),this._removeListeners=this._server=null,a.close(()=>{o(this)})}}shouldHandle(a){if(this.options.path){let b=a.url.indexOf("?");if((-1!==b?a.url.slice(0,b):a.url)!==this.options.path)return!1}return!0}handleUpgrade(a,b,c,d){b.on("error",p);let e=a.headers["sec-websocket-key"],f=a.headers.upgrade,g=+a.headers["sec-websocket-version"];if("GET"!==a.method)return void r(this,a,b,405,"Invalid HTTP method");if(void 0===f||"websocket"!==f.toLowerCase())return void r(this,a,b,400,"Invalid Upgrade header");if(void 0===e||!n.test(e))return void r(this,a,b,400,"Missing or invalid Sec-WebSocket-Key header");if(13!==g&&8!==g)return void r(this,a,b,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});if(!this.shouldHandle(a))return void q(b,400);let k=a.headers["sec-websocket-protocol"],l=new Set;if(void 0!==k)try{l=j.parse(k)}catch(c){r(this,a,b,400,"Invalid Sec-WebSocket-Protocol header");return}let m=a.headers["sec-websocket-extensions"],o={};if(this.options.perMessageDeflate&&void 0!==m){let c=new i(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let a=h.parse(m);a[i.extensionName]&&(c.accept(a[i.extensionName]),o[i.extensionName]=c)}catch(c){r(this,a,b,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let f={origin:a.headers[`${8===g?"sec-websocket-origin":"origin"}`],secure:!!(a.socket.authorized||a.socket.encrypted),req:a};if(2===this.options.verifyClient.length)return void this.options.verifyClient(f,(f,g,h,i)=>{if(!f)return q(b,g||401,h,i);this.completeUpgrade(o,e,l,a,b,c,d)});if(!this.options.verifyClient(f))return q(b,401)}this.completeUpgrade(o,e,l,a,b,c,d)}completeUpgrade(a,b,c,d,e,f,j){if(!e.readable||!e.writable)return e.destroy();if(e[m])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return q(e,503);let k=g("sha1").update(b+l).digest("base64"),n=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${k}`],r=new this.options.WebSocket(null,void 0,this.options);if(c.size){let a=this.options.handleProtocols?this.options.handleProtocols(c,d):c.values().next().value;a&&(n.push(`Sec-WebSocket-Protocol: ${a}`),r._protocol=a)}if(a[i.extensionName]){let b=a[i.extensionName].params,c=h.format({[i.extensionName]:[b]});n.push(`Sec-WebSocket-Extensions: ${c}`),r._extensions=a}this.emit("headers",n,d),e.write(n.concat("\r\n").join("\r\n")),e.removeListener("error",p),r.setSocket(e,f,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(r),r.on("close",()=>{this.clients.delete(r),this._shouldEmitClose&&!this.clients.size&&process.nextTick(o,this)})),j(r,d)}}},37628,a=>{"use strict";let b,c;a.s(["GoogleGenAI",()=>cw],37628);var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$=a.i(77530),_=a.i(22734),aa=a.i(81111);a.i(16816),a.i(23852),a.i(14260);var ab=a.i(79126);a.i(72513),ab.default;var ac=a.i(24868);class ad{}function ae(a,b){return a.replace(/\{([^}]+)\}/g,(a,c)=>{if(Object.prototype.hasOwnProperty.call(b,c)){let a=b[c];return null!=a?String(a):""}throw Error(`Key '${c}' not found in valueMap.`)})}function af(a,b,c){for(let d=0;d<b.length-1;d++){let e=b[d];if(e.endsWith("[]")){let f=e.slice(0,-2);if(!(f in a))if(Array.isArray(c))a[f]=Array.from({length:c.length},()=>({}));else throw Error(`Value must be a list given an array path ${e}`);if(Array.isArray(a[f])){let e=a[f];if(Array.isArray(c))for(let a=0;a<e.length;a++)af(e[a],b.slice(d+1),c[a]);else for(let a of e)af(a,b.slice(d+1),c)}return}if(e.endsWith("[0]")){let f=e.slice(0,-3);f in a||(a[f]=[{}]),af(a[f][0],b.slice(d+1),c);return}a[e]&&"object"==typeof a[e]||(a[e]={}),a=a[e]}let d=b[b.length-1],e=a[d];if(void 0!==e){if(!c||"object"==typeof c&&0===Object.keys(c).length||c===e)return;if("object"==typeof e&&"object"==typeof c&&null!==e&&null!==c)Object.assign(e,c);else throw Error(`Cannot set value for an existing key. Key: ${d}`)}else"_self"!==d||"object"!=typeof c||null===c||Array.isArray(c)?a[d]=c:Object.assign(a,c)}function ag(a,b){try{if(1===b.length&&"_self"===b[0])return a;for(let c=0;c<b.length;c++){if("object"!=typeof a||null===a)return;let d=b[c];if(d.endsWith("[]")){let e=d.slice(0,-2);if(!(e in a))return;{let d=a[e];if(!Array.isArray(d))return;return d.map(a=>ag(a,b.slice(c+1)))}}a=a[d]}return a}catch(a){if(a instanceof TypeError)return;throw a}}function ah(a){if("string"!=typeof a)throw Error("fromImageBytes must be a string");return a}!function(a){a.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",a.OUTCOME_OK="OUTCOME_OK",a.OUTCOME_FAILED="OUTCOME_FAILED",a.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"}(d||(d={})),function(a){a.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",a.PYTHON="PYTHON"}(e||(e={})),function(a){a.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",a.STRING="STRING",a.NUMBER="NUMBER",a.INTEGER="INTEGER",a.BOOLEAN="BOOLEAN",a.ARRAY="ARRAY",a.OBJECT="OBJECT",a.NULL="NULL"}(f||(f={})),function(a){a.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",a.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",a.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",a.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",a.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",a.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",a.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",a.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",a.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",a.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"}(g||(g={})),function(a){a.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",a.SEVERITY="SEVERITY",a.PROBABILITY="PROBABILITY"}(h||(h={})),function(a){a.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",a.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",a.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",a.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",a.BLOCK_NONE="BLOCK_NONE",a.OFF="OFF"}(i||(i={})),function(a){a.MODE_UNSPECIFIED="MODE_UNSPECIFIED",a.MODE_DYNAMIC="MODE_DYNAMIC"}(j||(j={})),function(a){a.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",a.NO_AUTH="NO_AUTH",a.API_KEY_AUTH="API_KEY_AUTH",a.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",a.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",a.OAUTH="OAUTH",a.OIDC_AUTH="OIDC_AUTH"}(k||(k={})),function(a){a.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",a.SIMPLE_SEARCH="SIMPLE_SEARCH",a.ELASTIC_SEARCH="ELASTIC_SEARCH"}(l||(l={})),function(a){a.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",a.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",a.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",a.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",a.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"}(m||(m={})),function(a){a.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",a.STOP="STOP",a.MAX_TOKENS="MAX_TOKENS",a.SAFETY="SAFETY",a.RECITATION="RECITATION",a.LANGUAGE="LANGUAGE",a.OTHER="OTHER",a.BLOCKLIST="BLOCKLIST",a.PROHIBITED_CONTENT="PROHIBITED_CONTENT",a.SPII="SPII",a.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",a.IMAGE_SAFETY="IMAGE_SAFETY",a.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"}(n||(n={})),function(a){a.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",a.NEGLIGIBLE="NEGLIGIBLE",a.LOW="LOW",a.MEDIUM="MEDIUM",a.HIGH="HIGH"}(o||(o={})),function(a){a.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",a.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",a.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",a.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",a.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"}(p||(p={})),function(a){a.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",a.SAFETY="SAFETY",a.OTHER="OTHER",a.BLOCKLIST="BLOCKLIST",a.PROHIBITED_CONTENT="PROHIBITED_CONTENT",a.IMAGE_SAFETY="IMAGE_SAFETY"}(q||(q={})),function(a){a.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",a.ON_DEMAND="ON_DEMAND",a.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"}(r||(r={})),function(a){a.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",a.TEXT="TEXT",a.IMAGE="IMAGE",a.AUDIO="AUDIO"}(s||(s={})),function(a){a.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",a.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",a.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",a.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"}(t||(t={})),function(a){a.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",a.JOB_STATE_QUEUED="JOB_STATE_QUEUED",a.JOB_STATE_PENDING="JOB_STATE_PENDING",a.JOB_STATE_RUNNING="JOB_STATE_RUNNING",a.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",a.JOB_STATE_FAILED="JOB_STATE_FAILED",a.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",a.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",a.JOB_STATE_PAUSED="JOB_STATE_PAUSED",a.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",a.JOB_STATE_UPDATING="JOB_STATE_UPDATING",a.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"}(u||(u={})),function(a){a.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",a.TUNING_MODE_FULL="TUNING_MODE_FULL",a.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"}(v||(v={})),function(a){a.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",a.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",a.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",a.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",a.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",a.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",a.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"}(w||(w={})),function(a){a.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",a.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",a.BALANCED="BALANCED",a.PRIORITIZE_COST="PRIORITIZE_COST"}(x||(x={})),function(a){a.UNSPECIFIED="UNSPECIFIED",a.BLOCKING="BLOCKING",a.NON_BLOCKING="NON_BLOCKING"}(y||(y={})),function(a){a.MODE_UNSPECIFIED="MODE_UNSPECIFIED",a.MODE_DYNAMIC="MODE_DYNAMIC"}(z||(z={})),function(a){a.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",a.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"}(A||(A={})),function(a){a.MODE_UNSPECIFIED="MODE_UNSPECIFIED",a.AUTO="AUTO",a.ANY="ANY",a.NONE="NONE",a.VALIDATED="VALIDATED"}(B||(B={})),function(a){a.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",a.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",a.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",a.BLOCK_NONE="BLOCK_NONE"}(C||(C={})),function(a){a.DONT_ALLOW="DONT_ALLOW",a.ALLOW_ADULT="ALLOW_ADULT",a.ALLOW_ALL="ALLOW_ALL"}(D||(D={})),function(a){a.auto="auto",a.en="en",a.ja="ja",a.ko="ko",a.hi="hi",a.zh="zh",a.pt="pt",a.es="es"}(E||(E={})),function(a){a.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",a.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",a.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",a.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",a.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"}(F||(F={})),function(a){a.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",a.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",a.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",a.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"}(G||(G={})),function(a){a.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",a.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",a.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",a.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"}(H||(H={})),function(a){a.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",a.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",a.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",a.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",a.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",a.EDIT_MODE_STYLE="EDIT_MODE_STYLE",a.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",a.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"}(I||(I={})),function(a){a.FOREGROUND="FOREGROUND",a.BACKGROUND="BACKGROUND",a.PROMPT="PROMPT",a.SEMANTIC="SEMANTIC",a.INTERACTIVE="INTERACTIVE"}(J||(J={})),function(a){a.ASSET="ASSET",a.STYLE="STYLE"}(K||(K={})),function(a){a.INSERT="INSERT",a.REMOVE="REMOVE",a.REMOVE_STATIC="REMOVE_STATIC",a.OUTPAINT="OUTPAINT"}(L||(L={})),function(a){a.OPTIMIZED="OPTIMIZED",a.LOSSLESS="LOSSLESS"}(M||(M={})),function(a){a.STATE_UNSPECIFIED="STATE_UNSPECIFIED",a.PROCESSING="PROCESSING",a.ACTIVE="ACTIVE",a.FAILED="FAILED"}(N||(N={})),function(a){a.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",a.UPLOADED="UPLOADED",a.GENERATED="GENERATED"}(O||(O={})),function(a){a.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",a.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",a.RESPONSE_REJECTED="RESPONSE_REJECTED",a.NEED_MORE_INPUT="NEED_MORE_INPUT"}(P||(P={})),function(a){a.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",a.TEXT="TEXT",a.IMAGE="IMAGE",a.VIDEO="VIDEO",a.AUDIO="AUDIO",a.DOCUMENT="DOCUMENT"}(Q||(Q={})),function(a){a.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",a.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",a.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"}(R||(R={})),function(a){a.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",a.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",a.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"}(S||(S={})),function(a){a.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",a.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",a.NO_INTERRUPTION="NO_INTERRUPTION"}(T||(T={})),function(a){a.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",a.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",a.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"}(U||(U={})),function(a){a.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",a.SILENT="SILENT",a.WHEN_IDLE="WHEN_IDLE",a.INTERRUPT="INTERRUPT"}(V||(V={})),function(a){a.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",a.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",a.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",a.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",a.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",a.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",a.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",a.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",a.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",a.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",a.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",a.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",a.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"}(W||(W={})),function(a){a.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",a.QUALITY="QUALITY",a.DIVERSITY="DIVERSITY",a.VOCALIZATION="VOCALIZATION"}(X||(X={})),function(a){a.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",a.PLAY="PLAY",a.PAUSE="PAUSE",a.STOP="STOP",a.RESET_CONTEXT="RESET_CONTEXT"}(Y||(Y={}));class ai{constructor(a){let b={};for(let c of a.headers.entries())b[c[0]]=c[1];this.headers=b,this.responseInternal=a}json(){return this.responseInternal.json()}}class aj{get text(){var a,b,c,d,e,f,g,h;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let i="",j=!1,k=[];for(let a of null!=(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?h:[]){for(let[b,c]of Object.entries(a))"text"!==b&&"thought"!==b&&(null!==c||void 0!==c)&&k.push(b);if("string"==typeof a.text){if("boolean"==typeof a.thought&&a.thought)continue;j=!0,i+=a.text}}return k.length>0&&console.warn(`there are non-text parts ${k} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),j?i:void 0}get data(){var a,b,c,d,e,f,g,h;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let i="",j=[];for(let a of null!=(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?h:[]){for(let[b,c]of Object.entries(a))"inlineData"!==b&&(null!==c||void 0!==c)&&j.push(b);a.inlineData&&"string"==typeof a.inlineData.data&&(i+=atob(a.inlineData.data))}return j.length>0&&console.warn(`there are non-data parts ${j} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}get functionCalls(){var a,b,c,d,e,f,g,h;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let i=null==(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?void 0:h.filter(a=>a.functionCall).map(a=>a.functionCall).filter(a=>void 0!==a);if((null==i?void 0:i.length)!==0)return i}get executableCode(){var a,b,c,d,e,f,g,h,i;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let j=null==(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?void 0:h.filter(a=>a.executableCode).map(a=>a.executableCode).filter(a=>void 0!==a);if((null==j?void 0:j.length)!==0)return null==(i=null==j?void 0:j[0])?void 0:i.code}get codeExecutionResult(){var a,b,c,d,e,f,g,h,i;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let j=null==(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?void 0:h.filter(a=>a.codeExecutionResult).map(a=>a.codeExecutionResult).filter(a=>void 0!==a);if((null==j?void 0:j.length)!==0)return null==(i=null==j?void 0:j[0])?void 0:i.output}}class ak{}class al{}class am{}class an{}class ao{}class ap{}class aq{}class ar{}class as{}class at{}class au{_fromAPIResponse({apiResponse:a,isVertexAI:b}){let c=new au;return Object.assign(c,b?function(a){let b={},c=ag(a,["name"]);null!=c&&af(b,["name"],c);let d=ag(a,["metadata"]);null!=d&&af(b,["metadata"],d);let e=ag(a,["done"]);null!=e&&af(b,["done"],e);let f=ag(a,["error"]);null!=f&&af(b,["error"],f);let g=ag(a,["response"]);return null!=g&&af(b,["response"],function(a){let b={},c=ag(a,["videos"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["_self"]);return null!=c&&af(b,["video"],function(a){let b={},c=ag(a,["gcsUri"]);null!=c&&af(b,["uri"],c);let d=ag(a,["bytesBase64Encoded"]);null!=d&&af(b,["videoBytes"],ah(d));let e=ag(a,["mimeType"]);return null!=e&&af(b,["mimeType"],e),b}(c)),b})(a))),af(b,["generatedVideos"],a)}let d=ag(a,["raiMediaFilteredCount"]);null!=d&&af(b,["raiMediaFilteredCount"],d);let e=ag(a,["raiMediaFilteredReasons"]);return null!=e&&af(b,["raiMediaFilteredReasons"],e),b}(g)),b}(a):function(a){let b={},c=ag(a,["name"]);null!=c&&af(b,["name"],c);let d=ag(a,["metadata"]);null!=d&&af(b,["metadata"],d);let e=ag(a,["done"]);null!=e&&af(b,["done"],e);let f=ag(a,["error"]);null!=f&&af(b,["error"],f);let g=ag(a,["response","generateVideoResponse"]);return null!=g&&af(b,["response"],function(a){let b={},c=ag(a,["generatedSamples"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["_self"]);return null!=c&&af(b,["video"],function(a){let b={},c=ag(a,["video","uri"]);null!=c&&af(b,["uri"],c);let d=ag(a,["video","encodedVideo"]);null!=d&&af(b,["videoBytes"],ah(d));let e=ag(a,["encoding"]);return null!=e&&af(b,["mimeType"],e),b}(c)),b})(a))),af(b,["generatedVideos"],a)}let d=ag(a,["raiMediaFilteredCount"]);null!=d&&af(b,["raiMediaFilteredCount"],d);let e=ag(a,["raiMediaFilteredReasons"]);return null!=e&&af(b,["raiMediaFilteredReasons"],e),b}(g)),b}(a)),c}}class av{}class aw{}class ax{}class ay{}class az{}class aA{}class aB{}class aC{get text(){var a,b,c;let d="",e=!1,f=[];for(let g of null!=(c=null==(b=null==(a=this.serverContent)?void 0:a.modelTurn)?void 0:b.parts)?c:[]){for(let[a,b]of Object.entries(g))"text"!==a&&"thought"!==a&&null!==b&&f.push(a);if("string"==typeof g.text){if("boolean"==typeof g.thought&&g.thought)continue;e=!0,d+=g.text}}return f.length>0&&console.warn(`there are non-text parts ${f} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),e?d:void 0}get data(){var a,b,c;let d="",e=[];for(let f of null!=(c=null==(b=null==(a=this.serverContent)?void 0:a.modelTurn)?void 0:b.parts)?c:[]){for(let[a,b]of Object.entries(f))"inlineData"!==a&&null!==b&&e.push(a);f.inlineData&&"string"==typeof f.inlineData.data&&(d+=atob(f.inlineData.data))}return e.length>0&&console.warn(`there are non-data parts ${e} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}}class aD{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}function aE(a,b){if(!b||"string"!=typeof b)throw Error("model is required and must be a string");if(a.isVertexAI())if(b.startsWith("publishers/")||b.startsWith("projects/")||b.startsWith("models/"))return b;else{if(!(b.indexOf("/")>=0))return`publishers/google/models/${b}`;let a=b.split("/",2);return`publishers/${a[0]}/models/${a[1]}`}return b.startsWith("models/")||b.startsWith("tunedModels/")?b:`models/${b}`}function aF(a,b){let c=aE(a,b);return c?c.startsWith("publishers/")&&a.isVertexAI()?`projects/${a.getProject()}/locations/${a.getLocation()}/${c}`:c.startsWith("models/")&&a.isVertexAI()?`projects/${a.getProject()}/locations/${a.getLocation()}/publishers/google/${c}`:c:""}function aG(a){return Array.isArray(a)?a.map(a=>aH(a)):[aH(a)]}function aH(a){if("object"==typeof a&&null!==a)return a;throw Error(`Could not parse input as Blob. Unsupported blob type: ${typeof a}`)}function aI(a){let b=aH(a);if(b.mimeType&&b.mimeType.startsWith("image/"))return b;throw Error(`Unsupported mime type: ${b.mimeType}`)}function aJ(a){let b=aH(a);if(b.mimeType&&b.mimeType.startsWith("audio/"))return b;throw Error(`Unsupported mime type: ${b.mimeType}`)}function aK(a){if(null==a)throw Error("PartUnion is required");if("object"==typeof a)return a;if("string"==typeof a)return{text:a};throw Error(`Unsupported part type: ${typeof a}`)}function aL(a){if(null==a||Array.isArray(a)&&0===a.length)throw Error("PartListUnion is required");return Array.isArray(a)?a.map(a=>aK(a)):[aK(a)]}function aM(a){return null!=a&&"object"==typeof a&&"parts"in a&&Array.isArray(a.parts)}function aN(a){return null!=a&&"object"==typeof a&&"functionCall"in a}function aO(a){return null!=a&&"object"==typeof a&&"functionResponse"in a}function aP(a){if(null==a)throw Error("ContentUnion is required");return aM(a)?a:{role:"user",parts:aL(a)}}function aQ(a,b){if(!b)return[];if(a.isVertexAI()&&Array.isArray(b))return b.flatMap(a=>{let b=aP(a);return b.parts&&b.parts.length>0&&void 0!==b.parts[0].text?[b.parts[0].text]:[]});if(a.isVertexAI()){let a=aP(b);return a.parts&&a.parts.length>0&&void 0!==a.parts[0].text?[a.parts[0].text]:[]}return Array.isArray(b)?b.map(a=>aP(a)):[aP(b)]}function aR(a){if(null==a||Array.isArray(a)&&0===a.length)throw Error("contents are required");if(!Array.isArray(a)){if(aN(a)||aO(a))throw Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[aP(a)]}let b=[],c=[],d=aM(a[0]);for(let e of a){let a=aM(e);if(a!=d)throw Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)b.push(e);else if(aN(e)||aO(e))throw Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");else c.push(e)}return d||b.push({role:"user",parts:aL(c)}),b}function aS(a){let b={},c=["items"],d=["anyOf"],e=["properties"];if(a.type&&a.anyOf)throw Error("type and anyOf cannot be both populated.");let g=a.anyOf;for(let[h,i]of(null!=g&&2==g.length&&("null"===g[0].type?(b.nullable=!0,a=g[1]):"null"===g[1].type&&(b.nullable=!0,a=g[0])),a.type instanceof Array&&function(a,b){a.includes("null")&&(b.nullable=!0);let c=a.filter(a=>"null"!==a);if(1===c.length)b.type=Object.values(f).includes(c[0].toUpperCase())?c[0].toUpperCase():f.TYPE_UNSPECIFIED;else for(let a of(b.anyOf=[],c))b.anyOf.push({type:Object.values(f).includes(a.toUpperCase())?a.toUpperCase():f.TYPE_UNSPECIFIED})}(a.type,b),Object.entries(a)))if(null!=i)if("type"==h){if("null"===i)throw Error("type: null can not be the only possible type for the field.");if(i instanceof Array)continue;b.type=Object.values(f).includes(i.toUpperCase())?i.toUpperCase():f.TYPE_UNSPECIFIED}else if(c.includes(h))b[h]=aS(i);else if(d.includes(h)){let a=[];for(let c of i){if("null"==c.type){b.nullable=!0;continue}a.push(aS(c))}b[h]=a}else if(e.includes(h)){let a={};for(let[b,c]of Object.entries(i))a[b]=aS(c);b[h]=a}else{if("additionalProperties"===h)continue;b[h]=i}return b}function aT(a){if("object"==typeof a)return a;if("string"==typeof a)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:a}}};throw Error(`Unsupported speechConfig type: ${typeof a}`)}function aU(a){if("multiSpeakerVoiceConfig"in a)throw Error("multiSpeakerVoiceConfig is not supported in the live API.");return a}function aV(a){if(a.functionDeclarations)for(let b of a.functionDeclarations)b.parameters&&(Object.keys(b.parameters).includes("$schema")?b.parametersJsonSchema||(b.parametersJsonSchema=b.parameters,delete b.parameters):b.parameters=aS(b.parameters)),b.response&&(Object.keys(b.response).includes("$schema")?b.responseJsonSchema||(b.responseJsonSchema=b.response,delete b.response):b.response=aS(b.response));return a}function aW(a){if(null==a)throw Error("tools is required");if(!Array.isArray(a))throw Error("tools is required and must be an array of Tools");let b=[];for(let c of a)b.push(c);return b}function aX(a,b){if("string"!=typeof b)throw Error("name must be a string");return function(a,b,c,d=1){let e=!b.startsWith(`${c}/`)&&b.split("/").length===d;if(a.isVertexAI())if(b.startsWith("projects/"))return b;else if(b.startsWith("locations/"))return`projects/${a.getProject()}/${b}`;else if(b.startsWith(`${c}/`))return`projects/${a.getProject()}/locations/${a.getLocation()}/${b}`;else if(e)return`projects/${a.getProject()}/locations/${a.getLocation()}/${c}/${b}`;else return b;return e?`${c}/${b}`:b}(a,b,"cachedContents")}function aY(a){switch(a){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return a}}function aZ(a){return null!=a&&"object"==typeof a&&"video"in a}function a$(a){return null!=a&&"object"==typeof a&&"uri"in a}function a_(a){var b;let c;if(null!=a&&"object"==typeof a&&"name"in a&&(c=a.name),!a$(a)||void 0!==(c=a.uri)){if(!aZ(a)||void 0!==(c=null==(b=a.video)?void 0:b.uri)){if("string"==typeof a&&(c=a),void 0===c)throw Error("Could not extract file name from the provided input.");if(c.startsWith("https://")){let a=c.split("files/")[1].match(/[a-z0-9]+/);if(null===a)throw Error(`Could not extract file name from URI ${c}`);c=a[0]}else c.startsWith("files/")&&(c=c.split("files/")[1]);return c}}}function a0(a,b){return a.isVertexAI()?b?"publishers/google/models":"models":b?"models":"tunedModels"}function a1(a){for(let d of["models","tunedModels","publisherModels"]){var b,c;if(b=a,c=d,null!==b&&"object"==typeof b&&c in b)return a[d]}return[]}function a2(a,b){let c;if("string"==typeof b)if(a.isVertexAI())if(b.startsWith("gs://"))c={format:"jsonl",gcsUri:[b]};else if(b.startsWith("bq://"))c={format:"bigquery",bigqueryUri:b};else throw Error(`Unsupported string source for Vertex AI: ${b}`);else if(b.startsWith("files/"))c={fileName:b};else throw Error(`Unsupported string source for Gemini API: ${b}`);else if(Array.isArray(b)){if(a.isVertexAI())throw Error("InlinedRequest[] is not supported in Vertex AI.");c={inlinedRequests:b}}else c=b;let d=[c.gcsUri,c.bigqueryUri].filter(Boolean).length,e=[c.inlinedRequests,c.fileName].filter(Boolean).length;if(a.isVertexAI()){if(e>0||1!==d)throw Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(d>0||1!==e)throw Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return c}function a3(a){if("object"!=typeof a||null===a)return{};let b=a.inlinedResponses;if("object"!=typeof b||null===b)return a;let c=b.inlinedResponses;if(!Array.isArray(c)||0===c.length)return a;let d=!1;for(let a of c){if("object"!=typeof a||null===a)continue;let b=a.response;if("object"==typeof b&&null!==b&&void 0!==b.embedding){d=!0;break}}return d&&(a.inlinedEmbedContentResponses=a.inlinedResponses,delete a.inlinedResponses),a}function a4(a,b){if(!a.isVertexAI()){if(/batches\/[^/]+$/.test(b))return b.split("/").pop();throw Error(`Invalid batch job name: ${b}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(b))return b.split("/").pop();if(/^\d+$/.test(b))return b;throw Error(`Invalid batch job name: ${b}.`)}function a5(a){if("BATCH_STATE_UNSPECIFIED"===a)return"JOB_STATE_UNSPECIFIED";if("BATCH_STATE_PENDING"===a)return"JOB_STATE_PENDING";if("BATCH_STATE_RUNNING"===a)return"JOB_STATE_RUNNING";if("BATCH_STATE_SUCCEEDED"===a)return"JOB_STATE_SUCCEEDED";if("BATCH_STATE_FAILED"===a)return"JOB_STATE_FAILED";else if("BATCH_STATE_CANCELLED"===a)return"JOB_STATE_CANCELLED";else if("BATCH_STATE_EXPIRED"===a)return"JOB_STATE_EXPIRED";else return a}function a6(a){let b={},c=ag(a,["name"]);null!=c&&af(b,["name"],c);let d=ag(a,["metadata","displayName"]);null!=d&&af(b,["displayName"],d);let e=ag(a,["metadata","state"]);null!=e&&af(b,["state"],a5(e));let f=ag(a,["metadata","createTime"]);null!=f&&af(b,["createTime"],f);let g=ag(a,["metadata","endTime"]);null!=g&&af(b,["endTime"],g);let h=ag(a,["metadata","updateTime"]);null!=h&&af(b,["updateTime"],h);let i=ag(a,["metadata","model"]);null!=i&&af(b,["model"],i);let j=ag(a,["metadata","output"]);return null!=j&&af(b,["dest"],function(a){let b={},c=ag(a,["responsesFile"]);null!=c&&af(b,["fileName"],c);let d=ag(a,["inlinedResponses","inlinedResponses"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["response"]);null!=c&&af(b,["response"],function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["candidates"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["content"]);null!=c&&af(b,["content"],function(a){let b={},c=ag(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["videoMetadata"]);null!=c&&af(b,["videoMetadata"],function(a){let b={},c=ag(a,["fps"]);null!=c&&af(b,["fps"],c);let d=ag(a,["endOffset"]);null!=d&&af(b,["endOffset"],d);let e=ag(a,["startOffset"]);return null!=e&&af(b,["startOffset"],e),b}(c));let d=ag(a,["thought"]);null!=d&&af(b,["thought"],d);let e=ag(a,["inlineData"]);null!=e&&af(b,["inlineData"],function(a){let b={},c=ag(a,["data"]);null!=c&&af(b,["data"],c);let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(e));let f=ag(a,["fileData"]);null!=f&&af(b,["fileData"],function(a){let b={},c=ag(a,["fileUri"]);null!=c&&af(b,["fileUri"],c);let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(f));let g=ag(a,["thoughtSignature"]);null!=g&&af(b,["thoughtSignature"],g);let h=ag(a,["functionCall"]);null!=h&&af(b,["functionCall"],function(a){let b={},c=ag(a,["id"]);null!=c&&af(b,["id"],c);let d=ag(a,["args"]);null!=d&&af(b,["args"],d);let e=ag(a,["name"]);return null!=e&&af(b,["name"],e),b}(h));let i=ag(a,["codeExecutionResult"]);null!=i&&af(b,["codeExecutionResult"],i);let j=ag(a,["executableCode"]);null!=j&&af(b,["executableCode"],j);let k=ag(a,["functionResponse"]);null!=k&&af(b,["functionResponse"],k);let l=ag(a,["text"]);return null!=l&&af(b,["text"],l),b})(a))),af(b,["parts"],a)}let d=ag(a,["role"]);return null!=d&&af(b,["role"],d),b}(c));let d=ag(a,["citationMetadata"]);null!=d&&af(b,["citationMetadata"],function(a){let b={},c=ag(a,["citationSources"]);return null!=c&&af(b,["citations"],c),b}(d));let e=ag(a,["tokenCount"]);null!=e&&af(b,["tokenCount"],e);let f=ag(a,["finishReason"]);null!=f&&af(b,["finishReason"],f);let g=ag(a,["urlContextMetadata"]);null!=g&&af(b,["urlContextMetadata"],function(a){let b={},c=ag(a,["urlMetadata"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["retrievedUrl"]);null!=c&&af(b,["retrievedUrl"],c);let d=ag(a,["urlRetrievalStatus"]);return null!=d&&af(b,["urlRetrievalStatus"],d),b})(a))),af(b,["urlMetadata"],a)}return b}(g));let h=ag(a,["avgLogprobs"]);null!=h&&af(b,["avgLogprobs"],h);let i=ag(a,["groundingMetadata"]);null!=i&&af(b,["groundingMetadata"],i);let j=ag(a,["index"]);null!=j&&af(b,["index"],j);let k=ag(a,["logprobsResult"]);null!=k&&af(b,["logprobsResult"],k);let l=ag(a,["safetyRatings"]);return null!=l&&af(b,["safetyRatings"],l),b})(a))),af(b,["candidates"],a)}let e=ag(a,["modelVersion"]);null!=e&&af(b,["modelVersion"],e);let f=ag(a,["promptFeedback"]);null!=f&&af(b,["promptFeedback"],f);let g=ag(a,["responseId"]);null!=g&&af(b,["responseId"],g);let h=ag(a,["usageMetadata"]);return null!=h&&af(b,["usageMetadata"],h),b}(c));let d=ag(a,["error"]);return null!=d&&af(b,["error"],bb(d)),b})(a))),af(b,["inlinedResponses"],a)}let e=ag(a,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["response"]);null!=c&&af(b,["response"],function(a){let b={},c=ag(a,["embedding"]);null!=c&&af(b,["embedding"],function(a){let b={},c=ag(a,["values"]);return null!=c&&af(b,["values"],c),b}(c));let d=ag(a,["tokenCount"]);return null!=d&&af(b,["tokenCount"],d),b}(c));let d=ag(a,["error"]);return null!=d&&af(b,["error"],bb(d)),b})(a))),af(b,["inlinedEmbedContentResponses"],a)}return b}(a3(j))),b}function a7(a){let b={},c=ag(a,["name"]);null!=c&&af(b,["name"],c);let d=ag(a,["displayName"]);null!=d&&af(b,["displayName"],d);let e=ag(a,["state"]);null!=e&&af(b,["state"],a5(e));let f=ag(a,["error"]);null!=f&&af(b,["error"],bc(f));let g=ag(a,["createTime"]);null!=g&&af(b,["createTime"],g);let h=ag(a,["startTime"]);null!=h&&af(b,["startTime"],h);let i=ag(a,["endTime"]);null!=i&&af(b,["endTime"],i);let j=ag(a,["updateTime"]);null!=j&&af(b,["updateTime"],j);let k=ag(a,["model"]);null!=k&&af(b,["model"],k);let l=ag(a,["inputConfig"]);null!=l&&af(b,["src"],function(a){let b={},c=ag(a,["instancesFormat"]);null!=c&&af(b,["format"],c);let d=ag(a,["gcsSource","uris"]);null!=d&&af(b,["gcsUri"],d);let e=ag(a,["bigquerySource","inputUri"]);return null!=e&&af(b,["bigqueryUri"],e),b}(l));let m=ag(a,["outputConfig"]);return null!=m&&af(b,["dest"],function(a){let b={},c=ag(a,["predictionsFormat"]);null!=c&&af(b,["format"],c);let d=ag(a,["gcsDestination","outputUriPrefix"]);null!=d&&af(b,["gcsUri"],d);let e=ag(a,["bigqueryDestination","outputUri"]);return null!=e&&af(b,["bigqueryUri"],e),b}(a3(m))),b}function a8(a){let b={},c=ag(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["videoMetadata"]);null!=c&&af(b,["videoMetadata"],function(a){let b={},c=ag(a,["fps"]);null!=c&&af(b,["fps"],c);let d=ag(a,["endOffset"]);null!=d&&af(b,["endOffset"],d);let e=ag(a,["startOffset"]);return null!=e&&af(b,["startOffset"],e),b}(c));let d=ag(a,["thought"]);null!=d&&af(b,["thought"],d);let e=ag(a,["inlineData"]);null!=e&&af(b,["inlineData"],function(a){let b={};if(void 0!==ag(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=ag(a,["data"]);null!=c&&af(b,["data"],c);let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(e));let f=ag(a,["fileData"]);null!=f&&af(b,["fileData"],function(a){let b={};if(void 0!==ag(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=ag(a,["fileUri"]);null!=c&&af(b,["fileUri"],c);let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(f));let g=ag(a,["thoughtSignature"]);null!=g&&af(b,["thoughtSignature"],g);let h=ag(a,["functionCall"]);null!=h&&af(b,["functionCall"],function(a){let b={},c=ag(a,["id"]);null!=c&&af(b,["id"],c);let d=ag(a,["args"]);null!=d&&af(b,["args"],d);let e=ag(a,["name"]);return null!=e&&af(b,["name"],e),b}(h));let i=ag(a,["codeExecutionResult"]);null!=i&&af(b,["codeExecutionResult"],i);let j=ag(a,["executableCode"]);null!=j&&af(b,["executableCode"],j);let k=ag(a,["functionResponse"]);null!=k&&af(b,["functionResponse"],k);let l=ag(a,["text"]);return null!=l&&af(b,["text"],l),b})(a))),af(b,["parts"],a)}let d=ag(a,["role"]);return null!=d&&af(b,["role"],d),b}function a9(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["src"]);null!=e&&af(c,["batch","inputConfig"],function(a,b){let c={};if(void 0!==ag(b,["format"]))throw Error("format parameter is not supported in Gemini API.");if(void 0!==ag(b,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==ag(b,["bigqueryUri"]))throw Error("bigqueryUri parameter is not supported in Gemini API.");let d=ag(b,["fileName"]);null!=d&&af(c,["fileName"],d);let e=ag(b,["inlinedRequests"]);if(null!=e){let b=e;Array.isArray(b)&&(b=b.map(b=>(function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["request","model"],aE(a,d));let e=ag(b,["contents"]);if(null!=e){let a=aR(e);Array.isArray(a)&&(a=a.map(a=>a8(a))),af(c,["request","contents"],a)}let f=ag(b,["config"]);return null!=f&&af(c,["request","generationConfig"],function(a,b,c){let d={},e=ag(b,["systemInstruction"]);void 0!==c&&null!=e&&af(c,["systemInstruction"],a8(aP(e)));let f=ag(b,["temperature"]);null!=f&&af(d,["temperature"],f);let g=ag(b,["topP"]);null!=g&&af(d,["topP"],g);let h=ag(b,["topK"]);null!=h&&af(d,["topK"],h);let i=ag(b,["candidateCount"]);null!=i&&af(d,["candidateCount"],i);let j=ag(b,["maxOutputTokens"]);null!=j&&af(d,["maxOutputTokens"],j);let k=ag(b,["stopSequences"]);null!=k&&af(d,["stopSequences"],k);let l=ag(b,["responseLogprobs"]);null!=l&&af(d,["responseLogprobs"],l);let m=ag(b,["logprobs"]);null!=m&&af(d,["logprobs"],m);let n=ag(b,["presencePenalty"]);null!=n&&af(d,["presencePenalty"],n);let o=ag(b,["frequencyPenalty"]);null!=o&&af(d,["frequencyPenalty"],o);let p=ag(b,["seed"]);null!=p&&af(d,["seed"],p);let q=ag(b,["responseMimeType"]);null!=q&&af(d,["responseMimeType"],q);let r=ag(b,["responseSchema"]);null!=r&&af(d,["responseSchema"],function(a){let b={},c=ag(a,["anyOf"]);null!=c&&af(b,["anyOf"],c);let d=ag(a,["default"]);null!=d&&af(b,["default"],d);let e=ag(a,["description"]);null!=e&&af(b,["description"],e);let f=ag(a,["enum"]);null!=f&&af(b,["enum"],f);let g=ag(a,["example"]);null!=g&&af(b,["example"],g);let h=ag(a,["format"]);null!=h&&af(b,["format"],h);let i=ag(a,["items"]);null!=i&&af(b,["items"],i);let j=ag(a,["maxItems"]);null!=j&&af(b,["maxItems"],j);let k=ag(a,["maxLength"]);null!=k&&af(b,["maxLength"],k);let l=ag(a,["maxProperties"]);null!=l&&af(b,["maxProperties"],l);let m=ag(a,["maximum"]);null!=m&&af(b,["maximum"],m);let n=ag(a,["minItems"]);null!=n&&af(b,["minItems"],n);let o=ag(a,["minLength"]);null!=o&&af(b,["minLength"],o);let p=ag(a,["minProperties"]);null!=p&&af(b,["minProperties"],p);let q=ag(a,["minimum"]);null!=q&&af(b,["minimum"],q);let r=ag(a,["nullable"]);null!=r&&af(b,["nullable"],r);let s=ag(a,["pattern"]);null!=s&&af(b,["pattern"],s);let t=ag(a,["properties"]);null!=t&&af(b,["properties"],t);let u=ag(a,["propertyOrdering"]);null!=u&&af(b,["propertyOrdering"],u);let v=ag(a,["required"]);null!=v&&af(b,["required"],v);let w=ag(a,["title"]);null!=w&&af(b,["title"],w);let x=ag(a,["type"]);return null!=x&&af(b,["type"],x),b}(aS(r)));let s=ag(b,["responseJsonSchema"]);if(null!=s&&af(d,["responseJsonSchema"],s),void 0!==ag(b,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==ag(b,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let t=ag(b,["safetySettings"]);if(void 0!==c&&null!=t){let a=t;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={};if(void 0!==ag(a,["method"]))throw Error("method parameter is not supported in Gemini API.");let c=ag(a,["category"]);null!=c&&af(b,["category"],c);let d=ag(a,["threshold"]);return null!=d&&af(b,["threshold"],d),b})(a))),af(c,["safetySettings"],a)}let u=ag(b,["tools"]);if(void 0!==c&&null!=u){let a=aW(u);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["behavior"]);null!=c&&af(b,["behavior"],c);let d=ag(a,["description"]);null!=d&&af(b,["description"],d);let e=ag(a,["name"]);null!=e&&af(b,["name"],e);let f=ag(a,["parameters"]);null!=f&&af(b,["parameters"],f);let g=ag(a,["parametersJsonSchema"]);null!=g&&af(b,["parametersJsonSchema"],g);let h=ag(a,["response"]);null!=h&&af(b,["response"],h);let i=ag(a,["responseJsonSchema"]);return null!=i&&af(b,["responseJsonSchema"],i),b})(a))),af(b,["functionDeclarations"],a)}if(void 0!==ag(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=ag(a,["googleSearch"]);null!=d&&af(b,["googleSearch"],function(a){let b={},c=ag(a,["timeRangeFilter"]);if(null!=c&&af(b,["timeRangeFilter"],function(a){let b={},c=ag(a,["startTime"]);null!=c&&af(b,["startTime"],c);let d=ag(a,["endTime"]);return null!=d&&af(b,["endTime"],d),b}(c)),void 0!==ag(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return b}(d));let e=ag(a,["googleSearchRetrieval"]);if(null!=e&&af(b,["googleSearchRetrieval"],function(a){let b={},c=ag(a,["dynamicRetrievalConfig"]);return null!=c&&af(b,["dynamicRetrievalConfig"],function(a){let b={},c=ag(a,["mode"]);null!=c&&af(b,["mode"],c);let d=ag(a,["dynamicThreshold"]);return null!=d&&af(b,["dynamicThreshold"],d),b}(c)),b}(e)),void 0!==ag(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==ag(a,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");null!=ag(a,["urlContext"])&&af(b,["urlContext"],{});let f=ag(a,["computerUse"]);null!=f&&af(b,["computerUse"],function(a){let b={},c=ag(a,["environment"]);null!=c&&af(b,["environment"],c);let d=ag(a,["excludedPredefinedFunctions"]);return null!=d&&af(b,["excludedPredefinedFunctions"],d),b}(f));let g=ag(a,["codeExecution"]);return null!=g&&af(b,["codeExecution"],g),b})(aV(a)))),af(c,["tools"],a)}let v=ag(b,["toolConfig"]);if(void 0!==c&&null!=v&&af(c,["toolConfig"],function(a){let b={},c=ag(a,["functionCallingConfig"]);null!=c&&af(b,["functionCallingConfig"],function(a){let b={},c=ag(a,["mode"]);null!=c&&af(b,["mode"],c);let d=ag(a,["allowedFunctionNames"]);return null!=d&&af(b,["allowedFunctionNames"],d),b}(c));let d=ag(a,["retrievalConfig"]);return null!=d&&af(b,["retrievalConfig"],function(a){let b={},c=ag(a,["latLng"]);null!=c&&af(b,["latLng"],function(a){let b={},c=ag(a,["latitude"]);null!=c&&af(b,["latitude"],c);let d=ag(a,["longitude"]);return null!=d&&af(b,["longitude"],d),b}(c));let d=ag(a,["languageCode"]);return null!=d&&af(b,["languageCode"],d),b}(d)),b}(v)),void 0!==ag(b,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let w=ag(b,["cachedContent"]);void 0!==c&&null!=w&&af(c,["cachedContent"],aX(a,w));let x=ag(b,["responseModalities"]);null!=x&&af(d,["responseModalities"],x);let y=ag(b,["mediaResolution"]);null!=y&&af(d,["mediaResolution"],y);let z=ag(b,["speechConfig"]);if(null!=z&&af(d,["speechConfig"],function(a){let b={},c=ag(a,["voiceConfig"]);null!=c&&af(b,["voiceConfig"],bd(c));let d=ag(a,["multiSpeakerVoiceConfig"]);null!=d&&af(b,["multiSpeakerVoiceConfig"],function(a){let b={},c=ag(a,["speakerVoiceConfigs"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["speaker"]);null!=c&&af(b,["speaker"],c);let d=ag(a,["voiceConfig"]);return null!=d&&af(b,["voiceConfig"],bd(d)),b})(a))),af(b,["speakerVoiceConfigs"],a)}return b}(d));let e=ag(a,["languageCode"]);return null!=e&&af(b,["languageCode"],e),b}(aT(z))),void 0!==ag(b,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let A=ag(b,["thinkingConfig"]);return null!=A&&af(d,["thinkingConfig"],function(a){let b={},c=ag(a,["includeThoughts"]);null!=c&&af(b,["includeThoughts"],c);let d=ag(a,["thinkingBudget"]);return null!=d&&af(b,["thinkingBudget"],d),b}(A)),d}(a,f,c)),c})(a,b))),af(c,["requests","requests"],b)}return c}(a,a2(a,e)));let f=ag(b,["config"]);return null!=f&&function(a,b){let c=ag(a,["displayName"]);if(void 0!==b&&null!=c&&af(b,["batch","displayName"],c),void 0!==ag(a,["dest"]))throw Error("dest parameter is not supported in Gemini API.")}(f,c),c}function ba(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["src"]);null!=e&&af(c,["batch","inputConfig"],function(a,b){let c={},d=ag(b,["fileName"]);null!=d&&af(c,["file_name"],d);let e=ag(b,["inlinedRequests"]);return null!=e&&af(c,["requests"],function(a,b){let c={},d=ag(b,["contents"]);null!=d&&af(c,["requests[]","request","content"],aQ(a,d));let e=ag(b,["config"]);return null!=e&&af(c,["config"],function(a,b){let c=ag(a,["taskType"]);void 0!==b&&null!=c&&af(b,["requests[]","taskType"],c);let d=ag(a,["title"]);void 0!==b&&null!=d&&af(b,["requests[]","title"],d);let e=ag(a,["outputDimensionality"]);if(void 0!==b&&null!=e&&af(b,["requests[]","outputDimensionality"],e),void 0!==ag(a,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==ag(a,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.");return{}}(e,c)),c}(a,e)),c}(a,e));let f=ag(b,["config"]);return null!=f&&function(a,b){let c=ag(a,["displayName"]);void 0!==b&&null!=c&&af(b,["batch","displayName"],c)}(f,c),c}function bb(a){let b={},c=ag(a,["details"]);null!=c&&af(b,["details"],c);let d=ag(a,["code"]);null!=d&&af(b,["code"],d);let e=ag(a,["message"]);return null!=e&&af(b,["message"],e),b}function bc(a){let b={},c=ag(a,["details"]);null!=c&&af(b,["details"],c);let d=ag(a,["code"]);null!=d&&af(b,["code"],d);let e=ag(a,["message"]);return null!=e&&af(b,["message"],e),b}function bd(a){let b={},c=ag(a,["prebuiltVoiceConfig"]);return null!=c&&af(b,["prebuiltVoiceConfig"],function(a){let b={},c=ag(a,["voiceName"]);return null!=c&&af(b,["voiceName"],c),b}(c)),b}!function(a){a.PAGED_ITEM_BATCH_JOBS="batchJobs",a.PAGED_ITEM_MODELS="models",a.PAGED_ITEM_TUNING_JOBS="tuningJobs",a.PAGED_ITEM_FILES="files",a.PAGED_ITEM_CACHED_CONTENTS="cachedContents"}(Z||(Z={}));class be{constructor(a,b,c,d){this.pageInternal=[],this.paramsInternal={},this.requestInternal=b,this.init(a,c,d)}init(a,b,c){var d,e;this.nameInternal=a,this.pageInternal=b[this.nameInternal]||[],this.sdkHttpResponseInternal=null==b?void 0:b.sdkHttpResponse,this.idxInternal=0;let f={config:{}};(f=c&&0!==Object.keys(c).length?"object"==typeof c?Object.assign({},c):c:{config:{}}).config&&(f.config.pageToken=b.nextPageToken),this.paramsInternal=f,this.pageInternalSize=null!=(e=null==(d=f.config)?void 0:d.pageSize)?e:this.pageInternal.length}initNextPage(a){this.init(this.nameInternal,a,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(a){return this.pageInternal[a]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(!this.hasNextPage())return{value:void 0,done:!0};else await this.nextPage();let a=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:a,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw Error("No more pages to fetch.");let a=await this.requestInternal(this.params);return this.initNextPage(a),this.page}hasNextPage(){var a;return(null==(a=this.params.config)?void 0:a.pageToken)!==void 0}}class bf extends ad{constructor(a){super(),this.apiClient=a,this.create=async a=>{var b,c;if(this.apiClient.isVertexAI())return a.config=this.formatDestination(a.src,a.config),this.createInternal(a);let d=a.src;if(!(Array.isArray(a.src)||void 0!==d.inlinedRequests))return this.createInternal(a);let e=this.createInlinedGenerateContentRequest(a),f=e.path,g=e.body,h=a9(this.apiClient,a)._query||{};return this.apiClient.request({path:f,queryParams:h,body:JSON.stringify(g),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a6(a))},this.createEmbeddings=async a=>{var b,c;if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw Error("Vertex AI does not support batches.createEmbeddings.");if(void 0===a.src.inlinedRequests)return this.createEmbeddingsInternal(a);let d=this.createInlinedEmbedContentRequest(a),e=d.path,f=d.body,g=ba(this.apiClient,a)._query||{};return this.apiClient.request({path:e,queryParams:g,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a6(a))},this.list=async(a={})=>new be(Z.PAGED_ITEM_BATCH_JOBS,a=>this.listInternal(a),await this.listInternal(a),a)}createInlinedGenerateContentRequest(a){let b=a9(this.apiClient,a),c=ae("{model}:batchGenerateContent",b._url),d=b.batch.inputConfig.requests,e=d.requests,f=[];for(let a of e){let b=Object.assign({},a);if(b.systemInstruction){let a=b.systemInstruction;delete b.systemInstruction;let c=b.request;c.systemInstruction=a,b.request=c}f.push(b)}return d.requests=f,delete b.config,delete b._url,delete b._query,{path:c,body:b}}createInlinedEmbedContentRequest(a){let b=ba(this.apiClient,a),c=ae("{model}:asyncBatchEmbedContent",b._url),d=b.batch.inputConfig.requests,e=d.requests,f=[];for(let a of(delete d.config,e)){let b=Object.assign({},a),c=b.request;for(let a in b)"request"!==a&&(c[a]=b[a],delete b[a]);f.push(b)}return d.requests=f,delete b.config,delete b._url,delete b._query,{path:c,body:b}}getGcsUri(a){return"string"==typeof a?a.startsWith("gs://")?a:void 0:!Array.isArray(a)&&a.gcsUri&&a.gcsUri.length>0?a.gcsUri[0]:void 0}getBigqueryUri(a){return"string"==typeof a?a.startsWith("bq://")?a:void 0:Array.isArray(a)?void 0:a.bigqueryUri}formatDestination(a,b){let c=b?Object.assign({},b):{},d=Date.now().toString();if(c.displayName||(c.displayName=`genaiBatchJob_${d}`),void 0===c.dest){let b=this.getGcsUri(a),e=this.getBigqueryUri(a);if(b)b.endsWith(".jsonl")?c.dest=`${b.slice(0,-6)}/dest`:c.dest=`${b}_dest_${d}`;else if(e)c.dest=`${e}_dest_${d}`;else throw Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return c}async createInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["model"],aE(a,d));let e=ag(b,["src"]);null!=e&&af(c,["inputConfig"],function(a){let b={},c=ag(a,["format"]);null!=c&&af(b,["instancesFormat"],c);let d=ag(a,["gcsUri"]);null!=d&&af(b,["gcsSource","uris"],d);let e=ag(a,["bigqueryUri"]);if(null!=e&&af(b,["bigquerySource","inputUri"],e),void 0!==ag(a,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==ag(a,["inlinedRequests"]))throw Error("inlinedRequests parameter is not supported in Vertex AI.");return b}(a2(a,e)));let f=ag(b,["config"]);return null!=f&&function(a,b){let c=ag(a,["displayName"]);void 0!==b&&null!=c&&af(b,["displayName"],c);let d=ag(a,["dest"]);void 0!==b&&null!=d&&af(b,["outputConfig"],function(a){let b={},c=ag(a,["format"]);null!=c&&af(b,["predictionsFormat"],c);let d=ag(a,["gcsUri"]);null!=d&&af(b,["gcsDestination","outputUriPrefix"],d);let e=ag(a,["bigqueryUri"]);if(null!=e&&af(b,["bigqueryDestination","outputUri"],e),void 0!==ag(a,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==ag(a,["inlinedResponses"]))throw Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==ag(a,["inlinedEmbedContentResponses"]))throw Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return b}(function(a){if("string"!=typeof a)return a;if(a.startsWith("gs://"))return{format:"jsonl",gcsUri:a};if(a.startsWith("bq://"))return{format:"bigquery",bigqueryUri:a};throw Error(`Unsupported destination: ${a}`)}(d)))}(f,c),c}(this.apiClient,a);return f=ae("batchPredictionJobs",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a7(a))}{let b=a9(this.apiClient,a);return f=ae("{model}:batchGenerateContent",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>a6(a))}}async createEmbeddingsInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=ba(this.apiClient,a);return d=ae("{model}:asyncBatchEmbedContent",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a6(a))}}async get(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=ag(b,["name"]);return null!=d&&af(c,["_url","name"],a4(a,d)),c}(this.apiClient,a);return f=ae("batchPredictionJobs/{name}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a7(a))}{let b=function(a,b){let c={},d=ag(b,["name"]);return null!=d&&af(c,["_url","name"],a4(a,d)),c}(this.apiClient,a);return f=ae("batches/{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>a6(a))}}async cancel(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=ag(b,["name"]);return null!=d&&af(c,["_url","name"],a4(a,d)),c}(this.apiClient,a);f=ae("batchPredictionJobs/{name}:cancel",d._url),g=d._query,delete d._url,delete d._query,await this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal})}else{let b=function(a,b){let c={},d=ag(b,["name"]);return null!=d&&af(c,["_url","name"],a4(a,d)),c}(this.apiClient,a);f=ae("batches/{name}:cancel",b._url),g=b._query,delete b._url,delete b._query,await this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal})}}async listInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a){let b={},c=ag(a,["config"]);return null!=c&&function(a,b){let c=ag(a,["pageSize"]);void 0!==b&&null!=c&&af(b,["_query","pageSize"],c);let d=ag(a,["pageToken"]);void 0!==b&&null!=d&&af(b,["_query","pageToken"],d);let e=ag(a,["filter"]);void 0!==b&&null!=e&&af(b,["_query","filter"],e)}(c,b),b}(a);return f=ae("batchPredictionJobs",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["nextPageToken"]);null!=d&&af(b,["nextPageToken"],d);let e=ag(a,["batchPredictionJobs"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a7(a))),af(b,["batchJobs"],a)}return b}(a),c=new aB;return Object.assign(c,b),c})}{let b=function(a){let b={},c=ag(a,["config"]);return null!=c&&function(a,b){let c=ag(a,["pageSize"]);void 0!==b&&null!=c&&af(b,["_query","pageSize"],c);let d=ag(a,["pageToken"]);if(void 0!==b&&null!=d&&af(b,["_query","pageToken"],d),void 0!==ag(a,["filter"]))throw Error("filter parameter is not supported in Gemini API.")}(c,b),b}(a);return f=ae("batches",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["nextPageToken"]);null!=d&&af(b,["nextPageToken"],d);let e=ag(a,["operations"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a6(a))),af(b,["batchJobs"],a)}return b}(a),c=new aB;return Object.assign(c,b),c})}}async delete(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=ag(b,["name"]);return null!=d&&af(c,["_url","name"],a4(a,d)),c}(this.apiClient,a);return f=ae("batchPredictionJobs/{name}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>(function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["name"]);null!=d&&af(b,["name"],d);let e=ag(a,["done"]);null!=e&&af(b,["done"],e);let f=ag(a,["error"]);return null!=f&&af(b,["error"],bc(f)),b})(a))}{let b=function(a,b){let c={},d=ag(b,["name"]);return null!=d&&af(c,["_url","name"],a4(a,d)),c}(this.apiClient,a);return f=ae("batches/{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"DELETE",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>(function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["name"]);null!=d&&af(b,["name"],d);let e=ag(a,["done"]);null!=e&&af(b,["done"],e);let f=ag(a,["error"]);return null!=f&&af(b,["error"],bb(f)),b})(a))}}}function bg(a){let b={},c=ag(a,["name"]);null!=c&&af(b,["name"],c);let d=ag(a,["displayName"]);null!=d&&af(b,["displayName"],d);let e=ag(a,["model"]);null!=e&&af(b,["model"],e);let f=ag(a,["createTime"]);null!=f&&af(b,["createTime"],f);let g=ag(a,["updateTime"]);null!=g&&af(b,["updateTime"],g);let h=ag(a,["expireTime"]);null!=h&&af(b,["expireTime"],h);let i=ag(a,["usageMetadata"]);return null!=i&&af(b,["usageMetadata"],i),b}function bh(a){let b={},c=ag(a,["name"]);null!=c&&af(b,["name"],c);let d=ag(a,["displayName"]);null!=d&&af(b,["displayName"],d);let e=ag(a,["model"]);null!=e&&af(b,["model"],e);let f=ag(a,["createTime"]);null!=f&&af(b,["createTime"],f);let g=ag(a,["updateTime"]);null!=g&&af(b,["updateTime"],g);let h=ag(a,["expireTime"]);null!=h&&af(b,["expireTime"],h);let i=ag(a,["usageMetadata"]);return null!=i&&af(b,["usageMetadata"],i),b}function bi(a){let b={},c=ag(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["videoMetadata"]);null!=c&&af(b,["videoMetadata"],function(a){let b={},c=ag(a,["fps"]);null!=c&&af(b,["fps"],c);let d=ag(a,["endOffset"]);null!=d&&af(b,["endOffset"],d);let e=ag(a,["startOffset"]);return null!=e&&af(b,["startOffset"],e),b}(c));let d=ag(a,["thought"]);null!=d&&af(b,["thought"],d);let e=ag(a,["inlineData"]);null!=e&&af(b,["inlineData"],function(a){let b={};if(void 0!==ag(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=ag(a,["data"]);null!=c&&af(b,["data"],c);let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(e));let f=ag(a,["fileData"]);null!=f&&af(b,["fileData"],function(a){let b={};if(void 0!==ag(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=ag(a,["fileUri"]);null!=c&&af(b,["fileUri"],c);let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(f));let g=ag(a,["thoughtSignature"]);null!=g&&af(b,["thoughtSignature"],g);let h=ag(a,["functionCall"]);null!=h&&af(b,["functionCall"],function(a){let b={},c=ag(a,["id"]);null!=c&&af(b,["id"],c);let d=ag(a,["args"]);null!=d&&af(b,["args"],d);let e=ag(a,["name"]);return null!=e&&af(b,["name"],e),b}(h));let i=ag(a,["codeExecutionResult"]);null!=i&&af(b,["codeExecutionResult"],i);let j=ag(a,["executableCode"]);null!=j&&af(b,["executableCode"],j);let k=ag(a,["functionResponse"]);null!=k&&af(b,["functionResponse"],k);let l=ag(a,["text"]);return null!=l&&af(b,["text"],l),b})(a))),af(b,["parts"],a)}let d=ag(a,["role"]);return null!=d&&af(b,["role"],d),b}function bj(a){let b={},c=ag(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["videoMetadata"]);null!=c&&af(b,["videoMetadata"],function(a){let b={},c=ag(a,["fps"]);null!=c&&af(b,["fps"],c);let d=ag(a,["endOffset"]);null!=d&&af(b,["endOffset"],d);let e=ag(a,["startOffset"]);return null!=e&&af(b,["startOffset"],e),b}(c));let d=ag(a,["thought"]);null!=d&&af(b,["thought"],d);let e=ag(a,["inlineData"]);null!=e&&af(b,["inlineData"],function(a){let b={},c=ag(a,["displayName"]);null!=c&&af(b,["displayName"],c);let d=ag(a,["data"]);null!=d&&af(b,["data"],d);let e=ag(a,["mimeType"]);return null!=e&&af(b,["mimeType"],e),b}(e));let f=ag(a,["fileData"]);null!=f&&af(b,["fileData"],function(a){let b={},c=ag(a,["displayName"]);null!=c&&af(b,["displayName"],c);let d=ag(a,["fileUri"]);null!=d&&af(b,["fileUri"],d);let e=ag(a,["mimeType"]);return null!=e&&af(b,["mimeType"],e),b}(f));let g=ag(a,["thoughtSignature"]);null!=g&&af(b,["thoughtSignature"],g);let h=ag(a,["functionCall"]);null!=h&&af(b,["functionCall"],function(a){let b={},c=ag(a,["id"]);null!=c&&af(b,["id"],c);let d=ag(a,["args"]);null!=d&&af(b,["args"],d);let e=ag(a,["name"]);return null!=e&&af(b,["name"],e),b}(h));let i=ag(a,["codeExecutionResult"]);null!=i&&af(b,["codeExecutionResult"],i);let j=ag(a,["executableCode"]);null!=j&&af(b,["executableCode"],j);let k=ag(a,["functionResponse"]);null!=k&&af(b,["functionResponse"],k);let l=ag(a,["text"]);return null!=l&&af(b,["text"],l),b})(a))),af(b,["parts"],a)}let d=ag(a,["role"]);return null!=d&&af(b,["role"],d),b}class bk extends ad{constructor(a){super(),this.apiClient=a,this.list=async(a={})=>new be(Z.PAGED_ITEM_CACHED_CONTENTS,a=>this.listInternal(a),await this.listInternal(a),a)}async create(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["model"],aF(a,d));let e=ag(b,["config"]);return null!=e&&function(a,b){let c=ag(a,["ttl"]);void 0!==b&&null!=c&&af(b,["ttl"],c);let d=ag(a,["expireTime"]);void 0!==b&&null!=d&&af(b,["expireTime"],d);let e=ag(a,["displayName"]);void 0!==b&&null!=e&&af(b,["displayName"],e);let f=ag(a,["contents"]);if(void 0!==b&&null!=f){let a=aR(f);Array.isArray(a)&&(a=a.map(a=>bj(a))),af(b,["contents"],a)}let g=ag(a,["systemInstruction"]);void 0!==b&&null!=g&&af(b,["systemInstruction"],bj(aP(g)));let h=ag(a,["tools"]);if(void 0!==b&&null!=h){let a=h;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={};if(void 0!==ag(a,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let c=ag(a,["description"]);null!=c&&af(b,["description"],c);let d=ag(a,["name"]);null!=d&&af(b,["name"],d);let e=ag(a,["parameters"]);null!=e&&af(b,["parameters"],e);let f=ag(a,["parametersJsonSchema"]);null!=f&&af(b,["parametersJsonSchema"],f);let g=ag(a,["response"]);null!=g&&af(b,["response"],g);let h=ag(a,["responseJsonSchema"]);return null!=h&&af(b,["responseJsonSchema"],h),b})(a))),af(b,["functionDeclarations"],a)}let d=ag(a,["retrieval"]);null!=d&&af(b,["retrieval"],d);let e=ag(a,["googleSearch"]);null!=e&&af(b,["googleSearch"],function(a){let b={},c=ag(a,["timeRangeFilter"]);null!=c&&af(b,["timeRangeFilter"],function(a){let b={},c=ag(a,["startTime"]);null!=c&&af(b,["startTime"],c);let d=ag(a,["endTime"]);return null!=d&&af(b,["endTime"],d),b}(c));let d=ag(a,["excludeDomains"]);return null!=d&&af(b,["excludeDomains"],d),b}(e));let f=ag(a,["googleSearchRetrieval"]);null!=f&&af(b,["googleSearchRetrieval"],function(a){let b={},c=ag(a,["dynamicRetrievalConfig"]);return null!=c&&af(b,["dynamicRetrievalConfig"],function(a){let b={},c=ag(a,["mode"]);null!=c&&af(b,["mode"],c);let d=ag(a,["dynamicThreshold"]);return null!=d&&af(b,["dynamicThreshold"],d),b}(c)),b}(f));let g=ag(a,["enterpriseWebSearch"]);null!=g&&af(b,["enterpriseWebSearch"],function(a){let b={},c=ag(a,["excludeDomains"]);return null!=c&&af(b,["excludeDomains"],c),b}(g));let h=ag(a,["googleMaps"]);null!=h&&af(b,["googleMaps"],function(a){let b={},c=ag(a,["authConfig"]);return null!=c&&af(b,["authConfig"],function(a){let b={},c=ag(a,["apiKeyConfig"]);null!=c&&af(b,["apiKeyConfig"],function(a){let b={},c=ag(a,["apiKeyString"]);return null!=c&&af(b,["apiKeyString"],c),b}(c));let d=ag(a,["authType"]);null!=d&&af(b,["authType"],d);let e=ag(a,["googleServiceAccountConfig"]);null!=e&&af(b,["googleServiceAccountConfig"],e);let f=ag(a,["httpBasicAuthConfig"]);null!=f&&af(b,["httpBasicAuthConfig"],f);let g=ag(a,["oauthConfig"]);null!=g&&af(b,["oauthConfig"],g);let h=ag(a,["oidcConfig"]);return null!=h&&af(b,["oidcConfig"],h),b}(c)),b}(h)),null!=ag(a,["urlContext"])&&af(b,["urlContext"],{});let i=ag(a,["computerUse"]);null!=i&&af(b,["computerUse"],function(a){let b={},c=ag(a,["environment"]);null!=c&&af(b,["environment"],c);let d=ag(a,["excludedPredefinedFunctions"]);return null!=d&&af(b,["excludedPredefinedFunctions"],d),b}(i));let j=ag(a,["codeExecution"]);return null!=j&&af(b,["codeExecution"],j),b})(a))),af(b,["tools"],a)}let i=ag(a,["toolConfig"]);void 0!==b&&null!=i&&af(b,["toolConfig"],function(a){let b={},c=ag(a,["functionCallingConfig"]);null!=c&&af(b,["functionCallingConfig"],function(a){let b={},c=ag(a,["mode"]);null!=c&&af(b,["mode"],c);let d=ag(a,["allowedFunctionNames"]);return null!=d&&af(b,["allowedFunctionNames"],d),b}(c));let d=ag(a,["retrievalConfig"]);return null!=d&&af(b,["retrievalConfig"],function(a){let b={},c=ag(a,["latLng"]);null!=c&&af(b,["latLng"],function(a){let b={},c=ag(a,["latitude"]);null!=c&&af(b,["latitude"],c);let d=ag(a,["longitude"]);return null!=d&&af(b,["longitude"],d),b}(c));let d=ag(a,["languageCode"]);return null!=d&&af(b,["languageCode"],d),b}(d)),b}(i));let j=ag(a,["kmsKeyName"]);void 0!==b&&null!=j&&af(b,["encryption_spec","kmsKeyName"],j)}(e,c),c}(this.apiClient,a);return f=ae("cachedContents",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>bh(a))}{let b=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["model"],aF(a,d));let e=ag(b,["config"]);return null!=e&&function(a,b){let c=ag(a,["ttl"]);void 0!==b&&null!=c&&af(b,["ttl"],c);let d=ag(a,["expireTime"]);void 0!==b&&null!=d&&af(b,["expireTime"],d);let e=ag(a,["displayName"]);void 0!==b&&null!=e&&af(b,["displayName"],e);let f=ag(a,["contents"]);if(void 0!==b&&null!=f){let a=aR(f);Array.isArray(a)&&(a=a.map(a=>bi(a))),af(b,["contents"],a)}let g=ag(a,["systemInstruction"]);void 0!==b&&null!=g&&af(b,["systemInstruction"],bi(aP(g)));let h=ag(a,["tools"]);if(void 0!==b&&null!=h){let a=h;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["behavior"]);null!=c&&af(b,["behavior"],c);let d=ag(a,["description"]);null!=d&&af(b,["description"],d);let e=ag(a,["name"]);null!=e&&af(b,["name"],e);let f=ag(a,["parameters"]);null!=f&&af(b,["parameters"],f);let g=ag(a,["parametersJsonSchema"]);null!=g&&af(b,["parametersJsonSchema"],g);let h=ag(a,["response"]);null!=h&&af(b,["response"],h);let i=ag(a,["responseJsonSchema"]);return null!=i&&af(b,["responseJsonSchema"],i),b})(a))),af(b,["functionDeclarations"],a)}if(void 0!==ag(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=ag(a,["googleSearch"]);null!=d&&af(b,["googleSearch"],function(a){let b={},c=ag(a,["timeRangeFilter"]);if(null!=c&&af(b,["timeRangeFilter"],function(a){let b={},c=ag(a,["startTime"]);null!=c&&af(b,["startTime"],c);let d=ag(a,["endTime"]);return null!=d&&af(b,["endTime"],d),b}(c)),void 0!==ag(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return b}(d));let e=ag(a,["googleSearchRetrieval"]);if(null!=e&&af(b,["googleSearchRetrieval"],function(a){let b={},c=ag(a,["dynamicRetrievalConfig"]);return null!=c&&af(b,["dynamicRetrievalConfig"],function(a){let b={},c=ag(a,["mode"]);null!=c&&af(b,["mode"],c);let d=ag(a,["dynamicThreshold"]);return null!=d&&af(b,["dynamicThreshold"],d),b}(c)),b}(e)),void 0!==ag(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==ag(a,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");null!=ag(a,["urlContext"])&&af(b,["urlContext"],{});let f=ag(a,["computerUse"]);null!=f&&af(b,["computerUse"],function(a){let b={},c=ag(a,["environment"]);null!=c&&af(b,["environment"],c);let d=ag(a,["excludedPredefinedFunctions"]);return null!=d&&af(b,["excludedPredefinedFunctions"],d),b}(f));let g=ag(a,["codeExecution"]);return null!=g&&af(b,["codeExecution"],g),b})(a))),af(b,["tools"],a)}let i=ag(a,["toolConfig"]);if(void 0!==b&&null!=i&&af(b,["toolConfig"],function(a){let b={},c=ag(a,["functionCallingConfig"]);null!=c&&af(b,["functionCallingConfig"],function(a){let b={},c=ag(a,["mode"]);null!=c&&af(b,["mode"],c);let d=ag(a,["allowedFunctionNames"]);return null!=d&&af(b,["allowedFunctionNames"],d),b}(c));let d=ag(a,["retrievalConfig"]);return null!=d&&af(b,["retrievalConfig"],function(a){let b={},c=ag(a,["latLng"]);null!=c&&af(b,["latLng"],function(a){let b={},c=ag(a,["latitude"]);null!=c&&af(b,["latitude"],c);let d=ag(a,["longitude"]);return null!=d&&af(b,["longitude"],d),b}(c));let d=ag(a,["languageCode"]);return null!=d&&af(b,["languageCode"],d),b}(d)),b}(i)),void 0!==ag(a,["kmsKeyName"]))throw Error("kmsKeyName parameter is not supported in Gemini API.")}(e,c),c}(this.apiClient,a);return f=ae("cachedContents",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>bg(a))}}async get(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=ag(b,["name"]);return null!=d&&af(c,["_url","name"],aX(a,d)),c}(this.apiClient,a);return f=ae("{name}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>bh(a))}{let b=function(a,b){let c={},d=ag(b,["name"]);return null!=d&&af(c,["_url","name"],aX(a,d)),c}(this.apiClient,a);return f=ae("{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>bg(a))}}async delete(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=ag(b,["name"]);return null!=d&&af(c,["_url","name"],aX(a,d)),c}(this.apiClient,a);return f=ae("{name}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);return null!=c&&af(b,["sdkHttpResponse"],c),b}(a),c=new aw;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=ag(b,["name"]);return null!=d&&af(c,["_url","name"],aX(a,d)),c}(this.apiClient,a);return f=ae("{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"DELETE",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);return null!=c&&af(b,["sdkHttpResponse"],c),b}(a),c=new aw;return Object.assign(c,b),c})}}async update(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=ag(b,["name"]);null!=d&&af(c,["_url","name"],aX(a,d));let e=ag(b,["config"]);return null!=e&&function(a,b){let c=ag(a,["ttl"]);void 0!==b&&null!=c&&af(b,["ttl"],c);let d=ag(a,["expireTime"]);void 0!==b&&null!=d&&af(b,["expireTime"],d)}(e,c),c}(this.apiClient,a);return f=ae("{name}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>bh(a))}{let b=function(a,b){let c={},d=ag(b,["name"]);null!=d&&af(c,["_url","name"],aX(a,d));let e=ag(b,["config"]);return null!=e&&function(a,b){let c=ag(a,["ttl"]);void 0!==b&&null!=c&&af(b,["ttl"],c);let d=ag(a,["expireTime"]);void 0!==b&&null!=d&&af(b,["expireTime"],d)}(e,c),c}(this.apiClient,a);return f=ae("{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"PATCH",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>bg(a))}}async listInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a){let b={},c=ag(a,["config"]);return null!=c&&function(a,b){let c=ag(a,["pageSize"]);void 0!==b&&null!=c&&af(b,["_query","pageSize"],c);let d=ag(a,["pageToken"]);void 0!==b&&null!=d&&af(b,["_query","pageToken"],d)}(c,b),b}(a);return f=ae("cachedContents",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["nextPageToken"]);null!=d&&af(b,["nextPageToken"],d);let e=ag(a,["cachedContents"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>bh(a))),af(b,["cachedContents"],a)}return b}(a),c=new ax;return Object.assign(c,b),c})}{let b=function(a){let b={},c=ag(a,["config"]);return null!=c&&function(a,b){let c=ag(a,["pageSize"]);void 0!==b&&null!=c&&af(b,["_query","pageSize"],c);let d=ag(a,["pageToken"]);void 0!==b&&null!=d&&af(b,["_query","pageToken"],d)}(c,b),b}(a);return f=ae("cachedContents",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["nextPageToken"]);null!=d&&af(b,["nextPageToken"],d);let e=ag(a,["cachedContents"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>bg(a))),af(b,["cachedContents"],a)}return b}(a),c=new ax;return Object.assign(c,b),c})}}}function bl(a){return this instanceof bl?(this.v=a,this):new bl(a)}function bm(a,b,c){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var d,e=c.apply(a,b||[]),f=[];return d=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",function(a){return function(b){return Promise.resolve(b).then(a,j)}}),d[Symbol.asyncIterator]=function(){return this},d;function g(a,b){e[a]&&(d[a]=function(b){return new Promise(function(c,d){f.push([a,b,c,d])>1||h(a,b)})},b&&(d[a]=b(d[a])))}function h(a,b){try{var c;(c=e[a](b)).value instanceof bl?Promise.resolve(c.value.v).then(i,j):k(f[0][2],c)}catch(a){k(f[0][3],a)}}function i(a){h("next",a)}function j(a){h("throw",a)}function k(a,b){a(b),f.shift(),f.length&&h(f[0][0],f[0][1])}}function bn(a){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var b,c=a[Symbol.asyncIterator];return c?c.call(a):(a=function(a){var b="function"==typeof Symbol&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&"number"==typeof a.length)return{next:function(){return a&&d>=a.length&&(a=void 0),{value:a&&a[d++],done:!a}}};throw TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")}(a),b={},d("next"),d("throw"),d("return"),b[Symbol.asyncIterator]=function(){return this},b);function d(c){b[c]=a[c]&&function(b){return new Promise(function(d,e){var f,g,h;f=d,g=e,h=(b=a[c](b)).done,Promise.resolve(b.value).then(function(a){f({value:a,done:h})},g)})}}}function bo(a){if(void 0===a.parts||0===a.parts.length)return!1;for(let b of a.parts)if(void 0===b||0===Object.keys(b).length)return!1;return!0}function bp(a){if(void 0===a||0===a.length)return[];let b=[],c=a.length,d=0;for(;d<c;)if("user"===a[d].role)b.push(a[d]),d++;else{let e=[],f=!0;for(;d<c&&"model"===a[d].role;)e.push(a[d]),f&&!bo(a[d])&&(f=!1),d++;f?b.push(...e):b.pop()}return b}"function"==typeof SuppressedError&&SuppressedError;class bq{constructor(a,b){this.modelsModule=a,this.apiClient=b}create(a){return new br(this.apiClient,this.modelsModule,a.model,a.config,structuredClone(a.history))}}class br{constructor(a,b,c,d={},e=[]){this.apiClient=a,this.modelsModule=b,this.model=c,this.config=d,this.history=e,this.sendPromise=Promise.resolve(),function(a){if(0!==a.length){for(let b of a)if("user"!==b.role&&"model"!==b.role)throw Error(`Role must be user or model, but got ${b.role}.`)}}(e)}async sendMessage(a){var b;await this.sendPromise;let c=aP(a.message),d=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(c),config:null!=(b=a.config)?b:this.config});return this.sendPromise=(async()=>{var a,b,e;let f=await d,g=null==(b=null==(a=f.candidates)?void 0:a[0])?void 0:b.content,h=f.automaticFunctionCallingHistory,i=this.getHistory(!0).length,j=[];null!=h&&(j=null!=(e=h.slice(i))?e:[]),this.recordHistory(c,g?[g]:[],j)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),d}async sendMessageStream(a){var b;await this.sendPromise;let c=aP(a.message),d=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(c),config:null!=(b=a.config)?b:this.config});this.sendPromise=d.then(()=>void 0).catch(()=>void 0);let e=await d;return this.processStreamResponse(e,c)}getHistory(a=!1){return structuredClone(a?bp(this.history):this.history)}processStreamResponse(a,b){var c,d;return bm(this,arguments,function*(){var e,f,g,h;let i=[];try{for(var j,k=!0,l=bn(a);!(e=(j=yield bl(l.next())).done);k=!0){if(h=j.value,k=!1,function(a){var b;if(void 0==a.candidates||0===a.candidates.length)return!1;let c=null==(b=a.candidates[0])?void 0:b.content;return void 0!==c&&bo(c)}(h)){let a=null==(d=null==(c=h.candidates)?void 0:c[0])?void 0:d.content;void 0!==a&&i.push(a)}yield yield bl(h)}}catch(a){f={error:a}}finally{try{!k&&!e&&(g=l.return)&&(yield bl(g.call(l)))}finally{if(f)throw f.error}}this.recordHistory(b,i)})}recordHistory(a,b,c){let d=[];b.length>0&&b.every(a=>void 0!==a.role)?d=b:d.push({role:"model",parts:[]}),c&&c.length>0?this.history.push(...bp(c)):this.history.push(a),this.history.push(...d)}}class bs extends Error{constructor(a){super(a.message),this.name="ApiError",this.status=a.status,Object.setPrototypeOf(this,bs.prototype)}}function bt(a){let b={},c=ag(a,["name"]);null!=c&&af(b,["name"],c);let d=ag(a,["displayName"]);null!=d&&af(b,["displayName"],d);let e=ag(a,["mimeType"]);null!=e&&af(b,["mimeType"],e);let f=ag(a,["sizeBytes"]);null!=f&&af(b,["sizeBytes"],f);let g=ag(a,["createTime"]);null!=g&&af(b,["createTime"],g);let h=ag(a,["expirationTime"]);null!=h&&af(b,["expirationTime"],h);let i=ag(a,["updateTime"]);null!=i&&af(b,["updateTime"],i);let j=ag(a,["sha256Hash"]);null!=j&&af(b,["sha256Hash"],j);let k=ag(a,["uri"]);null!=k&&af(b,["uri"],k);let l=ag(a,["downloadUri"]);null!=l&&af(b,["downloadUri"],l);let m=ag(a,["state"]);null!=m&&af(b,["state"],m);let n=ag(a,["source"]);null!=n&&af(b,["source"],n);let o=ag(a,["videoMetadata"]);null!=o&&af(b,["videoMetadata"],o);let p=ag(a,["error"]);return null!=p&&af(b,["error"],function(a){let b={},c=ag(a,["details"]);null!=c&&af(b,["details"],c);let d=ag(a,["message"]);null!=d&&af(b,["message"],d);let e=ag(a,["code"]);return null!=e&&af(b,["code"],e),b}(p)),b}class bu extends ad{constructor(a){super(),this.apiClient=a,this.list=async(a={})=>new be(Z.PAGED_ITEM_FILES,a=>this.listInternal(a),await this.listInternal(a),a)}async upload(a){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(a.file,a.config).then(a=>bt(a))}async download(a){await this.apiClient.downloadFile(a)}async listInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=ag(a,["config"]);return null!=c&&function(a,b){let c=ag(a,["pageSize"]);void 0!==b&&null!=c&&af(b,["_query","pageSize"],c);let d=ag(a,["pageToken"]);void 0!==b&&null!=d&&af(b,["_query","pageToken"],d)}(c,b),b}(a);return d=ae("files",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["nextPageToken"]);null!=d&&af(b,["nextPageToken"],d);let e=ag(a,["files"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>bt(a))),af(b,["files"],a)}return b}(a),c=new ay;return Object.assign(c,b),c})}}async createInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=ag(a,["file"]);return null!=c&&af(b,["file"],function(a){let b={},c=ag(a,["name"]);null!=c&&af(b,["name"],c);let d=ag(a,["displayName"]);null!=d&&af(b,["displayName"],d);let e=ag(a,["mimeType"]);null!=e&&af(b,["mimeType"],e);let f=ag(a,["sizeBytes"]);null!=f&&af(b,["sizeBytes"],f);let g=ag(a,["createTime"]);null!=g&&af(b,["createTime"],g);let h=ag(a,["expirationTime"]);null!=h&&af(b,["expirationTime"],h);let i=ag(a,["updateTime"]);null!=i&&af(b,["updateTime"],i);let j=ag(a,["sha256Hash"]);null!=j&&af(b,["sha256Hash"],j);let k=ag(a,["uri"]);null!=k&&af(b,["uri"],k);let l=ag(a,["downloadUri"]);null!=l&&af(b,["downloadUri"],l);let m=ag(a,["state"]);null!=m&&af(b,["state"],m);let n=ag(a,["source"]);null!=n&&af(b,["source"],n);let o=ag(a,["videoMetadata"]);null!=o&&af(b,["videoMetadata"],o);let p=ag(a,["error"]);return null!=p&&af(b,["error"],function(a){let b={},c=ag(a,["details"]);null!=c&&af(b,["details"],c);let d=ag(a,["message"]);null!=d&&af(b,["message"],d);let e=ag(a,["code"]);return null!=e&&af(b,["code"],e),b}(p)),b}(c)),b}(a);return d=ae("upload/v1beta/files",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);return null!=c&&af(b,["sdkHttpResponse"],c),b}(a),c=new az;return Object.assign(c,b),c})}}async get(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=ag(a,["name"]);return null!=c&&af(b,["_url","file"],a_(c)),b}(a);return d=ae("files/{file}",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>bt(a))}}async delete(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=ag(a,["name"]);return null!=c&&af(b,["_url","file"],a_(c)),b}(a);return d=ae("files/{file}",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);return null!=c&&af(b,["sdkHttpResponse"],c),b}(a),c=new aA;return Object.assign(c,b),c})}}}function bv(a){let b={},c=ag(a,["id"]);null!=c&&af(b,["id"],c);let d=ag(a,["args"]);null!=d&&af(b,["args"],d);let e=ag(a,["name"]);return null!=e&&af(b,["name"],e),b}function bw(a){let b={},c=ag(a,["id"]);null!=c&&af(b,["id"],c);let d=ag(a,["args"]);null!=d&&af(b,["args"],d);let e=ag(a,["name"]);return null!=e&&af(b,["name"],e),b}function bx(a){let b={},c=ag(a,["weightedPrompts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>bG(a))),af(b,["weightedPrompts"],a)}return b}function by(a){let b={},c=ag(a,["setup"]);null!=c&&af(b,["setup"],bz(c));let d=ag(a,["clientContent"]);null!=d&&af(b,["clientContent"],bx(d));let e=ag(a,["musicGenerationConfig"]);null!=e&&af(b,["musicGenerationConfig"],bA(e));let f=ag(a,["playbackControl"]);return null!=f&&af(b,["playbackControl"],f),b}function bz(a){let b={},c=ag(a,["model"]);return null!=c&&af(b,["model"],c),b}function bA(a){let b={},c=ag(a,["temperature"]);null!=c&&af(b,["temperature"],c);let d=ag(a,["topK"]);null!=d&&af(b,["topK"],d);let e=ag(a,["seed"]);null!=e&&af(b,["seed"],e);let f=ag(a,["guidance"]);null!=f&&af(b,["guidance"],f);let g=ag(a,["bpm"]);null!=g&&af(b,["bpm"],g);let h=ag(a,["density"]);null!=h&&af(b,["density"],h);let i=ag(a,["brightness"]);null!=i&&af(b,["brightness"],i);let j=ag(a,["scale"]);null!=j&&af(b,["scale"],j);let k=ag(a,["muteBass"]);null!=k&&af(b,["muteBass"],k);let l=ag(a,["muteDrums"]);null!=l&&af(b,["muteDrums"],l);let m=ag(a,["onlyBassAndDrums"]);null!=m&&af(b,["onlyBassAndDrums"],m);let n=ag(a,["musicGenerationMode"]);return null!=n&&af(b,["musicGenerationMode"],n),b}function bB(a){let b={},c=ag(a,["modality"]);null!=c&&af(b,["modality"],c);let d=ag(a,["tokenCount"]);return null!=d&&af(b,["tokenCount"],d),b}function bC(a){let b={},c=ag(a,["modality"]);null!=c&&af(b,["modality"],c);let d=ag(a,["tokenCount"]);return null!=d&&af(b,["tokenCount"],d),b}function bD(a){let b={},c=ag(a,["text"]);null!=c&&af(b,["text"],c);let d=ag(a,["finished"]);return null!=d&&af(b,["finished"],d),b}function bE(a){let b={},c=ag(a,["text"]);null!=c&&af(b,["text"],c);let d=ag(a,["finished"]);return null!=d&&af(b,["finished"],d),b}function bF(a){let b={},c=ag(a,["prebuiltVoiceConfig"]);return null!=c&&af(b,["prebuiltVoiceConfig"],function(a){let b={},c=ag(a,["voiceName"]);return null!=c&&af(b,["voiceName"],c),b}(c)),b}function bG(a){let b={},c=ag(a,["text"]);null!=c&&af(b,["text"],c);let d=ag(a,["weight"]);return null!=d&&af(b,["weight"],d),b}function bH(a){let b={},c=ag(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["videoMetadata"]);null!=c&&af(b,["videoMetadata"],function(a){let b={},c=ag(a,["fps"]);null!=c&&af(b,["fps"],c);let d=ag(a,["endOffset"]);null!=d&&af(b,["endOffset"],d);let e=ag(a,["startOffset"]);return null!=e&&af(b,["startOffset"],e),b}(c));let d=ag(a,["thought"]);null!=d&&af(b,["thought"],d);let e=ag(a,["inlineData"]);null!=e&&af(b,["inlineData"],function(a){let b={};if(void 0!==ag(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=ag(a,["data"]);null!=c&&af(b,["data"],c);let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(e));let f=ag(a,["fileData"]);null!=f&&af(b,["fileData"],function(a){let b={};if(void 0!==ag(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=ag(a,["fileUri"]);null!=c&&af(b,["fileUri"],c);let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(f));let g=ag(a,["thoughtSignature"]);null!=g&&af(b,["thoughtSignature"],g);let h=ag(a,["functionCall"]);null!=h&&af(b,["functionCall"],function(a){let b={},c=ag(a,["id"]);null!=c&&af(b,["id"],c);let d=ag(a,["args"]);null!=d&&af(b,["args"],d);let e=ag(a,["name"]);return null!=e&&af(b,["name"],e),b}(h));let i=ag(a,["codeExecutionResult"]);null!=i&&af(b,["codeExecutionResult"],i);let j=ag(a,["executableCode"]);null!=j&&af(b,["executableCode"],j);let k=ag(a,["functionResponse"]);null!=k&&af(b,["functionResponse"],k);let l=ag(a,["text"]);return null!=l&&af(b,["text"],l),b})(a))),af(b,["parts"],a)}let d=ag(a,["role"]);return null!=d&&af(b,["role"],d),b}function bI(a){let b={},c=ag(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["videoMetadata"]);null!=c&&af(b,["videoMetadata"],function(a){let b={},c=ag(a,["fps"]);null!=c&&af(b,["fps"],c);let d=ag(a,["endOffset"]);null!=d&&af(b,["endOffset"],d);let e=ag(a,["startOffset"]);return null!=e&&af(b,["startOffset"],e),b}(c));let d=ag(a,["thought"]);null!=d&&af(b,["thought"],d);let e=ag(a,["inlineData"]);null!=e&&af(b,["inlineData"],function(a){let b={},c=ag(a,["displayName"]);null!=c&&af(b,["displayName"],c);let d=ag(a,["data"]);null!=d&&af(b,["data"],d);let e=ag(a,["mimeType"]);return null!=e&&af(b,["mimeType"],e),b}(e));let f=ag(a,["fileData"]);null!=f&&af(b,["fileData"],function(a){let b={},c=ag(a,["displayName"]);null!=c&&af(b,["displayName"],c);let d=ag(a,["fileUri"]);null!=d&&af(b,["fileUri"],d);let e=ag(a,["mimeType"]);return null!=e&&af(b,["mimeType"],e),b}(f));let g=ag(a,["thoughtSignature"]);null!=g&&af(b,["thoughtSignature"],g);let h=ag(a,["functionCall"]);null!=h&&af(b,["functionCall"],function(a){let b={},c=ag(a,["id"]);null!=c&&af(b,["id"],c);let d=ag(a,["args"]);null!=d&&af(b,["args"],d);let e=ag(a,["name"]);return null!=e&&af(b,["name"],e),b}(h));let i=ag(a,["codeExecutionResult"]);null!=i&&af(b,["codeExecutionResult"],i);let j=ag(a,["executableCode"]);null!=j&&af(b,["executableCode"],j);let k=ag(a,["functionResponse"]);null!=k&&af(b,["functionResponse"],k);let l=ag(a,["text"]);return null!=l&&af(b,["text"],l),b})(a))),af(b,["parts"],a)}let d=ag(a,["role"]);return null!=d&&af(b,["role"],d),b}function bJ(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["contents"]);if(null!=e){let a=aR(e);Array.isArray(a)&&(a=a.map(a=>bH(a))),af(c,["contents"],a)}let f=ag(b,["config"]);return null!=f&&af(c,["generationConfig"],function(a,b,c){let d={},e=ag(b,["systemInstruction"]);void 0!==c&&null!=e&&af(c,["systemInstruction"],bH(aP(e)));let f=ag(b,["temperature"]);null!=f&&af(d,["temperature"],f);let g=ag(b,["topP"]);null!=g&&af(d,["topP"],g);let h=ag(b,["topK"]);null!=h&&af(d,["topK"],h);let i=ag(b,["candidateCount"]);null!=i&&af(d,["candidateCount"],i);let j=ag(b,["maxOutputTokens"]);null!=j&&af(d,["maxOutputTokens"],j);let k=ag(b,["stopSequences"]);null!=k&&af(d,["stopSequences"],k);let l=ag(b,["responseLogprobs"]);null!=l&&af(d,["responseLogprobs"],l);let m=ag(b,["logprobs"]);null!=m&&af(d,["logprobs"],m);let n=ag(b,["presencePenalty"]);null!=n&&af(d,["presencePenalty"],n);let o=ag(b,["frequencyPenalty"]);null!=o&&af(d,["frequencyPenalty"],o);let p=ag(b,["seed"]);null!=p&&af(d,["seed"],p);let q=ag(b,["responseMimeType"]);null!=q&&af(d,["responseMimeType"],q);let r=ag(b,["responseSchema"]);null!=r&&af(d,["responseSchema"],function(a){let b={},c=ag(a,["anyOf"]);null!=c&&af(b,["anyOf"],c);let d=ag(a,["default"]);null!=d&&af(b,["default"],d);let e=ag(a,["description"]);null!=e&&af(b,["description"],e);let f=ag(a,["enum"]);null!=f&&af(b,["enum"],f);let g=ag(a,["example"]);null!=g&&af(b,["example"],g);let h=ag(a,["format"]);null!=h&&af(b,["format"],h);let i=ag(a,["items"]);null!=i&&af(b,["items"],i);let j=ag(a,["maxItems"]);null!=j&&af(b,["maxItems"],j);let k=ag(a,["maxLength"]);null!=k&&af(b,["maxLength"],k);let l=ag(a,["maxProperties"]);null!=l&&af(b,["maxProperties"],l);let m=ag(a,["maximum"]);null!=m&&af(b,["maximum"],m);let n=ag(a,["minItems"]);null!=n&&af(b,["minItems"],n);let o=ag(a,["minLength"]);null!=o&&af(b,["minLength"],o);let p=ag(a,["minProperties"]);null!=p&&af(b,["minProperties"],p);let q=ag(a,["minimum"]);null!=q&&af(b,["minimum"],q);let r=ag(a,["nullable"]);null!=r&&af(b,["nullable"],r);let s=ag(a,["pattern"]);null!=s&&af(b,["pattern"],s);let t=ag(a,["properties"]);null!=t&&af(b,["properties"],t);let u=ag(a,["propertyOrdering"]);null!=u&&af(b,["propertyOrdering"],u);let v=ag(a,["required"]);null!=v&&af(b,["required"],v);let w=ag(a,["title"]);null!=w&&af(b,["title"],w);let x=ag(a,["type"]);return null!=x&&af(b,["type"],x),b}(aS(r)));let s=ag(b,["responseJsonSchema"]);if(null!=s&&af(d,["responseJsonSchema"],s),void 0!==ag(b,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==ag(b,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let t=ag(b,["safetySettings"]);if(void 0!==c&&null!=t){let a=t;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={};if(void 0!==ag(a,["method"]))throw Error("method parameter is not supported in Gemini API.");let c=ag(a,["category"]);null!=c&&af(b,["category"],c);let d=ag(a,["threshold"]);return null!=d&&af(b,["threshold"],d),b})(a))),af(c,["safetySettings"],a)}let u=ag(b,["tools"]);if(void 0!==c&&null!=u){let a=aW(u);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["behavior"]);null!=c&&af(b,["behavior"],c);let d=ag(a,["description"]);null!=d&&af(b,["description"],d);let e=ag(a,["name"]);null!=e&&af(b,["name"],e);let f=ag(a,["parameters"]);null!=f&&af(b,["parameters"],f);let g=ag(a,["parametersJsonSchema"]);null!=g&&af(b,["parametersJsonSchema"],g);let h=ag(a,["response"]);null!=h&&af(b,["response"],h);let i=ag(a,["responseJsonSchema"]);return null!=i&&af(b,["responseJsonSchema"],i),b})(a))),af(b,["functionDeclarations"],a)}if(void 0!==ag(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=ag(a,["googleSearch"]);null!=d&&af(b,["googleSearch"],function(a){let b={},c=ag(a,["timeRangeFilter"]);if(null!=c&&af(b,["timeRangeFilter"],function(a){let b={},c=ag(a,["startTime"]);null!=c&&af(b,["startTime"],c);let d=ag(a,["endTime"]);return null!=d&&af(b,["endTime"],d),b}(c)),void 0!==ag(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return b}(d));let e=ag(a,["googleSearchRetrieval"]);if(null!=e&&af(b,["googleSearchRetrieval"],function(a){let b={},c=ag(a,["dynamicRetrievalConfig"]);return null!=c&&af(b,["dynamicRetrievalConfig"],function(a){let b={},c=ag(a,["mode"]);null!=c&&af(b,["mode"],c);let d=ag(a,["dynamicThreshold"]);return null!=d&&af(b,["dynamicThreshold"],d),b}(c)),b}(e)),void 0!==ag(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==ag(a,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");null!=ag(a,["urlContext"])&&af(b,["urlContext"],{});let f=ag(a,["computerUse"]);null!=f&&af(b,["computerUse"],function(a){let b={},c=ag(a,["environment"]);null!=c&&af(b,["environment"],c);let d=ag(a,["excludedPredefinedFunctions"]);return null!=d&&af(b,["excludedPredefinedFunctions"],d),b}(f));let g=ag(a,["codeExecution"]);return null!=g&&af(b,["codeExecution"],g),b})(aV(a)))),af(c,["tools"],a)}let v=ag(b,["toolConfig"]);if(void 0!==c&&null!=v&&af(c,["toolConfig"],function(a){let b={},c=ag(a,["functionCallingConfig"]);null!=c&&af(b,["functionCallingConfig"],function(a){let b={},c=ag(a,["mode"]);null!=c&&af(b,["mode"],c);let d=ag(a,["allowedFunctionNames"]);return null!=d&&af(b,["allowedFunctionNames"],d),b}(c));let d=ag(a,["retrievalConfig"]);return null!=d&&af(b,["retrievalConfig"],function(a){let b={},c=ag(a,["latLng"]);null!=c&&af(b,["latLng"],function(a){let b={},c=ag(a,["latitude"]);null!=c&&af(b,["latitude"],c);let d=ag(a,["longitude"]);return null!=d&&af(b,["longitude"],d),b}(c));let d=ag(a,["languageCode"]);return null!=d&&af(b,["languageCode"],d),b}(d)),b}(v)),void 0!==ag(b,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let w=ag(b,["cachedContent"]);void 0!==c&&null!=w&&af(c,["cachedContent"],aX(a,w));let x=ag(b,["responseModalities"]);null!=x&&af(d,["responseModalities"],x);let y=ag(b,["mediaResolution"]);null!=y&&af(d,["mediaResolution"],y);let z=ag(b,["speechConfig"]);if(null!=z&&af(d,["speechConfig"],function(a){let b={},c=ag(a,["voiceConfig"]);null!=c&&af(b,["voiceConfig"],bX(c));let d=ag(a,["multiSpeakerVoiceConfig"]);null!=d&&af(b,["multiSpeakerVoiceConfig"],function(a){let b={},c=ag(a,["speakerVoiceConfigs"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["speaker"]);null!=c&&af(b,["speaker"],c);let d=ag(a,["voiceConfig"]);return null!=d&&af(b,["voiceConfig"],bX(d)),b})(a))),af(b,["speakerVoiceConfigs"],a)}return b}(d));let e=ag(a,["languageCode"]);return null!=e&&af(b,["languageCode"],e),b}(aT(z))),void 0!==ag(b,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let A=ag(b,["thinkingConfig"]);return null!=A&&af(d,["thinkingConfig"],function(a){let b={},c=ag(a,["includeThoughts"]);null!=c&&af(b,["includeThoughts"],c);let d=ag(a,["thinkingBudget"]);return null!=d&&af(b,["thinkingBudget"],d),b}(A)),d}(a,f,c)),c}function bK(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["contents"]);if(null!=e){let a=aR(e);Array.isArray(a)&&(a=a.map(a=>bI(a))),af(c,["contents"],a)}let f=ag(b,["config"]);return null!=f&&af(c,["generationConfig"],function(a,b,c){let d={},e=ag(b,["systemInstruction"]);void 0!==c&&null!=e&&af(c,["systemInstruction"],bI(aP(e)));let f=ag(b,["temperature"]);null!=f&&af(d,["temperature"],f);let g=ag(b,["topP"]);null!=g&&af(d,["topP"],g);let h=ag(b,["topK"]);null!=h&&af(d,["topK"],h);let i=ag(b,["candidateCount"]);null!=i&&af(d,["candidateCount"],i);let j=ag(b,["maxOutputTokens"]);null!=j&&af(d,["maxOutputTokens"],j);let k=ag(b,["stopSequences"]);null!=k&&af(d,["stopSequences"],k);let l=ag(b,["responseLogprobs"]);null!=l&&af(d,["responseLogprobs"],l);let m=ag(b,["logprobs"]);null!=m&&af(d,["logprobs"],m);let n=ag(b,["presencePenalty"]);null!=n&&af(d,["presencePenalty"],n);let o=ag(b,["frequencyPenalty"]);null!=o&&af(d,["frequencyPenalty"],o);let p=ag(b,["seed"]);null!=p&&af(d,["seed"],p);let q=ag(b,["responseMimeType"]);null!=q&&af(d,["responseMimeType"],q);let r=ag(b,["responseSchema"]);null!=r&&af(d,["responseSchema"],function(a){let b={},c=ag(a,["anyOf"]);null!=c&&af(b,["anyOf"],c);let d=ag(a,["default"]);null!=d&&af(b,["default"],d);let e=ag(a,["description"]);null!=e&&af(b,["description"],e);let f=ag(a,["enum"]);null!=f&&af(b,["enum"],f);let g=ag(a,["example"]);null!=g&&af(b,["example"],g);let h=ag(a,["format"]);null!=h&&af(b,["format"],h);let i=ag(a,["items"]);null!=i&&af(b,["items"],i);let j=ag(a,["maxItems"]);null!=j&&af(b,["maxItems"],j);let k=ag(a,["maxLength"]);null!=k&&af(b,["maxLength"],k);let l=ag(a,["maxProperties"]);null!=l&&af(b,["maxProperties"],l);let m=ag(a,["maximum"]);null!=m&&af(b,["maximum"],m);let n=ag(a,["minItems"]);null!=n&&af(b,["minItems"],n);let o=ag(a,["minLength"]);null!=o&&af(b,["minLength"],o);let p=ag(a,["minProperties"]);null!=p&&af(b,["minProperties"],p);let q=ag(a,["minimum"]);null!=q&&af(b,["minimum"],q);let r=ag(a,["nullable"]);null!=r&&af(b,["nullable"],r);let s=ag(a,["pattern"]);null!=s&&af(b,["pattern"],s);let t=ag(a,["properties"]);null!=t&&af(b,["properties"],t);let u=ag(a,["propertyOrdering"]);null!=u&&af(b,["propertyOrdering"],u);let v=ag(a,["required"]);null!=v&&af(b,["required"],v);let w=ag(a,["title"]);null!=w&&af(b,["title"],w);let x=ag(a,["type"]);return null!=x&&af(b,["type"],x),b}(aS(r)));let s=ag(b,["responseJsonSchema"]);null!=s&&af(d,["responseJsonSchema"],s);let t=ag(b,["routingConfig"]);null!=t&&af(d,["routingConfig"],t);let u=ag(b,["modelSelectionConfig"]);null!=u&&af(d,["modelConfig"],function(a){let b={},c=ag(a,["featureSelectionPreference"]);return null!=c&&af(b,["featureSelectionPreference"],c),b}(u));let v=ag(b,["safetySettings"]);if(void 0!==c&&null!=v){let a=v;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["method"]);null!=c&&af(b,["method"],c);let d=ag(a,["category"]);null!=d&&af(b,["category"],d);let e=ag(a,["threshold"]);return null!=e&&af(b,["threshold"],e),b})(a))),af(c,["safetySettings"],a)}let w=ag(b,["tools"]);if(void 0!==c&&null!=w){let a=aW(w);Array.isArray(a)&&(a=a.map(a=>bV(aV(a)))),af(c,["tools"],a)}let x=ag(b,["toolConfig"]);void 0!==c&&null!=x&&af(c,["toolConfig"],function(a){let b={},c=ag(a,["functionCallingConfig"]);null!=c&&af(b,["functionCallingConfig"],function(a){let b={},c=ag(a,["mode"]);null!=c&&af(b,["mode"],c);let d=ag(a,["allowedFunctionNames"]);return null!=d&&af(b,["allowedFunctionNames"],d),b}(c));let d=ag(a,["retrievalConfig"]);return null!=d&&af(b,["retrievalConfig"],function(a){let b={},c=ag(a,["latLng"]);null!=c&&af(b,["latLng"],function(a){let b={},c=ag(a,["latitude"]);null!=c&&af(b,["latitude"],c);let d=ag(a,["longitude"]);return null!=d&&af(b,["longitude"],d),b}(c));let d=ag(a,["languageCode"]);return null!=d&&af(b,["languageCode"],d),b}(d)),b}(x));let y=ag(b,["labels"]);void 0!==c&&null!=y&&af(c,["labels"],y);let z=ag(b,["cachedContent"]);void 0!==c&&null!=z&&af(c,["cachedContent"],aX(a,z));let A=ag(b,["responseModalities"]);null!=A&&af(d,["responseModalities"],A);let B=ag(b,["mediaResolution"]);null!=B&&af(d,["mediaResolution"],B);let C=ag(b,["speechConfig"]);null!=C&&af(d,["speechConfig"],function(a){let b={},c=ag(a,["voiceConfig"]);if(null!=c&&af(b,["voiceConfig"],function(a){let b={},c=ag(a,["prebuiltVoiceConfig"]);return null!=c&&af(b,["prebuiltVoiceConfig"],function(a){let b={},c=ag(a,["voiceName"]);return null!=c&&af(b,["voiceName"],c),b}(c)),b}(c)),void 0!==ag(a,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");let d=ag(a,["languageCode"]);return null!=d&&af(b,["languageCode"],d),b}(aT(C)));let D=ag(b,["audioTimestamp"]);null!=D&&af(d,["audioTimestamp"],D);let E=ag(b,["thinkingConfig"]);return null!=E&&af(d,["thinkingConfig"],function(a){let b={},c=ag(a,["includeThoughts"]);null!=c&&af(b,["includeThoughts"],c);let d=ag(a,["thinkingBudget"]);return null!=d&&af(b,["thinkingBudget"],d),b}(E)),d}(a,f,c)),c}function bL(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["candidates"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["content"]);null!=c&&af(b,["content"],function(a){let b={},c=ag(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["videoMetadata"]);null!=c&&af(b,["videoMetadata"],function(a){let b={},c=ag(a,["fps"]);null!=c&&af(b,["fps"],c);let d=ag(a,["endOffset"]);null!=d&&af(b,["endOffset"],d);let e=ag(a,["startOffset"]);return null!=e&&af(b,["startOffset"],e),b}(c));let d=ag(a,["thought"]);null!=d&&af(b,["thought"],d);let e=ag(a,["inlineData"]);null!=e&&af(b,["inlineData"],function(a){let b={},c=ag(a,["data"]);null!=c&&af(b,["data"],c);let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(e));let f=ag(a,["fileData"]);null!=f&&af(b,["fileData"],function(a){let b={},c=ag(a,["fileUri"]);null!=c&&af(b,["fileUri"],c);let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(f));let g=ag(a,["thoughtSignature"]);null!=g&&af(b,["thoughtSignature"],g);let h=ag(a,["functionCall"]);null!=h&&af(b,["functionCall"],function(a){let b={},c=ag(a,["id"]);null!=c&&af(b,["id"],c);let d=ag(a,["args"]);null!=d&&af(b,["args"],d);let e=ag(a,["name"]);return null!=e&&af(b,["name"],e),b}(h));let i=ag(a,["codeExecutionResult"]);null!=i&&af(b,["codeExecutionResult"],i);let j=ag(a,["executableCode"]);null!=j&&af(b,["executableCode"],j);let k=ag(a,["functionResponse"]);null!=k&&af(b,["functionResponse"],k);let l=ag(a,["text"]);return null!=l&&af(b,["text"],l),b})(a))),af(b,["parts"],a)}let d=ag(a,["role"]);return null!=d&&af(b,["role"],d),b}(c));let d=ag(a,["citationMetadata"]);null!=d&&af(b,["citationMetadata"],function(a){let b={},c=ag(a,["citationSources"]);return null!=c&&af(b,["citations"],c),b}(d));let e=ag(a,["tokenCount"]);null!=e&&af(b,["tokenCount"],e);let f=ag(a,["finishReason"]);null!=f&&af(b,["finishReason"],f);let g=ag(a,["urlContextMetadata"]);null!=g&&af(b,["urlContextMetadata"],function(a){let b={},c=ag(a,["urlMetadata"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["retrievedUrl"]);null!=c&&af(b,["retrievedUrl"],c);let d=ag(a,["urlRetrievalStatus"]);return null!=d&&af(b,["urlRetrievalStatus"],d),b})(a))),af(b,["urlMetadata"],a)}return b}(g));let h=ag(a,["avgLogprobs"]);null!=h&&af(b,["avgLogprobs"],h);let i=ag(a,["groundingMetadata"]);null!=i&&af(b,["groundingMetadata"],i);let j=ag(a,["index"]);null!=j&&af(b,["index"],j);let k=ag(a,["logprobsResult"]);null!=k&&af(b,["logprobsResult"],k);let l=ag(a,["safetyRatings"]);return null!=l&&af(b,["safetyRatings"],l),b})(a))),af(b,["candidates"],a)}let e=ag(a,["modelVersion"]);null!=e&&af(b,["modelVersion"],e);let f=ag(a,["promptFeedback"]);null!=f&&af(b,["promptFeedback"],f);let g=ag(a,["responseId"]);null!=g&&af(b,["responseId"],g);let h=ag(a,["usageMetadata"]);return null!=h&&af(b,["usageMetadata"],h),b}function bM(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["candidates"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["content"]);null!=c&&af(b,["content"],function(a){let b={},c=ag(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["videoMetadata"]);null!=c&&af(b,["videoMetadata"],function(a){let b={},c=ag(a,["fps"]);null!=c&&af(b,["fps"],c);let d=ag(a,["endOffset"]);null!=d&&af(b,["endOffset"],d);let e=ag(a,["startOffset"]);return null!=e&&af(b,["startOffset"],e),b}(c));let d=ag(a,["thought"]);null!=d&&af(b,["thought"],d);let e=ag(a,["inlineData"]);null!=e&&af(b,["inlineData"],function(a){let b={},c=ag(a,["displayName"]);null!=c&&af(b,["displayName"],c);let d=ag(a,["data"]);null!=d&&af(b,["data"],d);let e=ag(a,["mimeType"]);return null!=e&&af(b,["mimeType"],e),b}(e));let f=ag(a,["fileData"]);null!=f&&af(b,["fileData"],function(a){let b={},c=ag(a,["displayName"]);null!=c&&af(b,["displayName"],c);let d=ag(a,["fileUri"]);null!=d&&af(b,["fileUri"],d);let e=ag(a,["mimeType"]);return null!=e&&af(b,["mimeType"],e),b}(f));let g=ag(a,["thoughtSignature"]);null!=g&&af(b,["thoughtSignature"],g);let h=ag(a,["functionCall"]);null!=h&&af(b,["functionCall"],function(a){let b={},c=ag(a,["id"]);null!=c&&af(b,["id"],c);let d=ag(a,["args"]);null!=d&&af(b,["args"],d);let e=ag(a,["name"]);return null!=e&&af(b,["name"],e),b}(h));let i=ag(a,["codeExecutionResult"]);null!=i&&af(b,["codeExecutionResult"],i);let j=ag(a,["executableCode"]);null!=j&&af(b,["executableCode"],j);let k=ag(a,["functionResponse"]);null!=k&&af(b,["functionResponse"],k);let l=ag(a,["text"]);return null!=l&&af(b,["text"],l),b})(a))),af(b,["parts"],a)}let d=ag(a,["role"]);return null!=d&&af(b,["role"],d),b}(c));let d=ag(a,["citationMetadata"]);null!=d&&af(b,["citationMetadata"],function(a){let b={},c=ag(a,["citations"]);return null!=c&&af(b,["citations"],c),b}(d));let e=ag(a,["finishMessage"]);null!=e&&af(b,["finishMessage"],e);let f=ag(a,["finishReason"]);null!=f&&af(b,["finishReason"],f);let g=ag(a,["urlContextMetadata"]);null!=g&&af(b,["urlContextMetadata"],function(a){let b={},c=ag(a,["urlMetadata"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["retrievedUrl"]);null!=c&&af(b,["retrievedUrl"],c);let d=ag(a,["urlRetrievalStatus"]);return null!=d&&af(b,["urlRetrievalStatus"],d),b})(a))),af(b,["urlMetadata"],a)}return b}(g));let h=ag(a,["avgLogprobs"]);null!=h&&af(b,["avgLogprobs"],h);let i=ag(a,["groundingMetadata"]);null!=i&&af(b,["groundingMetadata"],i);let j=ag(a,["index"]);null!=j&&af(b,["index"],j);let k=ag(a,["logprobsResult"]);null!=k&&af(b,["logprobsResult"],k);let l=ag(a,["safetyRatings"]);return null!=l&&af(b,["safetyRatings"],l),b})(a))),af(b,["candidates"],a)}let e=ag(a,["createTime"]);null!=e&&af(b,["createTime"],e);let f=ag(a,["modelVersion"]);null!=f&&af(b,["modelVersion"],f);let g=ag(a,["promptFeedback"]);null!=g&&af(b,["promptFeedback"],g);let h=ag(a,["responseId"]);null!=h&&af(b,["responseId"],h);let i=ag(a,["usageMetadata"]);return null!=i&&af(b,["usageMetadata"],i),b}function bN(a){let b={},c=ag(a,["_self"]);null!=c&&af(b,["image"],bO(c));let d=ag(a,["raiFilteredReason"]);null!=d&&af(b,["raiFilteredReason"],d);let e=ag(a,["_self"]);null!=e&&af(b,["safetyAttributes"],bU(e));let f=ag(a,["prompt"]);return null!=f&&af(b,["enhancedPrompt"],f),b}function bO(a){let b={},c=ag(a,["gcsUri"]);null!=c&&af(b,["gcsUri"],c);let d=ag(a,["bytesBase64Encoded"]);null!=d&&af(b,["imageBytes"],ah(d));let e=ag(a,["mimeType"]);return null!=e&&af(b,["mimeType"],e),b}function bP(a){let b={};if(void 0!==ag(a,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");let c=ag(a,["imageBytes"]);null!=c&&af(b,["bytesBase64Encoded"],ah(c));let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}function bQ(a){let b={},c=ag(a,["gcsUri"]);null!=c&&af(b,["gcsUri"],c);let d=ag(a,["imageBytes"]);null!=d&&af(b,["bytesBase64Encoded"],ah(d));let e=ag(a,["mimeType"]);return null!=e&&af(b,["mimeType"],e),b}function bR(a){let b={},c=ag(a,["name"]);null!=c&&af(b,["name"],c);let d=ag(a,["displayName"]);null!=d&&af(b,["displayName"],d);let e=ag(a,["description"]);null!=e&&af(b,["description"],e);let f=ag(a,["version"]);null!=f&&af(b,["version"],f);let g=ag(a,["_self"]);null!=g&&af(b,["tunedModelInfo"],function(a){let b={},c=ag(a,["baseModel"]);null!=c&&af(b,["baseModel"],c);let d=ag(a,["createTime"]);null!=d&&af(b,["createTime"],d);let e=ag(a,["updateTime"]);return null!=e&&af(b,["updateTime"],e),b}(g));let h=ag(a,["inputTokenLimit"]);null!=h&&af(b,["inputTokenLimit"],h);let i=ag(a,["outputTokenLimit"]);null!=i&&af(b,["outputTokenLimit"],i);let j=ag(a,["supportedGenerationMethods"]);return null!=j&&af(b,["supportedActions"],j),b}function bS(a){let b={},c=ag(a,["name"]);null!=c&&af(b,["name"],c);let d=ag(a,["displayName"]);null!=d&&af(b,["displayName"],d);let e=ag(a,["description"]);null!=e&&af(b,["description"],e);let f=ag(a,["versionId"]);null!=f&&af(b,["version"],f);let g=ag(a,["deployedModels"]);if(null!=g){let a=g;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["endpoint"]);null!=c&&af(b,["name"],c);let d=ag(a,["deployedModelId"]);return null!=d&&af(b,["deployedModelId"],d),b})(a))),af(b,["endpoints"],a)}let h=ag(a,["labels"]);null!=h&&af(b,["labels"],h);let i=ag(a,["_self"]);null!=i&&af(b,["tunedModelInfo"],function(a){let b={},c=ag(a,["labels","google-vertex-llm-tuning-base-model-id"]);null!=c&&af(b,["baseModel"],c);let d=ag(a,["createTime"]);null!=d&&af(b,["createTime"],d);let e=ag(a,["updateTime"]);return null!=e&&af(b,["updateTime"],e),b}(i));let j=ag(a,["defaultCheckpointId"]);null!=j&&af(b,["defaultCheckpointId"],j);let k=ag(a,["checkpoints"]);if(null!=k){let a=k;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["checkpointId"]);null!=c&&af(b,["checkpointId"],c);let d=ag(a,["epoch"]);null!=d&&af(b,["epoch"],d);let e=ag(a,["step"]);return null!=e&&af(b,["step"],e),b})(a))),af(b,["checkpoints"],a)}return b}function bT(a){let b={},c=ag(a,["safetyAttributes","categories"]);null!=c&&af(b,["categories"],c);let d=ag(a,["safetyAttributes","scores"]);null!=d&&af(b,["scores"],d);let e=ag(a,["contentType"]);return null!=e&&af(b,["contentType"],e),b}function bU(a){let b={},c=ag(a,["safetyAttributes","categories"]);null!=c&&af(b,["categories"],c);let d=ag(a,["safetyAttributes","scores"]);null!=d&&af(b,["scores"],d);let e=ag(a,["contentType"]);return null!=e&&af(b,["contentType"],e),b}function bV(a){let b={},c=ag(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={};if(void 0!==ag(a,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let c=ag(a,["description"]);null!=c&&af(b,["description"],c);let d=ag(a,["name"]);null!=d&&af(b,["name"],d);let e=ag(a,["parameters"]);null!=e&&af(b,["parameters"],e);let f=ag(a,["parametersJsonSchema"]);null!=f&&af(b,["parametersJsonSchema"],f);let g=ag(a,["response"]);null!=g&&af(b,["response"],g);let h=ag(a,["responseJsonSchema"]);return null!=h&&af(b,["responseJsonSchema"],h),b})(a))),af(b,["functionDeclarations"],a)}let d=ag(a,["retrieval"]);null!=d&&af(b,["retrieval"],d);let e=ag(a,["googleSearch"]);null!=e&&af(b,["googleSearch"],function(a){let b={},c=ag(a,["timeRangeFilter"]);null!=c&&af(b,["timeRangeFilter"],function(a){let b={},c=ag(a,["startTime"]);null!=c&&af(b,["startTime"],c);let d=ag(a,["endTime"]);return null!=d&&af(b,["endTime"],d),b}(c));let d=ag(a,["excludeDomains"]);return null!=d&&af(b,["excludeDomains"],d),b}(e));let f=ag(a,["googleSearchRetrieval"]);null!=f&&af(b,["googleSearchRetrieval"],function(a){let b={},c=ag(a,["dynamicRetrievalConfig"]);return null!=c&&af(b,["dynamicRetrievalConfig"],function(a){let b={},c=ag(a,["mode"]);null!=c&&af(b,["mode"],c);let d=ag(a,["dynamicThreshold"]);return null!=d&&af(b,["dynamicThreshold"],d),b}(c)),b}(f));let g=ag(a,["enterpriseWebSearch"]);null!=g&&af(b,["enterpriseWebSearch"],function(a){let b={},c=ag(a,["excludeDomains"]);return null!=c&&af(b,["excludeDomains"],c),b}(g));let h=ag(a,["googleMaps"]);null!=h&&af(b,["googleMaps"],function(a){let b={},c=ag(a,["authConfig"]);return null!=c&&af(b,["authConfig"],function(a){let b={},c=ag(a,["apiKeyConfig"]);null!=c&&af(b,["apiKeyConfig"],function(a){let b={},c=ag(a,["apiKeyString"]);return null!=c&&af(b,["apiKeyString"],c),b}(c));let d=ag(a,["authType"]);null!=d&&af(b,["authType"],d);let e=ag(a,["googleServiceAccountConfig"]);null!=e&&af(b,["googleServiceAccountConfig"],e);let f=ag(a,["httpBasicAuthConfig"]);null!=f&&af(b,["httpBasicAuthConfig"],f);let g=ag(a,["oauthConfig"]);null!=g&&af(b,["oauthConfig"],g);let h=ag(a,["oidcConfig"]);return null!=h&&af(b,["oidcConfig"],h),b}(c)),b}(h)),null!=ag(a,["urlContext"])&&af(b,["urlContext"],{});let i=ag(a,["computerUse"]);null!=i&&af(b,["computerUse"],function(a){let b={},c=ag(a,["environment"]);null!=c&&af(b,["environment"],c);let d=ag(a,["excludedPredefinedFunctions"]);return null!=d&&af(b,["excludedPredefinedFunctions"],d),b}(i));let j=ag(a,["codeExecution"]);return null!=j&&af(b,["codeExecution"],j),b}function bW(a){let b={},c=ag(a,["uri"]);null!=c&&af(b,["gcsUri"],c);let d=ag(a,["videoBytes"]);null!=d&&af(b,["bytesBase64Encoded"],ah(d));let e=ag(a,["mimeType"]);return null!=e&&af(b,["mimeType"],e),b}function bX(a){let b={},c=ag(a,["prebuiltVoiceConfig"]);return null!=c&&af(b,["prebuiltVoiceConfig"],function(a){let b={},c=ag(a,["voiceName"]);return null!=c&&af(b,["voiceName"],c),b}(c)),b}let bY="x-goog-api-client",bZ=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class b${constructor(a){var b,c;this.clientOptions=Object.assign(Object.assign({},a),{project:a.project,location:a.location,apiKey:a.apiKey,vertexai:a.vertexai});let d={};this.clientOptions.vertexai?(d.apiVersion=null!=(b=this.clientOptions.apiVersion)?b:"v1beta1",d.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(d.apiVersion=null!=(c=this.clientOptions.apiVersion)?c:"v1beta",d.baseUrl="https://generativelanguage.googleapis.com/"),d.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=d,a.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(d,a.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var a;return null!=(a=this.clientOptions.vertexai)&&a}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw Error("Headers are not set.")}getRequestUrlInternal(a){if(!a||void 0===a.baseUrl||void 0===a.apiVersion)throw Error("HTTP options are not correctly set.");let b=[a.baseUrl.endsWith("/")?a.baseUrl.slice(0,-1):a.baseUrl];return a.apiVersion&&""!==a.apiVersion&&b.push(a.apiVersion),b.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let a=new URL(this.getBaseUrl());return a.protocol="http:"==a.protocol?"ws":"wss",a.toString()}setBaseUrl(a){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=a;else throw Error("HTTP options are not correctly set.")}constructUrl(a,b,c){let d=[this.getRequestUrlInternal(b)];return c&&d.push(this.getBaseResourcePath()),""!==a&&d.push(a),new URL(`${d.join("/")}`)}shouldPrependVertexProjectPath(a){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||a.path.startsWith("projects/")||"GET"===a.httpMethod&&a.path.startsWith("publishers/google/models"))}async request(a){let b=this.clientOptions.httpOptions;a.httpOptions&&(b=this.patchHttpOptions(this.clientOptions.httpOptions,a.httpOptions));let c=this.shouldPrependVertexProjectPath(a),d=this.constructUrl(a.path,b,c);if(a.queryParams)for(let[b,c]of Object.entries(a.queryParams))d.searchParams.append(b,String(c));let e={};if("GET"===a.httpMethod){if(a.body&&"{}"!==a.body)throw Error("Request body should be empty for GET request, but got non empty request body")}else e.body=a.body;return e=await this.includeExtraHttpOptionsToRequestInit(e,b,a.abortSignal),this.unaryApiCall(d,e,a.httpMethod)}patchHttpOptions(a,b){let c=JSON.parse(JSON.stringify(a));for(let[a,d]of Object.entries(b))"object"==typeof d?c[a]=Object.assign(Object.assign({},c[a]),d):void 0!==d&&(c[a]=d);return c}async requestStream(a){let b=this.clientOptions.httpOptions;a.httpOptions&&(b=this.patchHttpOptions(this.clientOptions.httpOptions,a.httpOptions));let c=this.shouldPrependVertexProjectPath(a),d=this.constructUrl(a.path,b,c);d.searchParams.has("alt")&&"sse"===d.searchParams.get("alt")||d.searchParams.set("alt","sse");let e={};return e.body=a.body,e=await this.includeExtraHttpOptionsToRequestInit(e,b,a.abortSignal),this.streamApiCall(d,e,a.httpMethod)}async includeExtraHttpOptionsToRequestInit(a,b,c){if(b&&b.timeout||c){let d=new AbortController,e=d.signal;if(b.timeout&&(null==b?void 0:b.timeout)>0){let a=setTimeout(()=>d.abort(),b.timeout);a&&"function"==typeof a.unref&&a.unref()}c&&c.addEventListener("abort",()=>{d.abort()}),a.signal=e}return b&&null!==b.extraBody&&function(a,b){if(!b||0===Object.keys(b).length)return;if(a.body instanceof Blob)return console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");let c={};if("string"==typeof a.body&&a.body.length>0)try{let b=JSON.parse(a.body);if("object"!=typeof b||null===b||Array.isArray(b))return void console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");c=b}catch(a){console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}a.body=JSON.stringify(function a(b,c){let d=Object.assign({},b);for(let b in c)if(Object.prototype.hasOwnProperty.call(c,b)){let e=c[b],f=d[b];e&&"object"==typeof e&&!Array.isArray(e)&&f&&"object"==typeof f&&!Array.isArray(f)?d[b]=a(f,e):(f&&e&&typeof f!=typeof e&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${b}". Original type: ${typeof f}, New type: ${typeof e}. Overwriting.`),d[b]=e)}return d}(c,b))}(a,b.extraBody),a.headers=await this.getHeadersInternal(b),a}async unaryApiCall(a,b,c){return this.apiCall(a.toString(),Object.assign(Object.assign({},b),{method:c})).then(async a=>(await b_(a),new ai(a))).catch(a=>{if(a instanceof Error)throw a;throw Error(JSON.stringify(a))})}async streamApiCall(a,b,c){return this.apiCall(a.toString(),Object.assign(Object.assign({},b),{method:c})).then(async a=>(await b_(a),this.processStreamResponse(a))).catch(a=>{if(a instanceof Error)throw a;throw Error(JSON.stringify(a))})}processStreamResponse(a){var b;return bm(this,arguments,function*(){let c=null==(b=null==a?void 0:a.body)?void 0:b.getReader(),d=new TextDecoder("utf-8");if(!c)throw Error("Response body is empty");try{let b="";for(;;){let{done:e,value:f}=yield bl(c.read());if(e){if(b.trim().length>0)throw Error("Incomplete JSON segment at the end");break}let g=d.decode(f,{stream:!0});try{let a=JSON.parse(g);if("error"in a){let b=JSON.parse(JSON.stringify(a.error)),c=b.status,d=b.code,e=`got status: ${c}. ${JSON.stringify(a)}`;if(d>=400&&d<600)throw new bs({message:e,status:d})}}catch(a){if("ApiError"===a.name)throw a}let h=(b+=g).match(bZ);for(;h;){let c=h[1];try{let d=new Response(c,{headers:null==a?void 0:a.headers,status:null==a?void 0:a.status,statusText:null==a?void 0:a.statusText});yield yield bl(new ai(d)),h=(b=b.slice(h[0].length)).match(bZ)}catch(a){throw Error(`exception parsing stream chunk ${c}. ${a}`)}}}}finally{c.releaseLock()}})}async apiCall(a,b){return fetch(a,b).catch(a=>{throw Error(`exception ${a} sending request`)})}getDefaultHeaders(){let a={},b="google-genai-sdk/1.21.0 "+this.clientOptions.userAgentExtra;return a["User-Agent"]=b,a[bY]=b,a["Content-Type"]="application/json",a}async getHeadersInternal(a){let b=new Headers;if(a&&a.headers){for(let[c,d]of Object.entries(a.headers))b.append(c,d);a.timeout&&a.timeout>0&&b.append("X-Server-Timeout",String(Math.ceil(a.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(b),b}async uploadFile(a,b){var c;let d={};null!=b&&(d.mimeType=b.mimeType,d.name=b.name,d.displayName=b.displayName),d.name&&!d.name.startsWith("files/")&&(d.name=`files/${d.name}`);let e=this.clientOptions.uploader,f=await e.stat(a);d.sizeBytes=String(f.size);let g=null!=(c=null==b?void 0:b.mimeType)?c:f.type;if(void 0===g||""===g)throw Error("Can not determine mimeType. Please provide mimeType in the config.");d.mimeType=g;let h=await this.fetchUploadUrl(d,b);return e.upload(a,h,this)}async downloadFile(a){let b=this.clientOptions.downloader;await b.download(a,this)}async fetchUploadUrl(a,b){var c;let d={};d=(null==b?void 0:b.httpOptions)?b.httpOptions:{apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${a.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${a.mimeType}`}};let e={file:a},f=await this.request({path:ae("upload/v1beta/files",e._url),body:JSON.stringify(e),httpMethod:"POST",httpOptions:d});if(!f||!(null==f?void 0:f.headers))throw Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let g=null==(c=null==f?void 0:f.headers)?void 0:c["x-goog-upload-url"];if(void 0===g)throw Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return g}}async function b_(a){var b;if(void 0===a)throw Error("response is undefined");if(!a.ok){let c=a.status,d=JSON.stringify((null==(b=a.headers.get("content-type"))?void 0:b.includes("application/json"))?await a.json():{error:{message:await a.text(),code:a.status,status:a.statusText}});if(c>=400&&c<600)throw new bs({message:d,status:c});throw Error(d)}}function b0(a){for(let c of a){var b;if(null!==(b=c)&&"object"==typeof b&&b instanceof b2||"object"==typeof c&&"inputSchema"in c)return!0}return!1}function b1(a){var b;let c=null!=(b=a[bY])?b:"";a[bY]=(c+" mcp_used/unknown").trimStart()}class b2{constructor(a=[],b){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=a,this.config=b}static create(a,b){return new b2(a,b)}async initialize(){var a,b,c,d;if(this.mcpTools.length>0)return;let e={},f=[];for(let j of this.mcpClients)try{for(var g,h=!0,i=(b=void 0,bn(function(a,b=100){return bm(this,arguments,function*(){let c,d=0;for(;d<b;){let b=yield bl(a.listTools({cursor:c}));for(let a of b.tools)yield yield bl(a),d++;if(!b.nextCursor)break;c=b.nextCursor}})}(j)));!(a=(g=await i.next()).done);h=!0){d=g.value,h=!1,f.push(d);let a=d.name;if(e[a])throw Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);e[a]=j}}catch(a){b={error:a}}finally{try{!h&&!a&&(c=i.return)&&await c.call(i)}finally{if(b)throw b.error}}this.mcpTools=f,this.functionNameToMcpClient=e}async tool(){return await this.initialize(),function(a,b={}){let c=[],d=new Set;for(let e of a){let a=e.name;if(d.has(a))throw Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);d.add(a);let f=function(a,b={}){let c={name:a.name,description:a.description,parametersJsonSchema:a.inputSchema};return a.outputSchema&&(c.responseJsonSchema=a.outputSchema),b.behavior&&(c.behavior=b.behavior),{functionDeclarations:[c]}}(e,b);f.functionDeclarations&&c.push(...f.functionDeclarations)}return{functionDeclarations:c}}(this.mcpTools,this.config)}async callTool(a){await this.initialize();let b=[];for(let c of a)if(c.name in this.functionNameToMcpClient){let a,d=this.functionNameToMcpClient[c.name];this.config.timeout&&(a={timeout:this.config.timeout});let e=await d.callTool({name:c.name,arguments:c.args},void 0,a);b.push({functionResponse:{name:c.name,response:e.isError?{error:e}:e}})}return b}}async function b3(a,b,c){let d=new aD;Object.assign(d,function(a){let b={};null!=ag(a,["setupComplete"])&&af(b,["setupComplete"],{});let c=ag(a,["serverContent"]);null!=c&&af(b,["serverContent"],function(a){let b={},c=ag(a,["audioChunks"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["data"]);null!=c&&af(b,["data"],c);let d=ag(a,["mimeType"]);null!=d&&af(b,["mimeType"],d);let e=ag(a,["sourceMetadata"]);return null!=e&&af(b,["sourceMetadata"],function(a){let b={},c=ag(a,["clientContent"]);null!=c&&af(b,["clientContent"],function(a){let b={},c=ag(a,["weightedPrompts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["text"]);null!=c&&af(b,["text"],c);let d=ag(a,["weight"]);return null!=d&&af(b,["weight"],d),b})(a))),af(b,["weightedPrompts"],a)}return b}(c));let d=ag(a,["musicGenerationConfig"]);return null!=d&&af(b,["musicGenerationConfig"],function(a){let b={},c=ag(a,["temperature"]);null!=c&&af(b,["temperature"],c);let d=ag(a,["topK"]);null!=d&&af(b,["topK"],d);let e=ag(a,["seed"]);null!=e&&af(b,["seed"],e);let f=ag(a,["guidance"]);null!=f&&af(b,["guidance"],f);let g=ag(a,["bpm"]);null!=g&&af(b,["bpm"],g);let h=ag(a,["density"]);null!=h&&af(b,["density"],h);let i=ag(a,["brightness"]);null!=i&&af(b,["brightness"],i);let j=ag(a,["scale"]);null!=j&&af(b,["scale"],j);let k=ag(a,["muteBass"]);null!=k&&af(b,["muteBass"],k);let l=ag(a,["muteDrums"]);null!=l&&af(b,["muteDrums"],l);let m=ag(a,["onlyBassAndDrums"]);null!=m&&af(b,["onlyBassAndDrums"],m);let n=ag(a,["musicGenerationMode"]);return null!=n&&af(b,["musicGenerationMode"],n),b}(d)),b}(e)),b})(a))),af(b,["audioChunks"],a)}return b}(c));let d=ag(a,["filteredPrompt"]);return null!=d&&af(b,["filteredPrompt"],function(a){let b={},c=ag(a,["text"]);null!=c&&af(b,["text"],c);let d=ag(a,["filteredReason"]);return null!=d&&af(b,["filteredReason"],d),b}(d)),b}(c.data instanceof Blob?JSON.parse(await c.data.text()):JSON.parse(c.data))),b(d)}class b4{constructor(a,b,c){this.apiClient=a,this.auth=b,this.webSocketFactory=c}async connect(a){var b,c;if(this.apiClient.isVertexAI())throw Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let d=this.apiClient.getWebsocketBaseUrl(),e=this.apiClient.getApiVersion(),f=function(a){let b=new Headers;for(let[c,d]of Object.entries(a))b.append(c,d);return b}(this.apiClient.getDefaultHeaders()),g=this.apiClient.getApiKey(),h=`${d}/ws/google.ai.generativelanguage.${e}.GenerativeService.BidiGenerateMusic?key=${g}`,i=()=>{},j=new Promise(a=>{i=a}),k=a.callbacks,l=this.apiClient,m={onopen:function(){i({})},onmessage:a=>{b3(l,k.onmessage,a)},onerror:null!=(b=null==k?void 0:k.onerror)?b:function(a){},onclose:null!=(c=null==k?void 0:k.onclose)?c:function(a){}},n=this.webSocketFactory.create(h,function(a){let b={};return a.forEach((a,c)=>{b[c]=a}),b}(f),m);n.connect(),await j;let o=by({setup:bz({model:aE(this.apiClient,a.model)})});return n.send(JSON.stringify(o)),new b5(n,this.apiClient)}}class b5{constructor(a,b){this.conn=a,this.apiClient=b}async setWeightedPrompts(a){if(!a.weightedPrompts||0===Object.keys(a.weightedPrompts).length)throw Error("Weighted prompts must be set and contain at least one entry.");let b=bx(function(a){let b={},c=ag(a,["weightedPrompts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>bG(a))),af(b,["weightedPrompts"],a)}return b}(a));this.conn.send(JSON.stringify({clientContent:b}))}async setMusicGenerationConfig(a){a.musicGenerationConfig||(a.musicGenerationConfig={});let b=by(function(a){let b={},c=ag(a,["musicGenerationConfig"]);return null!=c&&af(b,["musicGenerationConfig"],bA(c)),b}(a));this.conn.send(JSON.stringify(b))}sendPlaybackControl(a){let b=by({playbackControl:a});this.conn.send(JSON.stringify(b))}play(){this.sendPlaybackControl(Y.PLAY)}pause(){this.sendPlaybackControl(Y.PAUSE)}stop(){this.sendPlaybackControl(Y.STOP)}resetContext(){this.sendPlaybackControl(Y.RESET_CONTEXT)}close(){this.conn.close()}}async function b6(a,b,c){let d=new aC,e=JSON.parse(c.data instanceof Blob?await c.data.text():c.data instanceof ArrayBuffer?new TextDecoder().decode(c.data):c.data);a.isVertexAI()?Object.assign(d,function(a){let b={},c=ag(a,["setupComplete"]);null!=c&&af(b,["setupComplete"],function(a){let b={},c=ag(a,["sessionId"]);return null!=c&&af(b,["sessionId"],c),b}(c));let d=ag(a,["serverContent"]);null!=d&&af(b,["serverContent"],function(a){let b={},c=ag(a,["modelTurn"]);null!=c&&af(b,["modelTurn"],function(a){let b={},c=ag(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["videoMetadata"]);null!=c&&af(b,["videoMetadata"],function(a){let b={},c=ag(a,["fps"]);null!=c&&af(b,["fps"],c);let d=ag(a,["endOffset"]);null!=d&&af(b,["endOffset"],d);let e=ag(a,["startOffset"]);return null!=e&&af(b,["startOffset"],e),b}(c));let d=ag(a,["thought"]);null!=d&&af(b,["thought"],d);let e=ag(a,["inlineData"]);null!=e&&af(b,["inlineData"],function(a){let b={},c=ag(a,["displayName"]);null!=c&&af(b,["displayName"],c);let d=ag(a,["data"]);null!=d&&af(b,["data"],d);let e=ag(a,["mimeType"]);return null!=e&&af(b,["mimeType"],e),b}(e));let f=ag(a,["fileData"]);null!=f&&af(b,["fileData"],function(a){let b={},c=ag(a,["displayName"]);null!=c&&af(b,["displayName"],c);let d=ag(a,["fileUri"]);null!=d&&af(b,["fileUri"],d);let e=ag(a,["mimeType"]);return null!=e&&af(b,["mimeType"],e),b}(f));let g=ag(a,["thoughtSignature"]);null!=g&&af(b,["thoughtSignature"],g);let h=ag(a,["functionCall"]);null!=h&&af(b,["functionCall"],bw(h));let i=ag(a,["codeExecutionResult"]);null!=i&&af(b,["codeExecutionResult"],i);let j=ag(a,["executableCode"]);null!=j&&af(b,["executableCode"],j);let k=ag(a,["functionResponse"]);null!=k&&af(b,["functionResponse"],k);let l=ag(a,["text"]);return null!=l&&af(b,["text"],l),b})(a))),af(b,["parts"],a)}let d=ag(a,["role"]);return null!=d&&af(b,["role"],d),b}(c));let d=ag(a,["turnComplete"]);null!=d&&af(b,["turnComplete"],d);let e=ag(a,["interrupted"]);null!=e&&af(b,["interrupted"],e);let f=ag(a,["groundingMetadata"]);null!=f&&af(b,["groundingMetadata"],f);let g=ag(a,["generationComplete"]);null!=g&&af(b,["generationComplete"],g);let h=ag(a,["inputTranscription"]);null!=h&&af(b,["inputTranscription"],bE(h));let i=ag(a,["outputTranscription"]);null!=i&&af(b,["outputTranscription"],bE(i));let j=ag(a,["turnCompleteReason"]);null!=j&&af(b,["turnCompleteReason"],j);let k=ag(a,["waitingForInput"]);return null!=k&&af(b,["waitingForInput"],k),b}(d));let e=ag(a,["toolCall"]);null!=e&&af(b,["toolCall"],function(a){let b={},c=ag(a,["functionCalls"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>bw(a))),af(b,["functionCalls"],a)}return b}(e));let f=ag(a,["toolCallCancellation"]);null!=f&&af(b,["toolCallCancellation"],function(a){let b={},c=ag(a,["ids"]);return null!=c&&af(b,["ids"],c),b}(f));let g=ag(a,["usageMetadata"]);null!=g&&af(b,["usageMetadata"],function(a){let b={},c=ag(a,["promptTokenCount"]);null!=c&&af(b,["promptTokenCount"],c);let d=ag(a,["cachedContentTokenCount"]);null!=d&&af(b,["cachedContentTokenCount"],d);let e=ag(a,["candidatesTokenCount"]);null!=e&&af(b,["responseTokenCount"],e);let f=ag(a,["toolUsePromptTokenCount"]);null!=f&&af(b,["toolUsePromptTokenCount"],f);let g=ag(a,["thoughtsTokenCount"]);null!=g&&af(b,["thoughtsTokenCount"],g);let h=ag(a,["totalTokenCount"]);null!=h&&af(b,["totalTokenCount"],h);let i=ag(a,["promptTokensDetails"]);if(null!=i){let a=i;Array.isArray(a)&&(a=a.map(a=>bC(a))),af(b,["promptTokensDetails"],a)}let j=ag(a,["cacheTokensDetails"]);if(null!=j){let a=j;Array.isArray(a)&&(a=a.map(a=>bC(a))),af(b,["cacheTokensDetails"],a)}let k=ag(a,["candidatesTokensDetails"]);if(null!=k){let a=k;Array.isArray(a)&&(a=a.map(a=>bC(a))),af(b,["responseTokensDetails"],a)}let l=ag(a,["toolUsePromptTokensDetails"]);if(null!=l){let a=l;Array.isArray(a)&&(a=a.map(a=>bC(a))),af(b,["toolUsePromptTokensDetails"],a)}let m=ag(a,["trafficType"]);return null!=m&&af(b,["trafficType"],m),b}(g));let h=ag(a,["goAway"]);null!=h&&af(b,["goAway"],function(a){let b={},c=ag(a,["timeLeft"]);return null!=c&&af(b,["timeLeft"],c),b}(h));let i=ag(a,["sessionResumptionUpdate"]);return null!=i&&af(b,["sessionResumptionUpdate"],function(a){let b={},c=ag(a,["newHandle"]);null!=c&&af(b,["newHandle"],c);let d=ag(a,["resumable"]);null!=d&&af(b,["resumable"],d);let e=ag(a,["lastConsumedClientMessageIndex"]);return null!=e&&af(b,["lastConsumedClientMessageIndex"],e),b}(i)),b}(e)):Object.assign(d,function(a){let b={};null!=ag(a,["setupComplete"])&&af(b,["setupComplete"],{});let c=ag(a,["serverContent"]);null!=c&&af(b,["serverContent"],function(a){let b={},c=ag(a,["modelTurn"]);null!=c&&af(b,["modelTurn"],function(a){let b={},c=ag(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["videoMetadata"]);null!=c&&af(b,["videoMetadata"],function(a){let b={},c=ag(a,["fps"]);null!=c&&af(b,["fps"],c);let d=ag(a,["endOffset"]);null!=d&&af(b,["endOffset"],d);let e=ag(a,["startOffset"]);return null!=e&&af(b,["startOffset"],e),b}(c));let d=ag(a,["thought"]);null!=d&&af(b,["thought"],d);let e=ag(a,["inlineData"]);null!=e&&af(b,["inlineData"],function(a){let b={},c=ag(a,["data"]);null!=c&&af(b,["data"],c);let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(e));let f=ag(a,["fileData"]);null!=f&&af(b,["fileData"],function(a){let b={},c=ag(a,["fileUri"]);null!=c&&af(b,["fileUri"],c);let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(f));let g=ag(a,["thoughtSignature"]);null!=g&&af(b,["thoughtSignature"],g);let h=ag(a,["functionCall"]);null!=h&&af(b,["functionCall"],bv(h));let i=ag(a,["codeExecutionResult"]);null!=i&&af(b,["codeExecutionResult"],i);let j=ag(a,["executableCode"]);null!=j&&af(b,["executableCode"],j);let k=ag(a,["functionResponse"]);null!=k&&af(b,["functionResponse"],k);let l=ag(a,["text"]);return null!=l&&af(b,["text"],l),b})(a))),af(b,["parts"],a)}let d=ag(a,["role"]);return null!=d&&af(b,["role"],d),b}(c));let d=ag(a,["turnComplete"]);null!=d&&af(b,["turnComplete"],d);let e=ag(a,["interrupted"]);null!=e&&af(b,["interrupted"],e);let f=ag(a,["groundingMetadata"]);null!=f&&af(b,["groundingMetadata"],f);let g=ag(a,["generationComplete"]);null!=g&&af(b,["generationComplete"],g);let h=ag(a,["inputTranscription"]);null!=h&&af(b,["inputTranscription"],bD(h));let i=ag(a,["outputTranscription"]);null!=i&&af(b,["outputTranscription"],bD(i));let j=ag(a,["urlContextMetadata"]);null!=j&&af(b,["urlContextMetadata"],function(a){let b={},c=ag(a,["urlMetadata"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["retrievedUrl"]);null!=c&&af(b,["retrievedUrl"],c);let d=ag(a,["urlRetrievalStatus"]);return null!=d&&af(b,["urlRetrievalStatus"],d),b})(a))),af(b,["urlMetadata"],a)}return b}(j));let k=ag(a,["turnCompleteReason"]);null!=k&&af(b,["turnCompleteReason"],k);let l=ag(a,["waitingForInput"]);return null!=l&&af(b,["waitingForInput"],l),b}(c));let d=ag(a,["toolCall"]);null!=d&&af(b,["toolCall"],function(a){let b={},c=ag(a,["functionCalls"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>bv(a))),af(b,["functionCalls"],a)}return b}(d));let e=ag(a,["toolCallCancellation"]);null!=e&&af(b,["toolCallCancellation"],function(a){let b={},c=ag(a,["ids"]);return null!=c&&af(b,["ids"],c),b}(e));let f=ag(a,["usageMetadata"]);null!=f&&af(b,["usageMetadata"],function(a){let b={},c=ag(a,["promptTokenCount"]);null!=c&&af(b,["promptTokenCount"],c);let d=ag(a,["cachedContentTokenCount"]);null!=d&&af(b,["cachedContentTokenCount"],d);let e=ag(a,["responseTokenCount"]);null!=e&&af(b,["responseTokenCount"],e);let f=ag(a,["toolUsePromptTokenCount"]);null!=f&&af(b,["toolUsePromptTokenCount"],f);let g=ag(a,["thoughtsTokenCount"]);null!=g&&af(b,["thoughtsTokenCount"],g);let h=ag(a,["totalTokenCount"]);null!=h&&af(b,["totalTokenCount"],h);let i=ag(a,["promptTokensDetails"]);if(null!=i){let a=i;Array.isArray(a)&&(a=a.map(a=>bB(a))),af(b,["promptTokensDetails"],a)}let j=ag(a,["cacheTokensDetails"]);if(null!=j){let a=j;Array.isArray(a)&&(a=a.map(a=>bB(a))),af(b,["cacheTokensDetails"],a)}let k=ag(a,["responseTokensDetails"]);if(null!=k){let a=k;Array.isArray(a)&&(a=a.map(a=>bB(a))),af(b,["responseTokensDetails"],a)}let l=ag(a,["toolUsePromptTokensDetails"]);if(null!=l){let a=l;Array.isArray(a)&&(a=a.map(a=>bB(a))),af(b,["toolUsePromptTokensDetails"],a)}return b}(f));let g=ag(a,["goAway"]);null!=g&&af(b,["goAway"],function(a){let b={},c=ag(a,["timeLeft"]);return null!=c&&af(b,["timeLeft"],c),b}(g));let h=ag(a,["sessionResumptionUpdate"]);return null!=h&&af(b,["sessionResumptionUpdate"],function(a){let b={},c=ag(a,["newHandle"]);null!=c&&af(b,["newHandle"],c);let d=ag(a,["resumable"]);null!=d&&af(b,["resumable"],d);let e=ag(a,["lastConsumedClientMessageIndex"]);return null!=e&&af(b,["lastConsumedClientMessageIndex"],e),b}(h)),b}(e)),b(d)}class b7{constructor(a,b,c){this.apiClient=a,this.auth=b,this.webSocketFactory=c,this.music=new b4(this.apiClient,this.auth,this.webSocketFactory)}async connect(a){var b,c,d,e,f,g;let h;if(a.config&&a.config.httpOptions)throw Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");let i=this.apiClient.getWebsocketBaseUrl(),j=this.apiClient.getApiVersion(),k=this.apiClient.getHeaders();a.config&&a.config.tools&&b0(a.config.tools)&&b1(k);let l=function(a){let b=new Headers;for(let[c,d]of Object.entries(a))b.append(c,d);return b}(k);if(this.apiClient.isVertexAI())h=`${i}/ws/google.cloud.aiplatform.${j}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(l);else{let a=this.apiClient.getApiKey(),b="BidiGenerateContent",c="key";(null==a?void 0:a.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==j&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),b="BidiGenerateContentConstrained",c="access_token"),h=`${i}/ws/google.ai.generativelanguage.${j}.GenerativeService.${b}?${c}=${a}`}let m=()=>{},n=new Promise(a=>{m=a}),o=a.callbacks,p=this.apiClient,q={onopen:function(){var a;null==(a=null==o?void 0:o.onopen)||a.call(o),m({})},onmessage:a=>{b6(p,o.onmessage,a)},onerror:null!=(b=null==o?void 0:o.onerror)?b:function(a){},onclose:null!=(c=null==o?void 0:o.onclose)?c:function(a){}},r=this.webSocketFactory.create(h,function(a){let b={};return a.forEach((a,c)=>{b[c]=a}),b}(l),q);r.connect(),await n;let t=aE(this.apiClient,a.model);if(this.apiClient.isVertexAI()&&t.startsWith("publishers/")){let a=this.apiClient.getProject(),b=this.apiClient.getLocation();t=`projects/${a}/locations/${b}/`+t}let u={};this.apiClient.isVertexAI()&&(null==(d=a.config)?void 0:d.responseModalities)===void 0&&(void 0===a.config?a.config={responseModalities:[s.AUDIO]}:a.config.responseModalities=[s.AUDIO]),(null==(e=a.config)?void 0:e.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let v=null!=(g=null==(f=a.config)?void 0:f.tools)?g:[],w=[];for(let a of v)this.isCallableTool(a)?w.push(await a.tool()):w.push(a);w.length>0&&(a.config.tools=w);let x={model:t,config:a.config,callbacks:a.callbacks};return u=this.apiClient.isVertexAI()?function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["setup","model"],aE(a,d));let e=ag(b,["config"]);return null!=e&&af(c,["config"],function(a,b){let c=ag(a,["generationConfig"]);void 0!==b&&null!=c&&af(b,["setup","generationConfig"],c);let d=ag(a,["responseModalities"]);void 0!==b&&null!=d&&af(b,["setup","generationConfig","responseModalities"],d);let e=ag(a,["temperature"]);void 0!==b&&null!=e&&af(b,["setup","generationConfig","temperature"],e);let f=ag(a,["topP"]);void 0!==b&&null!=f&&af(b,["setup","generationConfig","topP"],f);let g=ag(a,["topK"]);void 0!==b&&null!=g&&af(b,["setup","generationConfig","topK"],g);let h=ag(a,["maxOutputTokens"]);void 0!==b&&null!=h&&af(b,["setup","generationConfig","maxOutputTokens"],h);let i=ag(a,["mediaResolution"]);void 0!==b&&null!=i&&af(b,["setup","generationConfig","mediaResolution"],i);let j=ag(a,["seed"]);void 0!==b&&null!=j&&af(b,["setup","generationConfig","seed"],j);let k=ag(a,["speechConfig"]);void 0!==b&&null!=k&&af(b,["setup","generationConfig","speechConfig"],function(a){let b={},c=ag(a,["voiceConfig"]);if(null!=c&&af(b,["voiceConfig"],function(a){let b={},c=ag(a,["prebuiltVoiceConfig"]);return null!=c&&af(b,["prebuiltVoiceConfig"],function(a){let b={},c=ag(a,["voiceName"]);return null!=c&&af(b,["voiceName"],c),b}(c)),b}(c)),void 0!==ag(a,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");let d=ag(a,["languageCode"]);return null!=d&&af(b,["languageCode"],d),b}(aU(k)));let l=ag(a,["enableAffectiveDialog"]);void 0!==b&&null!=l&&af(b,["setup","generationConfig","enableAffectiveDialog"],l);let m=ag(a,["systemInstruction"]);void 0!==b&&null!=m&&af(b,["setup","systemInstruction"],function(a){let b={},c=ag(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["videoMetadata"]);null!=c&&af(b,["videoMetadata"],function(a){let b={},c=ag(a,["fps"]);null!=c&&af(b,["fps"],c);let d=ag(a,["endOffset"]);null!=d&&af(b,["endOffset"],d);let e=ag(a,["startOffset"]);return null!=e&&af(b,["startOffset"],e),b}(c));let d=ag(a,["thought"]);null!=d&&af(b,["thought"],d);let e=ag(a,["inlineData"]);null!=e&&af(b,["inlineData"],function(a){let b={},c=ag(a,["displayName"]);null!=c&&af(b,["displayName"],c);let d=ag(a,["data"]);null!=d&&af(b,["data"],d);let e=ag(a,["mimeType"]);return null!=e&&af(b,["mimeType"],e),b}(e));let f=ag(a,["fileData"]);null!=f&&af(b,["fileData"],function(a){let b={},c=ag(a,["displayName"]);null!=c&&af(b,["displayName"],c);let d=ag(a,["fileUri"]);null!=d&&af(b,["fileUri"],d);let e=ag(a,["mimeType"]);return null!=e&&af(b,["mimeType"],e),b}(f));let g=ag(a,["thoughtSignature"]);null!=g&&af(b,["thoughtSignature"],g);let h=ag(a,["functionCall"]);null!=h&&af(b,["functionCall"],function(a){let b={},c=ag(a,["id"]);null!=c&&af(b,["id"],c);let d=ag(a,["args"]);null!=d&&af(b,["args"],d);let e=ag(a,["name"]);return null!=e&&af(b,["name"],e),b}(h));let i=ag(a,["codeExecutionResult"]);null!=i&&af(b,["codeExecutionResult"],i);let j=ag(a,["executableCode"]);null!=j&&af(b,["executableCode"],j);let k=ag(a,["functionResponse"]);null!=k&&af(b,["functionResponse"],k);let l=ag(a,["text"]);return null!=l&&af(b,["text"],l),b})(a))),af(b,["parts"],a)}let d=ag(a,["role"]);return null!=d&&af(b,["role"],d),b}(aP(m)));let n=ag(a,["tools"]);if(void 0!==b&&null!=n){let a=aW(n);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={};if(void 0!==ag(a,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let c=ag(a,["description"]);null!=c&&af(b,["description"],c);let d=ag(a,["name"]);null!=d&&af(b,["name"],d);let e=ag(a,["parameters"]);null!=e&&af(b,["parameters"],e);let f=ag(a,["parametersJsonSchema"]);null!=f&&af(b,["parametersJsonSchema"],f);let g=ag(a,["response"]);null!=g&&af(b,["response"],g);let h=ag(a,["responseJsonSchema"]);return null!=h&&af(b,["responseJsonSchema"],h),b})(a))),af(b,["functionDeclarations"],a)}let d=ag(a,["retrieval"]);null!=d&&af(b,["retrieval"],d);let e=ag(a,["googleSearch"]);null!=e&&af(b,["googleSearch"],function(a){let b={},c=ag(a,["timeRangeFilter"]);null!=c&&af(b,["timeRangeFilter"],function(a){let b={},c=ag(a,["startTime"]);null!=c&&af(b,["startTime"],c);let d=ag(a,["endTime"]);return null!=d&&af(b,["endTime"],d),b}(c));let d=ag(a,["excludeDomains"]);return null!=d&&af(b,["excludeDomains"],d),b}(e));let f=ag(a,["googleSearchRetrieval"]);null!=f&&af(b,["googleSearchRetrieval"],function(a){let b={},c=ag(a,["dynamicRetrievalConfig"]);return null!=c&&af(b,["dynamicRetrievalConfig"],function(a){let b={},c=ag(a,["mode"]);null!=c&&af(b,["mode"],c);let d=ag(a,["dynamicThreshold"]);return null!=d&&af(b,["dynamicThreshold"],d),b}(c)),b}(f));let g=ag(a,["enterpriseWebSearch"]);null!=g&&af(b,["enterpriseWebSearch"],function(a){let b={},c=ag(a,["excludeDomains"]);return null!=c&&af(b,["excludeDomains"],c),b}(g));let h=ag(a,["googleMaps"]);null!=h&&af(b,["googleMaps"],function(a){let b={},c=ag(a,["authConfig"]);return null!=c&&af(b,["authConfig"],function(a){let b={},c=ag(a,["apiKeyConfig"]);null!=c&&af(b,["apiKeyConfig"],function(a){let b={},c=ag(a,["apiKeyString"]);return null!=c&&af(b,["apiKeyString"],c),b}(c));let d=ag(a,["authType"]);null!=d&&af(b,["authType"],d);let e=ag(a,["googleServiceAccountConfig"]);null!=e&&af(b,["googleServiceAccountConfig"],e);let f=ag(a,["httpBasicAuthConfig"]);null!=f&&af(b,["httpBasicAuthConfig"],f);let g=ag(a,["oauthConfig"]);null!=g&&af(b,["oauthConfig"],g);let h=ag(a,["oidcConfig"]);return null!=h&&af(b,["oidcConfig"],h),b}(c)),b}(h)),null!=ag(a,["urlContext"])&&af(b,["urlContext"],{});let i=ag(a,["computerUse"]);null!=i&&af(b,["computerUse"],function(a){let b={},c=ag(a,["environment"]);null!=c&&af(b,["environment"],c);let d=ag(a,["excludedPredefinedFunctions"]);return null!=d&&af(b,["excludedPredefinedFunctions"],d),b}(i));let j=ag(a,["codeExecution"]);return null!=j&&af(b,["codeExecution"],j),b})(aV(a)))),af(b,["setup","tools"],a)}let o=ag(a,["sessionResumption"]);void 0!==b&&null!=o&&af(b,["setup","sessionResumption"],function(a){let b={},c=ag(a,["handle"]);null!=c&&af(b,["handle"],c);let d=ag(a,["transparent"]);return null!=d&&af(b,["transparent"],d),b}(o));let p=ag(a,["inputAudioTranscription"]);void 0!==b&&null!=p&&af(b,["setup","inputAudioTranscription"],{});let q=ag(a,["outputAudioTranscription"]);void 0!==b&&null!=q&&af(b,["setup","outputAudioTranscription"],{});let r=ag(a,["realtimeInputConfig"]);void 0!==b&&null!=r&&af(b,["setup","realtimeInputConfig"],function(a){let b={},c=ag(a,["automaticActivityDetection"]);null!=c&&af(b,["automaticActivityDetection"],function(a){let b={},c=ag(a,["disabled"]);null!=c&&af(b,["disabled"],c);let d=ag(a,["startOfSpeechSensitivity"]);null!=d&&af(b,["startOfSpeechSensitivity"],d);let e=ag(a,["endOfSpeechSensitivity"]);null!=e&&af(b,["endOfSpeechSensitivity"],e);let f=ag(a,["prefixPaddingMs"]);null!=f&&af(b,["prefixPaddingMs"],f);let g=ag(a,["silenceDurationMs"]);return null!=g&&af(b,["silenceDurationMs"],g),b}(c));let d=ag(a,["activityHandling"]);null!=d&&af(b,["activityHandling"],d);let e=ag(a,["turnCoverage"]);return null!=e&&af(b,["turnCoverage"],e),b}(r));let s=ag(a,["contextWindowCompression"]);void 0!==b&&null!=s&&af(b,["setup","contextWindowCompression"],function(a){let b={},c=ag(a,["triggerTokens"]);null!=c&&af(b,["triggerTokens"],c);let d=ag(a,["slidingWindow"]);return null!=d&&af(b,["slidingWindow"],function(a){let b={},c=ag(a,["targetTokens"]);return null!=c&&af(b,["targetTokens"],c),b}(d)),b}(s));let t=ag(a,["proactivity"]);return void 0!==b&&null!=t&&af(b,["setup","proactivity"],function(a){let b={},c=ag(a,["proactiveAudio"]);return null!=c&&af(b,["proactiveAudio"],c),b}(t)),{}}(e,c)),c}(this.apiClient,x):function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["setup","model"],aE(a,d));let e=ag(b,["config"]);return null!=e&&af(c,["config"],function(a,b){let c=ag(a,["generationConfig"]);void 0!==b&&null!=c&&af(b,["setup","generationConfig"],c);let d=ag(a,["responseModalities"]);void 0!==b&&null!=d&&af(b,["setup","generationConfig","responseModalities"],d);let e=ag(a,["temperature"]);void 0!==b&&null!=e&&af(b,["setup","generationConfig","temperature"],e);let f=ag(a,["topP"]);void 0!==b&&null!=f&&af(b,["setup","generationConfig","topP"],f);let g=ag(a,["topK"]);void 0!==b&&null!=g&&af(b,["setup","generationConfig","topK"],g);let h=ag(a,["maxOutputTokens"]);void 0!==b&&null!=h&&af(b,["setup","generationConfig","maxOutputTokens"],h);let i=ag(a,["mediaResolution"]);void 0!==b&&null!=i&&af(b,["setup","generationConfig","mediaResolution"],i);let j=ag(a,["seed"]);void 0!==b&&null!=j&&af(b,["setup","generationConfig","seed"],j);let k=ag(a,["speechConfig"]);void 0!==b&&null!=k&&af(b,["setup","generationConfig","speechConfig"],function(a){let b={},c=ag(a,["voiceConfig"]);null!=c&&af(b,["voiceConfig"],bF(c));let d=ag(a,["multiSpeakerVoiceConfig"]);null!=d&&af(b,["multiSpeakerVoiceConfig"],function(a){let b={},c=ag(a,["speakerVoiceConfigs"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["speaker"]);null!=c&&af(b,["speaker"],c);let d=ag(a,["voiceConfig"]);return null!=d&&af(b,["voiceConfig"],bF(d)),b})(a))),af(b,["speakerVoiceConfigs"],a)}return b}(d));let e=ag(a,["languageCode"]);return null!=e&&af(b,["languageCode"],e),b}(aU(k)));let l=ag(a,["enableAffectiveDialog"]);void 0!==b&&null!=l&&af(b,["setup","generationConfig","enableAffectiveDialog"],l);let m=ag(a,["systemInstruction"]);void 0!==b&&null!=m&&af(b,["setup","systemInstruction"],function(a){let b={},c=ag(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["videoMetadata"]);null!=c&&af(b,["videoMetadata"],function(a){let b={},c=ag(a,["fps"]);null!=c&&af(b,["fps"],c);let d=ag(a,["endOffset"]);null!=d&&af(b,["endOffset"],d);let e=ag(a,["startOffset"]);return null!=e&&af(b,["startOffset"],e),b}(c));let d=ag(a,["thought"]);null!=d&&af(b,["thought"],d);let e=ag(a,["inlineData"]);null!=e&&af(b,["inlineData"],function(a){let b={};if(void 0!==ag(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=ag(a,["data"]);null!=c&&af(b,["data"],c);let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(e));let f=ag(a,["fileData"]);null!=f&&af(b,["fileData"],function(a){let b={};if(void 0!==ag(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=ag(a,["fileUri"]);null!=c&&af(b,["fileUri"],c);let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(f));let g=ag(a,["thoughtSignature"]);null!=g&&af(b,["thoughtSignature"],g);let h=ag(a,["functionCall"]);null!=h&&af(b,["functionCall"],function(a){let b={},c=ag(a,["id"]);null!=c&&af(b,["id"],c);let d=ag(a,["args"]);null!=d&&af(b,["args"],d);let e=ag(a,["name"]);return null!=e&&af(b,["name"],e),b}(h));let i=ag(a,["codeExecutionResult"]);null!=i&&af(b,["codeExecutionResult"],i);let j=ag(a,["executableCode"]);null!=j&&af(b,["executableCode"],j);let k=ag(a,["functionResponse"]);null!=k&&af(b,["functionResponse"],k);let l=ag(a,["text"]);return null!=l&&af(b,["text"],l),b})(a))),af(b,["parts"],a)}let d=ag(a,["role"]);return null!=d&&af(b,["role"],d),b}(aP(m)));let n=ag(a,["tools"]);if(void 0!==b&&null!=n){let a=aW(n);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["behavior"]);null!=c&&af(b,["behavior"],c);let d=ag(a,["description"]);null!=d&&af(b,["description"],d);let e=ag(a,["name"]);null!=e&&af(b,["name"],e);let f=ag(a,["parameters"]);null!=f&&af(b,["parameters"],f);let g=ag(a,["parametersJsonSchema"]);null!=g&&af(b,["parametersJsonSchema"],g);let h=ag(a,["response"]);null!=h&&af(b,["response"],h);let i=ag(a,["responseJsonSchema"]);return null!=i&&af(b,["responseJsonSchema"],i),b})(a))),af(b,["functionDeclarations"],a)}if(void 0!==ag(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=ag(a,["googleSearch"]);null!=d&&af(b,["googleSearch"],function(a){let b={},c=ag(a,["timeRangeFilter"]);if(null!=c&&af(b,["timeRangeFilter"],function(a){let b={},c=ag(a,["startTime"]);null!=c&&af(b,["startTime"],c);let d=ag(a,["endTime"]);return null!=d&&af(b,["endTime"],d),b}(c)),void 0!==ag(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return b}(d));let e=ag(a,["googleSearchRetrieval"]);if(null!=e&&af(b,["googleSearchRetrieval"],function(a){let b={},c=ag(a,["dynamicRetrievalConfig"]);return null!=c&&af(b,["dynamicRetrievalConfig"],function(a){let b={},c=ag(a,["mode"]);null!=c&&af(b,["mode"],c);let d=ag(a,["dynamicThreshold"]);return null!=d&&af(b,["dynamicThreshold"],d),b}(c)),b}(e)),void 0!==ag(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==ag(a,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");null!=ag(a,["urlContext"])&&af(b,["urlContext"],{});let f=ag(a,["computerUse"]);null!=f&&af(b,["computerUse"],function(a){let b={},c=ag(a,["environment"]);null!=c&&af(b,["environment"],c);let d=ag(a,["excludedPredefinedFunctions"]);return null!=d&&af(b,["excludedPredefinedFunctions"],d),b}(f));let g=ag(a,["codeExecution"]);return null!=g&&af(b,["codeExecution"],g),b})(aV(a)))),af(b,["setup","tools"],a)}let o=ag(a,["sessionResumption"]);void 0!==b&&null!=o&&af(b,["setup","sessionResumption"],function(a){let b={},c=ag(a,["handle"]);if(null!=c&&af(b,["handle"],c),void 0!==ag(a,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return b}(o));let p=ag(a,["inputAudioTranscription"]);void 0!==b&&null!=p&&af(b,["setup","inputAudioTranscription"],{});let q=ag(a,["outputAudioTranscription"]);void 0!==b&&null!=q&&af(b,["setup","outputAudioTranscription"],{});let r=ag(a,["realtimeInputConfig"]);void 0!==b&&null!=r&&af(b,["setup","realtimeInputConfig"],function(a){let b={},c=ag(a,["automaticActivityDetection"]);null!=c&&af(b,["automaticActivityDetection"],function(a){let b={},c=ag(a,["disabled"]);null!=c&&af(b,["disabled"],c);let d=ag(a,["startOfSpeechSensitivity"]);null!=d&&af(b,["startOfSpeechSensitivity"],d);let e=ag(a,["endOfSpeechSensitivity"]);null!=e&&af(b,["endOfSpeechSensitivity"],e);let f=ag(a,["prefixPaddingMs"]);null!=f&&af(b,["prefixPaddingMs"],f);let g=ag(a,["silenceDurationMs"]);return null!=g&&af(b,["silenceDurationMs"],g),b}(c));let d=ag(a,["activityHandling"]);null!=d&&af(b,["activityHandling"],d);let e=ag(a,["turnCoverage"]);return null!=e&&af(b,["turnCoverage"],e),b}(r));let s=ag(a,["contextWindowCompression"]);void 0!==b&&null!=s&&af(b,["setup","contextWindowCompression"],function(a){let b={},c=ag(a,["triggerTokens"]);null!=c&&af(b,["triggerTokens"],c);let d=ag(a,["slidingWindow"]);return null!=d&&af(b,["slidingWindow"],function(a){let b={},c=ag(a,["targetTokens"]);return null!=c&&af(b,["targetTokens"],c),b}(d)),b}(s));let t=ag(a,["proactivity"]);return void 0!==b&&null!=t&&af(b,["setup","proactivity"],function(a){let b={},c=ag(a,["proactiveAudio"]);return null!=c&&af(b,["proactiveAudio"],c),b}(t)),{}}(e,c)),c}(this.apiClient,x),delete u.config,r.send(JSON.stringify(u)),new b9(r,this.apiClient)}isCallableTool(a){return"callTool"in a&&"function"==typeof a.callTool}}let b8={turnComplete:!0};class b9{constructor(a,b){this.conn=a,this.apiClient=b}tLiveClientContent(a,b){if(null!==b.turns&&void 0!==b.turns){let c=[];try{c=aR(b.turns),c=a.isVertexAI()?c.map(a=>bI(a)):c.map(a=>bH(a))}catch(a){throw Error(`Failed to parse client content "turns", type: '${typeof b.turns}'`)}return{clientContent:{turns:c,turnComplete:b.turnComplete}}}return{clientContent:{turnComplete:b.turnComplete}}}tLiveClienttToolResponse(a,b){let c=[];if(null==b.functionResponses||0===(c=Array.isArray(b.functionResponses)?b.functionResponses:[b.functionResponses]).length)throw Error("functionResponses is required.");for(let b of c){if("object"!=typeof b||null===b||!("name"in b)||!("response"in b))throw Error(`Could not parse function response, type '${typeof b}'.`);if(!a.isVertexAI()&&!("id"in b))throw Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:c}}}sendClientContent(a){a=Object.assign(Object.assign({},b8),a);let b=this.tLiveClientContent(this.apiClient,a);this.conn.send(JSON.stringify(b))}sendRealtimeInput(a){let b={};b=this.apiClient.isVertexAI()?{realtimeInput:function(a){let b={},c=ag(a,["media"]);if(null!=c){let a=aG(c);Array.isArray(a)&&(a=a.map(a=>a)),af(b,["mediaChunks"],a)}let d=ag(a,["audio"]);null!=d&&af(b,["audio"],aJ(d));let e=ag(a,["audioStreamEnd"]);null!=e&&af(b,["audioStreamEnd"],e);let f=ag(a,["video"]);null!=f&&af(b,["video"],aI(f));let g=ag(a,["text"]);return null!=g&&af(b,["text"],g),null!=ag(a,["activityStart"])&&af(b,["activityStart"],{}),null!=ag(a,["activityEnd"])&&af(b,["activityEnd"],{}),b}(a)}:{realtimeInput:function(a){let b={},c=ag(a,["media"]);if(null!=c){let a=aG(c);Array.isArray(a)&&(a=a.map(a=>a)),af(b,["mediaChunks"],a)}let d=ag(a,["audio"]);null!=d&&af(b,["audio"],aJ(d));let e=ag(a,["audioStreamEnd"]);null!=e&&af(b,["audioStreamEnd"],e);let f=ag(a,["video"]);null!=f&&af(b,["video"],aI(f));let g=ag(a,["text"]);return null!=g&&af(b,["text"],g),null!=ag(a,["activityStart"])&&af(b,["activityStart"],{}),null!=ag(a,["activityEnd"])&&af(b,["activityEnd"],{}),b}(a)},this.conn.send(JSON.stringify(b))}sendToolResponse(a){if(null==a.functionResponses)throw Error("Tool response parameters are required.");let b=this.tLiveClienttToolResponse(this.apiClient,a);this.conn.send(JSON.stringify(b))}close(){this.conn.close()}}function ca(a){var b,c,d;if(null==(b=null==a?void 0:a.automaticFunctionCalling)?void 0:b.disable)return!0;let e=!1;for(let b of null!=(c=null==a?void 0:a.tools)?c:[])if(cb(b)){e=!0;break}if(!e)return!0;let f=null==(d=null==a?void 0:a.automaticFunctionCalling)?void 0:d.maximumRemoteCalls;return(!(!f||!(f<0)&&Number.isInteger(f))||0==f)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",f),!0)}function cb(a){return"callTool"in a&&"function"==typeof a.callTool}function cc(a){var b;return!(null==(b=null==a?void 0:a.automaticFunctionCalling)?void 0:b.ignoreCallHistory)}class cd extends ad{constructor(a){super(),this.apiClient=a,this.generateContent=async a=>{var b,c,d,e,f;let g,h,i=await this.processParamsMaybeAddMcpUsage(a);if(this.maybeMoveToResponseJsonSchem(a),!function(a){var b,c,d;return null!=(d=null==(c=null==(b=a.config)?void 0:b.tools)?void 0:c.some(a=>cb(a)))&&d}(a)||ca(a.config))return await this.generateContentInternal(i);if(function(a){var b,c,d;return null!=(d=null==(c=null==(b=a.config)?void 0:b.tools)?void 0:c.some(a=>!cb(a)))&&d}(a))throw Error("Automatic function calling with CallableTools and Tools is not yet supported.");let j=aR(i.contents),k=null!=(d=null==(c=null==(b=i.config)?void 0:b.automaticFunctionCalling)?void 0:c.maximumRemoteCalls)?d:10,l=0;for(;l<k&&(g=await this.generateContentInternal(i)).functionCalls&&0!==g.functionCalls.length;){let b=g.candidates[0].content,c=[];for(let b of null!=(f=null==(e=a.config)?void 0:e.tools)?f:[])if(cb(b)){let a=await b.callTool(g.functionCalls);c.push(...a)}l++,h={role:"user",parts:c},i.contents=aR(i.contents),i.contents.push(b),i.contents.push(h),cc(i.config)&&(j.push(b),j.push(h))}return cc(i.config)&&(g.automaticFunctionCallingHistory=j),g},this.generateContentStream=async a=>{if(this.maybeMoveToResponseJsonSchem(a),!ca(a.config))return await this.processAfcStream(a);{let b=await this.processParamsMaybeAddMcpUsage(a);return await this.generateContentStreamInternal(b)}},this.generateImages=async a=>await this.generateImagesInternal(a).then(a=>{var b;let c,d=[];if(null==a?void 0:a.generatedImages)for(let e of a.generatedImages)e&&(null==e?void 0:e.safetyAttributes)&&(null==(b=null==e?void 0:e.safetyAttributes)?void 0:b.contentType)==="Positive Prompt"?c=null==e?void 0:e.safetyAttributes:d.push(e);return c?{generatedImages:d,positivePromptSafetyAttributes:c,sdkHttpResponse:a.sdkHttpResponse}:{generatedImages:d,sdkHttpResponse:a.sdkHttpResponse}}),this.list=async a=>{var b;let c={config:Object.assign(Object.assign({},{queryBase:!0}),null==a?void 0:a.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase)if(null==(b=c.config)?void 0:b.filter)throw Error("Filtering tuned models list for Vertex AI is not currently supported");else c.config.filter="labels.tune-type:*";return new be(Z.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(c),c)},this.editImage=async a=>{let b={model:a.model,prompt:a.prompt,referenceImages:[],config:a.config};return a.referenceImages&&a.referenceImages&&(b.referenceImages=a.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(b)},this.upscaleImage=async a=>{let b={numberOfImages:1,mode:"upscale"};a.config&&(b=Object.assign(Object.assign({},b),a.config));let c={model:a.model,image:a.image,upscaleFactor:a.upscaleFactor,config:b};return await this.upscaleImageInternal(c)},this.generateVideos=async a=>{if((a.prompt||a.image||a.video)&&a.source)throw Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return await this.generateVideosInternal(a)}}maybeMoveToResponseJsonSchem(a){a.config&&a.config.responseSchema&&!a.config.responseJsonSchema&&Object.keys(a.config.responseSchema).includes("$schema")&&(a.config.responseJsonSchema=a.config.responseSchema,delete a.config.responseSchema)}async processParamsMaybeAddMcpUsage(a){var b,c,d;let e=null==(b=a.config)?void 0:b.tools;if(!e)return a;let f=await Promise.all(e.map(async a=>cb(a)?await a.tool():a)),g={model:a.model,contents:a.contents,config:Object.assign(Object.assign({},a.config),{tools:f})};if(g.config.tools=f,a.config&&a.config.tools&&b0(a.config.tools)){let b=Object.assign({},null!=(d=null==(c=a.config.httpOptions)?void 0:c.headers)?d:{});0===Object.keys(b).length&&(b=this.apiClient.getDefaultHeaders()),b1(b),g.config.httpOptions=Object.assign(Object.assign({},a.config.httpOptions),{headers:b})}return g}async initAfcToolsMap(a){var b,c,d;let e=new Map;for(let f of null!=(c=null==(b=a.config)?void 0:b.tools)?c:[])if(cb(f))for(let a of null!=(d=(await f.tool()).functionDeclarations)?d:[]){if(!a.name)throw Error("Function declaration name is required.");if(e.has(a.name))throw Error(`Duplicate tool declaration name: ${a.name}`);e.set(a.name,f)}return e}async processAfcStream(a){var b,c,d;let e=null!=(d=null==(c=null==(b=a.config)?void 0:b.automaticFunctionCalling)?void 0:c.maximumRemoteCalls)?d:10,f=!1,g=0;return function(a,b,c){var d,h;return bm(this,arguments,function*(){for(var i,j,k,l;g<e;){f&&(g++,f=!1);let p=yield bl(a.processParamsMaybeAddMcpUsage(c)),q=yield bl(a.generateContentStreamInternal(p)),r=[],s=[];try{for(var m,n=!0,o=(j=void 0,bn(q));!(i=(m=yield bl(o.next())).done);n=!0)if(l=m.value,n=!1,yield yield bl(l),l.candidates&&(null==(d=l.candidates[0])?void 0:d.content)){for(let a of(s.push(l.candidates[0].content),null!=(h=l.candidates[0].content.parts)?h:[]))if(g<e&&a.functionCall){if(!a.functionCall.name)throw Error("Function call name was not returned by the model.");if(b.has(a.functionCall.name)){let c=yield bl(b.get(a.functionCall.name).callTool([a.functionCall]));r.push(...c)}else throw Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${b.keys()}, mising tool: ${a.functionCall.name}`)}}}catch(a){j={error:a}}finally{try{!n&&!i&&(k=o.return)&&(yield bl(k.call(o)))}finally{if(j)throw j.error}}if(r.length>0){f=!0;let a=new aj;a.candidates=[{content:{role:"user",parts:r}}],yield yield bl(a);let b=[];b.push(...s),b.push({role:"user",parts:r});let d=aR(c.contents).concat(b);c.contents=d}else break}})}(this,await this.initAfcToolsMap(a),a)}async generateContentInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=bK(this.apiClient,a);return f=ae("{model}:generateContent",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=bM(a),c=new aj;return Object.assign(c,b),c})}{let b=bJ(this.apiClient,a);return f=ae("{model}:generateContent",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=bL(a),c=new aj;return Object.assign(c,b),c})}}async generateContentStreamInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=bK(this.apiClient,a);return f=ae("{model}:streamGenerateContent?alt=sse",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.requestStream({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(function(a){return bm(this,arguments,function*(){var b,c,d,e;try{for(var f,g=!0,h=bn(a);!(b=(f=yield bl(h.next())).done);g=!0){e=f.value,g=!1;let a=bM((yield bl(e.json())));a.sdkHttpResponse={headers:e.headers};let b=new aj;Object.assign(b,a),yield yield bl(b)}}catch(a){c={error:a}}finally{try{!g&&!b&&(d=h.return)&&(yield bl(d.call(h)))}finally{if(c)throw c.error}}})})}{let b=bJ(this.apiClient,a);return f=ae("{model}:streamGenerateContent?alt=sse",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.requestStream({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(function(a){return bm(this,arguments,function*(){var b,c,d,e;try{for(var f,g=!0,h=bn(a);!(b=(f=yield bl(h.next())).done);g=!0){e=f.value,g=!1;let a=bL((yield bl(e.json())));a.sdkHttpResponse={headers:e.headers};let b=new aj;Object.assign(b,a),yield yield bl(b)}}catch(a){c={error:a}}finally{try{!g&&!b&&(d=h.return)&&(yield bl(d.call(h)))}finally{if(c)throw c.error}}})})}}async embedContent(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["contents"]);null!=e&&af(c,["instances[]","content"],aQ(a,e));let f=ag(b,["config"]);return null!=f&&function(a,b){let c=ag(a,["taskType"]);void 0!==b&&null!=c&&af(b,["instances[]","task_type"],c);let d=ag(a,["title"]);void 0!==b&&null!=d&&af(b,["instances[]","title"],d);let e=ag(a,["outputDimensionality"]);void 0!==b&&null!=e&&af(b,["parameters","outputDimensionality"],e);let f=ag(a,["mimeType"]);void 0!==b&&null!=f&&af(b,["instances[]","mimeType"],f);let g=ag(a,["autoTruncate"]);void 0!==b&&null!=g&&af(b,["parameters","autoTruncate"],g)}(f,c),c}(this.apiClient,a);return f=ae("{model}:predict",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["predictions[]","embeddings"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["values"]);null!=c&&af(b,["values"],c);let d=ag(a,["statistics"]);return null!=d&&af(b,["statistics"],function(a){let b={},c=ag(a,["truncated"]);null!=c&&af(b,["truncated"],c);let d=ag(a,["token_count"]);return null!=d&&af(b,["tokenCount"],d),b}(d)),b})(a))),af(b,["embeddings"],a)}let e=ag(a,["metadata"]);return null!=e&&af(b,["metadata"],function(a){let b={},c=ag(a,["billableCharacterCount"]);return null!=c&&af(b,["billableCharacterCount"],c),b}(e)),b}(a),c=new ak;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["contents"]);null!=e&&af(c,["requests[]","content"],aQ(a,e));let f=ag(b,["config"]);null!=f&&function(a,b){let c=ag(a,["taskType"]);void 0!==b&&null!=c&&af(b,["requests[]","taskType"],c);let d=ag(a,["title"]);void 0!==b&&null!=d&&af(b,["requests[]","title"],d);let e=ag(a,["outputDimensionality"]);if(void 0!==b&&null!=e&&af(b,["requests[]","outputDimensionality"],e),void 0!==ag(a,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==ag(a,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.")}(f,c);let g=ag(b,["model"]);return void 0!==g&&af(c,["requests[]","model"],aE(a,g)),c}(this.apiClient,a);return f=ae("{model}:batchEmbedContents",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["embeddings"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["values"]);return null!=c&&af(b,["values"],c),b})(a))),af(b,["embeddings"],a)}return null!=ag(a,["metadata"])&&af(b,["metadata"],{}),b}(a),c=new ak;return Object.assign(c,b),c})}}async generateImagesInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["prompt"]);null!=e&&af(c,["instances[0]","prompt"],e);let f=ag(b,["config"]);return null!=f&&function(a,b){let c=ag(a,["outputGcsUri"]);void 0!==b&&null!=c&&af(b,["parameters","storageUri"],c);let d=ag(a,["negativePrompt"]);void 0!==b&&null!=d&&af(b,["parameters","negativePrompt"],d);let e=ag(a,["numberOfImages"]);void 0!==b&&null!=e&&af(b,["parameters","sampleCount"],e);let f=ag(a,["aspectRatio"]);void 0!==b&&null!=f&&af(b,["parameters","aspectRatio"],f);let g=ag(a,["guidanceScale"]);void 0!==b&&null!=g&&af(b,["parameters","guidanceScale"],g);let h=ag(a,["seed"]);void 0!==b&&null!=h&&af(b,["parameters","seed"],h);let i=ag(a,["safetyFilterLevel"]);void 0!==b&&null!=i&&af(b,["parameters","safetySetting"],i);let j=ag(a,["personGeneration"]);void 0!==b&&null!=j&&af(b,["parameters","personGeneration"],j);let k=ag(a,["includeSafetyAttributes"]);void 0!==b&&null!=k&&af(b,["parameters","includeSafetyAttributes"],k);let l=ag(a,["includeRaiReason"]);void 0!==b&&null!=l&&af(b,["parameters","includeRaiReason"],l);let m=ag(a,["language"]);void 0!==b&&null!=m&&af(b,["parameters","language"],m);let n=ag(a,["outputMimeType"]);void 0!==b&&null!=n&&af(b,["parameters","outputOptions","mimeType"],n);let o=ag(a,["outputCompressionQuality"]);void 0!==b&&null!=o&&af(b,["parameters","outputOptions","compressionQuality"],o);let p=ag(a,["addWatermark"]);void 0!==b&&null!=p&&af(b,["parameters","addWatermark"],p);let q=ag(a,["imageSize"]);void 0!==b&&null!=q&&af(b,["parameters","sampleImageSize"],q);let r=ag(a,["enhancePrompt"]);void 0!==b&&null!=r&&af(b,["parameters","enhancePrompt"],r)}(f,c),c}(this.apiClient,a);return f=ae("{model}:predict",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["predictions"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>bN(a))),af(b,["generatedImages"],a)}let e=ag(a,["positivePromptSafetyAttributes"]);return null!=e&&af(b,["positivePromptSafetyAttributes"],bU(e)),b}(a),c=new al;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["prompt"]);null!=e&&af(c,["instances[0]","prompt"],e);let f=ag(b,["config"]);return null!=f&&function(a,b){if(void 0!==ag(a,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==ag(a,["negativePrompt"]))throw Error("negativePrompt parameter is not supported in Gemini API.");let c=ag(a,["numberOfImages"]);void 0!==b&&null!=c&&af(b,["parameters","sampleCount"],c);let d=ag(a,["aspectRatio"]);void 0!==b&&null!=d&&af(b,["parameters","aspectRatio"],d);let e=ag(a,["guidanceScale"]);if(void 0!==b&&null!=e&&af(b,["parameters","guidanceScale"],e),void 0!==ag(a,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let f=ag(a,["safetyFilterLevel"]);void 0!==b&&null!=f&&af(b,["parameters","safetySetting"],f);let g=ag(a,["personGeneration"]);void 0!==b&&null!=g&&af(b,["parameters","personGeneration"],g);let h=ag(a,["includeSafetyAttributes"]);void 0!==b&&null!=h&&af(b,["parameters","includeSafetyAttributes"],h);let i=ag(a,["includeRaiReason"]);void 0!==b&&null!=i&&af(b,["parameters","includeRaiReason"],i);let j=ag(a,["language"]);void 0!==b&&null!=j&&af(b,["parameters","language"],j);let k=ag(a,["outputMimeType"]);void 0!==b&&null!=k&&af(b,["parameters","outputOptions","mimeType"],k);let l=ag(a,["outputCompressionQuality"]);if(void 0!==b&&null!=l&&af(b,["parameters","outputOptions","compressionQuality"],l),void 0!==ag(a,["addWatermark"]))throw Error("addWatermark parameter is not supported in Gemini API.");let m=ag(a,["imageSize"]);if(void 0!==b&&null!=m&&af(b,["parameters","sampleImageSize"],m),void 0!==ag(a,["enhancePrompt"]))throw Error("enhancePrompt parameter is not supported in Gemini API.")}(f,c),c}(this.apiClient,a);return f=ae("{model}:predict",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["predictions"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["_self"]);null!=c&&af(b,["image"],function(a){let b={},c=ag(a,["bytesBase64Encoded"]);null!=c&&af(b,["imageBytes"],ah(c));let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(c));let d=ag(a,["raiFilteredReason"]);null!=d&&af(b,["raiFilteredReason"],d);let e=ag(a,["_self"]);return null!=e&&af(b,["safetyAttributes"],bT(e)),b})(a))),af(b,["generatedImages"],a)}let e=ag(a,["positivePromptSafetyAttributes"]);return null!=e&&af(b,["positivePromptSafetyAttributes"],bT(e)),b}(a),c=new al;return Object.assign(c,b),c})}}async editImageInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["prompt"]);null!=e&&af(c,["instances[0]","prompt"],e);let f=ag(b,["referenceImages"]);if(null!=f){let a=f;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["referenceImage"]);null!=c&&af(b,["referenceImage"],bQ(c));let d=ag(a,["referenceId"]);null!=d&&af(b,["referenceId"],d);let e=ag(a,["referenceType"]);null!=e&&af(b,["referenceType"],e);let f=ag(a,["maskImageConfig"]);null!=f&&af(b,["maskImageConfig"],function(a){let b={},c=ag(a,["maskMode"]);null!=c&&af(b,["maskMode"],c);let d=ag(a,["segmentationClasses"]);null!=d&&af(b,["maskClasses"],d);let e=ag(a,["maskDilation"]);return null!=e&&af(b,["dilation"],e),b}(f));let g=ag(a,["controlImageConfig"]);null!=g&&af(b,["controlImageConfig"],function(a){let b={},c=ag(a,["controlType"]);null!=c&&af(b,["controlType"],c);let d=ag(a,["enableControlImageComputation"]);return null!=d&&af(b,["computeControl"],d),b}(g));let h=ag(a,["styleImageConfig"]);null!=h&&af(b,["styleImageConfig"],function(a){let b={},c=ag(a,["styleDescription"]);return null!=c&&af(b,["styleDescription"],c),b}(h));let i=ag(a,["subjectImageConfig"]);return null!=i&&af(b,["subjectImageConfig"],function(a){let b={},c=ag(a,["subjectType"]);null!=c&&af(b,["subjectType"],c);let d=ag(a,["subjectDescription"]);return null!=d&&af(b,["subjectDescription"],d),b}(i)),b})(a))),af(c,["instances[0]","referenceImages"],a)}let g=ag(b,["config"]);return null!=g&&function(a,b){let c=ag(a,["outputGcsUri"]);void 0!==b&&null!=c&&af(b,["parameters","storageUri"],c);let d=ag(a,["negativePrompt"]);void 0!==b&&null!=d&&af(b,["parameters","negativePrompt"],d);let e=ag(a,["numberOfImages"]);void 0!==b&&null!=e&&af(b,["parameters","sampleCount"],e);let f=ag(a,["aspectRatio"]);void 0!==b&&null!=f&&af(b,["parameters","aspectRatio"],f);let g=ag(a,["guidanceScale"]);void 0!==b&&null!=g&&af(b,["parameters","guidanceScale"],g);let h=ag(a,["seed"]);void 0!==b&&null!=h&&af(b,["parameters","seed"],h);let i=ag(a,["safetyFilterLevel"]);void 0!==b&&null!=i&&af(b,["parameters","safetySetting"],i);let j=ag(a,["personGeneration"]);void 0!==b&&null!=j&&af(b,["parameters","personGeneration"],j);let k=ag(a,["includeSafetyAttributes"]);void 0!==b&&null!=k&&af(b,["parameters","includeSafetyAttributes"],k);let l=ag(a,["includeRaiReason"]);void 0!==b&&null!=l&&af(b,["parameters","includeRaiReason"],l);let m=ag(a,["language"]);void 0!==b&&null!=m&&af(b,["parameters","language"],m);let n=ag(a,["outputMimeType"]);void 0!==b&&null!=n&&af(b,["parameters","outputOptions","mimeType"],n);let o=ag(a,["outputCompressionQuality"]);void 0!==b&&null!=o&&af(b,["parameters","outputOptions","compressionQuality"],o);let p=ag(a,["addWatermark"]);void 0!==b&&null!=p&&af(b,["parameters","addWatermark"],p);let q=ag(a,["editMode"]);void 0!==b&&null!=q&&af(b,["parameters","editMode"],q);let r=ag(a,["baseSteps"]);void 0!==b&&null!=r&&af(b,["parameters","editConfig","baseSteps"],r)}(g,c),c}(this.apiClient,a);return d=ae("{model}:predict",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["predictions"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>bN(a))),af(b,["generatedImages"],a)}return b}(a),c=new am;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["image"]);null!=e&&af(c,["instances[0]","image"],bQ(e));let f=ag(b,["upscaleFactor"]);null!=f&&af(c,["parameters","upscaleConfig","upscaleFactor"],f);let g=ag(b,["config"]);return null!=g&&function(a,b){let c=ag(a,["outputGcsUri"]);void 0!==b&&null!=c&&af(b,["parameters","storageUri"],c);let d=ag(a,["includeRaiReason"]);void 0!==b&&null!=d&&af(b,["parameters","includeRaiReason"],d);let e=ag(a,["outputMimeType"]);void 0!==b&&null!=e&&af(b,["parameters","outputOptions","mimeType"],e);let f=ag(a,["outputCompressionQuality"]);void 0!==b&&null!=f&&af(b,["parameters","outputOptions","compressionQuality"],f);let g=ag(a,["enhanceInputImage"]);void 0!==b&&null!=g&&af(b,["parameters","upscaleConfig","enhanceInputImage"],g);let h=ag(a,["imagePreservationFactor"]);void 0!==b&&null!=h&&af(b,["parameters","upscaleConfig","imagePreservationFactor"],h);let i=ag(a,["numberOfImages"]);void 0!==b&&null!=i&&af(b,["parameters","sampleCount"],i);let j=ag(a,["mode"]);void 0!==b&&null!=j&&af(b,["parameters","mode"],j)}(g,c),c}(this.apiClient,a);return d=ae("{model}:predict",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["predictions"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>bN(a))),af(b,["generatedImages"],a)}return b}(a),c=new an;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async recontextImage(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["source"]);null!=e&&function(a,b){let c=ag(a,["prompt"]);void 0!==b&&null!=c&&af(b,["instances[0]","prompt"],c);let d=ag(a,["personImage"]);void 0!==b&&null!=d&&af(b,["instances[0]","personImage","image"],bQ(d));let e=ag(a,["productImages"]);if(void 0!==b&&null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["productImage"]);return null!=c&&af(b,["image"],bQ(c)),b})(a))),af(b,["instances[0]","productImages"],a)}}(e,c);let f=ag(b,["config"]);return null!=f&&function(a,b){let c=ag(a,["numberOfImages"]);void 0!==b&&null!=c&&af(b,["parameters","sampleCount"],c);let d=ag(a,["baseSteps"]);void 0!==b&&null!=d&&af(b,["parameters","editConfig","baseSteps"],d);let e=ag(a,["outputGcsUri"]);void 0!==b&&null!=e&&af(b,["parameters","storageUri"],e);let f=ag(a,["seed"]);void 0!==b&&null!=f&&af(b,["parameters","seed"],f);let g=ag(a,["safetyFilterLevel"]);void 0!==b&&null!=g&&af(b,["parameters","safetySetting"],g);let h=ag(a,["personGeneration"]);void 0!==b&&null!=h&&af(b,["parameters","personGeneration"],h);let i=ag(a,["addWatermark"]);void 0!==b&&null!=i&&af(b,["parameters","addWatermark"],i);let j=ag(a,["outputMimeType"]);void 0!==b&&null!=j&&af(b,["parameters","outputOptions","mimeType"],j);let k=ag(a,["outputCompressionQuality"]);void 0!==b&&null!=k&&af(b,["parameters","outputOptions","compressionQuality"],k);let l=ag(a,["enhancePrompt"]);void 0!==b&&null!=l&&af(b,["parameters","enhancePrompt"],l)}(f,c),c}(this.apiClient,a);return d=ae("{model}:predict",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=ag(a,["predictions"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>bN(a))),af(b,["generatedImages"],a)}return b}(a),c=new ao;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async segmentImage(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["source"]);null!=e&&function(a,b){let c=ag(a,["prompt"]);void 0!==b&&null!=c&&af(b,["instances[0]","prompt"],c);let d=ag(a,["image"]);void 0!==b&&null!=d&&af(b,["instances[0]","image"],bQ(d));let e=ag(a,["scribbleImage"]);void 0!==b&&null!=e&&af(b,["instances[0]","scribble"],function(a){let b={},c=ag(a,["image"]);return null!=c&&af(b,["image"],bQ(c)),b}(e))}(e,c);let f=ag(b,["config"]);return null!=f&&function(a,b){let c=ag(a,["mode"]);void 0!==b&&null!=c&&af(b,["parameters","mode"],c);let d=ag(a,["maxPredictions"]);void 0!==b&&null!=d&&af(b,["parameters","maxPredictions"],d);let e=ag(a,["confidenceThreshold"]);void 0!==b&&null!=e&&af(b,["parameters","confidenceThreshold"],e);let f=ag(a,["maskDilation"]);void 0!==b&&null!=f&&af(b,["parameters","maskDilation"],f);let g=ag(a,["binaryColorThreshold"]);void 0!==b&&null!=g&&af(b,["parameters","binaryColorThreshold"],g)}(f,c),c}(this.apiClient,a);return d=ae("{model}:predict",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=ag(a,["predictions"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["_self"]);null!=c&&af(b,["mask"],bO(c));let d=ag(a,["labels"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["label"]);null!=c&&af(b,["label"],c);let d=ag(a,["score"]);return null!=d&&af(b,["score"],d),b})(a))),af(b,["labels"],a)}return b})(a))),af(b,["generatedMasks"],a)}return b}(a),c=new ap;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async get(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=ag(b,["model"]);return null!=d&&af(c,["_url","name"],aE(a,d)),c}(this.apiClient,a);return f=ae("{name}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>bS(a))}{let b=function(a,b){let c={},d=ag(b,["model"]);return null!=d&&af(c,["_url","name"],aE(a,d)),c}(this.apiClient,a);return f=ae("{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>bR(a))}}async listInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=ag(b,["config"]);return null!=d&&function(a,b,c){let d=ag(b,["pageSize"]);void 0!==c&&null!=d&&af(c,["_query","pageSize"],d);let e=ag(b,["pageToken"]);void 0!==c&&null!=e&&af(c,["_query","pageToken"],e);let f=ag(b,["filter"]);void 0!==c&&null!=f&&af(c,["_query","filter"],f);let g=ag(b,["queryBase"]);void 0!==c&&null!=g&&af(c,["_url","models_url"],a0(a,g))}(a,d,c),c}(this.apiClient,a);return f=ae("{models_url}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["nextPageToken"]);null!=d&&af(b,["nextPageToken"],d);let e=ag(a,["_self"]);if(null!=e){let a=a1(e);Array.isArray(a)&&(a=a.map(a=>bS(a))),af(b,["models"],a)}return b}(a),c=new aq;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=ag(b,["config"]);return null!=d&&function(a,b,c){let d=ag(b,["pageSize"]);void 0!==c&&null!=d&&af(c,["_query","pageSize"],d);let e=ag(b,["pageToken"]);void 0!==c&&null!=e&&af(c,["_query","pageToken"],e);let f=ag(b,["filter"]);void 0!==c&&null!=f&&af(c,["_query","filter"],f);let g=ag(b,["queryBase"]);void 0!==c&&null!=g&&af(c,["_url","models_url"],a0(a,g))}(a,d,c),c}(this.apiClient,a);return f=ae("{models_url}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["nextPageToken"]);null!=d&&af(b,["nextPageToken"],d);let e=ag(a,["_self"]);if(null!=e){let a=a1(e);Array.isArray(a)&&(a=a.map(a=>bR(a))),af(b,["models"],a)}return b}(a),c=new aq;return Object.assign(c,b),c})}}async update(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["config"]);return null!=e&&function(a,b){let c=ag(a,["displayName"]);void 0!==b&&null!=c&&af(b,["displayName"],c);let d=ag(a,["description"]);void 0!==b&&null!=d&&af(b,["description"],d);let e=ag(a,["defaultCheckpointId"]);void 0!==b&&null!=e&&af(b,["defaultCheckpointId"],e)}(e,c),c}(this.apiClient,a);return f=ae("{model}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>bS(a))}{let b=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","name"],aE(a,d));let e=ag(b,["config"]);return null!=e&&function(a,b){let c=ag(a,["displayName"]);void 0!==b&&null!=c&&af(b,["displayName"],c);let d=ag(a,["description"]);void 0!==b&&null!=d&&af(b,["description"],d);let e=ag(a,["defaultCheckpointId"]);void 0!==b&&null!=e&&af(b,["defaultCheckpointId"],e)}(e,c),c}(this.apiClient,a);return f=ae("{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"PATCH",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>bR(a))}}async delete(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=ag(b,["model"]);return null!=d&&af(c,["_url","name"],aE(a,d)),c}(this.apiClient,a);return f=ae("{name}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);return null!=c&&af(b,["sdkHttpResponse"],c),b}(a),c=new ar;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=ag(b,["model"]);return null!=d&&af(c,["_url","name"],aE(a,d)),c}(this.apiClient,a);return f=ae("{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"DELETE",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);return null!=c&&af(b,["sdkHttpResponse"],c),b}(a),c=new ar;return Object.assign(c,b),c})}}async countTokens(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["contents"]);if(null!=e){let a=aR(e);Array.isArray(a)&&(a=a.map(a=>bI(a))),af(c,["contents"],a)}let f=ag(b,["config"]);return null!=f&&function(a,b){let c=ag(a,["systemInstruction"]);void 0!==b&&null!=c&&af(b,["systemInstruction"],bI(aP(c)));let d=ag(a,["tools"]);if(void 0!==b&&null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>bV(a))),af(b,["tools"],a)}let e=ag(a,["generationConfig"]);void 0!==b&&null!=e&&af(b,["generationConfig"],e)}(f,c),c}(this.apiClient,a);return f=ae("{model}:countTokens",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["totalTokens"]);return null!=d&&af(b,["totalTokens"],d),b}(a),c=new as;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["contents"]);if(null!=e){let a=aR(e);Array.isArray(a)&&(a=a.map(a=>bH(a))),af(c,["contents"],a)}let f=ag(b,["config"]);return null!=f&&function(a){if(void 0!==ag(a,["systemInstruction"]))throw Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==ag(a,["tools"]))throw Error("tools parameter is not supported in Gemini API.");if(void 0!==ag(a,["generationConfig"]))throw Error("generationConfig parameter is not supported in Gemini API.")}(f),c}(this.apiClient,a);return f=ae("{model}:countTokens",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["totalTokens"]);null!=d&&af(b,["totalTokens"],d);let e=ag(a,["cachedContentTokenCount"]);return null!=e&&af(b,["cachedContentTokenCount"],e),b}(a),c=new as;return Object.assign(c,b),c})}}async computeTokens(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["contents"]);if(null!=e){let a=aR(e);Array.isArray(a)&&(a=a.map(a=>bI(a))),af(c,["contents"],a)}return c}(this.apiClient,a);return d=ae("{model}:computeTokens",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["tokensInfo"]);return null!=d&&af(b,["tokensInfo"],d),b}(a),c=new at;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["prompt"]);null!=e&&af(c,["instances[0]","prompt"],e);let f=ag(b,["image"]);null!=f&&af(c,["instances[0]","image"],bQ(f));let g=ag(b,["video"]);null!=g&&af(c,["instances[0]","video"],bW(g));let h=ag(b,["source"]);null!=h&&function(a,b){let c=ag(a,["prompt"]);void 0!==b&&null!=c&&af(b,["instances[0]","prompt"],c);let d=ag(a,["image"]);void 0!==b&&null!=d&&af(b,["instances[0]","image"],bQ(d));let e=ag(a,["video"]);void 0!==b&&null!=e&&af(b,["instances[0]","video"],bW(e))}(h,c);let i=ag(b,["config"]);return null!=i&&function(a,b){let c=ag(a,["numberOfVideos"]);void 0!==b&&null!=c&&af(b,["parameters","sampleCount"],c);let d=ag(a,["outputGcsUri"]);void 0!==b&&null!=d&&af(b,["parameters","storageUri"],d);let e=ag(a,["fps"]);void 0!==b&&null!=e&&af(b,["parameters","fps"],e);let f=ag(a,["durationSeconds"]);void 0!==b&&null!=f&&af(b,["parameters","durationSeconds"],f);let g=ag(a,["seed"]);void 0!==b&&null!=g&&af(b,["parameters","seed"],g);let h=ag(a,["aspectRatio"]);void 0!==b&&null!=h&&af(b,["parameters","aspectRatio"],h);let i=ag(a,["resolution"]);void 0!==b&&null!=i&&af(b,["parameters","resolution"],i);let j=ag(a,["personGeneration"]);void 0!==b&&null!=j&&af(b,["parameters","personGeneration"],j);let k=ag(a,["pubsubTopic"]);void 0!==b&&null!=k&&af(b,["parameters","pubsubTopic"],k);let l=ag(a,["negativePrompt"]);void 0!==b&&null!=l&&af(b,["parameters","negativePrompt"],l);let m=ag(a,["enhancePrompt"]);void 0!==b&&null!=m&&af(b,["parameters","enhancePrompt"],m);let n=ag(a,["generateAudio"]);void 0!==b&&null!=n&&af(b,["parameters","generateAudio"],n);let o=ag(a,["lastFrame"]);void 0!==b&&null!=o&&af(b,["instances[0]","lastFrame"],bQ(o));let p=ag(a,["referenceImages"]);if(void 0!==b&&null!=p){let a=p;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["image"]);null!=c&&af(b,["image"],bQ(c));let d=ag(a,["referenceType"]);return null!=d&&af(b,["referenceType"],d),b})(a))),af(b,["instances[0]","referenceImages"],a)}let q=ag(a,["mask"]);void 0!==b&&null!=q&&af(b,["instances[0]","mask"],function(a){let b={},c=ag(a,["image"]);null!=c&&af(b,["_self"],bQ(c));let d=ag(a,["maskMode"]);return null!=d&&af(b,["maskMode"],d),b}(q));let r=ag(a,["compressionQuality"]);void 0!==b&&null!=r&&af(b,["parameters","compressionQuality"],r)}(i,c),c}(this.apiClient,a);return f=ae("{model}:predictLongRunning",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=ag(a,["name"]);null!=c&&af(b,["name"],c);let d=ag(a,["metadata"]);null!=d&&af(b,["metadata"],d);let e=ag(a,["done"]);null!=e&&af(b,["done"],e);let f=ag(a,["error"]);null!=f&&af(b,["error"],f);let g=ag(a,["response"]);return null!=g&&af(b,["response"],function(a){let b={},c=ag(a,["videos"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["_self"]);return null!=c&&af(b,["video"],function(a){let b={},c=ag(a,["gcsUri"]);null!=c&&af(b,["uri"],c);let d=ag(a,["bytesBase64Encoded"]);null!=d&&af(b,["videoBytes"],ah(d));let e=ag(a,["mimeType"]);return null!=e&&af(b,["mimeType"],e),b}(c)),b})(a))),af(b,["generatedVideos"],a)}let d=ag(a,["raiMediaFilteredCount"]);null!=d&&af(b,["raiMediaFilteredCount"],d);let e=ag(a,["raiMediaFilteredReasons"]);return null!=e&&af(b,["raiMediaFilteredReasons"],e),b}(g)),b}(a),c=new au;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["_url","model"],aE(a,d));let e=ag(b,["prompt"]);null!=e&&af(c,["instances[0]","prompt"],e);let f=ag(b,["image"]);if(null!=f&&af(c,["instances[0]","image"],bP(f)),void 0!==ag(b,["video"]))throw Error("video parameter is not supported in Gemini API.");let g=ag(b,["source"]);null!=g&&function(a,b){let c=ag(a,["prompt"]);void 0!==b&&null!=c&&af(b,["instances[0]","prompt"],c);let d=ag(a,["image"]);if(void 0!==b&&null!=d&&af(b,["instances[0]","image"],bP(d)),void 0!==ag(a,["video"]))throw Error("video parameter is not supported in Gemini API.")}(g,c);let h=ag(b,["config"]);return null!=h&&function(a,b){let c=ag(a,["numberOfVideos"]);if(void 0!==b&&null!=c&&af(b,["parameters","sampleCount"],c),void 0!==ag(a,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==ag(a,["fps"]))throw Error("fps parameter is not supported in Gemini API.");let d=ag(a,["durationSeconds"]);if(void 0!==b&&null!=d&&af(b,["parameters","durationSeconds"],d),void 0!==ag(a,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let e=ag(a,["aspectRatio"]);void 0!==b&&null!=e&&af(b,["parameters","aspectRatio"],e);let f=ag(a,["resolution"]);void 0!==b&&null!=f&&af(b,["parameters","resolution"],f);let g=ag(a,["personGeneration"]);if(void 0!==b&&null!=g&&af(b,["parameters","personGeneration"],g),void 0!==ag(a,["pubsubTopic"]))throw Error("pubsubTopic parameter is not supported in Gemini API.");let h=ag(a,["negativePrompt"]);void 0!==b&&null!=h&&af(b,["parameters","negativePrompt"],h);let i=ag(a,["enhancePrompt"]);if(void 0!==b&&null!=i&&af(b,["parameters","enhancePrompt"],i),void 0!==ag(a,["generateAudio"]))throw Error("generateAudio parameter is not supported in Gemini API.");if(void 0!==ag(a,["lastFrame"]))throw Error("lastFrame parameter is not supported in Gemini API.");if(void 0!==ag(a,["referenceImages"]))throw Error("referenceImages parameter is not supported in Gemini API.");if(void 0!==ag(a,["mask"]))throw Error("mask parameter is not supported in Gemini API.");if(void 0!==ag(a,["compressionQuality"]))throw Error("compressionQuality parameter is not supported in Gemini API.")}(h,c),c}(this.apiClient,a);return f=ae("{model}:predictLongRunning",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=ag(a,["name"]);null!=c&&af(b,["name"],c);let d=ag(a,["metadata"]);null!=d&&af(b,["metadata"],d);let e=ag(a,["done"]);null!=e&&af(b,["done"],e);let f=ag(a,["error"]);null!=f&&af(b,["error"],f);let g=ag(a,["response","generateVideoResponse"]);return null!=g&&af(b,["response"],function(a){let b={},c=ag(a,["generatedSamples"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["_self"]);return null!=c&&af(b,["video"],function(a){let b={},c=ag(a,["video","uri"]);null!=c&&af(b,["uri"],c);let d=ag(a,["video","encodedVideo"]);null!=d&&af(b,["videoBytes"],ah(d));let e=ag(a,["encoding"]);return null!=e&&af(b,["mimeType"],e),b}(c)),b})(a))),af(b,["generatedVideos"],a)}let d=ag(a,["raiMediaFilteredCount"]);null!=d&&af(b,["raiMediaFilteredCount"],d);let e=ag(a,["raiMediaFilteredReasons"]);return null!=e&&af(b,["raiMediaFilteredReasons"],e),b}(g)),b}(a),c=new au;return Object.assign(c,b),c})}}}class ce extends ad{constructor(a){super(),this.apiClient=a}async getVideosOperation(a){let b=a.operation,c=a.config;if(void 0===b.name||""===b.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let a,d=b.name.split("/operations/")[0];c&&"httpOptions"in c&&(a=c.httpOptions);let e=await this.fetchPredictVideosOperationInternal({operationName:b.name,resourceName:d,config:{httpOptions:a}});return b._fromAPIResponse({apiResponse:e,isVertexAI:!0})}{let a=await this.getVideosOperationInternal({operationName:b.name,config:c});return b._fromAPIResponse({apiResponse:a,isVertexAI:!1})}}async get(a){let b=a.operation,c=a.config;if(void 0===b.name||""===b.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let a,d=b.name.split("/operations/")[0];c&&"httpOptions"in c&&(a=c.httpOptions);let e=await this.fetchPredictVideosOperationInternal({operationName:b.name,resourceName:d,config:{httpOptions:a}});return b._fromAPIResponse({apiResponse:e,isVertexAI:!0})}{let a=await this.getVideosOperationInternal({operationName:b.name,config:c});return b._fromAPIResponse({apiResponse:a,isVertexAI:!1})}}async getVideosOperationInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a){let b={},c=ag(a,["operationName"]);return null!=c&&af(b,["_url","operationName"],c),b}(a);return f=ae("{operationName}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json())}{let b=function(a){let b={},c=ag(a,["operationName"]);return null!=c&&af(b,["_url","operationName"],c),b}(a);return f=ae("{operationName}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json())}}async fetchPredictVideosOperationInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a){let b={},c=ag(a,["operationName"]);null!=c&&af(b,["operationName"],c);let d=ag(a,["resourceName"]);return null!=d&&af(b,["_url","resourceName"],d),b}(a);return d=ae("{resourceName}:fetchPredictOperation",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json())}throw Error("This method is only supported by the Vertex AI.")}}function cf(a){let b={},c=ag(a,["prebuiltVoiceConfig"]);return null!=c&&af(b,["prebuiltVoiceConfig"],function(a){let b={},c=ag(a,["voiceName"]);return null!=c&&af(b,["voiceName"],c),b}(c)),b}class cg extends ad{constructor(a){super(),this.apiClient=a}async create(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let f=function(a,b){let c={},d=ag(b,["config"]);return null!=d&&af(c,["config"],function(a,b,c){let d=ag(b,["expireTime"]);void 0!==c&&null!=d&&af(c,["expireTime"],d);let e=ag(b,["newSessionExpireTime"]);void 0!==c&&null!=e&&af(c,["newSessionExpireTime"],e);let f=ag(b,["uses"]);void 0!==c&&null!=f&&af(c,["uses"],f);let g=ag(b,["liveConnectConstraints"]);void 0!==c&&null!=g&&af(c,["bidiGenerateContentSetup"],function(a,b){let c={},d=ag(b,["model"]);null!=d&&af(c,["setup","model"],aE(a,d));let e=ag(b,["config"]);return null!=e&&af(c,["config"],function(a,b){let c=ag(a,["generationConfig"]);void 0!==b&&null!=c&&af(b,["setup","generationConfig"],c);let d=ag(a,["responseModalities"]);void 0!==b&&null!=d&&af(b,["setup","generationConfig","responseModalities"],d);let e=ag(a,["temperature"]);void 0!==b&&null!=e&&af(b,["setup","generationConfig","temperature"],e);let f=ag(a,["topP"]);void 0!==b&&null!=f&&af(b,["setup","generationConfig","topP"],f);let g=ag(a,["topK"]);void 0!==b&&null!=g&&af(b,["setup","generationConfig","topK"],g);let h=ag(a,["maxOutputTokens"]);void 0!==b&&null!=h&&af(b,["setup","generationConfig","maxOutputTokens"],h);let i=ag(a,["mediaResolution"]);void 0!==b&&null!=i&&af(b,["setup","generationConfig","mediaResolution"],i);let j=ag(a,["seed"]);void 0!==b&&null!=j&&af(b,["setup","generationConfig","seed"],j);let k=ag(a,["speechConfig"]);void 0!==b&&null!=k&&af(b,["setup","generationConfig","speechConfig"],function(a){let b={},c=ag(a,["voiceConfig"]);null!=c&&af(b,["voiceConfig"],cf(c));let d=ag(a,["multiSpeakerVoiceConfig"]);null!=d&&af(b,["multiSpeakerVoiceConfig"],function(a){let b={},c=ag(a,["speakerVoiceConfigs"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["speaker"]);null!=c&&af(b,["speaker"],c);let d=ag(a,["voiceConfig"]);return null!=d&&af(b,["voiceConfig"],cf(d)),b})(a))),af(b,["speakerVoiceConfigs"],a)}return b}(d));let e=ag(a,["languageCode"]);return null!=e&&af(b,["languageCode"],e),b}(aU(k)));let l=ag(a,["enableAffectiveDialog"]);void 0!==b&&null!=l&&af(b,["setup","generationConfig","enableAffectiveDialog"],l);let m=ag(a,["systemInstruction"]);void 0!==b&&null!=m&&af(b,["setup","systemInstruction"],function(a){let b={},c=ag(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["videoMetadata"]);null!=c&&af(b,["videoMetadata"],function(a){let b={},c=ag(a,["fps"]);null!=c&&af(b,["fps"],c);let d=ag(a,["endOffset"]);null!=d&&af(b,["endOffset"],d);let e=ag(a,["startOffset"]);return null!=e&&af(b,["startOffset"],e),b}(c));let d=ag(a,["thought"]);null!=d&&af(b,["thought"],d);let e=ag(a,["inlineData"]);null!=e&&af(b,["inlineData"],function(a){let b={};if(void 0!==ag(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=ag(a,["data"]);null!=c&&af(b,["data"],c);let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(e));let f=ag(a,["fileData"]);null!=f&&af(b,["fileData"],function(a){let b={};if(void 0!==ag(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=ag(a,["fileUri"]);null!=c&&af(b,["fileUri"],c);let d=ag(a,["mimeType"]);return null!=d&&af(b,["mimeType"],d),b}(f));let g=ag(a,["thoughtSignature"]);null!=g&&af(b,["thoughtSignature"],g);let h=ag(a,["functionCall"]);null!=h&&af(b,["functionCall"],function(a){let b={},c=ag(a,["id"]);null!=c&&af(b,["id"],c);let d=ag(a,["args"]);null!=d&&af(b,["args"],d);let e=ag(a,["name"]);return null!=e&&af(b,["name"],e),b}(h));let i=ag(a,["codeExecutionResult"]);null!=i&&af(b,["codeExecutionResult"],i);let j=ag(a,["executableCode"]);null!=j&&af(b,["executableCode"],j);let k=ag(a,["functionResponse"]);null!=k&&af(b,["functionResponse"],k);let l=ag(a,["text"]);return null!=l&&af(b,["text"],l),b})(a))),af(b,["parts"],a)}let d=ag(a,["role"]);return null!=d&&af(b,["role"],d),b}(aP(m)));let n=ag(a,["tools"]);if(void 0!==b&&null!=n){let a=aW(n);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["behavior"]);null!=c&&af(b,["behavior"],c);let d=ag(a,["description"]);null!=d&&af(b,["description"],d);let e=ag(a,["name"]);null!=e&&af(b,["name"],e);let f=ag(a,["parameters"]);null!=f&&af(b,["parameters"],f);let g=ag(a,["parametersJsonSchema"]);null!=g&&af(b,["parametersJsonSchema"],g);let h=ag(a,["response"]);null!=h&&af(b,["response"],h);let i=ag(a,["responseJsonSchema"]);return null!=i&&af(b,["responseJsonSchema"],i),b})(a))),af(b,["functionDeclarations"],a)}if(void 0!==ag(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=ag(a,["googleSearch"]);null!=d&&af(b,["googleSearch"],function(a){let b={},c=ag(a,["timeRangeFilter"]);if(null!=c&&af(b,["timeRangeFilter"],function(a){let b={},c=ag(a,["startTime"]);null!=c&&af(b,["startTime"],c);let d=ag(a,["endTime"]);return null!=d&&af(b,["endTime"],d),b}(c)),void 0!==ag(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return b}(d));let e=ag(a,["googleSearchRetrieval"]);if(null!=e&&af(b,["googleSearchRetrieval"],function(a){let b={},c=ag(a,["dynamicRetrievalConfig"]);return null!=c&&af(b,["dynamicRetrievalConfig"],function(a){let b={},c=ag(a,["mode"]);null!=c&&af(b,["mode"],c);let d=ag(a,["dynamicThreshold"]);return null!=d&&af(b,["dynamicThreshold"],d),b}(c)),b}(e)),void 0!==ag(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==ag(a,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");null!=ag(a,["urlContext"])&&af(b,["urlContext"],{});let f=ag(a,["computerUse"]);null!=f&&af(b,["computerUse"],function(a){let b={},c=ag(a,["environment"]);null!=c&&af(b,["environment"],c);let d=ag(a,["excludedPredefinedFunctions"]);return null!=d&&af(b,["excludedPredefinedFunctions"],d),b}(f));let g=ag(a,["codeExecution"]);return null!=g&&af(b,["codeExecution"],g),b})(aV(a)))),af(b,["setup","tools"],a)}let o=ag(a,["sessionResumption"]);void 0!==b&&null!=o&&af(b,["setup","sessionResumption"],function(a){let b={},c=ag(a,["handle"]);if(null!=c&&af(b,["handle"],c),void 0!==ag(a,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return b}(o));let p=ag(a,["inputAudioTranscription"]);void 0!==b&&null!=p&&af(b,["setup","inputAudioTranscription"],{});let q=ag(a,["outputAudioTranscription"]);void 0!==b&&null!=q&&af(b,["setup","outputAudioTranscription"],{});let r=ag(a,["realtimeInputConfig"]);void 0!==b&&null!=r&&af(b,["setup","realtimeInputConfig"],function(a){let b={},c=ag(a,["automaticActivityDetection"]);null!=c&&af(b,["automaticActivityDetection"],function(a){let b={},c=ag(a,["disabled"]);null!=c&&af(b,["disabled"],c);let d=ag(a,["startOfSpeechSensitivity"]);null!=d&&af(b,["startOfSpeechSensitivity"],d);let e=ag(a,["endOfSpeechSensitivity"]);null!=e&&af(b,["endOfSpeechSensitivity"],e);let f=ag(a,["prefixPaddingMs"]);null!=f&&af(b,["prefixPaddingMs"],f);let g=ag(a,["silenceDurationMs"]);return null!=g&&af(b,["silenceDurationMs"],g),b}(c));let d=ag(a,["activityHandling"]);null!=d&&af(b,["activityHandling"],d);let e=ag(a,["turnCoverage"]);return null!=e&&af(b,["turnCoverage"],e),b}(r));let s=ag(a,["contextWindowCompression"]);void 0!==b&&null!=s&&af(b,["setup","contextWindowCompression"],function(a){let b={},c=ag(a,["triggerTokens"]);null!=c&&af(b,["triggerTokens"],c);let d=ag(a,["slidingWindow"]);return null!=d&&af(b,["slidingWindow"],function(a){let b={},c=ag(a,["targetTokens"]);return null!=c&&af(b,["targetTokens"],c),b}(d)),b}(s));let t=ag(a,["proactivity"]);return void 0!==b&&null!=t&&af(b,["setup","proactivity"],function(a){let b={},c=ag(a,["proactiveAudio"]);return null!=c&&af(b,["proactiveAudio"],c),b}(t)),{}}(e,c)),c}(a,g));let h=ag(b,["lockAdditionalFields"]);return void 0!==c&&null!=h&&af(c,["fieldMask"],h),{}}(a,d,c)),c}(this.apiClient,a);d=ae("auth_tokens",f._url),e=f._query,delete f.config,delete f._url,delete f._query;let g=function(a,b){let c=null,d=a.bidiGenerateContentSetup;if("object"==typeof d&&null!==d&&"setup"in d){let b=d.setup;"object"==typeof b&&null!==b?(a.bidiGenerateContentSetup=b,c=b):delete a.bidiGenerateContentSetup}else void 0!==d&&delete a.bidiGenerateContentSetup;let e=a.fieldMask;if(c){let d=function(a){let b=[];for(let c in a)if(Object.prototype.hasOwnProperty.call(a,c)){let d=a[c];if("object"==typeof d&&null!=d&&Object.keys(d).length>0){let a=Object.keys(d).map(a=>`${c}.${a}`);b.push(...a)}else b.push(c)}return b.join(",")}(c);if(Array.isArray(null==b?void 0:b.lockAdditionalFields)&&(null==b?void 0:b.lockAdditionalFields.length)===0)d?a.fieldMask=d:delete a.fieldMask;else if((null==b?void 0:b.lockAdditionalFields)&&b.lockAdditionalFields.length>0&&null!==e&&Array.isArray(e)&&e.length>0){let b=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],c=[];e.length>0&&(c=e.map(a=>b.includes(a)?`generationConfig.${a}`:a));let f=[];d&&f.push(d),c.length>0&&f.push(...c),f.length>0?a.fieldMask=f.join(","):delete a.fieldMask}else delete a.fieldMask}else null!==e&&Array.isArray(e)&&e.length>0?a.fieldMask=e.join(","):delete a.fieldMask;return a}(f,a.config);return this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(g),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>(function(a){let b={},c=ag(a,["name"]);return null!=c&&af(b,["name"],c),b})(a))}}}let ch="x-goog-api-key",ci="https://www.googleapis.com/auth/cloud-platform";class cj{constructor(a){if(void 0!==a.apiKey){this.apiKey=a.apiKey;return}let b=function(a){let b;if(!a)return{scopes:[ci]};if((b=a).scopes){if("string"==typeof b.scopes&&b.scopes!==ci||Array.isArray(b.scopes)&&0>b.scopes.indexOf(ci))throw Error(`Invalid auth scopes. Scopes must include: ${ci}`)}else b.scopes=[ci];return b}(a.googleAuthOptions);this.googleAuth=new $.GoogleAuth(b)}async addAuthHeaders(a){if(void 0!==this.apiKey){if(this.apiKey.startsWith("auth_tokens/"))throw Error("Ephemeral tokens are only supported by the live API.");this.addKeyHeader(a);return}return this.addGoogleAuthHeaders(a)}addKeyHeader(a){if(null===a.get(ch)){if(void 0===this.apiKey)throw Error("Trying to set API key header but apiKey is not set");a.append(ch,this.apiKey)}}async addGoogleAuthHeaders(a){if(void 0===this.googleAuth)throw Error("Trying to set google-auth headers but googleAuth is unset");let b=await this.googleAuth.getRequestHeaders();for(let c in b)null===a.get(c)&&a.append(c,b[c])}}class ck{async download(a,b){if(a.downloadPath){let c=await cl(a,b);if(c instanceof ai){let b=(0,_.createWriteStream)(a.downloadPath);aa.Readable.fromWeb(c.responseInternal.body).pipe(b)}else(0,_.writeFile)(a.downloadPath,c,{encoding:"base64"},b=>{if(b)throw Error(`Failed to write file to ${a.downloadPath}: ${b}`)})}}}async function cl(a,b){var c,d,e;let f=a_(a.file);if(void 0!==f)return await b.request({path:`files/${f}:download`,httpMethod:"GET",queryParams:{alt:"media"},httpOptions:null==(c=a.config)?void 0:c.httpOptions,abortSignal:null==(d=a.config)?void 0:d.abortSignal});if(aZ(a.file)){let b=null==(e=a.file.video)?void 0:e.videoBytes;if("string"==typeof b)return b;throw Error("Failed to download generated video, Uri or videoBytes not found.")}if(a$(a.file)){let b=a.file.videoBytes;if("string"==typeof b)return b;throw Error("Failed to download video, Uri or videoBytes not found.")}throw Error("Unsupported file type")}class cm{create(a,b,c){return new cn(a,b,c)}}class cn{constructor(a,b,c){this.url=a,this.headers=b,this.callbacks=c}connect(){this.ws=new ab.default(this.url,{headers:this.headers}),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(a){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.send(a)}close(){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.close()}}function co(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["name"]);null!=d&&af(b,["name"],d);let e=ag(a,["state"]);null!=e&&af(b,["state"],aY(e));let f=ag(a,["createTime"]);null!=f&&af(b,["createTime"],f);let g=ag(a,["tuningTask","startTime"]);null!=g&&af(b,["startTime"],g);let h=ag(a,["tuningTask","completeTime"]);null!=h&&af(b,["endTime"],h);let i=ag(a,["updateTime"]);null!=i&&af(b,["updateTime"],i);let j=ag(a,["description"]);null!=j&&af(b,["description"],j);let k=ag(a,["baseModel"]);null!=k&&af(b,["baseModel"],k);let l=ag(a,["_self"]);null!=l&&af(b,["tunedModel"],function(a){let b={},c=ag(a,["name"]);null!=c&&af(b,["model"],c);let d=ag(a,["name"]);return null!=d&&af(b,["endpoint"],d),b}(l));let m=ag(a,["customBaseModel"]);null!=m&&af(b,["customBaseModel"],m);let n=ag(a,["experiment"]);null!=n&&af(b,["experiment"],n);let o=ag(a,["labels"]);null!=o&&af(b,["labels"],o);let p=ag(a,["outputUri"]);null!=p&&af(b,["outputUri"],p);let q=ag(a,["pipelineJob"]);null!=q&&af(b,["pipelineJob"],q);let r=ag(a,["serviceAccount"]);null!=r&&af(b,["serviceAccount"],r);let s=ag(a,["tunedModelDisplayName"]);return null!=s&&af(b,["tunedModelDisplayName"],s),b}function cp(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["name"]);null!=d&&af(b,["name"],d);let e=ag(a,["state"]);null!=e&&af(b,["state"],aY(e));let f=ag(a,["createTime"]);null!=f&&af(b,["createTime"],f);let g=ag(a,["startTime"]);null!=g&&af(b,["startTime"],g);let h=ag(a,["endTime"]);null!=h&&af(b,["endTime"],h);let i=ag(a,["updateTime"]);null!=i&&af(b,["updateTime"],i);let j=ag(a,["error"]);null!=j&&af(b,["error"],j);let k=ag(a,["description"]);null!=k&&af(b,["description"],k);let l=ag(a,["baseModel"]);null!=l&&af(b,["baseModel"],l);let m=ag(a,["tunedModel"]);null!=m&&af(b,["tunedModel"],function(a){let b={},c=ag(a,["model"]);null!=c&&af(b,["model"],c);let d=ag(a,["endpoint"]);null!=d&&af(b,["endpoint"],d);let e=ag(a,["checkpoints"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["checkpointId"]);null!=c&&af(b,["checkpointId"],c);let d=ag(a,["epoch"]);null!=d&&af(b,["epoch"],d);let e=ag(a,["step"]);null!=e&&af(b,["step"],e);let f=ag(a,["endpoint"]);return null!=f&&af(b,["endpoint"],f),b})(a))),af(b,["checkpoints"],a)}return b}(m));let n=ag(a,["preTunedModel"]);null!=n&&af(b,["preTunedModel"],n);let o=ag(a,["supervisedTuningSpec"]);null!=o&&af(b,["supervisedTuningSpec"],o);let p=ag(a,["tuningDataStats"]);null!=p&&af(b,["tuningDataStats"],p);let q=ag(a,["encryptionSpec"]);null!=q&&af(b,["encryptionSpec"],q);let r=ag(a,["partnerModelTuningSpec"]);null!=r&&af(b,["partnerModelTuningSpec"],r);let s=ag(a,["customBaseModel"]);null!=s&&af(b,["customBaseModel"],s);let t=ag(a,["experiment"]);null!=t&&af(b,["experiment"],t);let u=ag(a,["labels"]);null!=u&&af(b,["labels"],u);let v=ag(a,["outputUri"]);null!=v&&af(b,["outputUri"],v);let w=ag(a,["pipelineJob"]);null!=w&&af(b,["pipelineJob"],w);let x=ag(a,["serviceAccount"]);null!=x&&af(b,["serviceAccount"],x);let y=ag(a,["tunedModelDisplayName"]);return null!=y&&af(b,["tunedModelDisplayName"],y),b}class cq extends ad{constructor(a){super(),this.apiClient=a,this.get=async a=>await this.getInternal(a),this.list=async(a={})=>new be(Z.PAGED_ITEM_TUNING_JOBS,a=>this.listInternal(a),await this.listInternal(a),a),this.tune=async a=>{var b;if(this.apiClient.isVertexAI())if(a.baseModel.startsWith("projects/")){let c={tunedModelName:a.baseModel};(null==(b=a.config)?void 0:b.preTunedModelCheckpointId)&&(c.checkpointId=a.config.preTunedModelCheckpointId);let d=Object.assign(Object.assign({},a),{preTunedModel:c});return d.baseModel=void 0,await this.tuneInternal(d)}else{let b=Object.assign({},a);return await this.tuneInternal(b)}{let b=Object.assign({},a),c=await this.tuneMldevInternal(b),d="";return void 0!==c.metadata&&void 0!==c.metadata.tunedModel?d=c.metadata.tunedModel:void 0!==c.name&&c.name.includes("/operations/")&&(d=c.name.split("/operations/")[0]),{name:d,state:u.JOB_STATE_QUEUED}}}}async getInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a){let b={},c=ag(a,["name"]);return null!=c&&af(b,["_url","name"],c),b}(a);return f=ae("{name}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>cp(a))}{let b=function(a){let b={},c=ag(a,["name"]);return null!=c&&af(b,["_url","name"],c),b}(a);return f=ae("{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>co(a))}}async listInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a){let b={},c=ag(a,["config"]);return null!=c&&function(a,b){let c=ag(a,["pageSize"]);void 0!==b&&null!=c&&af(b,["_query","pageSize"],c);let d=ag(a,["pageToken"]);void 0!==b&&null!=d&&af(b,["_query","pageToken"],d);let e=ag(a,["filter"]);void 0!==b&&null!=e&&af(b,["_query","filter"],e)}(c,b),b}(a);return f=ae("tuningJobs",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["nextPageToken"]);null!=d&&af(b,["nextPageToken"],d);let e=ag(a,["tuningJobs"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>cp(a))),af(b,["tuningJobs"],a)}return b}(a),c=new av;return Object.assign(c,b),c})}{let b=function(a){let b={},c=ag(a,["config"]);return null!=c&&function(a,b){let c=ag(a,["pageSize"]);void 0!==b&&null!=c&&af(b,["_query","pageSize"],c);let d=ag(a,["pageToken"]);void 0!==b&&null!=d&&af(b,["_query","pageToken"],d);let e=ag(a,["filter"]);void 0!==b&&null!=e&&af(b,["_query","filter"],e)}(c,b),b}(a);return f=ae("tunedModels",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["nextPageToken"]);null!=d&&af(b,["nextPageToken"],d);let e=ag(a,["tunedModels"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>co(a))),af(b,["tuningJobs"],a)}return b}(a),c=new av;return Object.assign(c,b),c})}}async cancel(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a){let b={},c=ag(a,["name"]);return null!=c&&af(b,["_url","name"],c),b}(a);f=ae("{name}:cancel",d._url),g=d._query,delete d._url,delete d._query,await this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal})}else{let b=function(a){let b={},c=ag(a,["name"]);return null!=c&&af(b,["_url","name"],c),b}(a);f=ae("{name}:cancel",b._url),g=b._query,delete b._url,delete b._query,await this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal})}}async tuneInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a){let b={},c=ag(a,["baseModel"]);null!=c&&af(b,["baseModel"],c);let d=ag(a,["preTunedModel"]);null!=d&&af(b,["preTunedModel"],d);let e=ag(a,["trainingDataset"]);null!=e&&af(b,["supervisedTuningSpec","trainingDatasetUri"],function(a,b){let c=ag(a,["gcsUri"]);void 0!==b&&null!=c&&af(b,["supervisedTuningSpec","trainingDatasetUri"],c);let d=ag(a,["vertexDatasetResource"]);if(void 0!==b&&null!=d&&af(b,["supervisedTuningSpec","trainingDatasetUri"],d),void 0!==ag(a,["examples"]))throw Error("examples parameter is not supported in Vertex AI.");return{}}(e,b));let f=ag(a,["config"]);return null!=f&&function(a,b){let c=ag(a,["validationDataset"]);void 0!==b&&null!=c&&af(b,["supervisedTuningSpec"],function(a,b){let c={},d=ag(a,["gcsUri"]);null!=d&&af(c,["validationDatasetUri"],d);let e=ag(a,["vertexDatasetResource"]);return void 0!==b&&null!=e&&af(b,["supervisedTuningSpec","trainingDatasetUri"],e),c}(c,{}));let d=ag(a,["tunedModelDisplayName"]);void 0!==b&&null!=d&&af(b,["tunedModelDisplayName"],d);let e=ag(a,["description"]);void 0!==b&&null!=e&&af(b,["description"],e);let f=ag(a,["epochCount"]);void 0!==b&&null!=f&&af(b,["supervisedTuningSpec","hyperParameters","epochCount"],f);let g=ag(a,["learningRateMultiplier"]);void 0!==b&&null!=g&&af(b,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],g);let h=ag(a,["exportLastCheckpointOnly"]);void 0!==b&&null!=h&&af(b,["supervisedTuningSpec","exportLastCheckpointOnly"],h);let i=ag(a,["adapterSize"]);if(void 0!==b&&null!=i&&af(b,["supervisedTuningSpec","hyperParameters","adapterSize"],i),void 0!==ag(a,["batchSize"]))throw Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==ag(a,["learningRate"]))throw Error("learningRate parameter is not supported in Vertex AI.");let j=ag(a,["labels"]);void 0!==b&&null!=j&&af(b,["labels"],j)}(f,b),b}(a);return d=ae("tuningJobs",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>cp(a))}throw Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=ag(a,["baseModel"]);null!=c&&af(b,["baseModel"],c);let d=ag(a,["preTunedModel"]);null!=d&&af(b,["preTunedModel"],d);let e=ag(a,["trainingDataset"]);null!=e&&af(b,["tuningTask","trainingData"],function(a){let b={};if(void 0!==ag(a,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==ag(a,["vertexDatasetResource"]))throw Error("vertexDatasetResource parameter is not supported in Gemini API.");let c=ag(a,["examples"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=ag(a,["textInput"]);null!=c&&af(b,["textInput"],c);let d=ag(a,["output"]);return null!=d&&af(b,["output"],d),b})(a))),af(b,["examples","examples"],a)}return b}(e));let f=ag(a,["config"]);return null!=f&&function(a,b){if(void 0!==ag(a,["validationDataset"]))throw Error("validationDataset parameter is not supported in Gemini API.");let c=ag(a,["tunedModelDisplayName"]);if(void 0!==b&&null!=c&&af(b,["displayName"],c),void 0!==ag(a,["description"]))throw Error("description parameter is not supported in Gemini API.");let d=ag(a,["epochCount"]);void 0!==b&&null!=d&&af(b,["tuningTask","hyperparameters","epochCount"],d);let e=ag(a,["learningRateMultiplier"]);if(null!=e&&af({},["tuningTask","hyperparameters","learningRateMultiplier"],e),void 0!==ag(a,["exportLastCheckpointOnly"]))throw Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==ag(a,["preTunedModelCheckpointId"]))throw Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==ag(a,["adapterSize"]))throw Error("adapterSize parameter is not supported in Gemini API.");let f=ag(a,["batchSize"]);void 0!==b&&null!=f&&af(b,["tuningTask","hyperparameters","batchSize"],f);let g=ag(a,["learningRate"]);if(void 0!==b&&null!=g&&af(b,["tuningTask","hyperparameters","learningRate"],g),void 0!==ag(a,["labels"]))throw Error("labels parameter is not supported in Gemini API.")}(f,b),b}(a);return d=ae("tunedModels",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>(function(a){let b={},c=ag(a,["sdkHttpResponse"]);null!=c&&af(b,["sdkHttpResponse"],c);let d=ag(a,["name"]);null!=d&&af(b,["name"],d);let e=ag(a,["metadata"]);null!=e&&af(b,["metadata"],e);let f=ag(a,["done"]);null!=f&&af(b,["done"],f);let g=ag(a,["error"]);return null!=g&&af(b,["error"],g),b})(a))}}}let cr="x-goog-upload-status";async function cs(a,b,c){var d,e,f;let g=0,h=0,i=new ai(new Response),j="upload";for(g=a.size;h<g;){let f=Math.min(8388608,g-h),k=a.slice(h,h+f);h+f>=g&&(j+=", finalize");let l=0,m=1e3;for(;l<3&&(null==(d=null==(i=await c.request({path:"",body:k,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:b,headers:{"X-Goog-Upload-Command":j,"X-Goog-Upload-Offset":String(h),"Content-Length":String(f)}}}))?void 0:i.headers)||!d[cr]);)l++,await cu(m),m*=2;if(h+=f,(null==(e=null==i?void 0:i.headers)?void 0:e[cr])!=="active")break;if(g<=h)throw Error("All content has been uploaded, but the upload status is not finalized.")}let k=await (null==i?void 0:i.json());if((null==(f=null==i?void 0:i.headers)?void 0:f[cr])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return k.file}async function ct(a){return{size:a.size,type:a.type}}function cu(a){return new Promise(b=>setTimeout(b,a))}class cv{async stat(a){let b={size:0,type:void 0};return"string"==typeof a?(b.size=(await ac.stat(a)).size,b.type=this.inferMimeType(a),b):await ct(a)}async upload(a,b,c){return"string"==typeof a?await this.uploadFileFromPath(a,b,c):cs(a,b,c)}inferMimeType(a){return({aac:"audio/aac",abw:"application/x-abiword",arc:"application/x-freearc",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bmp:"image/bmp",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gz:"application/gzip",gif:"image/gif",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"text/javascript",json:"application/json",jsonld:"application/ld+json",kml:"application/vnd.google-earth.kml+xml",kmz:"application/vnd.google-earth.kmz+xml",mjs:"text/javascript",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",opus:"audio/opus",otf:"font/otf",png:"image/png",pdf:"application/pdf",php:"application/x-httpd-php",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/vnd.rar",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",ts:"video/mp2t",ttf:"font/ttf",txt:"text/plain",vsd:"application/vnd.visio",wav:"audio/wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip","3gp":"video/3gpp","3g2":"video/3gpp2","7z":"application/x-7z-compressed"})[a.slice(a.lastIndexOf(".")+1).toLowerCase()]}async uploadFileFromPath(a,b,c){var d,e,f;let g,h=0,i=0,j=new ai(new Response),k="upload";try{if(!(g=await ac.open(a,"r")))throw Error("Failed to open file");for(h=(await g.stat()).size;i<h;){let a=Math.min(8388608,h-i);i+a>=h&&(k+=", finalize");let f=new Uint8Array(a),{bytesRead:l}=await g.read(f,0,a,i);if(l!==a)throw Error(`Failed to read ${a} bytes from file at offset ${i}. bytes actually read: ${l}`);let m=new Blob([f]),n=0,o=1e3;for(;n<3&&(null==(d=null==(j=await c.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:b,headers:{"X-Goog-Upload-Command":k,"X-Goog-Upload-Offset":String(i),"Content-Length":String(l)}}}))?void 0:j.headers)||!d[cr]);)n++,await cu(o),o*=2;if(i+=l,(null==(e=null==j?void 0:j.headers)?void 0:e[cr])!=="active")break;if(h<=i)throw Error("All content has been uploaded, but the upload status is not finalized.")}let l=await (null==j?void 0:j.json());if((null==(f=null==j?void 0:j.headers)?void 0:f[cr])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return l.file}finally{g&&await g.close()}}}class cw{constructor(a){var d,e,f,g,h,i;if((a.project||a.location)&&a.apiKey)throw Error("Project/location and API key are mutually exclusive in the client initializer.");this.vertexai=null!=(e=null!=(d=a.vertexai)?d:function(a){var b;return void 0!==(b=cx(a))&&"true"===b.toLowerCase()}("GOOGLE_GENAI_USE_VERTEXAI"))&&e;let j=function(){let a=cx("GOOGLE_API_KEY"),b=cx("GEMINI_API_KEY");return a&&b&&console.warn("Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY."),a||b||void 0}(),k=cx("GOOGLE_CLOUD_PROJECT"),l=cx("GOOGLE_CLOUD_LOCATION");this.apiKey=null!=(f=a.apiKey)?f:j,this.project=null!=(g=a.project)?g:k,this.location=null!=(h=a.location)?h:l,a.vertexai&&((null==(i=a.googleAuthOptions)?void 0:i.credentials)&&(console.debug("The user provided Google Cloud credentials will take precedence over the API key from the environment variable."),this.apiKey=void 0),(k||l)&&a.apiKey?(console.debug("The user provided Vertex AI API key will take precedence over the project/location from the environment variables."),this.project=void 0,this.location=void 0):(a.project||a.location)&&j?(console.debug("The user provided project/location will take precedence over the API key from the environment variables."),this.apiKey=void 0):(k||l)&&j&&(console.debug("The project/location from the environment variables will take precedence over the API key from the environment variables."),this.apiKey=void 0));let m=function(a,d,e,f){return(null==a?void 0:a.baseUrl)?a.baseUrl:d?null!=c?c:e:null!=b?b:f}(a.httpOptions,a.vertexai,cx("GOOGLE_VERTEX_BASE_URL"),cx("GOOGLE_GEMINI_BASE_URL"));m&&(a.httpOptions?a.httpOptions.baseUrl=m:a.httpOptions={baseUrl:m}),this.apiVersion=a.apiVersion;let n=new cj({apiKey:this.apiKey,googleAuthOptions:a.googleAuthOptions});this.apiClient=new b$({auth:n,project:this.project,location:this.location,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:a.httpOptions,userAgentExtra:"gl-node/"+process.version,uploader:new cv,downloader:new ck}),this.models=new cd(this.apiClient),this.live=new b7(this.apiClient,n,new cm),this.batches=new bf(this.apiClient),this.chats=new bq(this.models,this.apiClient),this.caches=new bk(this.apiClient),this.files=new bu(this.apiClient),this.operations=new ce(this.apiClient),this.authTokens=new cg(this.apiClient),this.tunings=new cq(this.apiClient)}}function cx(a){var b,c,d;return null!=(d=null==(c=null==(b=null==process?void 0:process.env)?void 0:b[a])?void 0:c.trim())?d:void 0}}];

//# sourceMappingURL=node_modules_a21cd2d7._.js.map